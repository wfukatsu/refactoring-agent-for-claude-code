<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <defs>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#667eea"/>
      <stop offset="100%" style="stop-color:#764ba2"/>
    </linearGradient>
    <linearGradient id="phaseGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4facfe"/>
      <stop offset="100%" style="stop-color:#00f2fe"/>
    </linearGradient>
    <linearGradient id="graphGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#43e97b"/>
      <stop offset="100%" style="stop-color:#38f9d7"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="600" fill="#f8fafc"/>

  <!-- Title -->
  <rect x="20" y="15" width="860" height="45" rx="8" fill="url(#headerGrad)" filter="url(#shadow)"/>
  <text x="450" y="45" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="20" font-weight="bold">/refactor-system パイプライン</text>

  <!-- Orchestrator Box -->
  <rect x="30" y="75" width="840" height="510" rx="10" fill="white" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
  <text x="450" y="100" text-anchor="middle" fill="#334155" font-family="Arial, sans-serif" font-size="14" font-weight="bold">オーケストレーター</text>

  <!-- Phase boxes -->
  <!-- Phase 1 -->
  <rect x="50" y="120" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="125" y="150" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 1</text>
  <text x="125" y="170" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/analyze-system</text>

  <!-- Arrow 1 -->
  <path d="M200 155 L220 155" stroke="#94a3b8" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  <polygon points="220,155 215,150 215,160" fill="#94a3b8"/>

  <!-- Phase 2 -->
  <rect x="230" y="120" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="305" y="150" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 2</text>
  <text x="305" y="170" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/evaluate-mmi</text>

  <!-- Arrow 2 -->
  <path d="M380 155 L400 155" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="400,155 395,150 395,160" fill="#94a3b8"/>

  <!-- Phase 3 -->
  <rect x="410" y="120" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="485" y="150" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 3</text>
  <text x="485" y="170" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/map-domains</text>

  <!-- Arrow 3 -->
  <path d="M560 155 L580 155" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="580,155 575,150 575,160" fill="#94a3b8"/>

  <!-- Phase 4 -->
  <rect x="590" y="120" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="665" y="150" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 4</text>
  <text x="665" y="170" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/design-microservices</text>

  <!-- Arrow down from Phase 4 -->
  <path d="M665 190 L665 210" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="665,210 660,205 670,205" fill="#94a3b8"/>

  <!-- Phase 4.5 -->
  <rect x="590" y="220" width="150" height="70" rx="8" fill="#a78bfa" filter="url(#shadow)"/>
  <text x="665" y="250" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 4.5</text>
  <text x="665" y="270" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/design-api</text>

  <!-- Arrow back left -->
  <path d="M590 255 L570 255 L570 255" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="570,255 575,250 575,260" fill="#94a3b8"/>

  <!-- Phase 5 -->
  <rect x="410" y="220" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="485" y="250" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 5</text>
  <text x="485" y="270" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/design-scalardb</text>

  <!-- Arrow left -->
  <path d="M410 255 L390 255" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="390,255 395,250 395,260" fill="#94a3b8"/>

  <!-- Phase 5.5 (optional) -->
  <rect x="230" y="220" width="150" height="70" rx="8" fill="#a78bfa" stroke="#8b5cf6" stroke-width="2" stroke-dasharray="5,5" filter="url(#shadow)"/>
  <text x="305" y="245" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 5.5</text>
  <text x="305" y="265" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10">/design-scalardb-analytics</text>
  <text x="305" y="280" text-anchor="middle" fill="#fef3c7" font-family="Arial, sans-serif" font-size="9">(optional)</text>

  <!-- Arrow left -->
  <path d="M230 255 L210 255" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="210,255 215,250 215,260" fill="#94a3b8"/>

  <!-- Phase 6 -->
  <rect x="50" y="220" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="125" y="250" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 6</text>
  <text x="125" y="270" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/create-domain-story</text>

  <!-- Arrow down -->
  <path d="M125 290 L125 310" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="125,310 120,305 130,305" fill="#94a3b8"/>

  <!-- Phase 7 -->
  <rect x="50" y="320" width="150" height="70" rx="8" fill="url(#phaseGrad)" filter="url(#shadow)"/>
  <text x="125" y="350" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 7</text>
  <text x="125" y="370" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">/estimate-cost</text>

  <!-- Arrow right -->
  <path d="M200 355 L220 355" stroke="#94a3b8" stroke-width="2" fill="none"/>
  <polygon points="220,355 215,350 215,360" fill="#94a3b8"/>

  <!-- Phase 8 -->
  <rect x="230" y="320" width="150" height="70" rx="8" fill="#f59e0b" filter="url(#shadow)"/>
  <text x="305" y="350" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Phase 8</text>
  <text x="305" y="370" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="11">Executive Summary</text>

  <!-- Parallel Section - Knowledge Graph -->
  <rect x="450" y="310" width="400" height="170" rx="10" fill="#ecfdf5" stroke="#10b981" stroke-width="2" filter="url(#shadow)"/>
  <text x="650" y="335" text-anchor="middle" fill="#065f46" font-family="Arial, sans-serif" font-size="14" font-weight="bold">Parallel: Knowledge Graph</text>

  <!-- Graph Phase 1 -->
  <rect x="470" y="350" width="110" height="55" rx="6" fill="url(#graphGrad)" filter="url(#shadow)"/>
  <text x="525" y="375" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">/build-graph</text>
  <text x="525" y="392" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">グラフ構築</text>

  <!-- Arrow -->
  <path d="M580 377 L600 377" stroke="#059669" stroke-width="2" fill="none"/>
  <polygon points="600,377 595,372 595,382" fill="#059669"/>

  <!-- Graph Phase 2 -->
  <rect x="610" y="350" width="110" height="55" rx="6" fill="url(#graphGrad)" filter="url(#shadow)"/>
  <text x="665" y="375" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">/query-graph</text>
  <text x="665" y="392" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">クエリ実行</text>

  <!-- Arrow -->
  <path d="M720 377 L740 377" stroke="#059669" stroke-width="2" fill="none"/>
  <polygon points="740,377 735,372 735,382" fill="#059669"/>

  <!-- Graph Phase 3 -->
  <rect x="750" y="350" width="110" height="55" rx="6" fill="url(#graphGrad)" filter="url(#shadow)"/>
  <text x="805" y="375" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="10" font-weight="bold">/visualize-graph</text>
  <text x="805" y="392" text-anchor="middle" fill="white" font-family="Arial, sans-serif" font-size="9">可視化</text>

  <!-- Output Section -->
  <rect x="50" y="420" width="330" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="2" filter="url(#shadow)"/>
  <text x="215" y="445" text-anchor="middle" fill="#92400e" font-family="Arial, sans-serif" font-size="12" font-weight="bold">出力: reports/</text>
  <text x="215" y="465" text-anchor="middle" fill="#78350f" font-family="Arial, sans-serif" font-size="10">00_summary/ | 01_analysis/ | 02_evaluation/</text>
  <text x="215" y="480" text-anchor="middle" fill="#78350f" font-family="Arial, sans-serif" font-size="10">03_design/ | 04_stories/ | 05_estimate/</text>

  <!-- Standalone Section -->
  <rect x="590" y="500" width="260" height="70" rx="8" fill="#fce7f3" stroke="#ec4899" stroke-width="2" filter="url(#shadow)"/>
  <text x="720" y="525" text-anchor="middle" fill="#9d174d" font-family="Arial, sans-serif" font-size="12" font-weight="bold">Standalone</text>
  <text x="720" y="545" text-anchor="middle" fill="#831843" font-family="Arial, sans-serif" font-size="10">/scalardb-sizing-estimator</text>
  <text x="720" y="560" text-anchor="middle" fill="#831843" font-family="Arial, sans-serif" font-size="9">インタラクティブサイジング見積もり</text>

  <!-- Legend -->
  <rect x="50" y="510" width="15" height="15" rx="3" fill="url(#phaseGrad)"/>
  <text x="75" y="522" fill="#334155" font-family="Arial, sans-serif" font-size="10">必須フェーズ</text>

  <rect x="150" y="510" width="15" height="15" rx="3" fill="#a78bfa"/>
  <text x="175" y="522" fill="#334155" font-family="Arial, sans-serif" font-size="10">オプション</text>

  <rect x="250" y="510" width="15" height="15" rx="3" fill="url(#graphGrad)"/>
  <text x="275" y="522" fill="#334155" font-family="Arial, sans-serif" font-size="10">並列処理</text>

  <rect x="350" y="510" width="15" height="15" rx="3" fill="#f59e0b"/>
  <text x="375" y="522" fill="#334155" font-family="Arial, sans-serif" font-size="10">最終出力</text>
</svg>
