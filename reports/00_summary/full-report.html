<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scalar Auditor for BOX ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --heading-color: #1a1a2e;
            --link-color: #1976d2;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --table-header-bg: #f0f0f0;
            --sidebar-bg: #fafafa;
        }
    

        * {
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            background-color: var(--bg-color);
            margin: 0;
            padding: 0;
            display: flex;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            width: 280px;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            padding: 20px;
        }

        .sidebar h2 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--heading-color);
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar li {
            margin: 5px 0;
        }

        .sidebar a {
            color: var(--link-color);
            text-decoration: none;
            font-size: 0.9rem;
            display: block;
            padding: 5px 0;
        }

        .sidebar a:hover {
            text-decoration: underline;
        }

        .sidebar .section-title {
            font-weight: bold;
            margin-top: 15px;
            color: var(--heading-color);
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .main-content {
            margin-left: 280px;
            padding: 40px 60px;
            max-width: 1200px;
            width: calc(100% - 280px);
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .report-header {
            text-align: center;
            padding: 40px 0;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 40px;
        }

        .report-header h1 {
            font-size: 2.5rem;
            color: var(--heading-color);
            margin-bottom: 10px;
        }

        .report-header .meta {
            color: var(--text-color);
            opacity: 0.7;
        }

        /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        section {
            margin-bottom: 60px;
            padding-bottom: 40px;
            border-bottom: 1px solid var(--border-color);
        }

        h1 {
            font-size: 2rem;
            color: var(--heading-color);
            border-bottom: 2px solid var(--link-color);
            padding-bottom: 10px;
            margin-top: 40px;
        }

        h2 {
            font-size: 1.5rem;
            color: var(--heading-color);
            margin-top: 30px;
        }

        h3 {
            font-size: 1.25rem;
            color: var(--heading-color);
            margin-top: 25px;
        }

        h4 {
            font-size: 1.1rem;
            color: var(--heading-color);
        }

        /* ãƒ†ãƒ¼ãƒ–ãƒ« */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.9rem;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background-color: var(--table-header-bg);
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: rgba(0,0,0,0.02);
        }

        /* ã‚³ãƒ¼ãƒ‰ */
        pre {
            background-color: var(--code-bg);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 0.9rem;
        }

        code {
            font-family: 'Fira Code', 'Consolas', monospace;
            background-color: var(--code-bg);
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }

        pre code {
            padding: 0;
            background: none;
        }

        /* Mermaid */
        .mermaid {
            text-align: center;
            margin: 20px 0;
            background: white;
            padding: 20px;
            border-radius: 8px;
        }

        /* ãƒªã‚¹ãƒˆ */
        ul, ol {
            margin: 15px 0;
            padding-left: 25px;
        }

        li {
            margin: 8px 0;
        }

        /* ãƒªãƒ³ã‚¯ */
        a {
            color: var(--link-color);
        }

        /* å¼•ç”¨ */
        blockquote {
            border-left: 4px solid var(--link-color);
            margin: 20px 0;
            padding: 10px 20px;
            background: rgba(0,0,0,0.03);
        }

        /* å°åˆ·ç”¨ */
        @media print {
            .sidebar {
                display: none;
            }
            .main-content {
                margin-left: 0;
                width: 100%;
            }
            section {
                page-break-inside: avoid;
            }
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <nav class="sidebar">
        <h2>ç›®æ¬¡</h2>
        <ul>
<li class="section-title">ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼</li>
<li><a href="#summary-executive-summary">Executive Summary</a></li>
<li class="section-title">ã‚·ã‚¹ãƒ†ãƒ åˆ†æ</li>
<li><a href="#analysis-system-overview">System Overview</a></li>
<li><a href="#analysis-architecture-diagram">Architecture Diagram</a></li>
<li><a href="#analysis-ubiquitous-language">Ubiquitous Language</a></li>
<li><a href="#analysis-domain-entities">Domain Entities</a></li>
<li><a href="#analysis-actors-roles-permissions">Actors Roles Permissions</a></li>
<li><a href="#analysis-domain-code-mapping">Domain Code Mapping</a></li>
<li><a href="#analysis-api-endpoints">Api Endpoints</a></li>
<li class="section-title">MMIè©•ä¾¡</li>
<li><a href="#evaluation-mmi-overview">Mmi Overview</a></li>
<li><a href="#evaluation-mmi-by-module">Mmi By Module</a></li>
<li><a href="#evaluation-mmi-improvement-plan">Mmi Improvement Plan</a></li>
<li class="section-title">è¨­è¨ˆ</li>
<li><a href="#design-domain-analysis">Domain Analysis</a></li>
<li><a href="#design-context-map">Context Map</a></li>
<li><a href="#design-system-mapping">System Mapping</a></li>
<li><a href="#design-target-architecture">Target Architecture</a></li>
<li><a href="#design-transformation-plan">Transformation Plan</a></li>
<li><a href="#design-operations-plan">Operations Plan</a></li>
<li><a href="#design-api-design-overview">Api Design Overview</a></li>
<li><a href="#design-api-gateway-design">Api Gateway Design</a></li>
<li><a href="#design-api-security-design">Api Security Design</a></li>
<li><a href="#design-scalardb-architecture">Scalardb Architecture</a></li>
<li><a href="#design-scalardb-schema-design">Scalardb Schema Design</a></li>
<li><a href="#design-scalardb-schema">Scalardb Schema</a></li>
<li><a href="#design-scalardb-transaction-design">Scalardb Transaction Design</a></li>
<li><a href="#design-scalardb-transaction">Scalardb Transaction</a></li>
<li><a href="#design-scalardb-migration">Scalardb Migration</a></li>
<li class="section-title">ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</li>
<li><a href="#stories-domain-stories">Domain Stories</a></li>
<li><a href="#stories-audit-set-story">Audit Set Story</a></li>
<li class="section-title">ã‚³ã‚¹ãƒˆè©¦ç®—</li>
<li><a href="#estimate-cost-summary">Cost Summary</a></li>
<li><a href="#estimate-infrastructure-detail">Infrastructure Detail</a></li>
<li><a href="#estimate-license-requirements">License Requirements</a></li>
<li><a href="#estimate-cost-assumptions">Cost Assumptions</a></li>
<li><a href="#estimate-scalardb-sizing">Scalardb Sizing</a></li>
<li class="section-title">ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•</li>
<li><a href="#graph-schema">Schema</a></li>
<li><a href="#graph-statistics">Statistics</a></li>
<li><a href="#graph-visualizations/summary">Visualizations/Summary</a></li>
<li><a href="#graph-interactive">Interactive Viewer</a></li>
</ul>
</nav>

    <main class="main-content">
        <header class="report-header">
            <h1>Scalar Auditor for BOX ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ</h1>
            <p class="meta">Generated: 2026-01-13 18:00:25</p>
        </header>
    
<section id="summary">
<h1>ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼</h1>
<article id="summary-executive-summary">
<h1 id="executive-summary-scalar-auditor-for-box">Executive Summary: Scalar Auditor for BOX ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°åˆ†æ<a class="headerlink" href="#executive-summary-scalar-auditor-for-box" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p><strong>å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ </strong>: Scalar Auditor for BOX<br />
<strong>ç›®çš„</strong>: ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‹ã‚‰ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¸ã®ç§»è¡Œè¨ˆç”»ç­–å®š<br />
<strong>åˆ†ææœŸé–“</strong>: 2026å¹´1æœˆ</p>
<h3 id="12">1.2 ä¸»è¦ãªç™ºè¦‹<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é ˜åŸŸ</th>
<th>ç¾çŠ¶</th>
<th>èª²é¡Œãƒ¬ãƒ™ãƒ«</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æˆç†Ÿåº¦ï¼ˆMMIï¼‰</td>
<td>52.3/100</td>
<td>ä¸­</td>
</tr>
<tr>
<td>God Classå•é¡Œ</td>
<td>UserServiceï¼ˆ1,118è¡Œï¼‰</td>
<td>é«˜</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹é–“çµåˆ</td>
<td>é«˜å¯†çµåˆ</td>
<td>ä¸­</td>
</tr>
<tr>
<td>æŠ€è¡“çš„è² å‚µ</td>
<td>è“„ç©ã‚ã‚Š</td>
<td>ä¸­</td>
</tr>
</tbody>
</table>
<h3 id="13">1.3 æ¨å¥¨äº‹é …<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<p>âœ… <strong>ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã‚’æ¨å¥¨</strong> - æ®µéšçš„ãªç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€ãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–ã—ãªãŒã‚‰å®Ÿæ–½å¯èƒ½</p>
<hr />
<h2 id="2">2. ç¾çŠ¶åˆ†æçµæœ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>Scalar Auditor for BOX
â”œâ”€â”€ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: Java 17 / Spring Boot 3.2.1
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: React 18 / Redux / Vite
â”œâ”€â”€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: Cassandra (ScalarDBçµŒç”±)
â”œâ”€â”€ æ”¹ã–ã‚“æ¤œçŸ¥: ScalarDL
â””â”€â”€ å¤–éƒ¨é€£æº: BOX API
</code></pre>

<h3 id="22">2.2 è¦æ¨¡<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>æ•°å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>Javaãƒ•ã‚¡ã‚¤ãƒ«æ•°</td>
<td>167</td>
</tr>
<tr>
<td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«æ•°</td>
<td>128</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹æ•°</td>
<td>10</td>
</tr>
<tr>
<td>REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</td>
<td>48</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«</td>
<td>17</td>
</tr>
</tbody>
</table>
<h3 id="23-mmi">2.3 MMIè©•ä¾¡çµæœ<a class="headerlink" href="#23-mmi" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>ç·åˆã‚¹ã‚³ã‚¢: 52.3 / 100 (ä½ä¸­æˆç†Ÿåº¦)

è»¸åˆ¥ã‚¹ã‚³ã‚¢:
â”œâ”€â”€ Cohesionï¼ˆå‡é›†åº¦ï¼‰: 45/100 âš ï¸
â”œâ”€â”€ Couplingï¼ˆçµåˆåº¦ï¼‰: 50/100 âš ï¸
â”œâ”€â”€ Independenceï¼ˆç‹¬ç«‹æ€§ï¼‰: 55/100
â””â”€â”€ Reusabilityï¼ˆå†åˆ©ç”¨æ€§ï¼‰: 64/100
</code></pre>

<h3 id="24">2.4 ä¸»è¦ãªå•é¡Œç‚¹<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å•é¡Œ</th>
<th>å½±éŸ¿</th>
<th>å„ªå…ˆåº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>UserService God Class</strong></td>
<td>ä¿å®ˆæ€§ä½ä¸‹ã€ãƒ†ã‚¹ãƒˆå›°é›£</td>
<td>æœ€é«˜</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹é–“å¯†çµåˆ</td>
<td>ãƒ‡ãƒ—ãƒ­ã‚¤ç‹¬ç«‹æ€§ãªã—</td>
<td>é«˜</td>
</tr>
<tr>
<td>å¤§è¦æ¨¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
<td>å¯èª­æ€§ä½ä¸‹</td>
<td>ä¸­</td>
</tr>
<tr>
<td>çŠ¶æ…‹ç®¡ç†ã®æ··åœ¨</td>
<td>ãƒã‚°ãƒªã‚¹ã‚¯</td>
<td>ä½</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Core Services"
        AMS[Audit Management<br/>Service]
        VS[Verification<br/>Service]
    end

    subgraph "Supporting Services"
        ES[Event Service]
        IS[Item Service]
        IDS[Identity Service]
    end

    subgraph "Integration"
        BIS[BOX Integration]
        NS[Notification]
    end

    GW[API Gateway] --> AMS
    GW --> VS
    GW --> ES
    GW --> IS
    GW --> IDS
</div>

<h3 id="32">3.2 ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>è²¬å‹™</th>
<th>å„ªå…ˆåº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>Identity Service</td>
<td>èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td>Phase 1</td>
</tr>
<tr>
<td>Event Service</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</td>
<td>Phase 2</td>
</tr>
<tr>
<td>Item Service</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
<td>Phase 3</td>
</tr>
<tr>
<td>Verification Service</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥</td>
<td>Phase 4</td>
</tr>
<tr>
<td>BOX Integration Service</td>
<td>BOX APIé€£æº</td>
<td>Phase 5</td>
</tr>
<tr>
<td>Audit Management Service</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>Phase 6</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. ç§»è¡Œè¨ˆç”»<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ãƒ•ã‚§ãƒ¼ã‚ºæ¦‚è¦<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Phase</th>
<th>å†…å®¹</th>
<th>æœŸé–“</th>
<th>ãƒªã‚¹ã‚¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>UserServiceåˆ†è§£</td>
<td>3ãƒ¶æœˆ</td>
<td>ä¸­</td>
</tr>
<tr>
<td>2</td>
<td>Event ServiceæŠ½å‡º</td>
<td>1ãƒ¶æœˆ</td>
<td>ä½</td>
</tr>
<tr>
<td>3</td>
<td>Item ServiceæŠ½å‡º</td>
<td>1ãƒ¶æœˆ</td>
<td>ä½</td>
</tr>
<tr>
<td>4</td>
<td>Verification ServiceæŠ½å‡º</td>
<td>2ãƒ¶æœˆ</td>
<td>ä¸­</td>
</tr>
<tr>
<td>5</td>
<td>BOX IntegrationæŠ½å‡º</td>
<td>1ãƒ¶æœˆ</td>
<td>ä½</td>
</tr>
<tr>
<td>6</td>
<td>Audit Managementåˆ†é›¢</td>
<td>2ãƒ¶æœˆ</td>
<td>ä¸­</td>
</tr>
<tr>
<td>7</td>
<td>çµ±åˆãƒ†ã‚¹ãƒˆãƒ»ç§»è¡Œ</td>
<td>2ãƒ¶æœˆ</td>
<td>ä¸­</td>
</tr>
</tbody>
</table>
<p><strong>ç·æœŸé–“</strong>: ç´„12ãƒ¶æœˆ</p>
<h3 id="42">4.2 ç§»è¡Œæˆ¦ç•¥<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<p><strong>Strangler Fig ãƒ‘ã‚¿ãƒ¼ãƒ³</strong>ã‚’æ¡ç”¨:
1. æ–°ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¨ä¸¦è¡Œç¨¼åƒ
2. æ©Ÿèƒ½å˜ä½ã§æ®µéšçš„ã«åˆ‡ã‚Šæ›¿ãˆ
3. å…¨æ©Ÿèƒ½ç§»è¡Œå¾Œã«æ—§ã‚·ã‚¹ãƒ†ãƒ å»ƒæ­¢</p>
<hr />
<h2 id="5">5. ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Š<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 è²»ç”¨ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>åˆå¹´åº¦</th>
<th>2å¹´ç›®ä»¥é™/å¹´</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™ºãƒ»ç§»è¡Œ</td>
<td>2,400ä¸‡å††</td>
<td>-</td>
</tr>
<tr>
<td>ã‚¤ãƒ³ãƒ•ãƒ©</td>
<td>660ä¸‡å††</td>
<td>660ä¸‡å††</td>
</tr>
<tr>
<td>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
<td>1,425ä¸‡å††</td>
<td>1,425ä¸‡å††</td>
</tr>
<tr>
<td>é‹ç”¨</td>
<td>1,320ä¸‡å††</td>
<td>1,320ä¸‡å††</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>5,805ä¸‡å††</strong></td>
<td><strong>3,405ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<h3 id="52-roi">5.2 ROI<a class="headerlink" href="#52-roi" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¹´é–“åŠ¹æœ</td>
<td>1,100ä¸‡å††</td>
</tr>
<tr>
<td>æŠ•è³‡å›åæœŸé–“</td>
<td>ç´„12å¹´</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨è¨˜</strong>: å®šé‡åŒ–å›°é›£ãªåŠ¹æœï¼ˆé–‹ç™ºé€Ÿåº¦å‘ä¸Šã€æ¡ç”¨å®¹æ˜“åŒ–ï¼‰ã¯å«ã¾ãš</p>
<hr />
<h2 id="6">6. ãƒªã‚¹ã‚¯ã¨è»½æ¸›ç­–<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒªã‚¹ã‚¯</th>
<th>å½±éŸ¿</th>
<th>ç™ºç”Ÿç¢ºç‡</th>
<th>è»½æ¸›ç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç§»è¡Œä¸­ã®ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢</td>
<td>é«˜</td>
<td>ä½</td>
<td>ä¸¦è¡Œé‹ç”¨ã€æ®µéšçš„åˆ‡æ›¿</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ</td>
<td>é«˜</td>
<td>ä¸­</td>
<td>Sagaãƒ‘ã‚¿ãƒ¼ãƒ³ã€çµæœæ•´åˆæ€§</td>
</tr>
<tr>
<td>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>äº‹å‰è² è·ãƒ†ã‚¹ãƒˆ</td>
</tr>
<tr>
<td>ã‚¹ã‚­ãƒ«ä¸è¶³</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€å¤–éƒ¨æ”¯æ´</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7">7. æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="0-3">çŸ­æœŸï¼ˆ0-3ãƒ¶æœˆï¼‰<a class="headerlink" href="#0-3" title="Permanent link">&para;</a></h3>
<ol>
<li>âœ… UserServiceåˆ†è§£ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆé–‹å§‹</li>
<li>âœ… é–‹ç™ºãƒãƒ¼ãƒ ã®ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°</li>
<li>âœ… ã‚¤ãƒ³ãƒ•ãƒ©ç’°å¢ƒï¼ˆK8sï¼‰ã®PoC</li>
</ol>
<h3 id="3-9">ä¸­æœŸï¼ˆ3-9ãƒ¶æœˆï¼‰<a class="headerlink" href="#3-9" title="Permanent link">&para;</a></h3>
<ol>
<li>ğŸ”„ ã‚µãƒ¼ãƒ“ã‚¹æŠ½å‡ºã®å®Ÿæ–½ï¼ˆPhase 2-5ï¼‰</li>
<li>ğŸ”„ CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰</li>
<li>ğŸ”„ ç›£è¦–åŸºç›¤æ•´å‚™</li>
</ol>
<h3 id="9-12">é•·æœŸï¼ˆ9-12ãƒ¶æœˆï¼‰<a class="headerlink" href="#9-12" title="Permanent link">&para;</a></h3>
<ol>
<li>ğŸ“‹ æœ¬ç•ªç§»è¡Œ</li>
<li>ğŸ“‹ æ—§ã‚·ã‚¹ãƒ†ãƒ å»ƒæ­¢</li>
<li>ğŸ“‹ é‹ç”¨ä½“åˆ¶ç¢ºç«‹</li>
</ol>
<hr />
<h2 id="8">8. æˆæœç‰©ä¸€è¦§<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>æˆæœç‰©</th>
<th>ãƒ‘ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆ†æ</td>
<td>ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦</td>
<td>reports/01_analysis/system-overview.md</td>
</tr>
<tr>
<td>åˆ†æ</td>
<td>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</td>
<td>reports/01_analysis/ubiquitous-language.md</td>
</tr>
<tr>
<td>åˆ†æ</td>
<td>ã‚¢ã‚¯ã‚¿ãƒ¼ãƒ»ãƒ­ãƒ¼ãƒ«</td>
<td>reports/01_analysis/actors-roles-permissions.md</td>
</tr>
<tr>
<td>åˆ†æ</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³-ã‚³ãƒ¼ãƒ‰å¯¾å¿œ</td>
<td>reports/01_analysis/domain-code-mapping.md</td>
</tr>
<tr>
<td>è©•ä¾¡</td>
<td>MMIæ¦‚è¦</td>
<td>reports/02_evaluation/mmi-overview.md</td>
</tr>
<tr>
<td>è©•ä¾¡</td>
<td>MMIè©³ç´°</td>
<td>reports/02_evaluation/mmi-by-module.md</td>
</tr>
<tr>
<td>è©•ä¾¡</td>
<td>æ”¹å–„è¨ˆç”»</td>
<td>reports/02_evaluation/mmi-improvement-plan.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†æ</td>
<td>reports/03_design/domain-analysis.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ—</td>
<td>reports/03_design/context-map.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</td>
<td>reports/03_design/target-architecture.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>APIè¨­è¨ˆ</td>
<td>reports/03_design/api-design-overview.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>API Gateway</td>
<td>reports/03_design/api-gateway-design.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>APIã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>reports/03_design/api-security-design.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ScalarDBã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</td>
<td>reports/03_design/scalardb-architecture.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ScalarDBã‚¹ã‚­ãƒ¼ãƒ</td>
<td>reports/03_design/scalardb-schema-design.md</td>
</tr>
<tr>
<td>è¨­è¨ˆ</td>
<td>ScalarDBãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</td>
<td>reports/03_design/scalardb-transaction-design.md</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>reports/04_stories/audit-set-story.md</td>
</tr>
<tr>
<td>è¦‹ç©ã‚‚ã‚Š</td>
<td>ã‚³ã‚¹ãƒˆã‚µãƒãƒªãƒ¼</td>
<td>reports/05_estimate/cost-summary.md</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="9">9. çµè«–<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã¯ã€ç¾çŠ¶ã®ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ä¿å®ˆæ€§ãƒ»æ‹¡å¼µæ€§ã«èª²é¡Œã‚’æŠ±ãˆã¦ã„ã¾ã™ã€‚ç‰¹ã«UserServiceï¼ˆGod Classï¼‰ã®åˆ†è§£ãŒæ€¥å‹™ã§ã™ã€‚</p>
<p><strong>ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã«ã‚ˆã‚ŠæœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ</strong>:
- é–‹ç™ºç”Ÿç”£æ€§ 50%å‘ä¸Š
- éšœå®³å¾©æ—§æ™‚é–“ 87%çŸ­ç¸®
- ç‹¬ç«‹ã—ãŸãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå®Ÿç¾
- æŠ€è¡“çš„è² å‚µã®è§£æ¶ˆ</p>
<p>æ®µéšçš„ãªç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€ãƒªã‚¹ã‚¯ã‚’æœ€å°åŒ–ã—ãªãŒã‚‰12ãƒ¶æœˆã§ã®å®Œå…¨ç§»è¡ŒãŒå¯èƒ½ã§ã™ã€‚</p>
<hr />
<p><em>æœ¬ãƒ¬ãƒãƒ¼ãƒˆã¯2026å¹´1æœˆæ™‚ç‚¹ã®åˆ†æçµæœã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚</em></p>
</article>
</section>
<section id="analysis">
<h1>ã‚·ã‚¹ãƒ†ãƒ åˆ†æ</h1>
<article id="analysis-system-overview">
<h1 id="_1">ç¾è¡Œã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p><strong>Scalar Auditor for BOX</strong> ã¯ã€BOXã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¨çµ±åˆã•ã‚ŒãŸç›£æŸ»ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚BOXã§ç®¡ç†ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å¤–éƒ¨ã«ä¿å­˜ã—ã€å¤–éƒ¨ç›£æŸ»äººãŒãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨æ€§ã‚’æ¤œè¨¼ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ScalarDBã§ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã—ã€ScalarDLã§ãƒ•ã‚¡ã‚¤ãƒ«æ”¹ã–ã‚“ã‚’æ¤œå‡ºã—ã¾ã™ã€‚</p>
<h2 id="_3">æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="_4">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€è¡“</th>
<th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>Java</td>
<td>17</td>
<td>ãƒ¡ã‚¤ãƒ³è¨€èª</td>
</tr>
<tr>
<td>Spring Boot</td>
<td>3.2.1</td>
<td>Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
</tr>
<tr>
<td>Spring Security</td>
<td>3.2.x</td>
<td>èªè¨¼ãƒ»èªå¯</td>
</tr>
<tr>
<td>JWT (jjwt)</td>
<td>0.11.5</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼</td>
</tr>
<tr>
<td>ScalarDB Cluster</td>
<td>3.14.0</td>
<td>åˆ†æ•£ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>3.10.0</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥ãƒ»å°å¸³ç®¡ç†</td>
</tr>
<tr>
<td>Box Java SDK</td>
<td>4.4.0</td>
<td>BOX APIé€£æº</td>
</tr>
<tr>
<td>Lombok</td>
<td>-</td>
<td>ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ</td>
</tr>
<tr>
<td>SpringDoc OpenAPI</td>
<td>2.3.0</td>
<td>APIä»•æ§˜æ›¸ç”Ÿæˆ</td>
</tr>
</tbody>
</table>
<h3 id="webapp">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆWebAppï¼‰<a class="headerlink" href="#webapp" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€è¡“</th>
<th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>React</td>
<td>18.2.0</td>
<td>UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
</tr>
<tr>
<td>Vite</td>
<td>5.0.8</td>
<td>ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>Redux / Redux Toolkit</td>
<td>2.1.0</td>
<td>çŠ¶æ…‹ç®¡ç†</td>
</tr>
<tr>
<td>Material UI</td>
<td>5.15.x</td>
<td>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
<tr>
<td>React Router</td>
<td>6.22.0</td>
<td>ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</td>
</tr>
<tr>
<td>i18next</td>
<td>23.11.2</td>
<td>å›½éš›åŒ–ï¼ˆæ—¥è‹±å¯¾å¿œï¼‰</td>
</tr>
<tr>
<td>Axios</td>
<td>1.6.7</td>
<td>HTTPé€šä¿¡</td>
</tr>
<tr>
<td>Box UI Elements</td>
<td>19.0.0</td>
<td>BOX UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
<tr>
<td>Tailwind CSS</td>
<td>3.4.1</td>
<td>CSSãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
</tr>
</tbody>
</table>
<h3 id="integration-menu">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆIntegration Menuï¼‰<a class="headerlink" href="#integration-menu" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€è¡“</th>
<th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>React</td>
<td>18.x</td>
<td>UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
</tr>
<tr>
<td>Vite</td>
<td>-</td>
<td>ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>i18next</td>
<td>-</td>
<td>å›½éš›åŒ–</td>
</tr>
</tbody>
</table>
<h3 id="_5">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€è¡“</th>
<th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cassandra</td>
<td>-</td>
<td>NoSQLãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢</td>
</tr>
<tr>
<td>ScalarDB</td>
<td>3.14.0</td>
<td>åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>3.10.0</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥ç”¨å°å¸³</td>
</tr>
</tbody>
</table>
<h3 id="_6">ã‚¤ãƒ³ãƒ•ãƒ©<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŠ€è¡“</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kubernetes</td>
<td>ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td>Helm</td>
<td>ScalarDB Clusterãƒ‡ãƒ—ãƒ­ã‚¤</td>
</tr>
</tbody>
</table>
<h2 id="_7">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph TB
    subgraph "Frontend Applications"
        WebApp["Scalar-Box-WebApp<br/>(React + Redux)"]
        IntegrationMenu["Scalar-WebApp-Integration-Menu<br/>(BOXçµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼)"]
    end

    subgraph "Backend"
        SpringBoot["Spring Boot API Server<br/>(Scalar-Box-Event-Log-Tool)"]
        Security["Spring Security<br/>(JWTèªè¨¼)"]
    end

    subgraph "External Services"
        BoxAPI1["BOX API<br/>(Client Credentials)<br/>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—"]
        BoxAPI2["BOX API<br/>(OAuth 2.0)<br/>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ"]
    end

    subgraph "Data Layer"
        ScalarDB["ScalarDB Cluster<br/>(åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³)"]
        ScalarDL["ScalarDL<br/>(æ”¹ã–ã‚“æ¤œçŸ¥)"]
        Cassandra["Cassandra<br/>(ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢)"]
    end

    WebApp --> SpringBoot
    IntegrationMenu --> SpringBoot
    SpringBoot --> Security
    SpringBoot --> BoxAPI1
    SpringBoot --> BoxAPI2
    SpringBoot --> ScalarDB
    SpringBoot --> ScalarDL
    ScalarDB --> Cassandra
    ScalarDL --> Cassandra
</div>

<h2 id="_8">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="java">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆJavaï¼‰<a class="headerlink" href="#java" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸</th>
<th>è²¬å‹™</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>controller</td>
<td>REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</td>
<td>9</td>
</tr>
<tr>
<td>service</td>
<td>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯</td>
<td>10</td>
</tr>
<tr>
<td>repository</td>
<td>ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆScalarDBï¼‰</td>
<td>19</td>
</tr>
<tr>
<td>model</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>20</td>
</tr>
<tr>
<td>dto</td>
<td>ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>47</td>
</tr>
<tr>
<td>responsedto</td>
<td>APIãƒ¬ã‚¹ãƒãƒ³ã‚¹</td>
<td>15</td>
</tr>
<tr>
<td>constant</td>
<td>å®šæ•°ãƒ»Enumå®šç¾©</td>
<td>11</td>
</tr>
<tr>
<td>security</td>
<td>èªè¨¼ãƒ»èªå¯</td>
<td>5</td>
</tr>
<tr>
<td>business</td>
<td>ãƒ“ã‚¸ãƒã‚¹ãƒ˜ãƒ«ãƒ‘ãƒ¼</td>
<td>8</td>
</tr>
<tr>
<td>utility</td>
<td>ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</td>
<td>4</td>
</tr>
<tr>
<td>exception</td>
<td>ä¾‹å¤–å‡¦ç†</td>
<td>3</td>
</tr>
<tr>
<td>config</td>
<td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="webapp_1">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆWebAppï¼‰<a class="headerlink" href="#webapp_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</th>
<th>è²¬å‹™</th>
<th>ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«</th>
</tr>
</thead>
<tbody>
<tr>
<td>pages/auth</td>
<td>èªè¨¼ç”»é¢</td>
<td>LoginandSignup, ForgotPassword, OtpComponent</td>
</tr>
<tr>
<td>pages/AuditSet</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>AuditSet, AuditDailogBox, ItemViewFileandFolders</td>
</tr>
<tr>
<td>pages/AuditorsAndGroups</td>
<td>å¤–éƒ¨ç›£æŸ»äººãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
<td>AuditorsAndGroups, AddExternalAuditor, AddAuditGroup</td>
</tr>
<tr>
<td>pages/ExternalAuditorPage</td>
<td>å¤–éƒ¨ç›£æŸ»äººå‘ã‘ç”»é¢</td>
<td>ExternalAuditor, ExternalAuditorCard, Validating</td>
</tr>
<tr>
<td>pages/UserRole</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†</td>
<td>UserRole</td>
</tr>
<tr>
<td>pages/ViewAllEventHistory</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º</td>
<td>ViewAllEventHistory, TableList</td>
</tr>
<tr>
<td>pages/ViewItemsUnderAudit</td>
<td>ç›£æŸ»å¯¾è±¡ã‚¢ã‚¤ãƒ†ãƒ è¡¨ç¤º</td>
<td>ViewItemsUnderAudit</td>
</tr>
<tr>
<td>redux/reducerSlice</td>
<td>çŠ¶æ…‹ç®¡ç†</td>
<td>authSlice, tokenSlice, folderAndFileSlice</td>
</tr>
<tr>
<td>hooks</td>
<td>ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯</td>
<td>useAxiosPrivate, useRefreshToken</td>
</tr>
<tr>
<td>i18n</td>
<td>å›½éš›åŒ–</td>
<td>config, locales/en, locales/ja</td>
</tr>
</tbody>
</table>
<h2 id="_9">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«å</th>
<th>èª¬æ˜</th>
<th>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>events</td>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
<td>yyyy_mm_dd</td>
</tr>
<tr>
<td>item_events</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>item_id</td>
</tr>
<tr>
<td>audit_set</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå®šç¾©</td>
<td>audit_set_id</td>
</tr>
<tr>
<td>audit_set_collaborators</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå…±åŒä½œæ¥­è€…</td>
<td>user_email</td>
</tr>
<tr>
<td>auditset_folder_file_mapping</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ-ã‚¢ã‚¤ãƒ†ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>audit_set_id</td>
</tr>
<tr>
<td>user</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</td>
<td>user_email</td>
</tr>
<tr>
<td>role_user</td>
<td>ãƒ­ãƒ¼ãƒ«-ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>role_name</td>
</tr>
<tr>
<td>audit_group</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>audit_group_id</td>
</tr>
<tr>
<td>user_audit_group</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼-ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>user_email</td>
</tr>
<tr>
<td>audit_grp_audit_set_mapping</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—-ç›£æŸ»ã‚»ãƒƒãƒˆãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>audit_group_id</td>
</tr>
<tr>
<td>item_status</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æ¤œè¨¼çŠ¶æ…‹</td>
<td>item_id</td>
</tr>
<tr>
<td>items_by_sha1</td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥åˆ¥ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>sha1_hash</td>
</tr>
<tr>
<td>auditor_logs</td>
<td>å¤–éƒ¨ç›£æŸ»äººæ“ä½œãƒ­ã‚°</td>
<td>audit_set_id</td>
</tr>
<tr>
<td>position_tracker</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ä½ç½®</td>
<td>user_id</td>
</tr>
<tr>
<td>user_token</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>user_email</td>
</tr>
<tr>
<td>user_otp</td>
<td>OTPã‚³ãƒ¼ãƒ‰</td>
<td>user_email</td>
</tr>
<tr>
<td>organization</td>
<td>çµ„ç¹”æƒ…å ±</td>
<td>org_id</td>
</tr>
</tbody>
</table>
<h2 id="_10">å¤–éƒ¨é€£æº<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>é€£æºå…ˆ</th>
<th>é€£æºæ–¹å¼</th>
<th>ç”¨é€”</th>
<th>å®Ÿè£…ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOX API (Event Stream)</td>
<td>Client Credentials Grant</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—</td>
<td>EventLogService</td>
</tr>
<tr>
<td>BOX API (File Operations)</td>
<td>OAuth 2.0</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ»è©³ç´°å–å¾—</td>
<td>FileService, FolderService</td>
</tr>
<tr>
<td>ScalarDB Cluster</td>
<td>gRPC</td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</td>
<td>Repositoryå±¤</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>gRPC</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ”¹ã–ã‚“æ¤œè¨¼</td>
<td>AssetService</td>
</tr>
<tr>
<td>SMTP Server</td>
<td>SMTP</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆOTPé€ä¿¡</td>
<td>EmailUtility</td>
</tr>
</tbody>
</table>
<h2 id="_11">èª²é¡Œãƒ»æŠ€è¡“çš„è² å‚µ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>èª²é¡Œ</th>
<th>æ·±åˆ»åº¦</th>
<th>å½±éŸ¿ç¯„å›²</th>
<th>æ¨å¥¨å¯¾å¿œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>CORSè¨­å®šãŒå…¨è¨±å¯ï¼ˆ*ï¼‰</td>
<td>é«˜</td>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>æœ¬ç•ªç’°å¢ƒã§ã¯é©åˆ‡ãªã‚ªãƒªã‚¸ãƒ³ã‚’æŒ‡å®š</td>
</tr>
<tr>
<td>å¤§é‡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¤œè¨¼æ™‚é–“</td>
<td>ä¸­</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£</td>
<td>éåŒæœŸå‡¦ç†ãƒ»ãƒãƒƒãƒå‡¦ç†ã®å°å…¥</td>
</tr>
<tr>
<td>ãƒ¢ãƒãƒªã‚·ãƒƒã‚¯ãªã‚µãƒ¼ãƒ“ã‚¹å±¤</td>
<td>ä¸­</td>
<td>ä¿å®ˆæ€§</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ†é›¢</td>
</tr>
<tr>
<td>DTOã¨Modelã®é‡è¤‡</td>
<td>ä½</td>
<td>ã‚³ãƒ¼ãƒ‰é‡è¤‡</td>
<td>MapStructãªã©ã®ãƒãƒƒãƒ‘ãƒ¼å°å…¥</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸</td>
<td>ä¸­</td>
<td>å“è³ª</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹å±¤ã®ãƒ†ã‚¹ãƒˆæ‹¡å……</td>
</tr>
<tr>
<td>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å›½éš›åŒ–</td>
<td>ä½</td>
<td>UX</td>
<td>ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®i18nå¯¾å¿œ</td>
</tr>
</tbody>
</table>
<h2 id="_12">ãƒ•ã‚¡ã‚¤ãƒ«çµ±è¨ˆ<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Javaãƒ•ã‚¡ã‚¤ãƒ«</strong>: 167ãƒ•ã‚¡ã‚¤ãƒ«</li>
<li><strong>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«</strong>: 128ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆWebApp + Integration Menuï¼‰</li>
<li><strong>è¨­è¨ˆæ›¸ãƒ•ã‚¡ã‚¤ãƒ«</strong>: 13ãƒ•ã‚¡ã‚¤ãƒ«</li>
<li><strong>ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«</strong>: 7ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚µãƒ¼ãƒ“ã‚¹å±¤ã®ã¿ï¼‰</li>
</ul>
</article>
<article id="analysis-architecture-diagram">
<h1 id="_1">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph TB
    subgraph "External Services"
        BOX[Box Cloud]
    end

    subgraph "Frontend Layer"
        FE1[Scalar-Box-WebApp<br/>React + MUI]
        FE2[Scalar-WebApp-Integration-Menu<br/>React]
    end

    subgraph "Backend Layer"
        BE[Scalar-Box-Event-Log-Tool<br/>Spring Boot 3.2]
    end

    subgraph "Data Layer"
        SDB[ScalarDB Cluster]
        SDL[ScalarDL]
        CASS[(Cassandra)]
    end

    BOX -->|Events API| BE
    FE1 -->|REST API| BE
    FE2 -->|REST API| BE
    BE -->|CRUD| SDB
    BE -->|Asset Verification| SDL
    SDB -->|Storage| CASS
    SDL -->|Ledger| CASS
</div>

<h2 id="2-backend">2. Backend ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹æˆ<a class="headerlink" href="#2-backend" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph LR
    subgraph "Presentation Layer"
        CTRL[Controllers]
    end

    subgraph "Business Layer"
        BIZ[Business Classes]
        SVC[Services]
    end

    subgraph "Data Access Layer"
        REPO[Repositories]
    end

    subgraph "Infrastructure"
        SDB[ScalarDB]
        SDL[ScalarDL]
        BOX[Box SDK]
    end

    CTRL --> BIZ
    BIZ --> SVC
    SVC --> REPO
    REPO --> SDB
    SVC --> SDL
    SVC --> BOX
</div>

<h2 id="3">3. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–¢ä¿‚å›³<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph TB
    subgraph "User Management"
        UC[UserController]
        UB[UserBusiness]
        US[UserService]
        UR[UserRepository]
    end

    subgraph "Audit Set Management"
        ASC[AuditSetController]
        ASB[AuditSetBusiness]
        ASS[AuditSetService]
        ASR[AuditSetRepository]
    end

    subgraph "Event Log"
        ELC[EventLogController]
        ELB[EventLogBusiness]
        ELS[EventLogService]
        ELR[EventsRepository]
    end

    subgraph "File Operations"
        FC[FileController]
        FB[FileBusiness]
        FS[FileService]
        ISR[ItemStatusRepository]
    end

    subgraph "ScalarDL Integration"
        AS[AssetService]
        SDR[ScalardlRepository]
    end

    UC --> UB --> US --> UR
    ASC --> ASB --> ASS --> ASR
    ELC --> ELB --> ELS --> ELR
    FC --> FB --> FS --> ISR
    FS --> AS --> SDR
</div>

<h2 id="4">4. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å›³<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<div class="mermaid">
sequenceDiagram
    participant User
    participant Frontend
    participant Backend
    participant BoxAPI
    participant ScalarDB
    participant ScalarDL

    User->>Frontend: ãƒ­ã‚°ã‚¤ãƒ³
    Frontend->>Backend: POST /api/users/login
    Backend->>ScalarDB: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼
    ScalarDB-->>Backend: èªè¨¼çµæœ
    Backend-->>Frontend: JWT Token

    User->>Frontend: ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°è¡¨ç¤º
    Frontend->>Backend: GET /api/events
    Backend->>ScalarDB: ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢
    ScalarDB-->>Backend: ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿
    Backend-->>Frontend: ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§

    User->>Frontend: ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼
    Frontend->>Backend: GET /api/files/{id}/verify
    Backend->>ScalarDL: æ”¹ã–ã‚“æ¤œè¨¼
    ScalarDL-->>Backend: æ¤œè¨¼çµæœ
    Backend-->>Frontend: æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
</div>

<h2 id="5">5. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæ§‹æˆ<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph TB
    subgraph "Kubernetes Cluster"
        subgraph "Frontend Pods"
            FE1[Scalar-Box-WebApp]
            FE2[Integration-Menu]
        end

        subgraph "Backend Pods"
            BE1[Event-Log-Tool #1]
            BE2[Event-Log-Tool #2]
        end

        subgraph "Data Pods"
            SDB1[ScalarDB Cluster]
            CASS1[Cassandra #1]
            CASS2[Cassandra #2]
            CASS3[Cassandra #3]
        end
    end

    LB[Load Balancer] --> FE1
    LB --> FE2
    FE1 --> BE1
    FE2 --> BE2
    BE1 --> SDB1
    BE2 --> SDB1
    SDB1 --> CASS1
    SDB1 --> CASS2
    SDB1 --> CASS3
</div>

<h2 id="6">6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<div class="mermaid">
sequenceDiagram
    participant Client
    participant JwtAuthFilter
    participant SecurityConfig
    participant Controller
    participant Service

    Client->>JwtAuthFilter: Request with JWT
    JwtAuthFilter->>JwtAuthFilter: Validate Token
    alt Token Valid
        JwtAuthFilter->>SecurityConfig: Set Authentication
        SecurityConfig->>Controller: Authorized Request
        Controller->>Service: Process Request
        Service-->>Client: Response
    else Token Invalid
        JwtAuthFilter-->>Client: 401 Unauthorized
    end
</div>
</article>
<article id="analysis-ubiquitous-language">
<h1 id="_1">ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªé›†<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">æ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã¯ã€BOXã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚µãƒ¼ãƒ“ã‚¹ã¨çµ±åˆã•ã‚ŒãŸå¤–éƒ¨ç›£æŸ»ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚’å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã—ã€å¤–éƒ¨ç›£æŸ»äººãŒãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨æ€§ã‚’æ¤œè¨¼ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚æœ¬è¨€èªé›†ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ç”¨èªã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<h2 id="_3">ç”¨èªå®šç¾©<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="-">ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ - ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†<a class="headerlink" href="#-" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>Audit Set</td>
<td>ç›£æŸ»å¯¾è±¡ã¨ã—ã¦é¸æŠã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚°ãƒ«ãƒ¼ãƒ—ã€‚åå‰ã¨èª¬æ˜ã‚’æŒã¤</td>
<td>AuditSet.java, AuditSetController</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>Audit Group</td>
<td>å¤–éƒ¨ç›£æŸ»äººã®ã‚°ãƒ«ãƒ¼ãƒ—ã€‚ç›£æŸ»ã‚»ãƒƒãƒˆã«ä¸€æ‹¬ã§å‰²ã‚Šå½“ã¦å¯èƒ½</td>
<td>AuditGroup.java, AuditGroupController</td>
</tr>
<tr>
<td>ç›£æŸ»å¯¾è±¡ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>Audit Set Item</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ•ã‚©ãƒ«ãƒ€</td>
<td>AuditSetItem.java</td>
</tr>
<tr>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>Collaborator</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>AuditSetCollaborators.java</td>
</tr>
<tr>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒªã‚¹ãƒˆ</td>
<td>Access List / ACL</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå†…ã§è¨±å¯ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸€è¦§</td>
<td>aclJson field</td>
</tr>
</tbody>
</table>
<h3 id="-_1">ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ - ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†<a class="headerlink" href="#-_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
<td>Event Log</td>
<td>BOXã§ã®æ“ä½œå±¥æ­´ï¼ˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€ç§»å‹•ã€ã‚³ãƒ”ãƒ¼ç­‰ï¼‰</td>
<td>Events.java, EventLogService</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>Item Events</td>
<td>ç‰¹å®šã‚¢ã‚¤ãƒ†ãƒ ã«å¯¾ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´</td>
<td>ItemEvents.java</td>
</tr>
<tr>
<td>ç›£æŸ»äººãƒ­ã‚°</td>
<td>Auditor Logs</td>
<td>å¤–éƒ¨ç›£æŸ»äººã®æ“ä½œå±¥æ­´ï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ç­‰ï¼‰</td>
<td>AuditorLogs.java</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´</td>
<td>Event History</td>
<td>æ—¥ä»˜ç¯„å›²ã‚„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ãªã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§</td>
<td>ViewAllEventHistory</td>
</tr>
</tbody>
</table>
<h3 id="-_2">ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ - ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼<a class="headerlink" href="#-_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ”¹ã–ã‚“æ¤œçŸ¥</td>
<td>Tampering Detection</td>
<td>ScalarDLã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«æ”¹ã–ã‚“ã®æ¤œå‡º</td>
<td>AssetService</td>
</tr>
<tr>
<td>æ¤œè¨¼</td>
<td>Validation</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ç›£æŸ»ã‚»ãƒƒãƒˆå…¨ä½“ã®æ”¹ã–ã‚“ãƒã‚§ãƒƒã‚¯</td>
<td>checkTamperingStatus API</td>
</tr>
<tr>
<td>æ”¹ã–ã‚“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>Tampering Status</td>
<td>TAMPERED, NOT_TAMPERED, MONITORED, NOT_MONITORED</td>
<td>TamperingStatusType</td>
</tr>
<tr>
<td>æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ</td>
<td>Validation Report</td>
<td>æ”¹ã–ã‚“æ¤œè¨¼çµæœã®å ±å‘Š</td>
<td>UI translations</td>
</tr>
<tr>
<td>SHA1ãƒãƒƒã‚·ãƒ¥</td>
<td>SHA1 Hash</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ„æ€§ã‚’è­˜åˆ¥ã™ã‚‹ãƒãƒƒã‚·ãƒ¥å€¤</td>
<td>ItemsBySha1.java</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼</td>
<td>File Copies</td>
<td>åŒä¸€ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æŒã¤ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€è¦§</td>
<td>getFileCopies API</td>
</tr>
<tr>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´</td>
<td>Version History</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®å…¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§</td>
<td>getFileVersion API</td>
</tr>
</tbody>
</table>
<h3 id="-_3">ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»æ¨©é™ç®¡ç†<a class="headerlink" href="#-_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>Organization User</td>
<td>BOXã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã¤å†…éƒ¨ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>User.java, UserRoles</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>External Auditor</td>
<td>å¤–éƒ¨çµ„ç¹”ã‹ã‚‰ã®ç›£æŸ»æ‹…å½“è€…ï¼ˆBOXã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸è¦ï¼‰</td>
<td>UserRoles.EXTERNAL_AUDITOR</td>
</tr>
<tr>
<td>ç›£æŸ»ç®¡ç†è€…</td>
<td>Audit Admin</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ¨©é™ã‚’æŒã¤ç®¡ç†è€…</td>
<td>UserRoles.AUDIT_ADMIN</td>
</tr>
<tr>
<td>ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>General User</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ãƒ»é–²è¦§æ¨©é™ã‚’æŒã¤ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>UserRoles.GENERAL_USER</td>
</tr>
<tr>
<td>æ‰€æœ‰è€…</td>
<td>Owner</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã®å®Œå…¨ãªç®¡ç†æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>CollaboratorUserRoles.OWNER</td>
</tr>
<tr>
<td>å…±åŒæ‰€æœ‰è€…</td>
<td>Co-Owner</td>
<td>æ‰€æœ‰è€…ã«æº–ãšã‚‹æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>CollaboratorUserRoles.CO_OWNER</td>
</tr>
<tr>
<td>ãƒ¡ãƒ³ãƒãƒ¼</td>
<td>Member</td>
<td>èª­ã¿å–ã‚Šã¨é™å®šç·¨é›†æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>CollaboratorUserRoles.MEMBER</td>
</tr>
<tr>
<td>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…</td>
<td>Reviewer</td>
<td>èª­ã¿å–ã‚Šå°‚ç”¨ã‚¢ã‚¯ã‚»ã‚¹ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>CollaboratorUserRoles.REVIEWER</td>
</tr>
</tbody>
</table>
<h3 id="-_4">ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ - ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†<a class="headerlink" href="#-_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>Item</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã¾ãŸã¯ãƒ•ã‚©ãƒ«ãƒ€ã®ç·ç§°</td>
<td>Item.java, ItemType</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«</td>
<td>File</td>
<td>BOXå†…ã®æ–‡æ›¸ãƒ•ã‚¡ã‚¤ãƒ«</td>
<td>ItemType.FILE</td>
</tr>
<tr>
<td>ãƒ•ã‚©ãƒ«ãƒ€</td>
<td>Folder</td>
<td>BOXå†…ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</td>
<td>ItemType.FOLDER</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>Item Status</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã®ç›£è¦–ãƒ»æ¤œè¨¼çŠ¶æ…‹</td>
<td>ItemStatus.java</td>
</tr>
<tr>
<td>ã‚¢ã‚»ãƒƒãƒˆ</td>
<td>Asset</td>
<td>ScalarDLã§ç®¡ç†ã•ã‚Œã‚‹æ¤œè¨¼å¯¾è±¡</td>
<td>AssetService</td>
</tr>
</tbody>
</table>
<h3 id="-box">ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ - BOXã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—<a class="headerlink" href="#-box" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</td>
<td>ITEM_UPLOAD</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ“ä½œ</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ç§»å‹•</td>
<td>ITEM_MOVE</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ç§»å‹•æ“ä½œ</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚³ãƒ”ãƒ¼</td>
<td>ITEM_COPY</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚³ãƒ”ãƒ¼æ“ä½œ</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤</td>
<td>ITEM_TRASH</td>
<td>ã‚´ãƒŸç®±ã¸ã®ç§»å‹•æ“ä½œ</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ å¾©å…ƒ</td>
<td>ITEM_UNDELETE_VIA_TRASH</td>
<td>ã‚´ãƒŸç®±ã‹ã‚‰ã®å¾©å…ƒæ“ä½œ</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ åå¤‰æ›´</td>
<td>ITEM_RENAME</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®åå‰å¤‰æ›´</td>
<td>EventType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ å¤‰æ›´</td>
<td>ITEM_MODIFY</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®å¤‰æ›´</td>
<td>EventType</td>
</tr>
</tbody>
</table>
<h3 id="-_5">ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ - å¤–éƒ¨ç›£æŸ»äººã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—<a class="headerlink" href="#-_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</td>
<td>ITEM_DOWNLOAD</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ“ä½œ</td>
<td>ActionType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</td>
<td>ITEM_PREVIEW</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º</td>
<td>ActionType</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ é–²è¦§</td>
<td>ITEM_VIEW</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°ã®é–²è¦§</td>
<td>ActionType</td>
</tr>
</tbody>
</table>
<h3 id="-_6">ã‚µãƒãƒ¼ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³ - èªè¨¼ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£<a class="headerlink" href="#-_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>JWTãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>JWT Token</td>
<td>APIèªè¨¼ç”¨ã®JSON Webãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>JwtHelper, JwtAuthFilter</td>
</tr>
<tr>
<td>ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>Refresh Token</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ç”¨ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>UserToken.java</td>
</tr>
<tr>
<td>OTPã‚³ãƒ¼ãƒ‰</td>
<td>OTP Code</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆç”¨ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
<td>UserOtp.java</td>
</tr>
<tr>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>Access Token</td>
<td>BOX APIå‘¼ã³å‡ºã—ç”¨ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>UserToken.java</td>
</tr>
</tbody>
</table>
<h3 id="_4">æŠ€è¡“ç”¨èª<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç”¨èªï¼ˆæ—¥æœ¬èªï¼‰</th>
<th>ç”¨èªï¼ˆè‹±èªï¼‰</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ScalarDB</td>
<td>ScalarDB</td>
<td>åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ãƒ¬ã‚¤ãƒ¤ãƒ¼</td>
<td>Repositoryå±¤</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>ScalarDL</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥ç”¨åˆ†æ•£å°å¸³</td>
<td>AssetService</td>
</tr>
<tr>
<td>BOX API</td>
<td>BOX API</td>
<td>BOXã‚¯ãƒ©ã‚¦ãƒ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®API</td>
<td>BoxUtility</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ </td>
<td>Event Stream</td>
<td>BOXã‹ã‚‰ã®ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </td>
<td>PositionTracker</td>
</tr>
</tbody>
</table>
<h2 id="_5">ç•¥èªãƒ»é ­å­—èª<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç•¥èª</th>
<th>æ­£å¼åç§°</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ACL</td>
<td>Access Control List</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆ</td>
</tr>
<tr>
<td>SHA1</td>
<td>Secure Hash Algorithm 1</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚·ãƒ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </td>
</tr>
<tr>
<td>JWT</td>
<td>JSON Web Token</td>
<td>èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³å½¢å¼</td>
</tr>
<tr>
<td>OTP</td>
<td>One-Time Password</td>
<td>ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
</tr>
<tr>
<td>CRUD</td>
<td>Create, Read, Update, Delete</td>
<td>åŸºæœ¬ãƒ‡ãƒ¼ã‚¿æ“ä½œ</td>
</tr>
<tr>
<td>DL</td>
<td>Distributed Ledger</td>
<td>åˆ†æ•£å°å¸³ï¼ˆScalarDLï¼‰</td>
</tr>
<tr>
<td>DB</td>
<td>Database</td>
<td>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆScalarDBï¼‰</td>
</tr>
</tbody>
</table>
<h2 id="_6">åŒç¾©èªãƒ»é¡ç¾©èªãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç”¨èªA</th>
<th>ç”¨èªB</th>
<th>æ¨å¥¨ç”¨èª</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>External User</td>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>ãƒ“ã‚¸ãƒã‚¹ãƒ­ãƒ¼ãƒ«ã‚’æ˜ç¢ºã«ã™ã‚‹</td>
</tr>
<tr>
<td>Organization User</td>
<td>BOX User</td>
<td>Organization User</td>
<td>ã‚·ã‚¹ãƒ†ãƒ å†…ã§ã®è­˜åˆ¥å</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼</td>
<td>Validation</td>
<td>æ¤œè¨¼</td>
<td>UIè¡¨ç¤ºã¨æ•´åˆ</td>
</tr>
<tr>
<td>æ”¹ã–ã‚“</td>
<td>Tampering</td>
<td>æ”¹ã–ã‚“</td>
<td>æ—¥æœ¬èªã§çµ±ä¸€</td>
</tr>
<tr>
<td>ã‚¢ã‚¯ã‚»ã‚¹è¨±å¯ãƒªã‚¹ãƒˆ</td>
<td>Allow List</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒªã‚¹ãƒˆ</td>
<td>ã‚³ãƒ¼ãƒ‰ä¸Šã®è¡¨ç¾ã¨æ•´åˆ</td>
</tr>
<tr>
<td>ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¢</td>
<td>Reviewer</td>
<td>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…</td>
<td>æ—¥æœ¬èªè¡¨ç¾ã‚’å„ªå…ˆ</td>
</tr>
</tbody>
</table>
<h2 id="_7">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåˆ¥ç”¨èªä½¿ç”¨<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="box">BOXçµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#box" title="Permanent link">&para;</a></h3>
<ul>
<li>ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°è¡¨ç¤ºã€ãƒ•ã‚©ãƒ«ãƒ€è©³ç´°è¡¨ç¤º</li>
<li>ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€è¿½åŠ </li>
<li>ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º</li>
</ul>
<h3 id="webui">WebUIã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#webui" title="Permanent link">&para;</a></h3>
<ul>
<li>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†ï¼ˆä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤ï¼‰</li>
<li>å¤–éƒ¨ç›£æŸ»äººãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</li>
<li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†</li>
<li>å…¨ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º</li>
</ul>
<h3 id="_8">å¤–éƒ¨ç›£æŸ»äººã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>ç›£æŸ»ã‚»ãƒƒãƒˆç›£è¦–</li>
<li>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
<li>æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆç¢ºèª</li>
</ul>
</article>
<article id="analysis-domain-entities">
<h1 id="_1">ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ä¸€è¦§<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="user">User<a class="headerlink" href="#user" title="Permanent link">&para;</a></h3>
<p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒã‚¹ã‚¿æƒ…å ±</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>id</td>
<td>BIGINT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
</tr>
<tr>
<td>name</td>
<td>TEXT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td>
</tr>
<tr>
<td>password</td>
<td>TEXT</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆãƒãƒƒã‚·ãƒ¥ï¼‰</td>
</tr>
<tr>
<td>role_json</td>
<td>TEXT</td>
<td>ãƒ­ãƒ¼ãƒ«æƒ…å ±ï¼ˆJSONï¼‰</td>
</tr>
<tr>
<td>org_id</td>
<td>TEXT</td>
<td>çµ„ç¹”ID</td>
</tr>
<tr>
<td>organization_name</td>
<td>TEXT</td>
<td>çµ„ç¹”å</td>
</tr>
<tr>
<td>image_url</td>
<td>TEXT</td>
<td>ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒURL</td>
</tr>
<tr>
<td>is_deleted</td>
<td>BOOLEAN</td>
<td>å‰Šé™¤ãƒ•ãƒ©ã‚°</td>
</tr>
<tr>
<td>is_box_admin</td>
<td>BOOLEAN</td>
<td>Boxç®¡ç†è€…ãƒ•ãƒ©ã‚°</td>
</tr>
<tr>
<td>language_code</td>
<td>TEXT</td>
<td>è¨€èªã‚³ãƒ¼ãƒ‰</td>
</tr>
</tbody>
</table>
<h3 id="roleuser">RoleUser<a class="headerlink" href="#roleuser" title="Permanent link">&para;</a></h3>
<p>ãƒ­ãƒ¼ãƒ«åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>role_name</td>
<td>TEXT</td>
<td>ãƒ­ãƒ¼ãƒ«åï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>user_id</td>
<td>BIGINT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
</tr>
<tr>
<td>user_name</td>
<td>TEXT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td>
</tr>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
</tr>
</tbody>
</table>
<h3 id="organization">Organization<a class="headerlink" href="#organization" title="Permanent link">&para;</a></h3>
<p>çµ„ç¹”ãƒã‚¹ã‚¿</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>org_id</td>
<td>TEXT</td>
<td>çµ„ç¹”IDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>organization_name</td>
<td>TEXT</td>
<td>çµ„ç¹”å</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ç›£æŸ»ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="auditset">AuditSet<a class="headerlink" href="#auditset" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ã‚»ãƒƒãƒˆ</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_set_id</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆIDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>audit_set_name</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå</td>
</tr>
<tr>
<td>description</td>
<td>TEXT</td>
<td>èª¬æ˜</td>
</tr>
<tr>
<td>owner_id</td>
<td>BIGINT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼ID</td>
</tr>
<tr>
<td>owner_name</td>
<td>TEXT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼å</td>
</tr>
<tr>
<td>owner_email</td>
<td>TEXT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼ãƒ¡ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>acl_json</td>
<td>TEXT</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒªã‚¹ãƒˆï¼ˆJSONï¼‰</td>
</tr>
<tr>
<td>is_deleted</td>
<td>BOOLEAN</td>
<td>å‰Šé™¤ãƒ•ãƒ©ã‚°</td>
</tr>
<tr>
<td>createdAt</td>
<td>BIGINT</td>
<td>ä½œæˆæ—¥æ™‚</td>
</tr>
<tr>
<td>audit_group_list_json</td>
<td>TEXT</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ãƒªã‚¹ãƒˆï¼ˆJSONï¼‰</td>
</tr>
</tbody>
</table>
<h3 id="auditsetcollaborators">AuditSetCollaborators<a class="headerlink" href="#auditsetcollaborators" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ã‚»ãƒƒãƒˆã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>audit_set_id</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆID</td>
</tr>
<tr>
<td>audit_set_name</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå</td>
</tr>
<tr>
<td>user_name</td>
<td>TEXT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td>
</tr>
<tr>
<td>audit_set_role</td>
<td>TEXT</td>
<td>ãƒ­ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>access_status</td>
<td>TEXT</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹çŠ¶æ…‹</td>
</tr>
<tr>
<td>is_favourite</td>
<td>BOOLEAN</td>
<td>ãŠæ°—ã«å…¥ã‚Šãƒ•ãƒ©ã‚°</td>
</tr>
</tbody>
</table>
<h3 id="auditgroup">AuditGroup<a class="headerlink" href="#auditgroup" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_group_id</td>
<td>TEXT</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—IDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>audit_group_name</td>
<td>TEXT</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—å</td>
</tr>
<tr>
<td>description</td>
<td>TEXT</td>
<td>èª¬æ˜</td>
</tr>
<tr>
<td>owner_id</td>
<td>BIGINT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼ID</td>
</tr>
<tr>
<td>owner_name</td>
<td>TEXT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼å</td>
</tr>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼ãƒ¡ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>member_list_json</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ³ãƒãƒ¼ãƒªã‚¹ãƒˆï¼ˆJSONï¼‰</td>
</tr>
<tr>
<td>created_at</td>
<td>BIGINT</td>
<td>ä½œæˆæ—¥æ™‚</td>
</tr>
<tr>
<td>is_deleted</td>
<td>BOOLEAN</td>
<td>å‰Šé™¤ãƒ•ãƒ©ã‚°</td>
</tr>
</tbody>
</table>
<h3 id="auditsetitem-auditset_folder_file_mapping">AuditSetItem (auditset_folder_file_mapping)<a class="headerlink" href="#auditsetitem-auditset_folder_file_mapping" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ </p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_set_id</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆIDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ID</td>
</tr>
<tr>
<td>item_name</td>
<td>TEXT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ å</td>
</tr>
<tr>
<td>item_type</td>
<td>TEXT</td>
<td>ã‚¿ã‚¤ãƒ—ï¼ˆfile/folderï¼‰</td>
</tr>
<tr>
<td>access_list_type</td>
<td>TEXT</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒªã‚¹ãƒˆã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>list_json</td>
<td>TEXT</td>
<td>ãƒªã‚¹ãƒˆæƒ…å ±ï¼ˆJSONï¼‰</td>
</tr>
<tr>
<td>created_at</td>
<td>BIGINT</td>
<td>ä½œæˆæ—¥æ™‚</td>
</tr>
<tr>
<td>assigned_by_user_id</td>
<td>BIGINT</td>
<td>å‰²ã‚Šå½“ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. ã‚¤ãƒ™ãƒ³ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="events">Events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h3>
<p>BOXã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>yyyy_mm_dd</td>
<td>TEXT</td>
<td>æ—¥ä»˜ï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>timestamp</td>
<td>TEXT</td>
<td>ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—</td>
</tr>
<tr>
<td>user_id</td>
<td>BIGINT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ID</td>
</tr>
<tr>
<td>user_name</td>
<td>TEXT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</td>
</tr>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
</tr>
<tr>
<td>asset_id</td>
<td>TEXT</td>
<td>ã‚¢ã‚»ãƒƒãƒˆID</td>
</tr>
<tr>
<td>asset_age</td>
<td>INT</td>
<td>ã‚¢ã‚»ãƒƒãƒˆå¹´é½¢</td>
</tr>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ID</td>
</tr>
<tr>
<td>item_version_id</td>
<td>BIGINT</td>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID</td>
</tr>
<tr>
<td>sha1_hash</td>
<td>TEXT</td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥</td>
</tr>
<tr>
<td>event_id</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆID</td>
</tr>
<tr>
<td>event_type</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>event_created_at</td>
<td>BIGINT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆä½œæˆæ—¥æ™‚</td>
</tr>
<tr>
<td>event_occured_on</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ—¥</td>
</tr>
<tr>
<td>parent_folder_id</td>
<td>BIGINT</td>
<td>è¦ªãƒ•ã‚©ãƒ«ãƒ€ID</td>
</tr>
<tr>
<td>source_json</td>
<td>TEXT</td>
<td>ã‚½ãƒ¼ã‚¹JSON</td>
</tr>
</tbody>
</table>
<h3 id="itemevents">ItemEvents<a class="headerlink" href="#itemevents" title="Permanent link">&para;</a></h3>
<p>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ IDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>item_version_id</td>
<td>BIGINT</td>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID</td>
</tr>
<tr>
<td>event_id</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆID</td>
</tr>
<tr>
<td>event_type</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>event_date</td>
<td>BIGINT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆæ—¥æ™‚</td>
</tr>
<tr>
<td>event_json_data</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆJSON</td>
</tr>
</tbody>
</table>
<h3 id="auditorlogs">AuditorLogs<a class="headerlink" href="#auditorlogs" title="Permanent link">&para;</a></h3>
<p>å¤–éƒ¨ç›£æŸ»äººæ“ä½œãƒ­ã‚°</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_set_id</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆIDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ID</td>
</tr>
<tr>
<td>user_email</td>
<td>TEXT</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</td>
</tr>
<tr>
<td>event_type</td>
<td>TEXT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>event_date</td>
<td>BIGINT</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆæ—¥æ™‚</td>
</tr>
<tr>
<td>item_type</td>
<td>TEXT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>custom_json_eventDetails</td>
<td>TEXT</td>
<td>ã‚«ã‚¹ã‚¿ãƒ ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="itemstatus">ItemStatus<a class="headerlink" href="#itemstatus" title="Permanent link">&para;</a></h3>
<p>ã‚¢ã‚¤ãƒ†ãƒ æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ IDï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>item_type</td>
<td>TEXT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—</td>
</tr>
<tr>
<td>status</td>
<td>TEXT</td>
<td>æ”¹ã–ã‚“æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
</tr>
<tr>
<td>last_validated_at</td>
<td>TEXT</td>
<td>æœ€çµ‚æ¤œè¨¼æ—¥æ™‚</td>
</tr>
<tr>
<td>monitored_status</td>
<td>TEXT</td>
<td>ç›£è¦–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
</tr>
<tr>
<td>list_of_auditset_json</td>
<td>TEXT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆ</td>
</tr>
</tbody>
</table>
<h3 id="itemsbysha1">ItemsBySha1<a class="headerlink" href="#itemsbysha1" title="Permanent link">&para;</a></h3>
<p>SHA1ãƒãƒƒã‚·ãƒ¥åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«</p>
<table>
<thead>
<tr>
<th>ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>sha1_hash</td>
<td>TEXT</td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥ï¼ˆPKï¼‰</td>
</tr>
<tr>
<td>item_id</td>
<td>BIGINT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ID</td>
</tr>
<tr>
<td>item_version_id</td>
<td>BIGINT</td>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ID</td>
</tr>
<tr>
<td>item_version_number</td>
<td>INT</td>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·</td>
</tr>
<tr>
<td>item_name</td>
<td>TEXT</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ å</td>
</tr>
<tr>
<td>owner_by_json</td>
<td>TEXT</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼æƒ…å ±</td>
</tr>
<tr>
<td>path</td>
<td>TEXT</td>
<td>ãƒ‘ã‚¹</td>
</tr>
<tr>
<td>created_at</td>
<td>BIGINT</td>
<td>ä½œæˆæ—¥æ™‚</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5-enum">5. å®šæ•°ãƒ»Enum<a class="headerlink" href="#5-enum" title="Permanent link">&para;</a></h2>
<h3 id="userroles">UserRoles<a class="headerlink" href="#userroles" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">- AUDIT_ADMIN
- GENERAL_USER
- EXTERNAL_AUDITOR
</code></pre>

<h3 id="eventtype">EventType<a class="headerlink" href="#eventtype" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">- UPLOAD
- DOWNLOAD
- PREVIEW
- DELETE
- MOVE
- COPY
- RENAME
- ... (Box Event Types)
</code></pre>

<h3 id="tamperingstatustype">TamperingStatusType<a class="headerlink" href="#tamperingstatustype" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">- VALID
- TAMPERED
- NOT_VERIFIED
</code></pre>

<h3 id="itemtype">ItemType<a class="headerlink" href="#itemtype" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">- FILE
- FOLDER
</code></pre>

<h3 id="collaboratoruserroles">CollaboratorUserRoles<a class="headerlink" href="#collaboratoruserroles" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">- OWNER
- REVIEWER
- VIEWER
</code></pre>
</article>
<article id="analysis-actors-roles-permissions">
<h1 id="_1">ã‚¢ã‚¯ã‚¿ãƒ¼ãƒ»ãƒ­ãƒ¼ãƒ«ãƒ»æ¨©é™<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">ã‚¢ã‚¯ã‚¿ãƒ¼ä¸€è¦§<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">äººé–“ã‚¢ã‚¯ã‚¿ãƒ¼<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¢ã‚¯ã‚¿ãƒ¼</th>
<th>èª¬æ˜</th>
<th>ä¸»ãªæ“ä½œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ç®¡ç†è€…ï¼ˆAudit Adminï¼‰</td>
<td>çµ„ç¹”ã®ç®¡ç†è²¬ä»»è€…ã€‚ç›£æŸ»ã‚»ãƒƒãƒˆã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€å¤–éƒ¨ç›£æŸ»äººã®ç®¡ç†ã‚’è¡Œã†</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆCRUDã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†ã€å¤–éƒ¨ç›£æŸ»äººç®¡ç†</td>
</tr>
<tr>
<td>ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆGeneral Userï¼‰</td>
<td>BOXã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’æŒã¤çµ„ç¹”å†…ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ã€é–²è¦§ã€ç›£æŸ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°ç¢ºèª</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äººï¼ˆExternal Auditorï¼‰</td>
<td>å¤–éƒ¨çµ„ç¹”ã‹ã‚‰ã®ç›£æŸ»æ‹…å½“è€…</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆé–²è¦§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€æ¤œè¨¼</td>
</tr>
</tbody>
</table>
<h3 id="_4">ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚¿ãƒ¼<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚·ã‚¹ãƒ†ãƒ </th>
<th>èª¬æ˜</th>
<th>é€£æºæ–¹æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOX API (Event Stream)</td>
<td>BOXã®ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ API</td>
<td>Client Credentials Grantèªè¨¼ã€ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—</td>
</tr>
<tr>
<td>BOX API (User Operations)</td>
<td>BOXã®ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œAPI</td>
<td>OAuth 2.0èªè¨¼ã€ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°å–å¾—ãƒ»æ“ä½œ</td>
</tr>
<tr>
<td>ScalarDB Cluster</td>
<td>åˆ†æ•£ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </td>
<td>gRPCé€šä¿¡ã€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>åˆ†æ•£å°å¸³ã‚·ã‚¹ãƒ†ãƒ </td>
<td>gRPCé€šä¿¡ã€æ”¹ã–ã‚“æ¤œçŸ¥ãƒ»ã‚¢ã‚»ãƒƒãƒˆç®¡ç†</td>
</tr>
<tr>
<td>SMTP Server</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒãƒ¼</td>
<td>SMTPé€šä¿¡ã€OTPãƒ¡ãƒ¼ãƒ«é€ä¿¡</td>
</tr>
</tbody>
</table>
<h2 id="_5">ãƒ­ãƒ¼ãƒ«å®šç¾©<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="userroles">ã‚·ã‚¹ãƒ†ãƒ ãƒ­ãƒ¼ãƒ«ï¼ˆUserRolesï¼‰<a class="headerlink" href="#userroles" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ­ãƒ¼ãƒ«</th>
<th>èª¬æ˜</th>
<th>æ¨©é™ã‚»ãƒƒãƒˆ</th>
<th>ã‚³ãƒ¼ãƒ‰å‚ç…§</th>
</tr>
</thead>
<tbody>
<tr>
<td>AUDIT_ADMIN</td>
<td>ç›£æŸ»ç®¡ç†è€…</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã€å¤–éƒ¨ç›£æŸ»äººç®¡ç†ã€å…¨ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´é–²è¦§</td>
<td>UserRoles.AUDIT_ADMIN</td>
</tr>
<tr>
<td>GENERAL_USER</td>
<td>ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ã€é–²è¦§ã€ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€ç›£æŸ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°é–²è¦§</td>
<td>UserRoles.GENERAL_USER</td>
</tr>
<tr>
<td>EXTERNAL_AUDITOR</td>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>å‰²ã‚Šå½“ã¦ç›£æŸ»ã‚»ãƒƒãƒˆé–²è¦§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã€æ¤œè¨¼</td>
<td>UserRoles.EXTERNAL_AUDITOR</td>
</tr>
</tbody>
</table>
<h3 id="collaboratoruserroles">ç›£æŸ»ã‚»ãƒƒãƒˆã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ«ï¼ˆCollaboratorUserRolesï¼‰<a class="headerlink" href="#collaboratoruserroles" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ­ãƒ¼ãƒ«</th>
<th>èª¬æ˜</th>
<th>æ¨©é™ã‚»ãƒƒãƒˆ</th>
<th>ã‚³ãƒ¼ãƒ‰å‚ç…§</th>
</tr>
</thead>
<tbody>
<tr>
<td>OWNER</td>
<td>æ‰€æœ‰è€…</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã®å®Œå…¨ãªç®¡ç†æ¨©é™ã€æ‰€æœ‰æ¨©ç§»è­²</td>
<td>CollaboratorUserRoles.OWNER</td>
</tr>
<tr>
<td>CO_OWNER</td>
<td>å…±åŒæ‰€æœ‰è€…</td>
<td>æ‰€æœ‰è€…ã«æº–ãšã‚‹ç®¡ç†æ¨©é™ï¼ˆæ‰€æœ‰æ¨©ç§»è­²ã¯å—ã‘å–ã‚Šã®ã¿ï¼‰</td>
<td>CollaboratorUserRoles.CO_OWNER</td>
</tr>
<tr>
<td>MEMBER</td>
<td>ãƒ¡ãƒ³ãƒãƒ¼</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå†…ã‚¢ã‚¤ãƒ†ãƒ ã®é–²è¦§ãƒ»é™å®šç·¨é›†</td>
<td>CollaboratorUserRoles.MEMBER</td>
</tr>
<tr>
<td>REVIEWER</td>
<td>ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‹…å½“è€…</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå†…ã‚¢ã‚¤ãƒ†ãƒ ã®èª­ã¿å–ã‚Šå°‚ç”¨ã‚¢ã‚¯ã‚»ã‚¹</td>
<td>CollaboratorUserRoles.REVIEWER</td>
</tr>
</tbody>
</table>
<h3 id="auditgroupprivileges">ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ¨©é™ï¼ˆAuditGroupPrivilegesï¼‰<a class="headerlink" href="#auditgroupprivileges" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¨©é™</th>
<th>èª¬æ˜</th>
<th>ã‚³ãƒ¼ãƒ‰å‚ç…§</th>
</tr>
</thead>
<tbody>
<tr>
<td>OWNER</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—æ‰€æœ‰è€…</td>
<td>AuditGroupPrivileges.OWNER</td>
</tr>
<tr>
<td>MEMBER</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ãƒ¡ãƒ³ãƒãƒ¼</td>
<td>AuditGroupPrivileges.MEMBER</td>
</tr>
</tbody>
</table>
<h2 id="_6">æ¨©é™ãƒãƒˆãƒªãƒƒã‚¯ã‚¹<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="_7">ã‚·ã‚¹ãƒ†ãƒ æ“ä½œæ¨©é™<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>Audit Admin</th>
<th>General User</th>
<th>External Auditor</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOXçµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ä½¿ç”¨</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>WebUI ãƒ­ã‚°ã‚¤ãƒ³</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–°</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ‰€æœ‰è€…å¤‰æ›´</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ </td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ </td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äººä½œæˆ</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äººæ›´æ–°</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äººå‰Šé™¤</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«è¿½åŠ /ç·¨é›†</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äººã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«å‰²ã‚Šå½“ã¦</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>å…¨ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°è¡¨ç¤º</td>
<td>âœ—</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</td>
<td>âœ—</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</td>
<td>âœ—</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>è‡ªåˆ†/å…±æœ‰ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°è¡¨ç¤º</td>
<td>âœ“</td>
<td>âœ“</td>
<td>-</td>
</tr>
<tr>
<td>ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°è¡¨ç¤º</td>
<td>-</td>
<td>-</td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<h3 id="_8">ç›£æŸ»ã‚»ãƒƒãƒˆã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼æ¨©é™<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>Owner</th>
<th>Co-Owner</th>
<th>Member</th>
<th>Reviewer</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæƒ…å ±é–²è¦§</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæƒ…å ±ç·¨é›†</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>æ‰€æœ‰è€…å¤‰æ›´</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>æ–°æ‰€æœ‰è€…ã«ãªã‚‹</td>
<td>-</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ </td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ é–²è¦§</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>æ¤œè¨¼å®Ÿè¡Œ</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<h2 id="_9">ãƒ­ãƒ¼ãƒ«å¤‰æ›´ãƒ«ãƒ¼ãƒ«<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h3 id="_10">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«å¤‰æ›´ãƒãƒˆãƒªãƒƒã‚¯ã‚¹<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å¤‰æ›´å‰ãƒ­ãƒ¼ãƒ«</th>
<th>æ“ä½œ</th>
<th>å¤‰æ›´å¾Œãƒ­ãƒ¼ãƒ«</th>
</tr>
</thead>
<tbody>
<tr>
<td>AUDIT_ADMIN</td>
<td>ãƒ­ãƒ¼ãƒ«å¤‰æ›´</td>
<td>GENERAL_USER</td>
</tr>
<tr>
<td>GENERAL_USER</td>
<td>ãƒ­ãƒ¼ãƒ«å¤‰æ›´</td>
<td>AUDIT_ADMIN</td>
</tr>
<tr>
<td>AUDIT_ADMIN</td>
<td>ãƒ­ãƒ¼ãƒ«è¿½åŠ </td>
<td>AUDIT_ADMIN + GENERAL_USER</td>
</tr>
<tr>
<td>GENERAL_USER</td>
<td>ãƒ­ãƒ¼ãƒ«è¿½åŠ </td>
<td>GENERAL_USER + AUDIT_ADMIN</td>
</tr>
<tr>
<td>AUDIT_ADMIN + GENERAL_USER</td>
<td>AUDIT_ADMINå‰Šé™¤</td>
<td>GENERAL_USER</td>
</tr>
<tr>
<td>AUDIT_ADMIN + GENERAL_USER</td>
<td>GENERAL_USERå‰Šé™¤</td>
<td>AUDIT_ADMIN</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„äº‹é …:</strong>
- ãƒ­ãƒ¼ãƒ«å¤‰æ›´ã¯AUDIT_ADMINã®ã¿å®Ÿè¡Œå¯èƒ½
- è‡ªåˆ†è‡ªèº«ã®AUDIT_ADMINãƒ­ãƒ¼ãƒ«ã¯å‰Šé™¤ä¸å¯ï¼ˆä»–ã®ç®¡ç†è€…ãŒå¿…è¦ï¼‰</p>
<h2 id="_11">èªè¨¼ãƒ»èªå¯ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h2>
<h3 id="_12">çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor User as çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant WebApp as Scalar Box WebApp
    participant API as Spring Boot API
    participant BOX as BOX OAuth 2.0
    participant DB as ScalarDB

    User->>WebApp: ã‚µã‚¤ãƒ³ã‚¤ãƒ³è¦æ±‚
    WebApp->>BOX: OAuthèªè¨¼ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    BOX-->>User: èªè¨¼ç”»é¢è¡¨ç¤º
    User->>BOX: BOXèªè¨¼æƒ…å ±å…¥åŠ›
    BOX-->>WebApp: èªè¨¼ã‚³ãƒ¼ãƒ‰è¿”å´
    WebApp->>API: ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›è¦æ±‚
    API->>BOX: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
    BOX-->>API: ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³
    API->>DB: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ä¿å­˜/æ›´æ–°
    API-->>WebApp: JWT ãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œ
    WebApp-->>User: ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†
</div>

<h3 id="_13">å¤–éƒ¨ç›£æŸ»äººèªè¨¼ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Auditor as å¤–éƒ¨ç›£æŸ»äºº
    participant WebApp as Scalar Box WebApp
    participant API as Spring Boot API
    participant DB as ScalarDB

    Auditor->>WebApp: ãƒ¡ãƒ¼ãƒ«/ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›
    WebApp->>API: èªè¨¼è¦æ±‚
    API->>DB: èªè¨¼æƒ…å ±æ¤œè¨¼
    DB-->>API: ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±
    API->>API: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼
    API->>API: JWT ãƒˆãƒ¼ã‚¯ãƒ³ç”Ÿæˆ
    API-->>WebApp: JWT ãƒˆãƒ¼ã‚¯ãƒ³
    WebApp-->>Auditor: ãƒ­ã‚°ã‚¤ãƒ³å®Œäº†
</div>

<h3 id="_14">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor User as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant WebApp as Scalar Box WebApp
    participant API as Spring Boot API
    participant DB as ScalarDB
    participant SMTP as SMTPã‚µãƒ¼ãƒãƒ¼

    User->>WebApp: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆè¦æ±‚
    WebApp->>API: OTPé€ä¿¡è¦æ±‚
    API->>API: OTPç”Ÿæˆ
    API->>DB: OTPä¿å­˜
    API->>SMTP: OTPãƒ¡ãƒ¼ãƒ«é€ä¿¡
    SMTP-->>User: OTPãƒ¡ãƒ¼ãƒ«å—ä¿¡
    User->>WebApp: OTP + æ–°ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›
    WebApp->>API: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°è¦æ±‚
    API->>DB: OTPæ¤œè¨¼ + ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°
    API-->>WebApp: æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    WebApp-->>User: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ›´æ–°å®Œäº†
</div>

<h3 id="api">APIèªå¯ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#api" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant Client as ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
    participant Filter as JwtAuthFilter
    participant Provider as AuthenticationProvider
    participant Controller as Controller
    participant Service as Service

    Client->>Filter: APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ + JWT
    Filter->>Filter: JWTãƒˆãƒ¼ã‚¯ãƒ³æŠ½å‡º
    Filter->>Provider: ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼
    Provider-->>Filter: èªè¨¼æƒ…å ±

    alt èªè¨¼æˆåŠŸ
        Filter->>Controller: ãƒªã‚¯ã‚¨ã‚¹ãƒˆè»¢é€
        Controller->>Service: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè¡Œ
        Service-->>Controller: çµæœ
        Controller-->>Client: æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    else èªè¨¼å¤±æ•—
        Filter-->>Client: 401 Unauthorized
    end
</div>

<h2 id="api_1">APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆèªå¯è¨­å®š<a class="headerlink" href="#api_1" title="Permanent link">&para;</a></h2>
<h3 id="_15">ãƒ›ãƒ¯ã‚¤ãƒˆãƒªã‚¹ãƒˆï¼ˆèªè¨¼ä¸è¦ï¼‰<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‘ã‚¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/auth/**</td>
<td>èªè¨¼é–¢é€£API</td>
</tr>
<tr>
<td>/box/user/login</td>
<td>ãƒ­ã‚°ã‚¤ãƒ³</td>
</tr>
<tr>
<td>/box/user/submitToken</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³é€ä¿¡</td>
</tr>
<tr>
<td>/box/item/getIntegratedItemDetail</td>
<td>çµ±åˆã‚¢ã‚¤ãƒ†ãƒ è©³ç´°</td>
</tr>
<tr>
<td>/box/user/sendResetPasswordOTP</td>
<td>OTPé€ä¿¡</td>
</tr>
<tr>
<td>/box/user/forgotPassword</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ</td>
</tr>
<tr>
<td>/box/user/userSignIn/*</td>
<td>ã‚µã‚¤ãƒ³ã‚¤ãƒ³</td>
</tr>
<tr>
<td>/box/user/getNewAccessToken</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°</td>
</tr>
<tr>
<td>/swagger-ui/<strong>, /v3/api-docs/</strong></td>
<td>APIä»•æ§˜æ›¸</td>
</tr>
</tbody>
</table>
<h3 id="_16">èªè¨¼å¿…è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>ãã®ä»–ã™ã¹ã¦ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯JWTèªè¨¼ãŒå¿…è¦ã§ã™ã€‚</p>
<h2 id="_17">ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>è¨­å®šé …ç›®</th>
<th>å€¤</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†</td>
<td>STATELESS</td>
<td>JWTãƒ™ãƒ¼ã‚¹ã®ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹èªè¨¼</td>
</tr>
<tr>
<td>CSRFä¿è­·</td>
<td>ç„¡åŠ¹</td>
<td>REST APIã®ãŸã‚CSRFç„¡åŠ¹åŒ–</td>
</tr>
<tr>
<td>CORS</td>
<td>å…¨ã‚ªãƒªã‚¸ãƒ³è¨±å¯</td>
<td>æœ¬ç•ªç’°å¢ƒã§ã¯é©åˆ‡ãªã‚ªãƒªã‚¸ãƒ³è¨­å®šå¿…è¦</td>
</tr>
<tr>
<td>èªè¨¼æ–¹å¼</td>
<td>JWT Bearer Token</td>
<td>Authorization ãƒ˜ãƒƒãƒ€ãƒ¼ã§é€ä¿¡</td>
</tr>
</tbody>
</table>
</article>
<article id="analysis-domain-code-mapping">
<h1 id="-">ãƒ‰ãƒ¡ã‚¤ãƒ³-ã‚³ãƒ¼ãƒ‰å¯¾å¿œè¡¨<a class="headerlink" href="#-" title="Permanent link">&para;</a></h1>
<h2 id="_1">ãƒãƒƒãƒ”ãƒ³ã‚°æ¦‚è¦<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã®ãƒ‰ãƒ¡ã‚¤ãƒ³æ¦‚å¿µã¨ã‚³ãƒ¼ãƒ‰å®Ÿè£…ã®å¯¾å¿œé–¢ä¿‚ã‚’æ•´ç†ã—ã¾ã™ã€‚æœ¬ã‚·ã‚¹ãƒ†ãƒ ã¯ä»¥ä¸‹ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ã§å®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ï¼š</p>
<ul>
<li><strong>Controllerå±¤</strong>: REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©</li>
<li><strong>Serviceå±¤</strong>: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…</li>
<li><strong>Repositoryå±¤</strong>: ScalarDBã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹</li>
<li><strong>Modelå±¤</strong>: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ï¼ˆ@Builderãƒ‘ã‚¿ãƒ¼ãƒ³ä½¿ç”¨ï¼‰</li>
<li><strong>DTOå±¤</strong>: ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</li>
<li><strong>Constantå±¤</strong>: Enumãƒ»å®šæ•°å®šç¾©</li>
</ul>
<h2 id="_2">ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="_3">ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µã‚«ãƒ†ã‚´ãƒª</th>
<th>è¨­è¨ˆæ›¸ã§ã®åç§°</th>
<th>ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>AuditSet</td>
<td>model/AuditSet.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>AuditGroup</td>
<td>model/AuditGroup.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ </td>
<td>AuditSetItem</td>
<td>model/AuditSetItem.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>AuditSetCollaborators</td>
<td>model/AuditSetCollaborators.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—-ç›£æŸ»ã‚»ãƒƒãƒˆãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>AuditGrpAuditSetMapping</td>
<td>model/AuditGrpAuditSetMapping.java</td>
<td>Mapping Entity</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>AuditSetService</td>
<td>service/AuditSetService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
<td>AuditGroupService</td>
<td>service/AuditGroupService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†</td>
<td>AuditSetItemService</td>
<td>service/AuditSetItemService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†</td>
<td>AuditSetCollaboratorService</td>
<td>service/AuditSetCollaboratorService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ°¸ç¶šåŒ–</td>
<td>AuditSetRepository</td>
<td>repository/AuditSetRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ°¸ç¶šåŒ–</td>
<td>AuditGroupRepository</td>
<td>repository/AuditGroupRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>API</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆCRUD</td>
<td>AuditSetController</td>
<td>controller/AuditSetController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>API</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—CRUD</td>
<td>AuditGroupController</td>
<td>controller/AuditGroupController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>DTO</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ</td>
<td>CreateAuditSet</td>
<td>dto/CreateAuditSet.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>DTO</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–°</td>
<td>UpdateAuditSet</td>
<td>dto/UpdateAuditSet.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>DTO</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ</td>
<td>CreateAuditGroup</td>
<td>dto/CreateAuditGroup.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>ãƒ¬ã‚¹ãƒãƒ³ã‚¹</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§</td>
<td>AuditSetList</td>
<td>responsedto/AuditSetList.java</td>
<td>Response DTO</td>
</tr>
</tbody>
</table>
<h3 id="_4">ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µã‚«ãƒ†ã‚´ãƒª</th>
<th>è¨­è¨ˆæ›¸ã§ã®åç§°</th>
<th>ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>Events</td>
<td>model/Events.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>ItemEvents</td>
<td>model/ItemEvents.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ç›£æŸ»äººãƒ­ã‚°</td>
<td>AuditorLogs</td>
<td>model/AuditorLogs.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ä½ç½®</td>
<td>PositionTracker</td>
<td>model/PositionTracker.java</td>
<td>Tracking Entity</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—</td>
<td>EventType</td>
<td>constant/EventType.java</td>
<td>Enum</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—</td>
<td>ActionType</td>
<td>constant/ActionType.java</td>
<td>Enum</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</td>
<td>EventLogService</td>
<td>service/EventLogService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆæ°¸ç¶šåŒ–</td>
<td>EventsRepository</td>
<td>repository/EventsRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆæ°¸ç¶šåŒ–</td>
<td>ItemEventsRepository</td>
<td>repository/ItemEventsRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ç›£æŸ»äººãƒ­ã‚°æ°¸ç¶šåŒ–</td>
<td>AuditorLogsRepository</td>
<td>repository/AuditorLogsRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>API</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´ç…§ä¼š</td>
<td>EventLogController</td>
<td>controller/EventLogController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>ãƒ“ã‚¸ãƒã‚¹</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å‡¦ç†</td>
<td>EventLogBusiness</td>
<td>business/EventLogBusiness.java</td>
<td>Business Logic</td>
</tr>
</tbody>
</table>
<h3 id="_5">ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†ãƒ»æ¤œè¨¼ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µã‚«ãƒ†ã‚´ãƒª</th>
<th>è¨­è¨ˆæ›¸ã§ã®åç§°</th>
<th>ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>Item</td>
<td>model/Item.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>ItemStatus</td>
<td>model/ItemStatus.java</td>
<td>Status Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>SHA1åˆ¥ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>ItemsBySha1</td>
<td>model/ItemsBySha1.java</td>
<td>Index Entity</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¿ã‚¤ãƒ—</td>
<td>ItemType</td>
<td>constant/ItemType.java</td>
<td>Enum (FILE, FOLDER)</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>æ”¹ã–ã‚“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>TamperingStatusType</td>
<td>constant/TamperingStatusType.java</td>
<td>Enum</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†</td>
<td>FileService</td>
<td>service/FileService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
<td>FolderService</td>
<td>service/FolderService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ã‚¢ã‚»ãƒƒãƒˆç®¡ç†ï¼ˆæ¤œè¨¼ï¼‰</td>
<td>AssetService</td>
<td>service/AssetService.java</td>
<td>@Service (ScalarDL)</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æ°¸ç¶šåŒ–</td>
<td>ItemRepository</td>
<td>repository/ItemRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ°¸ç¶šåŒ–</td>
<td>ItemStatusRepository</td>
<td>repository/ItemStatusRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ScalarDLé€£æº</td>
<td>ScalardlRepository</td>
<td>repository/ScalardlRepository.java</td>
<td>ScalarDL Repository</td>
</tr>
<tr>
<td>API</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ</td>
<td>FileController</td>
<td>controller/FileController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>API</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€æ“ä½œ</td>
<td>FolderController</td>
<td>controller/FolderController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>API</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æ“ä½œ</td>
<td>ItemController</td>
<td>controller/ItemController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>DTO</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°</td>
<td>ItemDetails</td>
<td>dto/ItemDetails.java</td>
<td>Response DTO</td>
</tr>
<tr>
<td>DTO</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³</td>
<td>FileVersion</td>
<td>dto/FileVersion.java</td>
<td>Response DTO</td>
</tr>
<tr>
<td>ãƒ¬ã‚¹ãƒãƒ³ã‚¹</td>
<td>æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>VerifyItemStatus</td>
<td>responsedto/VerifyItemStatus.java</td>
<td>Response DTO</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</td>
<td>BOX APIé€£æº</td>
<td>BoxUtility</td>
<td>utility/BoxUtility.java</td>
<td>Utility Class</td>
</tr>
</tbody>
</table>
<h3 id="_6">ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»èªè¨¼ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µã‚«ãƒ†ã‚´ãƒª</th>
<th>è¨­è¨ˆæ›¸ã§ã®åç§°</th>
<th>ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>User</td>
<td>model/User.java</td>
<td>Lombok @Builder Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ãƒ­ãƒ¼ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>RoleUser</td>
<td>model/RoleUser.java</td>
<td>Mapping Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>UserToken</td>
<td>model/UserToken.java</td>
<td>Token Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼OTP</td>
<td>UserOtp</td>
<td>model/UserOtp.java</td>
<td>OTP Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>UserAuditGroup</td>
<td>model/UserAuditGroup.java</td>
<td>Mapping Entity</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>çµ„ç¹”</td>
<td>Organization</td>
<td>model/Organization.java</td>
<td>Organization Entity</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«</td>
<td>UserRoles</td>
<td>constant/UserRoles.java</td>
<td>Enum</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ«</td>
<td>CollaboratorUserRoles</td>
<td>constant/CollaboratorUserRoles.java</td>
<td>Enum</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ¨©é™</td>
<td>AuditGroupPrivileges</td>
<td>constant/AuditGroupPrivileges.java</td>
<td>Enum</td>
</tr>
<tr>
<td>å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>AccessStatus</td>
<td>constant/AccessStatus.java</td>
<td>Enum</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td>UserService</td>
<td>service/UserService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹</td>
<td>å…±é€šã‚µãƒ¼ãƒ“ã‚¹</td>
<td>CommonService</td>
<td>service/CommonService.java</td>
<td>@Service</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æ°¸ç¶šåŒ–</td>
<td>UserRepository</td>
<td>repository/UserRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ãƒ­ãƒ¼ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼æ°¸ç¶šåŒ–</td>
<td>RoleUserRepository</td>
<td>repository/RoleUserRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>ãƒªãƒã‚¸ãƒˆãƒª</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³æ°¸ç¶šåŒ–</td>
<td>UserTokenRepository</td>
<td>repository/UserTokenRepository.java</td>
<td>ScalarDB Repository</td>
</tr>
<tr>
<td>API</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td>UserController</td>
<td>controller/UserController.java</td>
<td>@RestController</td>
</tr>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>JWTèªè¨¼ãƒ•ã‚£ãƒ«ã‚¿</td>
<td>JwtAuthFilter</td>
<td>security/JwtAuthFilter.java</td>
<td>Filter</td>
</tr>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>JWTãƒ˜ãƒ«ãƒ‘ãƒ¼</td>
<td>JwtHelper</td>
<td>security/JwtHelper.java</td>
<td>JWT Utility</td>
</tr>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®š</td>
<td>SecurityConfig</td>
<td>security/SecurityConfig.java</td>
<td>@Configuration</td>
</tr>
<tr>
<td>DTO</td>
<td>ãƒ­ã‚°ã‚¤ãƒ³è¦æ±‚</td>
<td>LoginRequest</td>
<td>dto/LoginRequest.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>DTO</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³é€ä¿¡</td>
<td>SubmitToken</td>
<td>dto/SubmitToken.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>DTO</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†</td>
<td>EditUserDto</td>
<td>dto/EditUserDto.java</td>
<td>Request DTO</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</td>
<td>ãƒ¡ãƒ¼ãƒ«é€ä¿¡</td>
<td>EmailUtility</td>
<td>utility/EmailUtility.java</td>
<td>Utility Class</td>
</tr>
</tbody>
</table>
<h3 id="_7">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µã‚«ãƒ†ã‚´ãƒª</th>
<th>è¨­è¨ˆæ›¸ã§ã®åç§°</th>
<th>ã‚³ãƒ¼ãƒ‰ä¸Šã®å®Ÿè£…</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç”»é¢</td>
<td>ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢</td>
<td>LoginandSignup</td>
<td>pages/auth/LoginandSignup.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ</td>
<td>ForgotPassword</td>
<td>pages/auth/ForgotPassword.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>AuditSet</td>
<td>pages/AuditSet/AuditSet.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>å¤–éƒ¨ç›£æŸ»äººãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
<td>AuditorsAndGroups</td>
<td>pages/AuditorsAndGroups/AuditorsAndGroups.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ç®¡ç†</td>
<td>UserRole</td>
<td>pages/UserRole/UserRole.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>å¤–éƒ¨ç›£æŸ»äººãƒ“ãƒ¥ãƒ¼</td>
<td>ExternalAuditor</td>
<td>pages/ExternalAuditorPage/ExternalAuditor.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´</td>
<td>ViewAllEventHistory</td>
<td>pages/ViewAllEventHistory/ViewAllEventHistory.jsx</td>
<td>React Component</td>
</tr>
<tr>
<td>ç”»é¢</td>
<td>ç›£æŸ»å¯¾è±¡ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>ViewItemsUnderAudit</td>
<td>pages/ViewItemsUnderAudit/</td>
<td>React Component</td>
</tr>
<tr>
<td>çŠ¶æ…‹ç®¡ç†</td>
<td>èªè¨¼çŠ¶æ…‹</td>
<td>authSlice</td>
<td>redux/reducerSlice/authSlice.js</td>
<td>Redux Slice</td>
</tr>
<tr>
<td>çŠ¶æ…‹ç®¡ç†</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³çŠ¶æ…‹</td>
<td>tokenSlice</td>
<td>redux/reducerSlice/tokenSlice.js</td>
<td>Redux Slice</td>
</tr>
<tr>
<td>çŠ¶æ…‹ç®¡ç†</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€çŠ¶æ…‹</td>
<td>folderAndFileSlice</td>
<td>redux/reducerSlice/folderAndFileSlice.js</td>
<td>Redux Slice</td>
</tr>
<tr>
<td>ãƒ•ãƒƒã‚¯</td>
<td>èªè¨¼æ¸ˆã¿Axios</td>
<td>useAxiosPrivate</td>
<td>hooks/useAxiosPrivate.js</td>
<td>Custom Hook</td>
</tr>
<tr>
<td>ãƒ•ãƒƒã‚¯</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥</td>
<td>useRefreshToken</td>
<td>hooks/useRefreshToken.js</td>
<td>Custom Hook</td>
</tr>
</tbody>
</table>
<h2 id="_8">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>è¨­è¨ˆæ¦‚å¿µ</th>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«å</th>
<th>ãƒ¢ãƒ‡ãƒ«ã‚¯ãƒ©ã‚¹</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
<td>scalar_box.events</td>
<td>Events</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: yyyy_mm_dd</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>scalar_box.item_events</td>
<td>ItemEvents</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: item_id</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>scalar_box.audit_set</td>
<td>AuditSet</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_set_id</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>scalar_box.audit_set_collaborators</td>
<td>AuditSetCollaborators</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_email</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ-ã‚¢ã‚¤ãƒ†ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>scalar_box.auditset_folder_file_mapping</td>
<td>AuditSetItem</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_set_id</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>scalar_box.user</td>
<td>User</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_email</td>
</tr>
<tr>
<td>ãƒ­ãƒ¼ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>scalar_box.role_user</td>
<td>RoleUser</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: role_name</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>scalar_box.audit_group</td>
<td>AuditGroup</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_group_id</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>scalar_box.user_audit_group</td>
<td>UserAuditGroup</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_email</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—-ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>scalar_box.audit_grp_audit_set_mapping</td>
<td>AuditGrpAuditSetMapping</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_group_id</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>scalar_box.item_status</td>
<td>ItemStatus</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: item_id</td>
</tr>
<tr>
<td>SHA1åˆ¥ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>scalar_box.items_by_sha1</td>
<td>ItemsBySha1</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: sha1_hash</td>
</tr>
<tr>
<td>ç›£æŸ»äººãƒ­ã‚°</td>
<td>scalar_box.auditor_logs</td>
<td>AuditorLogs</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_set_id</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ä½ç½®</td>
<td>scalar_box.position_tracker</td>
<td>PositionTracker</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_id</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>scalar_box.user_token</td>
<td>UserToken</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_email</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼OTP</td>
<td>scalar_box.user_otp</td>
<td>UserOtp</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: user_email</td>
</tr>
<tr>
<td>çµ„ç¹”</td>
<td>scalar_box.organization</td>
<td>Organization</td>
<td>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: org_id</td>
</tr>
</tbody>
</table>
<h2 id="_9">æœªãƒãƒƒãƒ”ãƒ³ã‚°é …ç›®<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<h3 id="_10">è¨­è¨ˆæ›¸ã«ã‚ã‚‹ãŒã‚³ãƒ¼ãƒ‰ã«ãªã„<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¦‚å¿µ</th>
<th>è¨­è¨ˆæ›¸ã§ã®è¨˜è¼‰ç®‡æ‰€</th>
<th>è€ƒãˆã‚‰ã‚Œã‚‹ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>ITEM_CREATE ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>Scalar-Auditor-For-BOX-HL-Design.md</td>
<td>EventType enumã«æœªå®Ÿè£…ï¼ˆBOX APIã‹ã‚‰å–å¾—å¯èƒ½ã ãŒå‡¦ç†å¯¾è±¡å¤–ï¼‰</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã®è¨­å®šå¯èƒ½åŒ–</td>
<td>Scalar-Auditor-For-BOX-HL-Design.md</td>
<td>Release 1.0ã§ã¯æœªå®Ÿè£…ã¨æ˜è¨˜</td>
</tr>
<tr>
<td>æ¤œè¨¼æ™‚é–“ã®æœ€é©åŒ–</td>
<td>features.md</td>
<td>V3.0ã§äºˆå®šã¨æ˜è¨˜</td>
</tr>
</tbody>
</table>
<h3 id="_11">ã‚³ãƒ¼ãƒ‰ã«ã‚ã‚‹ãŒè¨­è¨ˆæ›¸ã«ãªã„<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¯ãƒ©ã‚¹/é–¢æ•°</th>
<th>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</th>
<th>æ¨æ¸¬ã•ã‚Œã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>SystemEventDates</td>
<td>model/SystemEventDates.java</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆæ—¥ä»˜ç®¡ç†ï¼ˆå†…éƒ¨ç®¡ç†ç”¨ï¼‰</td>
</tr>
<tr>
<td>EnterpriseEventLogs</td>
<td>model/EnterpriseEventLogs.java</td>
<td>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼ˆæ‹¡å¼µæ©Ÿèƒ½ï¼‰</td>
</tr>
<tr>
<td>LanguageSupported</td>
<td>constant/LanguageSupported.java</td>
<td>å›½éš›åŒ–ã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>ErrorLogMessages</td>
<td>constant/ErrorLogMessages.java</td>
<td>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®šæ•°</td>
</tr>
<tr>
<td>Constants</td>
<td>constant/Constants.java</td>
<td>ã‚·ã‚¹ãƒ†ãƒ å®šæ•°</td>
</tr>
<tr>
<td>GenericUtility</td>
<td>utility/GenericUtility.java</td>
<td>æ±ç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</td>
</tr>
<tr>
<td>Translator</td>
<td>utility/Translator.java</td>
<td>ç¿»è¨³ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£</td>
</tr>
</tbody>
</table>
<h2 id="_12">å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³æ¦‚è¦<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<h3 id="_13">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Lombok @Builder</td>
<td>å…¨Model</td>
<td>ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã«ã‚ˆã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ</td>
</tr>
<tr>
<td>@RestController</td>
<td>å…¨Controller</td>
<td>REST APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>@Service</td>
<td>å…¨Service</td>
<td>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚³ãƒ³ãƒ†ãƒŠ</td>
</tr>
<tr>
<td>Repository Pattern</td>
<td>å…¨Repository</td>
<td>ScalarDBã‚¢ã‚¯ã‚»ã‚¹å±¤</td>
</tr>
<tr>
<td>DTO Pattern</td>
<td>dto/, responsedto/</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ‡ãƒ¼ã‚¿è»¢é€</td>
</tr>
<tr>
<td>JWT Authentication</td>
<td>security/</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼</td>
</tr>
</tbody>
</table>
<h3 id="_14">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>React Functional Component</td>
<td>å…¨pages/</td>
<td>é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
<tr>
<td>Redux Toolkit</td>
<td>redux/</td>
<td>çŠ¶æ…‹ç®¡ç†</td>
</tr>
<tr>
<td>Custom Hooks</td>
<td>hooks/</td>
<td>ãƒ­ã‚¸ãƒƒã‚¯å†åˆ©ç”¨</td>
</tr>
<tr>
<td>i18next</td>
<td>i18n/</td>
<td>å›½éš›åŒ–</td>
</tr>
<tr>
<td>Material UI</td>
<td>å…¨UI</td>
<td>UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒª</td>
</tr>
<tr>
<td>Axios</td>
<td>api/</td>
<td>HTTPé€šä¿¡</td>
</tr>
</tbody>
</table>
</article>
<article id="analysis-api-endpoints">
<h1 id="api">API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆä¸€è¦§<a class="headerlink" href="#api" title="Permanent link">&para;</a></h1>
<h2 id="1-api">1. èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ API<a class="headerlink" href="#1-api" title="Permanent link">&para;</a></h2>
<h3 id="usercontroller">UserController<a class="headerlink" href="#usercontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/users/login</td>
<td>ãƒ­ã‚°ã‚¤ãƒ³</td>
</tr>
<tr>
<td>POST</td>
<td>/api/users/register</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²</td>
</tr>
<tr>
<td>POST</td>
<td>/api/users/refresh-token</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°</td>
</tr>
<tr>
<td>GET</td>
<td>/api/users/managed</td>
<td>ç®¡ç†å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/users/{email}</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/users/role</td>
<td>ãƒ­ãƒ¼ãƒ«æ›´æ–°</td>
</tr>
<tr>
<td>GET</td>
<td>/api/users/external-auditors</td>
<td>å¤–éƒ¨ç›£æŸ»äººä¸€è¦§</td>
</tr>
<tr>
<td>POST</td>
<td>/api/users/forgot-password</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆè¦æ±‚</td>
</tr>
<tr>
<td>POST</td>
<td>/api/users/reset-password</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆå®Ÿè¡Œ</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/users/edit</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/users/language</td>
<td>è¨€èªè¨­å®šæ›´æ–°</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-api">2. ç›£æŸ»ã‚»ãƒƒãƒˆ API<a class="headerlink" href="#2-api" title="Permanent link">&para;</a></h2>
<h3 id="auditsetcontroller">AuditSetController<a class="headerlink" href="#auditsetcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/audit-sets</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ</td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/audit-sets/{id}</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-sets/my</td>
<td>è‡ªåˆ†ã®ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-sets/{id}/ext-auditor-logs</td>
<td>å¤–éƒ¨ç›£æŸ»äººãƒ­ã‚°è¡¨ç¤º</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/audit-sets/{id}/info</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæƒ…å ±æ›´æ–°</td>
</tr>
<tr>
<td>POST</td>
<td>/api/audit-sets/{id}/verify</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ¤œè¨¼</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-sets/item/{itemId}</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã®ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/audit-sets/item/{itemId}</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã®ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–°</td>
</tr>
</tbody>
</table>
<h3 id="auditsetitemcontroller">AuditSetItemController<a class="headerlink" href="#auditsetitemcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/audit-set-items</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ </td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/audit-set-items/{auditSetId}/{itemId}</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-set-items/{auditSetId}</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/audit-set-items/visibility</td>
<td>è¡¨ç¤ºè¨­å®šæ›´æ–°</td>
</tr>
</tbody>
</table>
<h3 id="auditsetcollaboratorcontroller">AuditSetCollaboratorController<a class="headerlink" href="#auditsetcollaboratorcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/audit-set-collaborators</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼è¿½åŠ </td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/audit-set-collaborators/{auditSetId}/{email}</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼å‰Šé™¤</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-set-collaborators/{auditSetId}</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/audit-set-collaborators</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼æ›´æ–°</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-api">3. ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ— API<a class="headerlink" href="#3-api" title="Permanent link">&para;</a></h2>
<h3 id="auditgroupcontroller">AuditGroupController<a class="headerlink" href="#auditgroupcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST</td>
<td>/api/audit-groups</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ</td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/audit-groups/{id}</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-groups</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§</td>
</tr>
<tr>
<td>GET</td>
<td>/api/audit-groups/{id}</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—è©³ç´°</td>
</tr>
<tr>
<td>PUT</td>
<td>/api/audit-groups/{id}</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°</td>
</tr>
<tr>
<td>POST</td>
<td>/api/audit-groups/{id}/members</td>
<td>ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ </td>
</tr>
<tr>
<td>DELETE</td>
<td>/api/audit-groups/{id}/members/{email}</td>
<td>ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-api">4. ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚° API<a class="headerlink" href="#4-api" title="Permanent link">&para;</a></h2>
<h3 id="eventlogcontroller">EventLogController<a class="headerlink" href="#eventlogcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/api/events</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼ˆæ—¥ä»˜ç¯„å›²ï¼‰</td>
</tr>
<tr>
<td>GET</td>
<td>/api/events/user/{userId}</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>GET</td>
<td>/api/events/type/{eventType}</td>
<td>ã‚¿ã‚¤ãƒ—åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>GET</td>
<td>/api/events/file/{fileId}</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>GET</td>
<td>/api/events/user/{userId}/type/{eventType}</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‹ã‚¿ã‚¤ãƒ—åˆ¥</td>
</tr>
</tbody>
</table>
<p><strong>ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:</strong>
- <code>startDate</code>: é–‹å§‹æ—¥æ™‚
- <code>endDate</code>: çµ‚äº†æ—¥æ™‚</p>
<hr />
<h2 id="5-api">5. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ API<a class="headerlink" href="#5-api" title="Permanent link">&para;</a></h2>
<h3 id="filecontroller">FileController<a class="headerlink" href="#filecontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/api/files/{id}</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°</td>
</tr>
<tr>
<td>GET</td>
<td>/api/files/{id}/copies</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ”ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>GET</td>
<td>/api/files/{id}/versions</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§</td>
</tr>
<tr>
<td>GET</td>
<td>/api/files/{id}/collaborators</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>POST</td>
<td>/api/files/{id}/verify</td>
<td>æ”¹ã–ã‚“æ¤œè¨¼</td>
</tr>
<tr>
<td>GET</td>
<td>/api/files/{id}/download</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</td>
</tr>
<tr>
<td>GET</td>
<td>/api/files/{id}/preview</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</td>
</tr>
</tbody>
</table>
<h3 id="foldercontroller">FolderController<a class="headerlink" href="#foldercontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/api/folders/{id}</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€è©³ç´°</td>
</tr>
<tr>
<td>GET</td>
<td>/api/folders/{id}/items</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€å†…ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</td>
</tr>
<tr>
<td>GET</td>
<td>/api/folders/{id}/collaborators</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ä¸€è¦§</td>
</tr>
</tbody>
</table>
<h3 id="itemcontroller">ItemController<a class="headerlink" href="#itemcontroller" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/api/items/{id}/status</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
</tr>
<tr>
<td>GET</td>
<td>/api/items/by-sha1/{sha1}</td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥æ¤œç´¢</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. èªè¨¼ãƒ˜ãƒƒãƒ€ãƒ¼<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<p>ã™ã¹ã¦ã®APIï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä»¥å¤–ï¼‰ã§ä»¥ä¸‹ã®ãƒ˜ãƒƒãƒ€ãƒ¼ãŒå¿…è¦:</p>
<pre class="codehilite"><code>Authorization: Bearer &lt;JWT_TOKEN&gt;
</code></pre>

<hr />
<h2 id="7">7. å…±é€šãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="_1">æˆåŠŸæ™‚<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;status&quot;: &quot;success&quot;,
  &quot;data&quot;: { ... },
  &quot;message&quot;: &quot;Operation completed successfully&quot;
}
</code></pre>

<h3 id="_2">ã‚¨ãƒ©ãƒ¼æ™‚<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;status&quot;: &quot;error&quot;,
  &quot;error&quot;: {
    &quot;code&quot;: &quot;ERROR_CODE&quot;,
    &quot;message&quot;: &quot;Error description&quot;
  }
}
</code></pre>
</article>
</section>
<section id="evaluation">
<h1>MMIè©•ä¾¡</h1>
<article id="evaluation-mmi-overview">
<h1 id="mmi">MMIè©•ä¾¡æ¦‚è¦<a class="headerlink" href="#mmi" title="Permanent link">&para;</a></h1>
<h2 id="_1">è©•ä¾¡å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ <a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p><strong>Scalar Auditor for BOX</strong> - BOXçµ±åˆãƒ•ã‚¡ã‚¤ãƒ«ç›£æŸ»ãƒ„ãƒ¼ãƒ«</p>
<h2 id="mmimodularity-maturity-index">MMIï¼ˆModularity Maturity Indexï¼‰ã¨ã¯<a class="headerlink" href="#mmimodularity-maturity-index" title="Permanent link">&para;</a></h2>
<p>MMIã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–æˆç†Ÿåº¦ã‚’4è»¸ã§è©•ä¾¡ã™ã‚‹æŒ‡æ¨™ã§ã™ã€‚</p>
<h3 id="_2">è©•ä¾¡è»¸ã¨é‡ã¿<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>é‡ã¿</th>
<th>è©•ä¾¡å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesionï¼ˆå‡é›†åº¦ï¼‰</td>
<td>30%</td>
<td>å˜ä¸€è²¬ä»»åŸå‰‡ã®éµå®ˆåº¦ã€æ©Ÿèƒ½ã®é›†ä¸­åº¦</td>
</tr>
<tr>
<td>Couplingï¼ˆçµåˆåº¦ï¼‰</td>
<td>30%</td>
<td>ç–çµåˆåº¦ã€å¾ªç’°ä¾å­˜ã®æœ‰ç„¡</td>
</tr>
<tr>
<td>Independenceï¼ˆç‹¬ç«‹æ€§ï¼‰</td>
<td>20%</td>
<td>ãƒ‡ãƒ—ãƒ­ã‚¤ç‹¬ç«‹æ€§ã€ä»–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¸ã®å½±éŸ¿åº¦</td>
</tr>
<tr>
<td>Reusabilityï¼ˆå†åˆ©ç”¨æ€§ï¼‰</td>
<td>20%</td>
<td>ä»–ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã®é©ç”¨å¯èƒ½æ€§</td>
</tr>
</tbody>
</table>
<h3 id="_3">æˆç†Ÿåº¦ãƒ¬ãƒ™ãƒ«<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¹ã‚³ã‚¢ç¯„å›²</th>
<th>ãƒ¬ãƒ™ãƒ«</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>80-100</td>
<td>é«˜æˆç†Ÿåº¦</td>
<td>ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã«é©ã—ãŸçŠ¶æ…‹</td>
</tr>
<tr>
<td>60-80</td>
<td>ä¸­æˆç†Ÿåº¦</td>
<td>è»½å¾®ãªæ”¹å–„ã§ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–å¯èƒ½</td>
</tr>
<tr>
<td>40-60</td>
<td>ä½ä¸­æˆç†Ÿåº¦</td>
<td>ä¸­ç¨‹åº¦ã®ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦</td>
</tr>
<tr>
<td>0-40</td>
<td>æœªæˆç†Ÿ</td>
<td>å¤§è¦æ¨¡ãªãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå¿…è¦</td>
</tr>
</tbody>
</table>
<h2 id="mmi_1">ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã®MMIã‚¹ã‚³ã‚¢<a class="headerlink" href="#mmi_1" title="Permanent link">&para;</a></h2>
<h3 id="523-100">ç·åˆã‚¹ã‚³ã‚¢: 52.3 / 100ï¼ˆä½ä¸­æˆç†Ÿåº¦ï¼‰<a class="headerlink" href="#523-100" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MMI Total Score                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  52.3%       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre>

<h3 id="_4">è»¸åˆ¥ã‚¹ã‚³ã‚¢<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>é‡ã¿ä»˜ãã‚¹ã‚³ã‚¢</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>45/100</td>
<td>13.5</td>
</tr>
<tr>
<td>Coupling</td>
<td>50/100</td>
<td>15.0</td>
</tr>
<tr>
<td>Independence</td>
<td>55/100</td>
<td>11.0</td>
</tr>
<tr>
<td>Reusability</td>
<td>64/100</td>
<td>12.8</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td>-</td>
<td><strong>52.3</strong></td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code>Cohesion      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  45%
Coupling      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%
Independence  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  55%
Reusability   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  64%
</code></pre>

<h2 id="_5">ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ¥ã‚¹ã‚³ã‚¢ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</th>
<th>Cohesion</th>
<th>Coupling</th>
<th>Independence</th>
<th>Reusability</th>
<th>MMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserService</td>
<td>25</td>
<td>30</td>
<td>40</td>
<td>45</td>
<td>34.0</td>
</tr>
<tr>
<td>AuditSetService</td>
<td>40</td>
<td>45</td>
<td>50</td>
<td>55</td>
<td>46.5</td>
</tr>
<tr>
<td>AuditSetItemService</td>
<td>35</td>
<td>40</td>
<td>45</td>
<td>50</td>
<td>41.5</td>
</tr>
<tr>
<td>AuditGroupService</td>
<td>55</td>
<td>55</td>
<td>60</td>
<td>65</td>
<td>57.5</td>
</tr>
<tr>
<td>FileService</td>
<td>50</td>
<td>50</td>
<td>55</td>
<td>60</td>
<td>52.5</td>
</tr>
<tr>
<td>EventLogService</td>
<td>70</td>
<td>75</td>
<td>70</td>
<td>75</td>
<td>72.5</td>
</tr>
<tr>
<td>AssetService</td>
<td>65</td>
<td>70</td>
<td>65</td>
<td>70</td>
<td>67.5</td>
</tr>
<tr>
<td>CommonService</td>
<td>80</td>
<td>85</td>
<td>75</td>
<td>70</td>
<td>78.5</td>
</tr>
<tr>
<td>FolderService</td>
<td>60</td>
<td>65</td>
<td>60</td>
<td>65</td>
<td>62.5</td>
</tr>
<tr>
<td>AuditSetCollaboratorService</td>
<td>55</td>
<td>60</td>
<td>55</td>
<td>60</td>
<td>57.5</td>
</tr>
</tbody>
</table>
<h3 id="_7">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</th>
<th>Cohesion</th>
<th>Coupling</th>
<th>Independence</th>
<th>Reusability</th>
<th>MMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>pages/auth</td>
<td>60</td>
<td>55</td>
<td>60</td>
<td>55</td>
<td>57.5</td>
</tr>
<tr>
<td>pages/AuditSet</td>
<td>45</td>
<td>50</td>
<td>50</td>
<td>45</td>
<td>47.5</td>
</tr>
<tr>
<td>pages/AuditorsAndGroups</td>
<td>50</td>
<td>55</td>
<td>55</td>
<td>50</td>
<td>52.5</td>
</tr>
<tr>
<td>pages/ExternalAuditorPage</td>
<td>45</td>
<td>50</td>
<td>50</td>
<td>45</td>
<td>47.5</td>
</tr>
<tr>
<td>pages/ViewAllEventHistory</td>
<td>55</td>
<td>60</td>
<td>60</td>
<td>55</td>
<td>57.5</td>
</tr>
<tr>
<td>redux</td>
<td>65</td>
<td>60</td>
<td>55</td>
<td>60</td>
<td>60.0</td>
</tr>
</tbody>
</table>
<h2 id="_8">ä¸»è¦ãªå•é¡Œç‚¹<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="1-god-class">1. God Classå•é¡Œï¼ˆæ·±åˆ»åº¦: é«˜ï¼‰<a class="headerlink" href="#1-god-class" title="Permanent link">&para;</a></h3>
<p><strong>UserService</strong> ãŒ1118è¡Œã€20ä»¥ä¸Šã®ä¾å­˜ã‚’æŒã¤å·¨å¤§ã‚¯ãƒ©ã‚¹</p>
<pre class="codehilite"><code>è²¬å‹™ã®æ··åœ¨:
â”œâ”€â”€ èªè¨¼ãƒ»èªå¯
â”œâ”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼CRUD
â”œâ”€â”€ ãƒ­ãƒ¼ãƒ«ç®¡ç†
â”œâ”€â”€ ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
â”œâ”€â”€ ãƒ¡ãƒ¼ãƒ«é€ä¿¡
â”œâ”€â”€ BOXé€£æº
â””â”€â”€ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
</code></pre>

<h3 id="2">2. ã‚µãƒ¼ãƒ“ã‚¹é–“å¯†çµåˆï¼ˆæ·±åˆ»åº¦: ä¸­ï¼‰<a class="headerlink" href="#2" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>ä¾å­˜é–¢ä¿‚:
AuditSetItemService â”€â”€â†’ AuditSetService
FileService â”€â”€â†’ UserService
AuditSetService â”€â”€â†’ CommonService
</code></pre>

<h3 id="3">3. å¤§è¦æ¨¡ã‚µãƒ¼ãƒ“ã‚¹ã‚¯ãƒ©ã‚¹ï¼ˆæ·±åˆ»åº¦: ä¸­ï¼‰<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¯ãƒ©ã‚¹</th>
<th>è¡Œæ•°</th>
<th>å•é¡Œç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserService</td>
<td>1118</td>
<td>è²¬å‹™éå¤šã€åˆ†å‰²å¿…è¦</td>
</tr>
<tr>
<td>AuditSetItemService</td>
<td>902</td>
<td>ã‚„ã‚„å¤§ãã„</td>
</tr>
<tr>
<td>AuditSetService</td>
<td>845</td>
<td>ã‚„ã‚„å¤§ãã„</td>
</tr>
</tbody>
</table>
<h3 id="4">4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®çŠ¶æ…‹ç®¡ç†ï¼ˆæ·±åˆ»åº¦: ä½ï¼‰<a class="headerlink" href="#4" title="Permanent link">&para;</a></h3>
<ul>
<li>ä¸€éƒ¨ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ­ãƒ¼ã‚«ãƒ«çŠ¶æ…‹ã¨ReduxçŠ¶æ…‹ãŒæ··åœ¨</li>
<li>ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¤§ãã™ãã‚‹ï¼ˆAuditSet: 1000è¡Œè¶…ï¼‰</li>
</ul>
<h2 id="_9">æ”¹å–„ã®å„ªå…ˆé †ä½<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>å„ªå…ˆåº¦</th>
<th>å¯¾è±¡</th>
<th>æ”¹å–„å†…å®¹</th>
<th>æœŸå¾…åŠ¹æœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>UserService</td>
<td>è²¬å‹™åˆ†å‰²ï¼ˆ5-6ã‚µãƒ¼ãƒ“ã‚¹ã¸ï¼‰</td>
<td>Cohesion +30, Coupling +25</td>
</tr>
<tr>
<td>2</td>
<td>AuditSetItemService</td>
<td>AssetServiceã¨ã®çµ±åˆæ¤œè¨</td>
<td>Coupling +15</td>
</tr>
<tr>
<td>3</td>
<td>FileService</td>
<td>UserServiceä¾å­˜ã®å‰Šé™¤</td>
<td>Independence +20</td>
</tr>
<tr>
<td>4</td>
<td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰</td>
<td>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²</td>
<td>Reusability +15</td>
</tr>
</tbody>
</table>
<h2 id="_10">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Phase 3: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°</strong> - å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ç‰¹å®š</li>
<li><strong>Phase 4: ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ</strong> - ã‚µãƒ¼ãƒ“ã‚¹å¢ƒç•Œã®æ±ºå®š</li>
<li><strong>Phase 5: ScalarDBè¨­è¨ˆ</strong> - ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ€é©åŒ–</li>
</ol>
</article>
<article id="evaluation-mmi-by-module">
<h1 id="mmi">MMI ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ¥è©³ç´°è©•ä¾¡<a class="headerlink" href="#mmi" title="Permanent link">&para;</a></h1>
<h2 id="_1">è©•ä¾¡æ–¹æ³•<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’4è»¸ï¼ˆCohesion, Coupling, Independence, Reusabilityï¼‰ã§è©•ä¾¡ã—ã€
é‡ã¿ä»˜ã‘ï¼ˆ30%, 30%, 20%, 20%ï¼‰ã§MMIã‚¹ã‚³ã‚¢ã‚’ç®—å‡ºã—ã¾ã™ã€‚</p>
<hr />
<h2 id="_2">ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹è©³ç´°<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="1-userservice-mmi-340-">1. UserService (MMI: 34.0 - æœªæˆç†Ÿ)<a class="headerlink" href="#1-userservice-mmi-340-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/UserService.java</code>
<strong>è¡Œæ•°</strong>: 1,118è¡Œ
<strong>ä¾å­˜æ•°</strong>: 20+</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>25/100</td>
<td>6ä»¥ä¸Šã®è²¬å‹™ãŒæ··åœ¨ï¼ˆèªè¨¼ã€CRUDã€ãƒ­ãƒ¼ãƒ«ã€ãƒˆãƒ¼ã‚¯ãƒ³ã€ãƒ¡ãƒ¼ãƒ«ã€BOXé€£æºï¼‰</td>
</tr>
<tr>
<td>Coupling</td>
<td>30/100</td>
<td>å¤šæ•°ã®ãƒªãƒã‚¸ãƒˆãƒªãƒ»ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã«ä¾å­˜ã€å¾ªç’°ä¾å­˜ãƒªã‚¹ã‚¯</td>
</tr>
<tr>
<td>Independence</td>
<td>40/100</td>
<td>ä»–ã‚µãƒ¼ãƒ“ã‚¹ã‹ã‚‰ã®ä¾å­˜ãŒå¤šãã€å˜ç‹¬ãƒ‡ãƒ—ãƒ­ã‚¤å›°é›£</td>
</tr>
<tr>
<td>Reusability</td>
<td>45/100</td>
<td>æ±ç”¨ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰ãŒæ··åœ¨</td>
</tr>
</tbody>
</table>
<p><strong>è²¬å‹™åˆ†æ</strong>:</p>
<pre class="codehilite"><code>UserService (God Class)
â”œâ”€â”€ èªè¨¼é–¢é€£
â”‚   â”œâ”€â”€ login()
â”‚   â”œâ”€â”€ verifyPassword()
â”‚   â””â”€â”€ handleOAuth()
â”œâ”€â”€ ãƒ¦ãƒ¼ã‚¶ãƒ¼CRUD
â”‚   â”œâ”€â”€ createUser()
â”‚   â”œâ”€â”€ updateUser()
â”‚   â””â”€â”€ deleteUser()
â”œâ”€â”€ ãƒ­ãƒ¼ãƒ«ç®¡ç†
â”‚   â”œâ”€â”€ assignRole()
â”‚   â”œâ”€â”€ removeRole()
â”‚   â””â”€â”€ getRoles()
â”œâ”€â”€ ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
â”‚   â”œâ”€â”€ generateToken()
â”‚   â”œâ”€â”€ refreshToken()
â”‚   â””â”€â”€ revokeToken()
â”œâ”€â”€ ãƒ¡ãƒ¼ãƒ«é€ä¿¡
â”‚   â”œâ”€â”€ sendOTP()
â”‚   â””â”€â”€ sendWelcomeEmail()
â””â”€â”€ BOXé€£æº
    â”œâ”€â”€ syncBoxUser()
    â””â”€â”€ getBoxToken()
</code></pre>

<p><strong>æ¨å¥¨åˆ†å‰²</strong>:
1. <code>AuthenticationService</code> - èªè¨¼ãƒ»èªå¯
2. <code>UserManagementService</code> - ãƒ¦ãƒ¼ã‚¶ãƒ¼CRUD
3. <code>RoleService</code> - ãƒ­ãƒ¼ãƒ«ç®¡ç†
4. <code>TokenService</code> - ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†
5. <code>NotificationService</code> - ãƒ¡ãƒ¼ãƒ«é€ä¿¡
6. <code>BoxIntegrationService</code> - BOXé€£æº</p>
<hr />
<h3 id="2-auditsetservice-mmi-465-">2. AuditSetService (MMI: 46.5 - ä½ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#2-auditsetservice-mmi-465-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/AuditSetService.java</code>
<strong>è¡Œæ•°</strong>: 845è¡Œ
<strong>ä¾å­˜æ•°</strong>: 12</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>40/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†ã«é›†ä¸­ã—ã¦ã„ã‚‹ãŒã€ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ã‚‚å«ã‚€</td>
</tr>
<tr>
<td>Coupling</td>
<td>45/100</td>
<td>CommonServiceã€è¤‡æ•°ãƒªãƒã‚¸ãƒˆãƒªã«ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>50/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã—ã¦ç‹¬ç«‹å¯èƒ½ã ãŒä¾å­˜å¤šã„</td>
</tr>
<tr>
<td>Reusability</td>
<td>55/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ“ä½œã¯å†åˆ©ç”¨å¯èƒ½</td>
</tr>
</tbody>
</table>
<p><strong>è²¬å‹™åˆ†æ</strong>:</p>
<pre class="codehilite"><code>AuditSetService
â”œâ”€â”€ ç›£æŸ»ã‚»ãƒƒãƒˆCRUD
â”‚   â”œâ”€â”€ createAuditSet()
â”‚   â”œâ”€â”€ updateAuditSet()
â”‚   â””â”€â”€ deleteAuditSet()
â”œâ”€â”€ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ï¼ˆåˆ†é›¢å€™è£œï¼‰
â”‚   â”œâ”€â”€ addCollaborator()
â”‚   â””â”€â”€ removeCollaborator()
â””â”€â”€ æ‰€æœ‰è€…å¤‰æ›´
    â””â”€â”€ changeOwner()
</code></pre>

<hr />
<h3 id="3-auditsetitemservice-mmi-415-">3. AuditSetItemService (MMI: 41.5 - ä½ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#3-auditsetitemservice-mmi-415-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/AuditSetItemService.java</code>
<strong>è¡Œæ•°</strong>: 902è¡Œ
<strong>ä¾å­˜æ•°</strong>: 15</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>35/100</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†ã¨BOXé€£æºãŒæ··åœ¨</td>
</tr>
<tr>
<td>Coupling</td>
<td>40/100</td>
<td>AuditSetServiceã€AssetServiceã«å¼·ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>45/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚µãƒ¼ãƒ“ã‚¹ãªã—ã§ã¯å‹•ä½œä¸å¯</td>
</tr>
<tr>
<td>Reusability</td>
<td>50/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ å›ºæœ‰ã®ãƒ­ã‚¸ãƒƒã‚¯</td>
</tr>
</tbody>
</table>
<p><strong>å•é¡Œç‚¹</strong>:
- AuditSetServiceã¸ã®ç›´æ¥å‚ç…§
- BOX APIå‘¼ã³å‡ºã—ã¨ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ··åœ¨
- ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¢ƒç•ŒãŒä¸æ˜ç¢º</p>
<hr />
<h3 id="4-auditgroupservice-mmi-575-">4. AuditGroupService (MMI: 57.5 - ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#4-auditgroupservice-mmi-575-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/AuditGroupService.java</code>
<strong>è¡Œæ•°</strong>: 420è¡Œ
<strong>ä¾å­˜æ•°</strong>: 7</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>55/100</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã«é›†ä¸­</td>
</tr>
<tr>
<td>Coupling</td>
<td>55/100</td>
<td>é©åº¦ãªä¾å­˜é–¢ä¿‚</td>
</tr>
<tr>
<td>Independence</td>
<td>60/100</td>
<td>æ¯”è¼ƒçš„ç‹¬ç«‹ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>65/100</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ãƒ­ã‚¸ãƒƒã‚¯ã¯æ±ç”¨çš„</td>
</tr>
</tbody>
</table>
<p><strong>è‰¯ã„ç‚¹</strong>:
- å˜ä¸€è²¬ä»»ã«è¿‘ã„è¨­è¨ˆ
- ä¾å­˜é–¢ä¿‚ãŒé™å®šçš„
- ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ãŒé«˜ã„</p>
<hr />
<h3 id="5-fileservice-mmi-525-">5. FileService (MMI: 52.5 - ä½ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#5-fileservice-mmi-525-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/FileService.java</code>
<strong>è¡Œæ•°</strong>: 580è¡Œ
<strong>ä¾å­˜æ•°</strong>: 10</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>50/100</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã«é›†ä¸­ã ãŒUserServiceä¾å­˜</td>
</tr>
<tr>
<td>Coupling</td>
<td>50/100</td>
<td>UserServiceã¸ã®ä¸å¿…è¦ãªä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>55/100</td>
<td>UserServiceåˆ†é›¢å¾Œã¯ç‹¬ç«‹å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>60/100</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã¯æ±ç”¨çš„</td>
</tr>
</tbody>
</table>
<p><strong>å•é¡Œç‚¹</strong>:
- <code>UserService</code>ã¸ã®ä¾å­˜ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ã®ãŸã‚ï¼‰
- BOX APIã¨ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ãŒç›´æ¥åŸ‹ã‚è¾¼ã¿</p>
<hr />
<h3 id="6-eventlogservice-mmi-725-">6. EventLogService (MMI: 72.5 - ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#6-eventlogservice-mmi-725-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/EventLogService.java</code>
<strong>è¡Œæ•°</strong>: 350è¡Œ
<strong>ä¾å­˜æ•°</strong>: 5</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>70/100</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†ã«ç‰¹åŒ–</td>
</tr>
<tr>
<td>Coupling</td>
<td>75/100</td>
<td>ãƒªãƒã‚¸ãƒˆãƒªã®ã¿ã«ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>70/100</td>
<td>ç‹¬ç«‹ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>75/100</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ã¯ä»–ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§ã‚‚åˆ©ç”¨å¯èƒ½</td>
</tr>
</tbody>
</table>
<p><strong>è‰¯ã„ç‚¹</strong>:
- æ˜ç¢ºãªå˜ä¸€è²¬ä»»
- ä½ã„å¤–éƒ¨ä¾å­˜
- ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã®å€™è£œ</p>
<hr />
<h3 id="7-assetservice-mmi-675-">7. AssetService (MMI: 67.5 - ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#7-assetservice-mmi-675-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/AssetService.java</code>
<strong>è¡Œæ•°</strong>: 480è¡Œ
<strong>ä¾å­˜æ•°</strong>: 6</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>65/100</td>
<td>ScalarDLé€£æºã«ç‰¹åŒ–</td>
</tr>
<tr>
<td>Coupling</td>
<td>70/100</td>
<td>ScalarDLãƒªãƒã‚¸ãƒˆãƒªã®ã¿ã«ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>65/100</td>
<td>ScalarDLä¾å­˜ã ãŒåˆ†é›¢å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>70/100</td>
<td>æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯ã¯æ±ç”¨çš„</td>
</tr>
</tbody>
</table>
<p><strong>è‰¯ã„ç‚¹</strong>:
- æ”¹ã–ã‚“æ¤œçŸ¥ã¨ã„ã†æ˜ç¢ºãªè²¬å‹™
- å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æºãŒé©åˆ‡ã«ã‚«ãƒ—ã‚»ãƒ«åŒ–</p>
<hr />
<h3 id="8-commonservice-mmi-785-">8. CommonService (MMI: 78.5 - é«˜æˆç†Ÿåº¦)<a class="headerlink" href="#8-commonservice-mmi-785-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/CommonService.java</code>
<strong>è¡Œæ•°</strong>: 280è¡Œ
<strong>ä¾å­˜æ•°</strong>: 3</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>80/100</td>
<td>å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£æ©Ÿèƒ½ã«ç‰¹åŒ–</td>
</tr>
<tr>
<td>Coupling</td>
<td>85/100</td>
<td>æœ€å°é™ã®ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>75/100</td>
<td>ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã¨ã—ã¦ç‹¬ç«‹</td>
</tr>
<tr>
<td>Reusability</td>
<td>70/100</td>
<td>è¤‡æ•°ã‚µãƒ¼ãƒ“ã‚¹ã§å†åˆ©ç”¨å¯èƒ½</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„ç‚¹</strong>:
- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã¨ã—ã¦é©åˆ‡ã ãŒã€ã‚µãƒ¼ãƒ“ã‚¹å±¤ã«ã‚ã‚‹ã¹ãã‹æ¤œè¨</p>
<hr />
<h3 id="9-folderservice-mmi-625-">9. FolderService (MMI: 62.5 - ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#9-folderservice-mmi-625-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/FolderService.java</code>
<strong>è¡Œæ•°</strong>: 420è¡Œ
<strong>ä¾å­˜æ•°</strong>: 8</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>60/100</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€æ“ä½œã«é›†ä¸­</td>
</tr>
<tr>
<td>Coupling</td>
<td>65/100</td>
<td>FileServiceã¨é¡ä¼¼ã®ä¾å­˜ãƒ‘ã‚¿ãƒ¼ãƒ³</td>
</tr>
<tr>
<td>Independence</td>
<td>60/100</td>
<td>FileServiceã¨çµ±åˆæ¤œè¨å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>65/100</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€æ“ä½œã¯æ±ç”¨çš„</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="10-auditsetcollaboratorservice-mmi-575-">10. AuditSetCollaboratorService (MMI: 57.5 - ä¸­æˆç†Ÿåº¦)<a class="headerlink" href="#10-auditsetcollaboratorservice-mmi-575-" title="Permanent link">&para;</a></h3>
<p><strong>ãƒ•ã‚¡ã‚¤ãƒ«</strong>: <code>service/AuditSetCollaboratorService.java</code>
<strong>è¡Œæ•°</strong>: 380è¡Œ
<strong>ä¾å­˜æ•°</strong>: 7</p>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>55/100</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ã«é›†ä¸­</td>
</tr>
<tr>
<td>Coupling</td>
<td>60/100</td>
<td>AuditSetServiceã¸ã®ä¾å­˜ã‚ã‚Š</td>
</tr>
<tr>
<td>Independence</td>
<td>55/100</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã¨å¯†çµåˆ</td>
</tr>
<tr>
<td>Reusability</td>
<td>60/100</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ã¯æ±ç”¨åŒ–å¯èƒ½</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_3">ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è©³ç´°<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="1-pagesauth-mmi-575">1. pages/auth (MMI: 57.5)<a class="headerlink" href="#1-pagesauth-mmi-575" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>60/100</td>
<td>èªè¨¼ç”»é¢ã«é›†ä¸­</td>
</tr>
<tr>
<td>Coupling</td>
<td>55/100</td>
<td>Redux storeã¨API hookã«ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>60/100</td>
<td>èªè¨¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ã—ã¦ç‹¬ç«‹å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>55/100</td>
<td>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®UI</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="2-pagesauditset-mmi-475">2. pages/AuditSet (MMI: 47.5)<a class="headerlink" href="#2-pagesauditset-mmi-475" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>45/100</td>
<td>1000è¡Œè¶…ã®å¤§è¦æ¨¡ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
<tr>
<td>Coupling</td>
<td>50/100</td>
<td>å¤šæ•°ã®ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ä¾å­˜</td>
</tr>
<tr>
<td>Independence</td>
<td>50/100</td>
<td>åˆ†å‰²å¾Œã¯ç‹¬ç«‹å¯èƒ½</td>
</tr>
<tr>
<td>Reusability</td>
<td>45/100</td>
<td>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰</td>
</tr>
</tbody>
</table>
<p><strong>å•é¡Œç‚¹</strong>:
- ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¤§ãã™ãã‚‹
- çŠ¶æ…‹ç®¡ç†ãŒè¤‡é›‘
- ã‚µãƒ–ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ãŒå¿…è¦</p>
<hr />
<h3 id="3-redux-mmi-600">3. redux (MMI: 60.0)<a class="headerlink" href="#3-redux-mmi-600" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¸</th>
<th>ã‚¹ã‚³ã‚¢</th>
<th>è©•ä¾¡ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>65/100</td>
<td>Sliceå˜ä½ã§é©åˆ‡ã«åˆ†é›¢</td>
</tr>
<tr>
<td>Coupling</td>
<td>60/100</td>
<td>é©åº¦ãªä¾å­˜é–¢ä¿‚</td>
</tr>
<tr>
<td>Independence</td>
<td>55/100</td>
<td>ã‚¢ãƒ—ãƒªå…¨ä½“ã®çŠ¶æ…‹ç®¡ç†</td>
</tr>
<tr>
<td>Reusability</td>
<td>60/100</td>
<td>Sliceãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å†åˆ©ç”¨å¯èƒ½</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_4">ã‚¹ã‚³ã‚¢åˆ†å¸ƒå›³<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<pre class="codehilite"><code>         0    20    40    60    80   100
         |     |     |     |     |     |
UserService          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 34.0 âŒ
AuditSetItemService  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 41.5
AuditSetService      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 46.5
FileService          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 52.5
AuditGroupService    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 57.5
AudSetCollabService  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 57.5
FolderService        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ 62.5
AssetService         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 67.5 âœ“
EventLogService      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 72.5 âœ“
CommonService        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 78.5 âœ“
         |     |     |     |     |     |
         0    20    40    60    80   100

Legend: âŒ è¦ç·Šæ€¥å¯¾å¿œ  âœ“ ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–é©æ ¼
</code></pre>

<h2 id="_5">è©•ä¾¡ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–é©æ ¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>EventLogService</strong> (72.5) - ã‚¤ãƒ™ãƒ³ãƒˆç®¡ç†ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ç‹¬ç«‹å¯èƒ½</li>
<li><strong>AssetService</strong> (67.5) - æ¤œè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã¨ã—ã¦ç‹¬ç«‹å¯èƒ½</li>
<li><strong>CommonService</strong> (78.5) - å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦æä¾›</li>
</ol>
<h3 id="_7">è¦æ”¹å–„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>UserService</strong> (34.0) - 6ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®åˆ†å‰²ãŒå¿…é ˆ</li>
<li><strong>AuditSetItemService</strong> (41.5) - BOXé€£æºã®åˆ†é›¢ãŒå¿…è¦</li>
<li><strong>AuditSetService</strong> (46.5) - ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†ã®åˆ†é›¢</li>
</ol>
<h3 id="_8">çµ±åˆæ¤œè¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>FileService + FolderService â†’ ItemService ã¸ã®çµ±åˆ</li>
<li>AuditSetCollaboratorService â†’ AuditSetService ã¸ã®çµ±åˆã¾ãŸã¯Access Controlã‚µãƒ¼ãƒ“ã‚¹åŒ–</li>
</ul>
</article>
<article id="evaluation-mmi-improvement-plan">
<h1 id="mmi">MMIæ”¹å–„è¨ˆç”»<a class="headerlink" href="#mmi" title="Permanent link">&para;</a></h1>
<h2 id="_1">æ”¹å–„ç›®æ¨™<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>ç¾åœ¨ã®MMIã‚¹ã‚³ã‚¢ <strong>52.3</strong> ã‚’ <strong>70.0ä»¥ä¸Š</strong> ã«å‘ä¸Šã•ã›ã€
ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã«é©ã—ãŸçŠ¶æ…‹ã‚’é”æˆã™ã‚‹ã€‚</p>
<h2 id="_2">æ”¹å–„ãƒ•ã‚§ãƒ¼ã‚º<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-god-class">Phase 1: God Classåˆ†è§£ï¼ˆå„ªå…ˆåº¦: æœ€é«˜ï¼‰<a class="headerlink" href="#phase-1-god-class" title="Permanent link">&para;</a></h3>
<p><strong>å¯¾è±¡</strong>: UserService (MMI: 34.0 â†’ ç›®æ¨™: 65.0)
<strong>æœŸé–“ç›®å®‰</strong>: ä¸­è¦æ¨¡</p>
<h4 id="_3">åˆ†å‰²è¨ˆç”»<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<div class="mermaid">
graph TD
    subgraph "ç¾çŠ¶"
        US[UserService<br/>1118è¡Œ, MMI:34]
    end

    subgraph "åˆ†å‰²å¾Œ"
        AS[AuthService<br/>~200è¡Œ]
        UMS[UserManagementService<br/>~250è¡Œ]
        RS[RoleService<br/>~150è¡Œ]
        TS[TokenService<br/>~180è¡Œ]
        NS[NotificationService<br/>~120è¡Œ]
        BIS[BoxIntegrationService<br/>~220è¡Œ]
    end

    US --> AS
    US --> UMS
    US --> RS
    US --> TS
    US --> NS
    US --> BIS
</div>

<h4 id="_4">å„ã‚µãƒ¼ãƒ“ã‚¹ã®è²¬å‹™<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ–°ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>è²¬å‹™</th>
<th>äºˆæƒ³MMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>AuthService</td>
<td>èªè¨¼ãƒ»èªå¯ã€ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†</td>
<td>70</td>
</tr>
<tr>
<td>UserManagementService</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼CRUD</td>
<td>72</td>
</tr>
<tr>
<td>RoleService</td>
<td>ãƒ­ãƒ¼ãƒ«ç®¡ç†</td>
<td>68</td>
</tr>
<tr>
<td>TokenService</td>
<td>JWT/ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ç®¡ç†</td>
<td>75</td>
</tr>
<tr>
<td>NotificationService</td>
<td>ãƒ¡ãƒ¼ãƒ«ãƒ»é€šçŸ¥</td>
<td>70</td>
</tr>
<tr>
<td>BoxIntegrationService</td>
<td>BOX OAuthé€£æº</td>
<td>65</td>
</tr>
</tbody>
</table>
<h4 id="_5">å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©</strong>
   <code>java
   public interface AuthService {
       AuthResult authenticate(LoginRequest request);
       void logout(String userId);
       boolean validateToken(String token);
   }</code></p>
</li>
<li>
<p><strong>ä¾å­˜é–¢ä¿‚ã®æ•´ç†</strong></p>
</li>
<li>TokenServiceã¯AuthServiceã‹ã‚‰åˆ©ç”¨</li>
<li>BoxIntegrationServiceã¯AuthServiceã‹ã‚‰åˆ©ç”¨</li>
<li>
<p>NotificationServiceã¯ç‹¬ç«‹</p>
</li>
<li>
<p><strong>æ®µéšçš„ç§»è¡Œ</strong></p>
</li>
<li>æ–°ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ</li>
<li>UserServiceã‹ã‚‰ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ç§»å‹•</li>
<li>å‘¼ã³å‡ºã—å…ƒã‚’æ›´æ–°</li>
<li>ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</li>
</ol>
<h4 id="_6">æœŸå¾…åŠ¹æœ<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>æ”¹å–„å‰</th>
<th>æ”¹å–„å¾Œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cohesion</td>
<td>25</td>
<td>70 (+45)</td>
</tr>
<tr>
<td>Coupling</td>
<td>30</td>
<td>60 (+30)</td>
</tr>
<tr>
<td>Independence</td>
<td>40</td>
<td>65 (+25)</td>
</tr>
<tr>
<td>Reusability</td>
<td>45</td>
<td>68 (+23)</td>
</tr>
<tr>
<td><strong>MMI</strong></td>
<td><strong>34.0</strong></td>
<td><strong>65.5</strong></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="phase-2">Phase 2: ã‚µãƒ¼ãƒ“ã‚¹é–“çµåˆã®è§£æ¶ˆï¼ˆå„ªå…ˆåº¦: é«˜ï¼‰<a class="headerlink" href="#phase-2" title="Permanent link">&para;</a></h3>
<p><strong>å¯¾è±¡</strong>: AuditSetItemService, FileService
<strong>æœŸé–“ç›®å®‰</strong>: å°ã€œä¸­è¦æ¨¡</p>
<h4 id="21-box">2.1 BOXé€£æºã®åˆ†é›¢<a class="headerlink" href="#21-box" title="Permanent link">&para;</a></h4>
<div class="mermaid">
graph LR
    subgraph "ç¾çŠ¶"
        ASIS[AuditSetItemService] --> BOX1[BOX APIç›´æ¥å‘¼å‡º]
        FS[FileService] --> BOX2[BOX APIç›´æ¥å‘¼å‡º]
    end

    subgraph "æ”¹å–„å¾Œ"
        ASIS2[AuditSetItemService] --> BAS[BoxAdapterService]
        FS2[FileService] --> BAS
        BAS --> BOX[BOX API]
    end
</div>

<h4 id="22">2.2 ã‚µãƒ¼ãƒ“ã‚¹é–“ä¾å­˜ã®è§£æ¶ˆ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-java">// Before: ç›´æ¥ä¾å­˜
public class FileService {
    @Autowired
    private UserService userService; // å¼·çµåˆ
}

// After: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹çµŒç”±
public class FileService {
    @Autowired
    private UserInfoProvider userInfoProvider; // ç–çµåˆ
}
</code></pre>

<h4 id="_7">æœŸå¾…åŠ¹æœ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>æ”¹å–„å‰MMI</th>
<th>æ”¹å–„å¾ŒMMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>AuditSetItemService</td>
<td>41.5</td>
<td>58.0</td>
</tr>
<tr>
<td>FileService</td>
<td>52.5</td>
<td>65.0</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="phase-3">Phase 3: ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ã®çµ±åˆï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰<a class="headerlink" href="#phase-3" title="Permanent link">&para;</a></h3>
<p><strong>å¯¾è±¡</strong>: FileService, FolderService
<strong>æœŸé–“ç›®å®‰</strong>: å°è¦æ¨¡</p>
<h4 id="_8">çµ±åˆè¨ˆç”»<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<div class="mermaid">
graph TD
    subgraph "ç¾çŠ¶"
        FS[FileService<br/>MMI:52.5]
        FOS[FolderService<br/>MMI:62.5]
    end

    subgraph "çµ±åˆå¾Œ"
        IS[ItemService<br/>ç›®æ¨™MMI:68]
        FH[FileHandler]
        FOH[FolderHandler]
    end

    FS --> IS
    FOS --> IS
    IS --> FH
    IS --> FOH
</div>

<h4 id="_9">è¨­è¨ˆæ–¹é‡<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li>Strategy ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€å‡¦ç†ã‚’æŠ½è±¡åŒ–</li>
<li>å…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ <code>ItemHandler</code> ã‚’å®šç¾©</li>
<li>BOX APIã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã‚’å…±æœ‰</li>
</ul>
<hr />
<h3 id="phase-4">Phase 4: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ”¹å–„ï¼ˆå„ªå…ˆåº¦: ä¸­ï¼‰<a class="headerlink" href="#phase-4" title="Permanent link">&para;</a></h3>
<p><strong>å¯¾è±¡</strong>: pages/AuditSet
<strong>æœŸé–“ç›®å®‰</strong>: å°ã€œä¸­è¦æ¨¡</p>
<h4 id="_10">ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code>AuditSet/ (ç¾çŠ¶: 1000è¡Œè¶…)
â”œâ”€â”€ AuditSetContainer.jsx (çŠ¶æ…‹ç®¡ç†)
â”œâ”€â”€ AuditSetList.jsx (ä¸€è¦§è¡¨ç¤º)
â”œâ”€â”€ AuditSetDetail.jsx (è©³ç´°è¡¨ç¤º)
â”œâ”€â”€ AuditSetForm.jsx (ä½œæˆãƒ»ç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ )
â””â”€â”€ hooks/
    â”œâ”€â”€ useAuditSet.js
    â””â”€â”€ useAuditSetItem.js
</code></pre>

<h4 id="_11">æœŸå¾…åŠ¹æœ<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>æ”¹å–„å‰MMI</th>
<th>æ”¹å–„å¾ŒMMI</th>
</tr>
</thead>
<tbody>
<tr>
<td>pages/AuditSet</td>
<td>47.5</td>
<td>62.0</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_12">æ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<div class="mermaid">
gantt
    title MMIæ”¹å–„ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
    dateFormat  YYYY-MM-DD

    section Phase 1
    UserServiceåˆ†è§£è¨­è¨ˆ      :a1, 2024-01-01, 5d
    AuthServiceå®Ÿè£…          :a2, after a1, 3d
    UserManagementService    :a3, after a2, 3d
    RoleServiceå®Ÿè£…          :a4, after a3, 2d
    TokenServiceå®Ÿè£…         :a5, after a4, 3d
    NotificationService      :a6, after a5, 2d
    BoxIntegrationService    :a7, after a6, 3d

    section Phase 2
    BoxAdapterServiceè¨­è¨ˆ    :b1, after a7, 3d
    ä¾å­˜é–¢ä¿‚ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° :b2, after b1, 5d

    section Phase 3
    ItemServiceçµ±åˆ          :c1, after b2, 4d

    section Phase 4
    FE ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²    :d1, after c1, 5d
</div>

<hr />
<h2 id="mmi_1">MMIã‚¹ã‚³ã‚¢æ¨ç§»äºˆæ¸¬<a class="headerlink" href="#mmi_1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒ•ã‚§ãƒ¼ã‚º</th>
<th>å®Œäº†å¾ŒMMI</th>
<th>æ”¹å–„å¹…</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç¾çŠ¶</td>
<td>52.3</td>
<td>-</td>
</tr>
<tr>
<td>Phase 1å®Œäº†</td>
<td>60.5</td>
<td>+8.2</td>
</tr>
<tr>
<td>Phase 2å®Œäº†</td>
<td>66.0</td>
<td>+5.5</td>
</tr>
<tr>
<td>Phase 3å®Œäº†</td>
<td>68.5</td>
<td>+2.5</td>
</tr>
<tr>
<td>Phase 4å®Œäº†</td>
<td>71.0</td>
<td>+2.5</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code>MMI Score Projection
100 â”¤
 90 â”¤
 80 â”¤                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç›®æ¨™ãƒ©ã‚¤ãƒ³
 70 â”¤                              â•­â”€â”€â”€â”€â”€â”˜  71.0
 60 â”¤              â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
 50 â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯  52.3
 40 â”¤
 30 â”¤
    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€
          ç¾çŠ¶  Phase1 Phase2 Phase3 Phase4
</code></pre>

<hr />
<h2 id="_13">ãƒªã‚¹ã‚¯ã¨è»½æ¸›ç­–<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒªã‚¹ã‚¯</th>
<th>å½±éŸ¿åº¦</th>
<th>è»½æ¸›ç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserServiceåˆ†è§£æ™‚ã®æ—¢å­˜æ©Ÿèƒ½ç ´å£Š</td>
<td>é«˜</td>
<td>åŒ…æ‹¬çš„ãªçµ±åˆãƒ†ã‚¹ãƒˆå®Ÿæ–½</td>
</tr>
<tr>
<td>BOX APIå¤‰æ›´ã«ã‚ˆã‚‹å½±éŸ¿</td>
<td>ä¸­</td>
<td>ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã§éš”é›¢</td>
</tr>
<tr>
<td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰çŠ¶æ…‹ç®¡ç†ã®è¤‡é›‘åŒ–</td>
<td>ä¸­</td>
<td>Redux Toolkitæ´»ç”¨</td>
</tr>
<tr>
<td>ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ä¸­ã®ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢</td>
<td>ä½</td>
<td>ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ãƒ•ãƒ©ã‚°æ´»ç”¨</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_14">æˆåŠŸæŒ‡æ¨™<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h2>
<h3 id="_15">å®šé‡æŒ‡æ¨™<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] å…¨ã‚µãƒ¼ãƒ“ã‚¹ã®MMI 60ä»¥ä¸Š</li>
<li>[ ] å¾ªç’°ä¾å­˜ 0ä»¶</li>
<li>[ ] God Class 0ä»¶</li>
<li>[ ] ã‚µãƒ¼ãƒ“ã‚¹é–“ç›´æ¥ä¾å­˜ 50%å‰Šæ¸›</li>
</ul>
<h3 id="_16">å®šæ€§æŒ‡æ¨™<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] æ–°ã‚µãƒ¼ãƒ“ã‚¹å˜ç‹¬ã§ã®ãƒ‡ãƒ—ãƒ­ã‚¤å¯èƒ½</li>
<li>[ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ 80%ä»¥ä¸Š</li>
<li>[ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼æ‰¿èªç‡å‘ä¸Š</li>
</ul>
<hr />
<h2 id="_17">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Phase 3: ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°</strong> ã§å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç‰¹å®š</li>
<li><strong>Phase 4: ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ</strong> ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’æ±ºå®š</li>
<li>æœ¬æ”¹å–„è¨ˆç”»ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«åˆã‚ã›ã¦èª¿æ•´</li>
</ol>
</article>
</section>
<section id="design">
<h1>è¨­è¨ˆ</h1>
<article id="design-domain-analysis">
<h1 id="_1">ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†æ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†é¡<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã‚·ã‚¹ãƒ†ãƒ ã‚’æˆ¦ç•¥çš„ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã®è¦³ç‚¹ã‹ã‚‰åˆ†æã—ã¾ã™ã€‚</p>
<h3 id="11">1.1 ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<p>ãƒ“ã‚¸ãƒã‚¹ã«ãŠã„ã¦æœ€ã‚‚ä¾¡å€¤ã‚’ç”Ÿã¿å‡ºã™ã€å·®åˆ¥åŒ–è¦å› ã¨ãªã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã€‚</p>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>èª¬æ˜</th>
<th>ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</strong></td>
<td>ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã¨ç®¡ç†</td>
<td>ç›£æŸ»æ¥­å‹™ã®åŠ¹ç‡åŒ–ã€ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å¯¾å¿œ</td>
</tr>
<tr>
<td><strong>æ”¹ã–ã‚“æ¤œçŸ¥</strong></td>
<td>ScalarDLã‚’ç”¨ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«å®Œå…¨æ€§ã®æ¤œè¨¼</td>
<td>æ³•çš„è¨¼æ‹ ã¨ã—ã¦ã®ä¿¡é ¼æ€§ã€ä¸æ­£æ¤œå‡º</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 ã‚µãƒãƒ¼ãƒˆãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<p>ã‚³ã‚¢ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŒã€å·®åˆ¥åŒ–è¦å› ã§ã¯ãªã„ãƒ‰ãƒ¡ã‚¤ãƒ³ã€‚</p>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>èª¬æ˜</th>
<th>å½¹å‰²</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</strong></td>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆã®å–å¾—ãƒ»ä¿å­˜ãƒ»ç…§ä¼š</td>
<td>ç›£æŸ»è¨¼è·¡ã®æä¾›</td>
</tr>
<tr>
<td><strong>ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†</strong></td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†</td>
<td>ç›£æŸ»å¯¾è±¡ã®è¿½è·¡</td>
</tr>
<tr>
<td><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</strong></td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼CRUDã€ãƒ­ãƒ¼ãƒ«ç®¡ç†</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®åŸºç›¤</td>
</tr>
</tbody>
</table>
<h3 id="13">1.3 æ±ç”¨ãƒ‰ãƒ¡ã‚¤ãƒ³<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<p>å¸‚è²©å“ã‚„ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã§ä»£æ›¿å¯èƒ½ãªæ±ç”¨æ©Ÿèƒ½ã€‚</p>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>èª¬æ˜</th>
<th>ä»£æ›¿å¯èƒ½æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>èªè¨¼ãƒ»èªå¯</strong></td>
<td>JWTèªè¨¼ã€BOX OAuth</td>
<td>æ±ç”¨èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã§ä»£æ›¿å¯èƒ½</td>
</tr>
<tr>
<td><strong>é€šçŸ¥</strong></td>
<td>ãƒ¡ãƒ¼ãƒ«é€ä¿¡ã€OTP</td>
<td>ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã§ä»£æ›¿å¯èƒ½</td>
</tr>
<tr>
<td><strong>BOXé€£æº</strong></td>
<td>BOX APIçµ±åˆ</td>
<td>SDKãƒ™ãƒ¼ã‚¹ã§æ¨™æº–åŒ–å¯èƒ½</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¸€è¦§<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Audit Management Context"
        AS[ç›£æŸ»ã‚»ãƒƒãƒˆ]
        AG[ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—]
        COL[ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼]
    end

    subgraph "Verification Context"
        VER[æ”¹ã–ã‚“æ¤œçŸ¥]
        ASSET[ã‚¢ã‚»ãƒƒãƒˆç®¡ç†]
    end

    subgraph "Event Context"
        EVT[ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°]
        TRACK[ã‚¤ãƒ™ãƒ³ãƒˆè¿½è·¡]
    end

    subgraph "Item Context"
        FILE[ãƒ•ã‚¡ã‚¤ãƒ«]
        FOLDER[ãƒ•ã‚©ãƒ«ãƒ€]
        STATUS[ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹]
    end

    subgraph "Identity Context"
        USER[ãƒ¦ãƒ¼ã‚¶ãƒ¼]
        ROLE[ãƒ­ãƒ¼ãƒ«]
        AUTH[èªè¨¼]
    end

    subgraph "Integration Context"
        BOX[BOX API]
        DL[ScalarDL]
    end
</div>

<h3 id="22">2.2 å„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®è©³ç´°<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h4 id="audit-management-context">Audit Management Contextï¼ˆç›£æŸ»ç®¡ç†ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#audit-management-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: ç›£æŸ»ã‚»ãƒƒãƒˆã€ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ç®¡ç†</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>é›†ç´„ãƒ«ãƒ¼ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>AuditSet</td>
<td>âœ“</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã®ä½œæˆãƒ»æ›´æ–°ãƒ»å‰Šé™¤</td>
</tr>
<tr>
<td>AuditGroup</td>
<td>âœ“</td>
<td>å¤–éƒ¨ç›£æŸ»äººã‚°ãƒ«ãƒ¼ãƒ—ã®ç®¡ç†</td>
</tr>
<tr>
<td>AuditSetCollaborators</td>
<td></td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ç®¡ç†</td>
</tr>
<tr>
<td>AuditSetItem</td>
<td></td>
<td>ç›£æŸ»å¯¾è±¡ã‚¢ã‚¤ãƒ†ãƒ ã®ãƒãƒƒãƒ”ãƒ³ã‚°</td>
</tr>
<tr>
<td>AuditGrpAuditSetMapping</td>
<td></td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—ã¨ç›£æŸ»ã‚»ãƒƒãƒˆã®é–¢é€£</td>
</tr>
<tr>
<td>UserAuditGroup</td>
<td></td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã‚°ãƒ«ãƒ¼ãƒ—ã®é–¢é€£</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- ç›£æŸ»ã‚»ãƒƒãƒˆï¼ˆAudit Setï¼‰
- ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆAudit Groupï¼‰
- ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆCollaboratorï¼‰
- æ‰€æœ‰è€…ï¼ˆOwnerï¼‰ã€å…±åŒæ‰€æœ‰è€…ï¼ˆCo-Ownerï¼‰</p>
<hr />
<h4 id="verification-context">Verification Contextï¼ˆæ¤œè¨¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#verification-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: ScalarDLã‚’ç”¨ã„ãŸãƒ•ã‚¡ã‚¤ãƒ«æ”¹ã–ã‚“æ¤œçŸ¥</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>é›†ç´„ãƒ«ãƒ¼ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Asset</td>
<td>âœ“</td>
<td>ScalarDLã‚¢ã‚»ãƒƒãƒˆï¼ˆæ¤œè¨¼å¯¾è±¡ï¼‰</td>
</tr>
<tr>
<td>ItemStatus</td>
<td></td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ã®æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
</tr>
<tr>
<td>ItemsBySha1</td>
<td></td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç´¢å¼•</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- æ”¹ã–ã‚“ï¼ˆTamperingï¼‰
- æ¤œè¨¼ï¼ˆValidationï¼‰
- ã‚¢ã‚»ãƒƒãƒˆï¼ˆAssetï¼‰
- æ”¹ã–ã‚“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆTAMPERED, NOT_TAMPERED, MONITORED, NOT_MONITOREDï¼‰</p>
<hr />
<h4 id="event-context">Event Contextï¼ˆã‚¤ãƒ™ãƒ³ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#event-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: BOXã‚¤ãƒ™ãƒ³ãƒˆã®å–å¾—ã€ä¿å­˜ã€ç…§ä¼š</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>é›†ç´„ãƒ«ãƒ¼ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Events</td>
<td>âœ“</td>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
</tr>
<tr>
<td>ItemEvents</td>
<td></td>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>AuditorLogs</td>
<td></td>
<td>å¤–éƒ¨ç›£æŸ»äººæ“ä½œãƒ­ã‚°</td>
</tr>
<tr>
<td>PositionTracker</td>
<td></td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ ä½ç½®</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ï¼ˆEvent Logï¼‰
- ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ï¼ˆITEM_UPLOAD, ITEM_MOVEç­‰ï¼‰
- ç›£æŸ»äººãƒ­ã‚°ï¼ˆAuditor Logï¼‰</p>
<hr />
<h4 id="item-context">Item Contextï¼ˆã‚¢ã‚¤ãƒ†ãƒ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#item-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>é›†ç´„ãƒ«ãƒ¼ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>Item</td>
<td>âœ“</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€åŸºæœ¬æƒ…å ±</td>
</tr>
<tr>
<td>FileVersion</td>
<td></td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆItemï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆFileï¼‰
- ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆFolderï¼‰
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆVersionï¼‰</p>
<hr />
<h4 id="identity-context">Identity Contextï¼ˆã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#identity-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã€ãƒ­ãƒ¼ãƒ«ç®¡ç†</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>é›†ç´„ãƒ«ãƒ¼ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>User</td>
<td>âœ“</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±</td>
</tr>
<tr>
<td>RoleUser</td>
<td></td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°</td>
</tr>
<tr>
<td>UserToken</td>
<td></td>
<td>èªè¨¼ãƒˆãƒ¼ã‚¯ãƒ³</td>
</tr>
<tr>
<td>UserOtp</td>
<td></td>
<td>ãƒ¯ãƒ³ã‚¿ã‚¤ãƒ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</td>
</tr>
<tr>
<td>Organization</td>
<td></td>
<td>çµ„ç¹”æƒ…å ±</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆOrganization Userï¼‰
- å¤–éƒ¨ç›£æŸ»äººï¼ˆExternal Auditorï¼‰
- ç›£æŸ»ç®¡ç†è€…ï¼ˆAudit Adminï¼‰
- ãƒ­ãƒ¼ãƒ«ï¼ˆRoleï¼‰</p>
<hr />
<h4 id="integration-context">Integration Contextï¼ˆçµ±åˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼‰<a class="headerlink" href="#integration-context" title="Permanent link">&para;</a></h4>
<p><strong>è²¬å‹™</strong>: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº</p>
<table>
<thead>
<tr>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>BoxUtility</td>
<td>BOX APIé€£æº</td>
</tr>
<tr>
<td>ScalardlRepository</td>
<td>ScalarDLé€£æº</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èª</strong>:
- BOXãƒˆãƒ¼ã‚¯ãƒ³
- ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ 
- åˆ†æ•£å°å¸³</p>
<hr />
<h2 id="3">3. ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†é¡ãƒãƒˆãƒªãƒƒã‚¯ã‚¹<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ãƒ“ã‚¸ãƒã‚¹æ§‹é€ è»¸<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</th>
<th>ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒ¼ãƒ‰</th>
<th>ãƒ€ã‚¤ã‚¢ãƒ­ã‚°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td></td>
<td>âœ“</td>
<td></td>
</tr>
<tr>
<td>æ”¹ã–ã‚“æ¤œçŸ¥</td>
<td>âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
<td>âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†</td>
<td></td>
<td>âœ“</td>
<td></td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td></td>
<td>âœ“</td>
<td></td>
</tr>
<tr>
<td>èªè¨¼</td>
<td></td>
<td></td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<h3 id="32">3.2 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å¢ƒç•Œè»¸<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>ãƒ—ãƒ­ã‚»ã‚¹</th>
<th>ãƒã‚¹ã‚¿ãƒ¼</th>
<th>çµ±åˆ</th>
<th>ã‚µãƒãƒ¼ãƒˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†</td>
<td>âœ“</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>æ”¹ã–ã‚“æ¤œçŸ¥</td>
<td>âœ“</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°</td>
<td></td>
<td>âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ ç®¡ç†</td>
<td></td>
<td>âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td></td>
<td>âœ“</td>
<td></td>
<td></td>
</tr>
<tr>
<td>èªè¨¼</td>
<td></td>
<td></td>
<td></td>
<td>âœ“</td>
</tr>
<tr>
<td>BOXé€£æº</td>
<td></td>
<td></td>
<td>âœ“</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–“é–¢ä¿‚<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 é–¢ä¿‚ã‚¿ã‚¤ãƒ—<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é–¢ä¿‚</th>
<th>ä¸Šæµ</th>
<th>ä¸‹æµ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>é¡§å®¢-ä¾›çµ¦è€…</td>
<td>Audit Management</td>
<td>Event</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãŒã‚¤ãƒ™ãƒ³ãƒˆç…§ä¼š</td>
</tr>
<tr>
<td>é¡§å®¢-ä¾›çµ¦è€…</td>
<td>Audit Management</td>
<td>Item</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãŒã‚¢ã‚¤ãƒ†ãƒ å‚ç…§</td>
</tr>
<tr>
<td>é¡§å®¢-ä¾›çµ¦è€…</td>
<td>Verification</td>
<td>Item</td>
<td>æ¤œè¨¼ãŒã‚¢ã‚¤ãƒ†ãƒ çŠ¶æ…‹æ›´æ–°</td>
</tr>
<tr>
<td>ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—</td>
<td>Audit Management</td>
<td>Verification</td>
<td>ç›£æŸ»ã¨æ¤œè¨¼ã®å”èª¿</td>
</tr>
<tr>
<td>è…æ•—é˜²æ­¢å±¤</td>
<td>Integration</td>
<td>å¤–éƒ¨</td>
<td>BOX/ScalarDLé€£æº</td>
</tr>
<tr>
<td>å…±æœ‰ã‚«ãƒ¼ãƒãƒ«</td>
<td>Identity</td>
<td>å…¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å…±æœ‰</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<div class="mermaid">
flowchart LR
    subgraph External
        BOX[BOX API]
        SDL[ScalarDL]
    end

    subgraph Internal
        INT[Integration]
        EVT[Event]
        ITEM[Item]
        AUD[Audit Management]
        VER[Verification]
        ID[Identity]
    end

    BOX --> INT
    INT --> EVT
    INT --> ITEM
    ITEM --> AUD
    EVT --> AUD
    AUD --> VER
    VER --> SDL
    ID -.-> AUD
    ID -.-> VER
    ID -.-> EVT
</div>

<hr />
<h2 id="5">5. æ¨å¥¨ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å¢ƒç•Œ<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<p>Phase 1åˆ†æã«åŸºã¥ãæ¨å¥¨ã‚µãƒ¼ãƒ“ã‚¹å¢ƒç•Œï¼š</p>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹å</th>
<th>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>ä¸»è¦è²¬å‹™</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit-management-service</td>
<td>Audit Management</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
</tr>
<tr>
<td>verification-service</td>
<td>Verification</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥ãƒ»æ¤œè¨¼</td>
</tr>
<tr>
<td>event-service</td>
<td>Event</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</td>
</tr>
<tr>
<td>item-service</td>
<td>Item</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
</tr>
<tr>
<td>identity-service</td>
<td>Identity</td>
<td>èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
</tr>
<tr>
<td>box-integration-service</td>
<td>Integration (BOX)</td>
<td>BOX APIé€£æº</td>
</tr>
<tr>
<td>notification-service</td>
<td>-</td>
<td>é€šçŸ¥ãƒ»ãƒ¡ãƒ¼ãƒ«é€ä¿¡</td>
</tr>
</tbody>
</table>
<p>è©³ç´°ã¯Phase 4ã§è¨­è¨ˆã—ã¾ã™ã€‚</p>
</article>
<article id="design-context-map">
<h1 id="_1">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ—<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">æ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã‚·ã‚¹ãƒ†ãƒ ã®å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–“ã®é–¢ä¿‚ã‚’å®šç¾©ã—ã¾ã™ã€‚</p>
<hr />
<h2 id="_3">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒãƒƒãƒ—å›³<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph TB
    subgraph "Core Domain"
        AM[Audit Management<br/>ç›£æŸ»ç®¡ç†]
        VER[Verification<br/>æ¤œè¨¼]
    end

    subgraph "Supporting Domain"
        EVT[Event<br/>ã‚¤ãƒ™ãƒ³ãƒˆ]
        ITEM[Item<br/>ã‚¢ã‚¤ãƒ†ãƒ ]
        ID[Identity<br/>ã‚¢ã‚¤ãƒ‡ãƒ³ãƒ†ã‚£ãƒ†ã‚£]
    end

    subgraph "Generic Domain"
        INT[Integration<br/>çµ±åˆ]
        NOTIF[Notification<br/>é€šçŸ¥]
    end

    subgraph "External Systems"
        BOX[BOX API]
        SDL[ScalarDL]
        SMTP[SMTP Server]
    end

    %% Core relationships
    AM -->|é¡§å®¢-ä¾›çµ¦è€…| EVT
    AM -->|é¡§å®¢-ä¾›çµ¦è€…| ITEM
    AM -->|ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—| VER
    VER -->|è…æ•—é˜²æ­¢å±¤| SDL

    %% Supporting relationships
    EVT -->|æº–æ‹ è€…| INT
    ITEM -->|æº–æ‹ è€…| INT
    INT -->|è…æ•—é˜²æ­¢å±¤| BOX

    %% Identity as shared kernel
    ID -.->|å…±æœ‰ã‚«ãƒ¼ãƒãƒ«| AM
    ID -.->|å…±æœ‰ã‚«ãƒ¼ãƒãƒ«| VER
    ID -.->|å…±æœ‰ã‚«ãƒ¼ãƒãƒ«| EVT

    %% Notification
    NOTIF -->|è…æ•—é˜²æ­¢å±¤| SMTP
    ID -->|å…¬é–‹ãƒ›ã‚¹ãƒˆ| NOTIF

    classDef core fill:#f9f,stroke:#333,stroke-width:2px
    classDef support fill:#bbf,stroke:#333
    classDef generic fill:#bfb,stroke:#333
    classDef external fill:#fbb,stroke:#333,stroke-dasharray:5 5

    class AM,VER core
    class EVT,ITEM,ID support
    class INT,NOTIF generic
    class BOX,SDL,SMTP external
</div>

<hr />
<h2 id="_4">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–¢ä¿‚ã®è©³ç´°<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="1-audit-management-verification">1. Audit Management â†” Verificationï¼ˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—ï¼‰<a class="headerlink" href="#1-audit-management-verification" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Partnershipï¼ˆãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—ï¼‰</p>
<p>ä¸¡ãƒãƒ¼ãƒ ãŒå¯¾ç­‰ãªç«‹å ´ã§å”èª¿ã—ã€APIã¨è¦ä»¶ã‚’å…±åŒã§æ±ºå®šã€‚</p>
<div class="mermaid">
sequenceDiagram
    participant AM as Audit Management
    participant VER as Verification
    participant SDL as ScalarDL

    AM->>VER: validateAuditSet(auditSetId)
    VER->>VER: getItemsForValidation()
    loop å„ã‚¢ã‚¤ãƒ†ãƒ 
        VER->>SDL: validateAsset(assetId)
        SDL-->>VER: ValidationResult
    end
    VER-->>AM: AuditSetValidationReport
</div>

<p><strong>å…±æœ‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</strong>:</p>
<pre class="codehilite"><code class="language-java">public interface ValidationService {
    ValidationResult validateItem(String itemId);
    AuditSetValidationReport validateAuditSet(String auditSetId);
    TamperingStatus getItemStatus(String itemId);
}
</code></pre>

<hr />
<h3 id="2-audit-management-event-">2. Audit Management â†’ Eventï¼ˆé¡§å®¢-ä¾›çµ¦è€…ï¼‰<a class="headerlink" href="#2-audit-management-event-" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Customer-Supplierï¼ˆé¡§å®¢-ä¾›çµ¦è€…ï¼‰</p>
<p>Audit ManagementãŒCustomerï¼ˆé¡§å®¢ï¼‰ã€EventãŒSupplierï¼ˆä¾›çµ¦è€…ï¼‰ã€‚</p>
<div class="mermaid">
sequenceDiagram
    participant AM as Audit Management
    participant EVT as Event

    AM->>EVT: getEventHistory(auditSetId, dateRange)
    EVT->>EVT: filterEventsByItems()
    EVT-->>AM: List<EventLog>

    AM->>EVT: getItemEvents(itemId)
    EVT-->>AM: List<ItemEvent>
</div>

<p><strong>ä¾›çµ¦è€…API</strong>:</p>
<pre class="codehilite"><code class="language-java">public interface EventQueryService {
    List&lt;EventLog&gt; getEventsByAuditSet(String auditSetId, DateRange range);
    List&lt;ItemEvent&gt; getEventsByItem(String itemId);
    List&lt;AuditorLog&gt; getAuditorLogs(String auditSetId);
}
</code></pre>

<hr />
<h3 id="3-audit-management-item-">3. Audit Management â†’ Itemï¼ˆé¡§å®¢-ä¾›çµ¦è€…ï¼‰<a class="headerlink" href="#3-audit-management-item-" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Customer-Supplierï¼ˆé¡§å®¢-ä¾›çµ¦è€…ï¼‰</p>
<div class="mermaid">
sequenceDiagram
    participant AM as Audit Management
    participant ITEM as Item

    AM->>ITEM: getItemDetails(itemId)
    ITEM-->>AM: ItemDetails

    AM->>ITEM: getItemsByFolder(folderId)
    ITEM-->>AM: List<Item>
</div>

<p><strong>ä¾›çµ¦è€…API</strong>:</p>
<pre class="codehilite"><code class="language-java">public interface ItemQueryService {
    ItemDetails getItem(String itemId);
    List&lt;Item&gt; getItemsByFolder(String folderId);
    List&lt;FileVersion&gt; getFileVersions(String fileId);
    List&lt;Item&gt; getFileCopies(String sha1Hash);
}
</code></pre>

<hr />
<h3 id="4-integration-box-api">4. Integration â†’ BOX APIï¼ˆè…æ•—é˜²æ­¢å±¤ï¼‰<a class="headerlink" href="#4-integration-box-api" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Anti-Corruption Layerï¼ˆè…æ•—é˜²æ­¢å±¤ï¼‰</p>
<p>å¤–éƒ¨BOX APIã¨ã®çµ±åˆã‚’éš”é›¢ã—ã€å†…éƒ¨ãƒ¢ãƒ‡ãƒ«ã¸ã®å¤‰æ›ã‚’æ‹…å½“ã€‚</p>
<div class="mermaid">
sequenceDiagram
    participant INT as Integration
    participant ACL as AntiCorruptionLayer
    participant BOX as BOX API

    INT->>ACL: fetchEventStream(position)
    ACL->>BOX: GET /events?stream_position=...
    BOX-->>ACL: BoxEventResponse
    ACL->>ACL: translateToInternalModel()
    ACL-->>INT: List<InternalEvent>
</div>

<p><strong>è…æ•—é˜²æ­¢å±¤ã®å®Ÿè£…</strong>:</p>
<pre class="codehilite"><code class="language-java">public class BoxEventTranslator {
    public InternalEvent translate(BoxEvent boxEvent) {
        return InternalEvent.builder()
            .eventId(boxEvent.getEventId())
            .eventType(mapEventType(boxEvent.getEventType()))
            .itemId(boxEvent.getSource().getId())
            .timestamp(boxEvent.getCreatedAt())
            .userId(boxEvent.getCreatedBy().getId())
            .build();
    }

    private EventType mapEventType(String boxEventType) {
        return switch(boxEventType) {
            case &quot;ITEM_UPLOAD&quot; -&gt; EventType.UPLOAD;
            case &quot;ITEM_MOVE&quot; -&gt; EventType.MOVE;
            // ... mapping
        };
    }
}
</code></pre>

<hr />
<h3 id="5-verification-scalardl">5. Verification â†’ ScalarDLï¼ˆè…æ•—é˜²æ­¢å±¤ï¼‰<a class="headerlink" href="#5-verification-scalardl" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Anti-Corruption Layerï¼ˆè…æ•—é˜²æ­¢å±¤ï¼‰</p>
<p>ScalarDL APIã¨ã®çµ±åˆã‚’éš”é›¢ã€‚</p>
<div class="mermaid">
sequenceDiagram
    participant VER as Verification
    participant ACL as ScalarDLAdapter
    participant SDL as ScalarDL

    VER->>ACL: registerAsset(itemData)
    ACL->>ACL: convertToContract()
    ACL->>SDL: execute(PutAssetContract, args)
    SDL-->>ACL: ContractExecutionResult
    ACL-->>VER: AssetRegistrationResult

    VER->>ACL: validateAsset(assetId)
    ACL->>SDL: validate(assetId)
    SDL-->>ACL: ValidationResult
    ACL->>ACL: translateResult()
    ACL-->>VER: TamperingStatus
</div>

<hr />
<h3 id="6-identity">6. Identityï¼ˆå…±æœ‰ã‚«ãƒ¼ãƒãƒ«ï¼‰<a class="headerlink" href="#6-identity" title="Permanent link">&para;</a></h3>
<p><strong>é–¢ä¿‚ã‚¿ã‚¤ãƒ—</strong>: Shared Kernelï¼ˆå…±æœ‰ã‚«ãƒ¼ãƒãƒ«ï¼‰</p>
<p>å…¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å…±æœ‰ã•ã‚Œã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ãƒ­ãƒ¼ãƒ«æƒ…å ±ã€‚</p>
<p><strong>å…±æœ‰ãƒ¢ãƒ‡ãƒ«</strong>:</p>
<pre class="codehilite"><code class="language-java">// å…¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã§å…±æœ‰
public record UserInfo(
    String userId,
    String email,
    String name,
    Set&lt;Role&gt; roles
) {}

public enum Role {
    AUDIT_ADMIN,
    GENERAL_USER,
    EXTERNAL_AUDITOR
}
</code></pre>

<p><strong>æ³¨æ„ç‚¹</strong>:
- å…±æœ‰ã‚«ãƒ¼ãƒãƒ«ã¯æœ€å°é™ã«ä¿ã¤
- å¤‰æ›´æ™‚ã¯å…¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¸ã®å½±éŸ¿ã‚’æ¤œè¨
- ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã§åŒæœŸã‚’æ¤œè¨</p>
<hr />
<h2 id="_5">ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–“é€šä¿¡ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">åŒæœŸé€šä¿¡ï¼ˆç¾çŠ¶ï¼‰<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å‘¼ã³å‡ºã—å…ƒ</th>
<th>å‘¼ã³å‡ºã—å…ˆ</th>
<th>ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>Audit Management</td>
<td>Event</td>
<td>REST API</td>
</tr>
<tr>
<td>Audit Management</td>
<td>Item</td>
<td>REST API</td>
</tr>
<tr>
<td>Audit Management</td>
<td>Verification</td>
<td>REST API</td>
</tr>
<tr>
<td>Item</td>
<td>Integration (BOX)</td>
<td>REST API</td>
</tr>
<tr>
<td>Verification</td>
<td>Integration (ScalarDL)</td>
<td>gRPC</td>
</tr>
</tbody>
</table>
<h3 id="_7">æ¨å¥¨éåŒæœŸé€šä¿¡ï¼ˆå°†æ¥ï¼‰<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œå…ƒ</th>
<th>ã‚¤ãƒ™ãƒ³ãƒˆ</th>
<th>è³¼èª­è€…</th>
</tr>
</thead>
<tbody>
<tr>
<td>Item</td>
<td>ItemCreated</td>
<td>Audit Management, Event</td>
</tr>
<tr>
<td>Item</td>
<td>ItemModified</td>
<td>Verification, Event</td>
</tr>
<tr>
<td>Audit Management</td>
<td>AuditSetCreated</td>
<td>Event</td>
</tr>
<tr>
<td>Verification</td>
<td>ValidationCompleted</td>
<td>Audit Management</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_8">ãƒãƒ¼ãƒ å¢ƒç•Œã¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="_9">æ¨å¥¨ãƒãƒ¼ãƒ æ§‹æˆ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Platform Team"
        ID[Identity Context]
        INT[Integration Context]
        NOTIF[Notification]
    end

    subgraph "Audit Team"
        AM[Audit Management]
        VER[Verification]
    end

    subgraph "Data Team"
        EVT[Event Context]
        ITEM[Item Context]
    end
</div>

<table>
<thead>
<tr>
<th>ãƒãƒ¼ãƒ </th>
<th>æ‹…å½“ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>è²¬å‹™</th>
</tr>
</thead>
<tbody>
<tr>
<td>Platform Team</td>
<td>Identity, Integration, Notification</td>
<td>åŸºç›¤ã‚µãƒ¼ãƒ“ã‚¹</td>
</tr>
<tr>
<td>Audit Team</td>
<td>Audit Management, Verification</td>
<td>ã‚³ã‚¢ãƒ“ã‚¸ãƒã‚¹</td>
</tr>
<tr>
<td>Data Team</td>
<td>Event, Item</td>
<td>ãƒ‡ãƒ¼ã‚¿ç®¡ç†</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_10">ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§æˆ¦ç•¥<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h2>
<h3 id="_11">çµæœæ•´åˆæ€§ã®æ¡ç”¨<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆé–“ã§ã¯çµæœæ•´åˆæ€§ã‚’æ¡ç”¨ã—ã€Sagaãƒ‘ã‚¿ãƒ¼ãƒ³ã§é•·æ™‚é–“ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç®¡ç†ã€‚</p>
<div class="mermaid">
sequenceDiagram
    participant AM as Audit Management
    participant ITEM as Item
    participant VER as Verification

    AM->>AM: createAuditSet()
    AM->>ITEM: addItemToAuditSet()
    ITEM-->>AM: success
    AM->>VER: registerForMonitoring()

    alt æˆåŠŸ
        VER-->>AM: success
        AM->>AM: commitAuditSet()
    else å¤±æ•—
        VER-->>AM: failure
        AM->>ITEM: removeItem() [è£œå„Ÿ]
        AM->>AM: rollbackAuditSet()
    end
</div>

<hr />
<h2 id="_12">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Phase 4: ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹è¨­è¨ˆ</strong> - å…·ä½“çš„ãªã‚µãƒ¼ãƒ“ã‚¹å¢ƒç•Œã¨è²¬å‹™ã®å®šç¾©</li>
<li><strong>Phase 4.5: APIè¨­è¨ˆ</strong> - REST/gRPC/ã‚¤ãƒ™ãƒ³ãƒˆAPIã®è©³ç´°è¨­è¨ˆ</li>
<li><strong>Phase 5: ScalarDBè¨­è¨ˆ</strong> - ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ€é©åŒ–</li>
</ol>
</article>
<article id="design-system-mapping">
<h1 id="system-mapping">ã‚·ã‚¹ãƒ†ãƒ ãƒãƒƒãƒ”ãƒ³ã‚° (System Mapping)<a class="headerlink" href="#system-mapping" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ç¾çŠ¶ã‚·ã‚¹ãƒ†ãƒ  â†’ ãƒ‰ãƒ¡ã‚¤ãƒ³å¯¾å¿œè¡¨<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ã‚µãƒ¼ãƒ“ã‚¹å±¤ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç¾è¡Œã‚µãƒ¼ãƒ“ã‚¹</th>
<th>è¡Œæ•°</th>
<th>å¯¾å¿œãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>åˆ†å‰²ææ¡ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserService</td>
<td>1116</td>
<td>Identity &amp; Access, BOX Integration</td>
<td>Identity &amp; Access, BOX Integration</td>
<td>AuthService, BoxUserService, UserMgmtService, PasswordService</td>
</tr>
<tr>
<td>AuditSetService</td>
<td>845</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditSetCrudService, AuditSetAccessService, AuditSetGroupService</td>
</tr>
<tr>
<td>AuditSetItemService</td>
<td>899</td>
<td>Audit Management, Integrity Verification</td>
<td>Audit Management, Integrity Verification</td>
<td>ItemCrudService, MonitoringService, VerificationService</td>
</tr>
<tr>
<td>AuditSetCollaboratorService</td>
<td>288</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>ç¶­æŒ</td>
</tr>
<tr>
<td>AuditGroupService</td>
<td>439</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>ç¶­æŒ</td>
</tr>
<tr>
<td>FileService</td>
<td>555</td>
<td>File Management</td>
<td>File Management</td>
<td>FileDetailsService, FileVersionService</td>
</tr>
<tr>
<td>FolderService</td>
<td>115</td>
<td>File Management</td>
<td>File Management</td>
<td>ç¶­æŒ</td>
</tr>
<tr>
<td>EventLogService</td>
<td>222</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>ç¶­æŒ</td>
</tr>
<tr>
<td>AssetService</td>
<td>199</td>
<td>Integrity Verification</td>
<td>Integrity Verification</td>
<td>ç¶­æŒ</td>
</tr>
<tr>
<td>CommonService</td>
<td>33</td>
<td>å…±æœ‰ã‚«ãƒ¼ãƒãƒ«</td>
<td>Shared Kernel</td>
<td>ç¶­æŒ</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 ãƒªãƒã‚¸ãƒˆãƒªå±¤ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç¾è¡Œãƒªãƒã‚¸ãƒˆãƒª</th>
<th>å¯¾å¿œãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>Aggregate</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserRepository</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>User</td>
</tr>
<tr>
<td>RoleUserRepository</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>User</td>
</tr>
<tr>
<td>UserTokenRepository</td>
<td>Identity &amp; Access, BOX Integration</td>
<td>Identity &amp; Access</td>
<td>User</td>
</tr>
<tr>
<td>UserOptRepository</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>User</td>
</tr>
<tr>
<td>OrganizationRepository</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Organization</td>
</tr>
<tr>
<td>AuditSetRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditSet</td>
</tr>
<tr>
<td>AuditSetItemRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditSet</td>
</tr>
<tr>
<td>AuditSetCollaboratorsRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditSet</td>
</tr>
<tr>
<td>AuditGroupRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditGroup</td>
</tr>
<tr>
<td>AuditGrpAuditSetMappingRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditGroup</td>
</tr>
<tr>
<td>UserAuditGroupMappingRepository</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>AuditGroup</td>
</tr>
<tr>
<td>EventsRepository</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>Event</td>
</tr>
<tr>
<td>ItemEventsRepository</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>Event</td>
</tr>
<tr>
<td>FileMonitoringStatusRepository</td>
<td>File Management</td>
<td>File Management</td>
<td>FileMonitoring</td>
</tr>
<tr>
<td>AuditorLogsRepository</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>AuditLog</td>
</tr>
<tr>
<td>Sha1Repository</td>
<td>File Management, Integrity Verification</td>
<td>File Management</td>
<td>FileSha1</td>
</tr>
</tbody>
</table>
<h3 id="13">1.3 ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±¤ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç¾è¡Œã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</th>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>ç¨®åˆ¥</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>User</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Aggregate Root</td>
<td></td>
</tr>
<tr>
<td>RoleUser</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Entity</td>
<td>Useré…ä¸‹</td>
</tr>
<tr>
<td>UserToken</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Value Object</td>
<td></td>
</tr>
<tr>
<td>UserOpt</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Entity</td>
<td></td>
</tr>
<tr>
<td>Organization</td>
<td>Identity &amp; Access</td>
<td>Identity &amp; Access</td>
<td>Aggregate Root</td>
<td></td>
</tr>
<tr>
<td>AuditSet</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Aggregate Root</td>
<td></td>
</tr>
<tr>
<td>AuditSetItem</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Entity</td>
<td>AuditSeté…ä¸‹</td>
</tr>
<tr>
<td>AuditSetCollaborators</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Entity</td>
<td>AuditSeté…ä¸‹</td>
</tr>
<tr>
<td>AuditGroup</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Aggregate Root</td>
<td></td>
</tr>
<tr>
<td>AuditGrpAuditSetMapping</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Value Object</td>
<td></td>
</tr>
<tr>
<td>UserAuditGroupMapping</td>
<td>Audit Management</td>
<td>Audit Management</td>
<td>Value Object</td>
<td></td>
</tr>
<tr>
<td>Events</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>Aggregate Root</td>
<td></td>
</tr>
<tr>
<td>ItemEvents</td>
<td>Event Tracking</td>
<td>Event Tracking</td>
<td>Entity</td>
<td>Eventsé…ä¸‹</td>
</tr>
<tr>
<td>FileMonitoringStatus</td>
<td>File Management</td>
<td>File Management</td>
<td>Entity</td>
<td></td>
</tr>
<tr>
<td>Sha1</td>
<td>Integrity Verification</td>
<td>Integrity Verification</td>
<td>Value Object</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ã‚³ãƒ¼ãƒ‰é…ç½®ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ç¾è¡Œãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ â†’ ç›®æ¨™ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>ã€ç¾è¡Œæ§‹é€ ã€‘                          ã€ç›®æ¨™æ§‹é€ ã€‘
com.scalar.events_log_tool/           com.scalar.auditor/
â”œâ”€â”€ application/                      â”œâ”€â”€ identity/
â”‚   â”œâ”€â”€ controller/                   â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ UserController            â”‚   â”‚   â””â”€â”€ UserController
â”‚   â”‚   â”œâ”€â”€ AuditSetController        â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â””â”€â”€ ...                       â”‚   â”‚   â”œâ”€â”€ AuthenticationService
â”‚   â””â”€â”€ service/                      â”‚   â”‚   â”œâ”€â”€ UserManagementService
â”‚       â”œâ”€â”€ UserService               â”‚   â”‚   â””â”€â”€ PasswordResetService
â”‚       â”œâ”€â”€ AuditSetService           â”‚   â”œâ”€â”€ domain/
â”‚       â””â”€â”€ ...                       â”‚   â”‚   â”œâ”€â”€ User
â”œâ”€â”€ domain/                           â”‚   â”‚   â”œâ”€â”€ RoleUser
â”‚   â””â”€â”€ model/                        â”‚   â”‚   â””â”€â”€ UserRepository
â”‚       â”œâ”€â”€ User                      â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ AuditSet                  â”‚       â””â”€â”€ JpaUserRepository
â”‚       â””â”€â”€ ...                       â”‚
â”œâ”€â”€ infrastructure/                   â”œâ”€â”€ audit/
â”‚   â””â”€â”€ repository/                   â”‚   â”œâ”€â”€ api/
â”‚       â”œâ”€â”€ UserRepository            â”‚   â”‚   â”œâ”€â”€ AuditSetController
â”‚       â”œâ”€â”€ AuditSetRepository        â”‚   â”‚   â””â”€â”€ AuditGroupController
â”‚       â””â”€â”€ ...                       â”‚   â”œâ”€â”€ application/
â””â”€â”€ utility/                          â”‚   â”‚   â”œâ”€â”€ AuditSetService
    â””â”€â”€ BoxUtility                    â”‚   â”‚   â””â”€â”€ AuditGroupService
                                      â”‚   â”œâ”€â”€ domain/
                                      â”‚   â”‚   â”œâ”€â”€ AuditSet
                                      â”‚   â”‚   â”œâ”€â”€ AuditSetItem
                                      â”‚   â”‚   â””â”€â”€ AuditGroup
                                      â”‚   â””â”€â”€ infrastructure/
                                      â”‚
                                      â”œâ”€â”€ file/
                                      â”‚   â”œâ”€â”€ api/
                                      â”‚   â”œâ”€â”€ application/
                                      â”‚   â”œâ”€â”€ domain/
                                      â”‚   â””â”€â”€ infrastructure/
                                      â”‚
                                      â”œâ”€â”€ event/
                                      â”‚   â”œâ”€â”€ api/
                                      â”‚   â”œâ”€â”€ application/
                                      â”‚   â”œâ”€â”€ domain/
                                      â”‚   â””â”€â”€ infrastructure/
                                      â”‚
                                      â”œâ”€â”€ verification/
                                      â”‚   â”œâ”€â”€ api/
                                      â”‚   â”œâ”€â”€ application/
                                      â”‚   â”œâ”€â”€ domain/
                                      â”‚   â””â”€â”€ infrastructure/
                                      â”‚
                                      â”œâ”€â”€ box/
                                      â”‚   â”œâ”€â”€ application/
                                      â”‚   â””â”€â”€ infrastructure/
                                      â”‚       â””â”€â”€ acl/
                                      â”‚
                                      â””â”€â”€ shared/
                                          â”œâ”€â”€ events/
                                          â””â”€â”€ types/
</code></pre>

<hr />
<h2 id="3-api">3. API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#3-api" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ç¾è¡Œã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ â†’ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ç¾è¡ŒController</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>ç§»è¡Œå…ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/api/auth/**</code></td>
<td>UserController</td>
<td>Identity &amp; Access</td>
<td>identity/api/AuthController</td>
</tr>
<tr>
<td><code>/api/users/**</code></td>
<td>UserController</td>
<td>Identity &amp; Access</td>
<td>identity/api/UserController</td>
</tr>
<tr>
<td><code>/api/audit-sets/**</code></td>
<td>AuditSetController</td>
<td>Audit Management</td>
<td>audit/api/AuditSetController</td>
</tr>
<tr>
<td><code>/api/audit-groups/**</code></td>
<td>AuditGroupController</td>
<td>Audit Management</td>
<td>audit/api/AuditGroupController</td>
</tr>
<tr>
<td><code>/api/files/**</code></td>
<td>FileController</td>
<td>File Management</td>
<td>file/api/FileController</td>
</tr>
<tr>
<td><code>/api/folders/**</code></td>
<td>FolderController</td>
<td>File Management</td>
<td>file/api/FolderController</td>
</tr>
<tr>
<td><code>/api/events/**</code></td>
<td>EventLogController</td>
<td>Event Tracking</td>
<td>event/api/EventController</td>
</tr>
<tr>
<td><code>/api/box/**</code></td>
<td>(å„Controllerå†…)</td>
<td>BOX Integration</td>
<td>box/api/BoxController</td>
</tr>
</tbody>
</table>
<h3 id="32-api">3.2 APIåˆ†é¡<a class="headerlink" href="#32-api" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Public API"
        A1["/api/auth"]
        A2["/api/users"]
        A3["/api/audit-sets"]
        A4["/api/files"]
        A5["/api/events"]
    end

    subgraph "Internal API"
        I1["/internal/verification"]
        I2["/internal/sync"]
    end

    subgraph "Webhook"
        W1["/webhook/box"]
    end

    subgraph "Context"
        C1[Identity & Access]
        C2[Audit Management]
        C3[File Management]
        C4[Event Tracking]
        C5[BOX Integration]
    end

    A1 --> C1
    A2 --> C1
    A3 --> C2
    A4 --> C3
    A5 --> C4
    I1 --> C2
    I2 --> C5
    W1 --> C5
</div>

<hr />
<h2 id="4">4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ãƒ†ãƒ¼ãƒ–ãƒ« â†’ ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>æ‰€æœ‰æ¨©</th>
<th>å…±æœ‰ã‚¿ã‚¤ãƒ—</th>
</tr>
</thead>
<tbody>
<tr>
<td>users</td>
<td>Identity &amp; Access</td>
<td>å°‚æœ‰</td>
<td>å‚ç…§ã®ã¿è¨±å¯</td>
</tr>
<tr>
<td>role_user</td>
<td>Identity &amp; Access</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>user_tokens</td>
<td>Identity &amp; Access</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>user_opt</td>
<td>Identity &amp; Access</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>organizations</td>
<td>Identity &amp; Access</td>
<td>å°‚æœ‰</td>
<td>å‚ç…§ã®ã¿è¨±å¯</td>
</tr>
<tr>
<td>audit_sets</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>audit_set_items</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>audit_set_collaborators</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>audit_groups</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>audit_grp_audit_set_mapping</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>user_audit_group_mapping</td>
<td>Audit Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>events</td>
<td>Event Tracking</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>item_events</td>
<td>Event Tracking</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>file_monitoring_status</td>
<td>File Management</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>sha1</td>
<td>Integrity Verification</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
<tr>
<td>auditor_logs</td>
<td>Event Tracking</td>
<td>å°‚æœ‰</td>
<td>ãªã—</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ã‚¹ã‚­ãƒ¼ãƒåˆ†å‰²è¨ˆç”»<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Current: Single Schema"
        DB[(ScalarDB Cluster)]
    end

    subgraph "Phase 1: Logical Separation"
        DB1[(auditor_identity)]
        DB2[(auditor_audit)]
        DB3[(auditor_file)]
        DB4[(auditor_event)]
        DB5[(auditor_verification)]
    end

    subgraph "Phase 2: Physical Separation"
        PDB1[(Identity DB)]
        PDB2[(Audit DB)]
        PDB3[(File DB)]
        PDB4[(Event DB)]
        PDB5[(Verification DB)]
    end

    DB --> DB1
    DB --> DB2
    DB --> DB3
    DB --> DB4
    DB --> DB5

    DB1 -.-> PDB1
    DB2 -.-> PDB2
    DB3 -.-> PDB3
    DB4 -.-> PDB4
    DB5 -.-> PDB5
</div>

<hr />
<h2 id="5">5. å¤–éƒ¨é€£æºãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-box-api">5.1 BOX APIé€£æº<a class="headerlink" href="#51-box-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç¾è¡Œåˆ©ç”¨ç®‡æ‰€</th>
<th>BOX API</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
<th>ACLçµŒç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserService.registerUserAndSaveToken</td>
<td>OAuth API</td>
<td>Identity &amp; Access</td>
<td>âœ“</td>
</tr>
<tr>
<td>FileService.getFileDetails</td>
<td>Files API</td>
<td>File Management</td>
<td>âœ“</td>
</tr>
<tr>
<td>FolderService.getFolderItems</td>
<td>Folders API</td>
<td>File Management</td>
<td>âœ“</td>
</tr>
<tr>
<td>EventLogService.getEnterpriseEvents</td>
<td>Events API</td>
<td>Event Tracking</td>
<td>âœ“</td>
</tr>
<tr>
<td>BoxUtility.getConnection</td>
<td>Connection</td>
<td>BOX Integration</td>
<td>-</td>
</tr>
</tbody>
</table>
<h3 id="52-scalardl">5.2 ScalarDLé€£æº<a class="headerlink" href="#52-scalardl" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç¾è¡Œåˆ©ç”¨ç®‡æ‰€</th>
<th>ScalarDL API</th>
<th>å¯¾å¿œã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>AssetService.registerAsset</td>
<td>Ledger.register</td>
<td>Integrity Verification</td>
</tr>
<tr>
<td>AssetService.validateAsset</td>
<td>Auditor.validate</td>
<td>Integrity Verification</td>
</tr>
<tr>
<td>AssetService.getAssetHistory</td>
<td>Ledger.scan</td>
<td>Integrity Verification</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ç¾è¡Œä¾å­˜é–¢ä¿‚<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TD
    subgraph "Controllers"
        UC[UserController]
        ASC[AuditSetController]
        FC[FileController]
    end

    subgraph "Services"
        US[UserService]
        ASS[AuditSetService]
        ASIS[AuditSetItemService]
        FS[FileService]
        AS[AssetService]
    end

    subgraph "Repositories"
        UR[UserRepository]
        ASR[AuditSetRepository]
        ASIR[AuditSetItemRepository]
        ER[EventsRepository]
    end

    UC --> US
    ASC --> ASS
    ASC --> ASIS
    FC --> FS

    US --> UR
    US --> ASR
    ASS --> ASR
    ASS --> UR
    ASS --> ASIR
    ASIS --> ASS
    ASIS --> AS
    FS --> US
    FS --> ER
</div>

<h3 id="62">6.2 ç›®æ¨™ä¾å­˜é–¢ä¿‚<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TD
    subgraph "Identity Context"
        IAC[AuthController]
        IAS[AuthService]
        IUR[UserRepository]
    end

    subgraph "Audit Context"
        AAC[AuditController]
        AAS[AuditSetService]
        AAR[AuditSetRepository]
    end

    subgraph "File Context"
        FAC[FileController]
        FAS[FileService]
        FFR[FileRepository]
    end

    subgraph "Verification Context"
        VAS[VerificationService]
        VAR[AssetRepository]
    end

    subgraph "Shared"
        EB[Event Bus]
        SK[Shared Kernel]
    end

    IAC --> IAS
    IAS --> IUR

    AAC --> AAS
    AAS --> AAR
    AAS --> EB
    AAS -.->|Interface| IAS

    FAC --> FAS
    FAS --> FFR
    FAS -.->|Interface| IAS

    VAS --> VAR
    VAS --> EB

    EB --> SK
</div>

<hr />
<h2 id="7">7. ç§»è¡Œãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-identity-access-context">7.1 Identity &amp; Access Context<a class="headerlink" href="#71-identity-access-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] UserServiceåˆ†å‰²</li>
<li>[ ] AuthenticationServiceæŠ½å‡º</li>
<li>[ ] UserManagementServiceæŠ½å‡º</li>
<li>[ ] PasswordResetServiceæŠ½å‡º</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<h3 id="72-audit-management-context">7.2 Audit Management Context<a class="headerlink" href="#72-audit-management-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] AuditSetServiceæ•´ç†</li>
<li>[ ] AuditSetItemServiceåˆ†å‰²</li>
<li>[ ] å¾ªç’°ä¾å­˜è§£æ¶ˆ</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<h3 id="73-file-management-context">7.3 File Management Context<a class="headerlink" href="#73-file-management-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] FileServiceæ•´ç†</li>
<li>[ ] FolderServiceçµ±åˆæ¤œè¨</li>
<li>[ ] BOX ACLçµŒç”±ã«å¤‰æ›´</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<h3 id="74-event-tracking-context">7.4 Event Tracking Context<a class="headerlink" href="#74-event-tracking-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] EventLogServiceç¶­æŒ</li>
<li>[ ] ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œè€…ã®æ•´ç†</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<h3 id="75-integrity-verification-context">7.5 Integrity Verification Context<a class="headerlink" href="#75-integrity-verification-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] AssetServiceç¶­æŒ</li>
<li>[ ] æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯æŠ½å‡º</li>
<li>[ ] ScalarDLé€£æºã®æŠ½è±¡åŒ–</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<h3 id="76-box-integration-context">7.6 BOX Integration Context<a class="headerlink" href="#76-box-integration-context" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] BoxApiClientä½œæˆ</li>
<li>[ ] ACLå±¤å®Ÿè£…</li>
<li>[ ] ãƒ¢ãƒ‡ãƒ«ãƒãƒƒãƒ‘ãƒ¼ä½œæˆ</li>
<li>[ ] ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç§»å‹•</li>
<li>[ ] ãƒ†ã‚¹ãƒˆç§»è¡Œ</li>
</ul>
<hr />
<h2 id="8">8. å½±éŸ¿åˆ†æ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 å¤‰æ›´å½±éŸ¿ãƒãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å¤‰æ›´å¯¾è±¡</th>
<th style="text-align: center;">Identity</th>
<th style="text-align: center;">Audit</th>
<th style="text-align: center;">File</th>
<th style="text-align: center;">Event</th>
<th style="text-align: center;">Verification</th>
<th style="text-align: center;">BOX</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserServiceåˆ†å‰²</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">â—‹</td>
</tr>
<tr>
<td>AuditSetå¾ªç’°ä¾å­˜è§£æ¶ˆ</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">-</td>
</tr>
<tr>
<td>BOX ACLå°å…¥</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—‹</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">â—</td>
</tr>
<tr>
<td>ã‚¹ã‚­ãƒ¼ãƒåˆ†å‰²</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">â—</td>
<td style="text-align: center;">-</td>
</tr>
</tbody>
</table>
<p>â—: ç›´æ¥å½±éŸ¿, â—‹: é–“æ¥å½±éŸ¿, -: å½±éŸ¿ãªã—</p>
<h3 id="82">8.2 ãƒªã‚¹ã‚¯è©•ä¾¡<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒãƒƒãƒ”ãƒ³ã‚°é …ç›®</th>
<th style="text-align: center;">ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>UserServiceåˆ†å‰²</td>
<td style="text-align: center;">é«˜</td>
<td>å…¨ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒä¾å­˜</td>
</tr>
<tr>
<td>å¾ªç’°ä¾å­˜è§£æ¶ˆ</td>
<td style="text-align: center;">ä¸­</td>
<td>Auditå†…ã§å®Œçµ</td>
</tr>
<tr>
<td>BOX ACLå°å…¥</td>
<td style="text-align: center;">ä¸­</td>
<td>å¤–éƒ¨APIå¤‰æ›´ãƒªã‚¹ã‚¯</td>
</tr>
<tr>
<td>ã‚¹ã‚­ãƒ¼ãƒåˆ†å‰²</td>
<td style="text-align: center;">é«˜</td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å½±éŸ¿</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: scalar-event-log-fetcher-main</em></p>
</article>
<article id="design-target-architecture">
<h1 id="_1">ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å…¨ä½“å›³<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Client Layer"
        WEB[Web Application<br/>React]
        BOX_UI[BOX Integration Menu<br/>React]
    end

    subgraph "API Gateway Layer"
        GW[API Gateway<br/>Kong/AWS API Gateway]
    end

    subgraph "Core Services"
        AMS[Audit Management<br/>Service]
        VS[Verification<br/>Service]
    end

    subgraph "Supporting Services"
        ES[Event<br/>Service]
        IS[Item<br/>Service]
        IDS[Identity<br/>Service]
    end

    subgraph "Integration Services"
        BIS[BOX Integration<br/>Service]
        NS[Notification<br/>Service]
    end

    subgraph "Data Layer"
        SDB[(ScalarDB<br/>Cluster)]
        SDL[(ScalarDL)]
        CACHE[(Redis<br/>Cache)]
    end

    subgraph "External"
        BOX[BOX API]
        SMTP[SMTP]
    end

    WEB --> GW
    BOX_UI --> GW

    GW --> AMS
    GW --> VS
    GW --> ES
    GW --> IS
    GW --> IDS

    AMS --> ES
    AMS --> IS
    AMS --> VS
    AMS --> IDS

    VS --> SDL
    VS --> IS

    ES --> BIS
    IS --> BIS

    BIS --> BOX
    NS --> SMTP

    AMS --> SDB
    ES --> SDB
    IS --> SDB
    IDS --> SDB

    AMS --> CACHE
    ES --> CACHE
</div>

<h3 id="12">1.2 ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹å</th>
<th>ç¨®åˆ¥</th>
<th>ä¸»è¦è²¬å‹™</th>
<th>æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit-management-service</td>
<td>Core</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
<td>Spring Boot, ScalarDB</td>
</tr>
<tr>
<td>verification-service</td>
<td>Core</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥ãƒ»æ¤œè¨¼</td>
<td>Spring Boot, ScalarDL</td>
</tr>
<tr>
<td>event-service</td>
<td>Supporting</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</td>
<td>Spring Boot, ScalarDB</td>
</tr>
<tr>
<td>item-service</td>
<td>Supporting</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
<td>Spring Boot, ScalarDB</td>
</tr>
<tr>
<td>identity-service</td>
<td>Supporting</td>
<td>èªè¨¼ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</td>
<td>Spring Boot, ScalarDB</td>
</tr>
<tr>
<td>box-integration-service</td>
<td>Integration</td>
<td>BOX APIé€£æº</td>
<td>Spring Boot</td>
</tr>
<tr>
<td>notification-service</td>
<td>Integration</td>
<td>ãƒ¡ãƒ¼ãƒ«ãƒ»é€šçŸ¥</td>
<td>Spring Boot</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ã‚µãƒ¼ãƒ“ã‚¹è©³ç´°è¨­è¨ˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-audit-management-service">2.1 Audit Management Service<a class="headerlink" href="#21-audit-management-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: ç›£æŸ»ã‚»ãƒƒãƒˆã€ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†</p>
<div class="mermaid">
graph LR
    subgraph "Audit Management Service"
        AC[AuditSet<br/>Controller]
        AGC[AuditGroup<br/>Controller]

        ASS[AuditSet<br/>Service]
        AGS[AuditGroup<br/>Service]
        ACS[Collaborator<br/>Service]

        AR[AuditSet<br/>Repository]
        AGR[AuditGroup<br/>Repository]
        ACR[Collaborator<br/>Repository]
    end

    AC --> ASS
    AGC --> AGS
    ASS --> ACS
    ASS --> AR
    AGS --> AGR
    ACS --> ACR
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| POST | /api/v1/audit-sets | ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ |
| GET | /api/v1/audit-sets | ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§ |
| GET | /api/v1/audit-sets/{id} | ç›£æŸ»ã‚»ãƒƒãƒˆè©³ç´° |
| PUT | /api/v1/audit-sets/{id} | ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–° |
| DELETE | /api/v1/audit-sets/{id} | ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤ |
| POST | /api/v1/audit-sets/{id}/items | ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ  |
| POST | /api/v1/audit-groups | ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ |
| POST | /api/v1/audit-sets/{id}/collaborators | ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼è¿½åŠ  |</p>
<p><strong>ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«</strong>:</p>
<pre class="codehilite"><code>AuditSet
â”œâ”€â”€ audit_set_id (PK)
â”œâ”€â”€ name
â”œâ”€â”€ description
â”œâ”€â”€ owner_user_id
â”œâ”€â”€ created_at
â””â”€â”€ updated_at

AuditSetItem
â”œâ”€â”€ audit_set_id (PK)
â”œâ”€â”€ item_id (CK)
â”œâ”€â”€ item_type
â””â”€â”€ added_at
</code></pre>

<hr />
<h3 id="22-verification-service">2.2 Verification Service<a class="headerlink" href="#22-verification-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: ScalarDLã‚’ç”¨ã„ãŸæ”¹ã–ã‚“æ¤œçŸ¥ãƒ»æ¤œè¨¼</p>
<div class="mermaid">
graph LR
    subgraph "Verification Service"
        VC[Verification<br/>Controller]

        VS[Validation<br/>Service]
        AS[Asset<br/>Service]

        SR[ScalarDL<br/>Repository]
        ISR[ItemStatus<br/>Repository]
    end

    VC --> VS
    VS --> AS
    AS --> SR
    VS --> ISR
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| POST | /api/v1/items/{id}/validate | ã‚¢ã‚¤ãƒ†ãƒ æ¤œè¨¼ |
| POST | /api/v1/audit-sets/{id}/validate | ç›£æŸ»ã‚»ãƒƒãƒˆå…¨ä½“æ¤œè¨¼ |
| GET | /api/v1/items/{id}/status | æ”¹ã–ã‚“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾— |
| POST | /api/v1/items/{id}/register | ã‚¢ã‚»ãƒƒãƒˆç™»éŒ² |</p>
<p><strong>ScalarDL Contract</strong>:</p>
<pre class="codehilite"><code>Contract: PutAsset
- assetId: item_id
- properties: {sha1_hash, version, timestamp}

Contract: ValidateAsset
- assetId: item_id
- returns: ValidationResult
</code></pre>

<hr />
<h3 id="23-event-service">2.3 Event Service<a class="headerlink" href="#23-event-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: BOXã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã®å–å¾—ãƒ»ä¿å­˜ãƒ»ç…§ä¼š</p>
<div class="mermaid">
graph LR
    subgraph "Event Service"
        EC[Event<br/>Controller]

        ELS[EventLog<br/>Service]
        EFS[EventFetch<br/>Service]

        ER[Events<br/>Repository]
        IER[ItemEvents<br/>Repository]
        ALR[AuditorLogs<br/>Repository]
    end

    EC --> ELS
    EFS --> ER
    EFS --> IER
    ELS --> ER
    ELS --> IER
    ELS --> ALR
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | /api/v1/events | ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ä»˜ãï¼‰ |
| GET | /api/v1/items/{id}/events | ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ |
| GET | /api/v1/audit-sets/{id}/events | ç›£æŸ»ã‚»ãƒƒãƒˆåˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ |
| GET | /api/v1/auditor-logs | ç›£æŸ»äººãƒ­ã‚° |</p>
<p><strong>ãƒãƒƒãƒå‡¦ç†</strong>:
- EventFetchJobãŒå®šæœŸçš„ã«BOX APIã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—
- PositionTrackerã§å–å¾—ä½ç½®ã‚’ç®¡ç†</p>
<hr />
<h3 id="24-item-service">2.4 Item Service<a class="headerlink" href="#24-item-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç®¡ç†</p>
<div class="mermaid">
graph LR
    subgraph "Item Service"
        IC[Item<br/>Controller]
        FC[File<br/>Controller]
        FOC[Folder<br/>Controller]

        ITS[Item<br/>Service]
        FS[File<br/>Service]
        FOS[Folder<br/>Service]

        IR[Item<br/>Repository]
        SHA[ItemsBySha1<br/>Repository]
    end

    IC --> ITS
    FC --> FS
    FOC --> FOS
    FS --> IR
    FOS --> IR
    FS --> SHA
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | /api/v1/items/{id} | ã‚¢ã‚¤ãƒ†ãƒ è©³ç´° |
| GET | /api/v1/files/{id}/versions | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§ |
| GET | /api/v1/files/{sha1}/copies | SHA1ã‚³ãƒ”ãƒ¼ä¸€è¦§ |
| GET | /api/v1/folders/{id}/children | ãƒ•ã‚©ãƒ«ãƒ€å†…å®¹ |</p>
<hr />
<h3 id="25-identity-service">2.5 Identity Service<a class="headerlink" href="#25-identity-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: èªè¨¼ãƒ»èªå¯ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</p>
<div class="mermaid">
graph LR
    subgraph "Identity Service"
        AC[Auth<br/>Controller]
        UC[User<br/>Controller]

        AS[Auth<br/>Service]
        US[User<br/>Service]
        RS[Role<br/>Service]
        TS[Token<br/>Service]

        UR[User<br/>Repository]
        RR[Role<br/>Repository]
        TR[Token<br/>Repository]
    end

    AC --> AS
    UC --> US
    AS --> TS
    AS --> US
    US --> RS
    US --> UR
    RS --> RR
    TS --> TR
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| POST | /api/v1/auth/login | ãƒ­ã‚°ã‚¤ãƒ³ |
| POST | /api/v1/auth/logout | ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ |
| POST | /api/v1/auth/refresh | ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–° |
| GET | /api/v1/users | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ |
| POST | /api/v1/users | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆï¼ˆå¤–éƒ¨ç›£æŸ»äººï¼‰ |
| PUT | /api/v1/users/{id}/roles | ãƒ­ãƒ¼ãƒ«æ›´æ–° |</p>
<hr />
<h3 id="26-box-integration-service">2.6 BOX Integration Service<a class="headerlink" href="#26-box-integration-service" title="Permanent link">&para;</a></h3>
<p><strong>è²¬å‹™</strong>: BOX APIã¨ã®é€£æºã‚’ä¸€å…ƒåŒ–</p>
<div class="mermaid">
graph LR
    subgraph "BOX Integration Service"
        BC[Box<br/>Controller]

        BES[BoxEvent<br/>Service]
        BFS[BoxFile<br/>Service]
        BAS[BoxAuth<br/>Service]

        ACL[Anti-Corruption<br/>Layer]
    end

    subgraph "External"
        BOX[BOX API]
    end

    BC --> BES
    BC --> BFS
    BES --> ACL
    BFS --> ACL
    BAS --> ACL
    ACL --> BOX
</div>

<p><strong>API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</strong>:
| ãƒ¡ã‚½ãƒƒãƒ‰ | ãƒ‘ã‚¹ | èª¬æ˜ |
|---------|------|------|
| GET | /api/v1/box/events | ã‚¤ãƒ™ãƒ³ãƒˆã‚¹ãƒˆãƒªãƒ¼ãƒ å–å¾— |
| GET | /api/v1/box/files/{id} | ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°å–å¾— |
| GET | /api/v1/box/files/{id}/preview | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼URLå–å¾— |
| POST | /api/v1/box/oauth/callback | OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ |</p>
<hr />
<h2 id="3">3. ã‚µãƒ¼ãƒ“ã‚¹é–“é€šä¿¡<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-restgrpc">3.1 åŒæœŸé€šä¿¡ï¼ˆREST/gRPCï¼‰<a class="headerlink" href="#31-restgrpc" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Client
    participant GW as API Gateway
    participant AMS as Audit Management
    participant IS as Item Service
    participant VS as Verification

    C->>GW: POST /audit-sets/{id}/items
    GW->>AMS: addItem(auditSetId, itemId)
    AMS->>IS: getItemDetails(itemId)
    IS-->>AMS: ItemDetails
    AMS->>VS: registerForMonitoring(itemId)
    VS-->>AMS: success
    AMS-->>GW: AuditSetItem
    GW-->>C: 201 Created
</div>

<h3 id="32">3.2 éåŒæœŸé€šä¿¡ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ï¼‰<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "Event Bus (Kafka/SQS)"
        TOPIC[Event Topics]
    end

    IS[Item Service] -->|ItemCreated| TOPIC
    IS -->|ItemModified| TOPIC
    ES[Event Service] -->|EventProcessed| TOPIC

    TOPIC -->|ItemCreated| AMS[Audit Management]
    TOPIC -->|ItemModified| VS[Verification]
    TOPIC -->|EventProcessed| AMS
</div>

<p><strong>ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾©</strong>:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;eventType&quot;: &quot;ItemCreated&quot;,
  &quot;timestamp&quot;: &quot;2024-01-01T00:00:00Z&quot;,
  &quot;payload&quot;: {
    &quot;itemId&quot;: &quot;file_123456&quot;,
    &quot;itemType&quot;: &quot;FILE&quot;,
    &quot;parentId&quot;: &quot;folder_789&quot;,
    &quot;sha1Hash&quot;: &quot;abc123...&quot;
  }
}
</code></pre>

<hr />
<h2 id="4">4. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-kubernetes">4.1 Kubernetesæ§‹æˆ<a class="headerlink" href="#41-kubernetes" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Kubernetes Cluster"
        subgraph "Ingress"
            ING[Ingress Controller]
        end

        subgraph "Services"
            AMS[audit-management<br/>replicas: 3]
            VS[verification<br/>replicas: 2]
            ES[event<br/>replicas: 2]
            IS[item<br/>replicas: 2]
            IDS[identity<br/>replicas: 2]
            BIS[box-integration<br/>replicas: 2]
            NS[notification<br/>replicas: 1]
        end

        subgraph "Data"
            SDB[ScalarDB Cluster<br/>nodes: 3]
            SDL[ScalarDL<br/>nodes: 3]
            REDIS[Redis Cluster<br/>nodes: 3]
        end
    end

    ING --> AMS
    ING --> VS
    ING --> ES
    ING --> IS
    ING --> IDS
</div>

<h3 id="42">4.2 ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>ãƒ¬ãƒ—ãƒªã‚«æ•°</th>
<th>CPU</th>
<th>Memory</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit-management</td>
<td>3</td>
<td>500m</td>
<td>1Gi</td>
<td>ã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹ã€é«˜å¯ç”¨æ€§</td>
</tr>
<tr>
<td>verification</td>
<td>2</td>
<td>1000m</td>
<td>2Gi</td>
<td>ScalarDLé€šä¿¡ã€CPUé›†ç´„</td>
</tr>
<tr>
<td>event</td>
<td>2</td>
<td>500m</td>
<td>1Gi</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</td>
</tr>
<tr>
<td>item</td>
<td>2</td>
<td>500m</td>
<td>512Mi</td>
<td>è»½é‡CRUD</td>
</tr>
<tr>
<td>identity</td>
<td>2</td>
<td>500m</td>
<td>512Mi</td>
<td>èªè¨¼å‡¦ç†</td>
</tr>
<tr>
<td>box-integration</td>
<td>2</td>
<td>500m</td>
<td>512Mi</td>
<td>å¤–éƒ¨APIé€šä¿¡</td>
</tr>
<tr>
<td>notification</td>
<td>1</td>
<td>250m</td>
<td>256Mi</td>
<td>éã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. ç§»è¡Œæˆ¦ç•¥<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-strangler-fig">5.1 æ®µéšçš„ç§»è¡Œï¼ˆStrangler Fig ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰<a class="headerlink" href="#51-strangler-fig" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Phase 1"
        MON[Monolith]
        IDS1[Identity Service<br/>æŠ½å‡º]
    end

    subgraph "Phase 2"
        MON2[Monolith<br/>ç¸®å°]
        IDS2[Identity Service]
        ES2[Event Service<br/>æŠ½å‡º]
    end

    subgraph "Phase 3"
        MON3[Monolith<br/>æœ€å°åŒ–]
        IDS3[Identity Service]
        ES3[Event Service]
        IS3[Item Service<br/>æŠ½å‡º]
    end

    subgraph "Phase 4: Complete"
        AMS4[Audit Management]
        VS4[Verification]
        ES4[Event]
        IS4[Item]
        IDS4[Identity]
        BIS4[BOX Integration]
    end

    MON --> MON2
    MON2 --> MON3
    MON3 --> AMS4
</div>

<h3 id="52">5.2 ç§»è¡Œãƒ•ã‚§ãƒ¼ã‚º<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Phase</th>
<th>æŠ½å‡ºã‚µãƒ¼ãƒ“ã‚¹</th>
<th>æœŸé–“ç›®å®‰</th>
<th>ãƒªã‚¹ã‚¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Identity Service</td>
<td>ä¸­</td>
<td>èªè¨¼ãƒ•ãƒ­ãƒ¼å¤‰æ›´</td>
</tr>
<tr>
<td>2</td>
<td>Event Service</td>
<td>å°</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—åˆ†é›¢</td>
</tr>
<tr>
<td>3</td>
<td>Item Service</td>
<td>å°</td>
<td>ãƒ‡ãƒ¼ã‚¿å‚ç…§ãƒ‘ã‚¿ãƒ¼ãƒ³å¤‰æ›´</td>
</tr>
<tr>
<td>4</td>
<td>Verification Service</td>
<td>ä¸­</td>
<td>ScalarDLé€£æº</td>
</tr>
<tr>
<td>5</td>
<td>BOX Integration</td>
<td>å°</td>
<td>APIçµ±åˆ</td>
</tr>
<tr>
<td>6</td>
<td>Audit Management</td>
<td>ä¸­</td>
<td>ã‚³ã‚¢æ©Ÿèƒ½åˆ†é›¢</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. ç›£è¦–ãƒ»é‹ç”¨<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 å¯è¦³æ¸¬æ€§<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é ˜åŸŸ</th>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</td>
<td>Prometheus + Grafana</td>
<td>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–</td>
</tr>
<tr>
<td>ãƒ­ã‚°</td>
<td>ELK Stack / Loki</td>
<td>ãƒ­ã‚°é›†ç´„ãƒ»æ¤œç´¢</td>
</tr>
<tr>
<td>ãƒˆãƒ¬ãƒ¼ã‚¹</td>
<td>Jaeger / Zipkin</td>
<td>åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°</td>
</tr>
<tr>
<td>ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
<td>PagerDuty / Opsgenie</td>
<td>ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†</td>
</tr>
</tbody>
</table>
<h3 id="62-sla">6.2 SLAç›®æ¨™<a class="headerlink" href="#62-sla" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</th>
<th>ç›®æ¨™å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¯ç”¨æ€§</td>
<td>99.9%</td>
</tr>
<tr>
<td>API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (P95)</td>
<td>&lt; 500ms</td>
</tr>
<tr>
<td>API ãƒ¬ã‚¹ãƒãƒ³ã‚¹ (P99)</td>
<td>&lt; 1000ms</td>
</tr>
<tr>
<td>ã‚¨ãƒ©ãƒ¼ç‡</td>
<td>&lt; 0.1%</td>
</tr>
</tbody>
</table>
</article>
<article id="design-transformation-plan">
<h1 id="transformation-plan">å¤‰æ›è¨ˆç”» (Transformation Plan)<a class="headerlink" href="#transformation-plan" title="Permanent link">&para;</a></h1>
<h2 id="1">1. å¤‰æ›æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ç¾çŠ¶ â†’ ç›®æ¨™<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "As-Is"
        MONO[Monolithic<br/>Spring Boot App]
        SDB1[(ScalarDB<br/>Single)]
    end

    subgraph "To-Be"
        IS[Identity Service]
        AS[Audit Service]
        FS[File Service]
        ES[Event Service]
        VS[Verification Service]
        BS[BOX Service]
        SDB2[(ScalarDB<br/>Cluster)]
    end

    MONO --> IS
    MONO --> AS
    MONO --> FS
    MONO --> ES
    MONO --> VS
    MONO --> BS
    SDB1 --> SDB2
</div>

<h3 id="12">1.2 å¤‰æ›æˆ¦ç•¥<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æˆ¦ç•¥</th>
<th>é©ç”¨</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Strangler Fig</strong></td>
<td>ã‚µãƒ¼ãƒ“ã‚¹åˆ†é›¢</td>
<td>æ®µéšçš„ç§»è¡Œã§ãƒªã‚¹ã‚¯è»½æ¸›</td>
</tr>
<tr>
<td><strong>Branch by Abstraction</strong></td>
<td>DBç§»è¡Œ</td>
<td>ä¸¦è¡Œé‹ç”¨å¯èƒ½</td>
</tr>
<tr>
<td><strong>Change Data Capture</strong></td>
<td>ãƒ‡ãƒ¼ã‚¿åŒæœŸ</td>
<td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åŒæœŸ</td>
</tr>
</tbody>
</table>
<h3 id="13">1.3 ãƒ•ã‚§ãƒ¼ã‚ºæ¦‚è¦<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Phase</th>
<th>æœŸé–“</th>
<th>ä¸»è¦ã‚¿ã‚¹ã‚¯</th>
<th>æˆæœç‰©</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phase 1</td>
<td>3ãƒ¶æœˆ</td>
<td>ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»åŸºç›¤æ§‹ç¯‰</td>
<td>K8sç’°å¢ƒã€CI/CD</td>
</tr>
<tr>
<td>Phase 2</td>
<td>4ãƒ¶æœˆ</td>
<td>Identity &amp; BOXåˆ†é›¢</td>
<td>2ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒ</td>
</tr>
<tr>
<td>Phase 3</td>
<td>4ãƒ¶æœˆ</td>
<td>File &amp; Eventåˆ†é›¢</td>
<td>4ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒ</td>
</tr>
<tr>
<td>Phase 4</td>
<td>3ãƒ¶æœˆ</td>
<td>Audit &amp; Verificationåˆ†é›¢</td>
<td>6ã‚µãƒ¼ãƒ“ã‚¹ç¨¼åƒ</td>
</tr>
<tr>
<td>Phase 5</td>
<td>2ãƒ¶æœˆ</td>
<td>æœ€é©åŒ–ãƒ»å®Œå…¨ç§»è¡Œ</td>
<td>æœ¬ç•ªé‹ç”¨é–‹å§‹</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-phase-1-3">2. Phase 1: ã‚¤ãƒ³ãƒ•ãƒ©ãƒ»åŸºç›¤æ§‹ç¯‰ï¼ˆ3ãƒ¶æœˆï¼‰<a class="headerlink" href="#2-phase-1-3" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ã‚¿ã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ‹…å½“</th>
<th>å·¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.1</td>
<td>Kubernetesç’°å¢ƒæ§‹ç¯‰</td>
<td>Infra</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>1.2</td>
<td>CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰</td>
<td>DevOps</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>1.3</td>
<td>ScalarDB Clusteræ§‹ç¯‰</td>
<td>Infra</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>1.4</td>
<td>ç›£è¦–ãƒ»ãƒ­ã‚°åŸºç›¤æ§‹ç¯‰</td>
<td>DevOps</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>1.5</td>
<td>API Gatewayå°å…¥</td>
<td>Infra</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>1.6</td>
<td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚­ãƒ¥ãƒ¼å°å…¥</td>
<td>Infra</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>1.7</td>
<td>å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½œæˆ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
</tbody>
</table>
<h3 id="22-kubernetes">2.2 Kubernetesç’°å¢ƒ<a class="headerlink" href="#22-kubernetes" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># ç’°å¢ƒæ§‹æˆ
environments:
  development:
    cluster: dev-cluster
    nodes: 3
    resources: small

  staging:
    cluster: stg-cluster
    nodes: 5
    resources: medium

  production:
    cluster: prod-cluster
    nodes: 10
    resources: large
    ha: true
</code></pre>

<h3 id="23-cicd">2.3 CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³<a class="headerlink" href="#23-cicd" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "CI Pipeline"
        CODE[Code Push] --> BUILD[Build]
        BUILD --> TEST[Unit Test]
        TEST --> SCAN[Security Scan]
        SCAN --> ARTIFACT[Docker Image]
    end

    subgraph "CD Pipeline"
        ARTIFACT --> DEV[Deploy Dev]
        DEV --> STG[Deploy Staging]
        STG --> PROD[Deploy Production]
    end
</div>

<h3 id="24">2.4 å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒª<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>auditor-commons/
â”œâ”€â”€ auditor-common-core/         # å…±é€šãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ auditor-common-security/     # JWTã€èªè¨¼
â”œâ”€â”€ auditor-common-scalardb/     # ScalarDBè¨­å®š
â”œâ”€â”€ auditor-common-messaging/    # ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
â”œâ”€â”€ auditor-common-logging/      # ãƒ­ã‚°è¨­å®š
â””â”€â”€ auditor-common-testing/      # ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
</code></pre>

<h3 id="25">2.5 æˆæœç‰©<a class="headerlink" href="#25" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Kubernetesæœ¬ç•ªã‚¯ãƒ©ã‚¹ã‚¿ç¨¼åƒ</li>
<li>[ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ç¨¼åƒ</li>
<li>[ ] ScalarDB Clusterç¨¼åƒ</li>
<li>[ ] Prometheus + Grafanaç¨¼åƒ</li>
<li>[ ] ELK Stackç¨¼åƒ</li>
<li>[ ] Kong API Gatewayç¨¼åƒ</li>
<li>[ ] RabbitMQç¨¼åƒ</li>
<li>[ ] å…±é€šãƒ©ã‚¤ãƒ–ãƒ©ãƒªv1.0ãƒªãƒªãƒ¼ã‚¹</li>
</ul>
<hr />
<h2 id="3-phase-2-identity-box4">3. Phase 2: Identity &amp; BOXåˆ†é›¢ï¼ˆ4ãƒ¶æœˆï¼‰<a class="headerlink" href="#3-phase-2-identity-box4" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 åˆ†é›¢å¯¾è±¡<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<p><strong>ç¾è¡ŒUserService (1116è¡Œ) â†’ 2ã‚µãƒ¼ãƒ“ã‚¹ã«åˆ†å‰²</strong></p>
<div class="mermaid">
graph TB
    subgraph "ç¾è¡Œ"
        US[UserService<br/>1116è¡Œ]
    end

    subgraph "ç›®æ¨™"
        IS[Identity Service<br/>~500è¡Œ]
        BS[BOX Integration Service<br/>~400è¡Œ]
    end

    US --> IS
    US --> BS
</div>

<h3 id="32">3.2 ã‚¿ã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ‹…å½“</th>
<th>å·¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>2.1</td>
<td>Identity Serviceãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>2.2</td>
<td>èªè¨¼æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.3</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.4</td>
<td>BOX Integration Serviceä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>2.5</td>
<td>BOX OAuthæ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.6</td>
<td>BOX APIé€£æºæ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.7</td>
<td>Anti-corruption Layerå®Ÿè£…</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.8</td>
<td>çµ±åˆãƒ†ã‚¹ãƒˆ</td>
<td>QA</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>2.9</td>
<td>æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆ</td>
<td>DevOps</td>
<td>2é€±é–“</td>
</tr>
</tbody>
</table>
<h3 id="33-identity-service">3.3 Identity Serviceå®Ÿè£…<a class="headerlink" href="#33-identity-service" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// æ–°Identity Serviceã®æ§‹é€ 
identity-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/identity/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ AuthController.java
â”‚   â”‚   â”œâ”€â”€ UserController.java
â”‚   â”‚   â””â”€â”€ OrganizationController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ AuthenticationService.java
â”‚   â”‚   â”œâ”€â”€ UserManagementService.java
â”‚   â”‚   â””â”€â”€ PasswordResetService.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ User.java
â”‚   â”‚   â”œâ”€â”€ UserToken.java
â”‚   â”‚   â””â”€â”€ Organization.java
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ ScalarDbUserRepository.java
â”‚   â”‚   â””â”€â”€ JwtTokenProvider.java
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ SecurityConfig.java
â””â”€â”€ src/test/
</code></pre>

<h3 id="34-box-integration-service">3.4 BOX Integration Serviceå®Ÿè£…<a class="headerlink" href="#34-box-integration-service" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// ACL (Anti-corruption Layer) è¨­è¨ˆ
box-integration-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/box/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ BoxController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ BoxOAuthService.java
â”‚   â”‚   â”œâ”€â”€ BoxFileService.java
â”‚   â”‚   â””â”€â”€ BoxEventService.java
â”‚   â”œâ”€â”€ infrastructure/
â”‚   â”‚   â”œâ”€â”€ acl/
â”‚   â”‚   â”‚   â”œâ”€â”€ BoxApiClient.java      # BOX SDK wrapper
â”‚   â”‚   â”‚   â””â”€â”€ BoxModelMapper.java    # BOX â†’ Domainå¤‰æ›
â”‚   â”‚   â””â”€â”€ BoxConnectionManager.java
â”‚   â””â”€â”€ config/
â”‚       â””â”€â”€ BoxConfig.java
</code></pre>

<h3 id="35">3.5 åˆ‡ã‚Šæ›¿ãˆæˆ¦ç•¥<a class="headerlink" href="#35" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant LB as Load Balancer
    participant OLD as Monolith (UserService)
    participant NEW_IS as Identity Service
    participant NEW_BS as BOX Service

    Note over LB,NEW_BS: Week 1: 10%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯
    LB->>NEW_IS: 10% /api/auth/*
    LB->>OLD: 90% /api/auth/*

    Note over LB,NEW_BS: Week 2: 50%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯
    LB->>NEW_IS: 50% /api/auth/*
    LB->>OLD: 50% /api/auth/*

    Note over LB,NEW_BS: Week 3: 100%ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯
    LB->>NEW_IS: 100% /api/auth/*
    LB->>NEW_BS: 100% /api/box/*
</div>

<h3 id="36">3.6 æˆæœç‰©<a class="headerlink" href="#36" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Identity Serviceæœ¬ç•ªç¨¼åƒ</li>
<li>[ ] BOX Integration Serviceæœ¬ç•ªç¨¼åƒ</li>
<li>[ ] æ—§UserServiceã®èªè¨¼ãƒ»BOXæ©Ÿèƒ½å»ƒæ­¢</li>
<li>[ ] API GatewayçµŒç”±ã®ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</li>
</ul>
<hr />
<h2 id="4-phase-3-file-event4">4. Phase 3: File &amp; Eventåˆ†é›¢ï¼ˆ4ãƒ¶æœˆï¼‰<a class="headerlink" href="#4-phase-3-file-event4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 åˆ†é›¢å¯¾è±¡<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ç¾è¡Œ"
        FS_OLD[FileService<br/>555è¡Œ]
        FOS_OLD[FolderService<br/>115è¡Œ]
        ELS_OLD[EventLogService<br/>222è¡Œ]
    end

    subgraph "ç›®æ¨™"
        FS_NEW[File Service<br/>~400è¡Œ]
        ES_NEW[Event Service<br/>~300è¡Œ]
    end

    FS_OLD --> FS_NEW
    FOS_OLD --> FS_NEW
    ELS_OLD --> ES_NEW
</div>

<h3 id="42">4.2 ã‚¿ã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ‹…å½“</th>
<th>å·¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>3.1</td>
<td>File Serviceãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>3.2</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>3.3</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€æ©Ÿèƒ½çµ±åˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>3.4</td>
<td>ç›£è¦–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>3.5</td>
<td>Event Serviceãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>3.6</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>3.7</td>
<td>ç›£æŸ»ãƒ­ã‚°æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>3.8</td>
<td>Cassandraã¸ã®ã‚¤ãƒ™ãƒ³ãƒˆç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>3.9</td>
<td>çµ±åˆãƒ†ã‚¹ãƒˆ</td>
<td>QA</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>3.10</td>
<td>æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆ</td>
<td>DevOps</td>
<td>2é€±é–“</td>
</tr>
</tbody>
</table>
<h3 id="43-file-service">4.3 File Serviceå®Ÿè£…<a class="headerlink" href="#43-file-service" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// File Serviceæ§‹é€ 
file-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/file/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ FileController.java
â”‚   â”‚   â”œâ”€â”€ FolderController.java
â”‚   â”‚   â””â”€â”€ ItemController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ FileInfoService.java
â”‚   â”‚   â”œâ”€â”€ FileVersionService.java
â”‚   â”‚   â””â”€â”€ MonitoringStatusService.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ Item.java
â”‚   â”‚   â”œâ”€â”€ ItemMonitoringStatus.java
â”‚   â”‚   â””â”€â”€ FileVersion.java
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ ScalarDbItemRepository.java
â”‚       â””â”€â”€ BoxIntegrationClient.java  # BOX Serviceå‘¼ã³å‡ºã—
</code></pre>

<h3 id="44-event-servicecassandra">4.4 Event Serviceå®Ÿè£…ï¼ˆCassandraå¯¾å¿œï¼‰<a class="headerlink" href="#44-event-servicecassandra" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// Event Serviceæ§‹é€ 
event-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/event/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ EventController.java
â”‚   â”‚   â””â”€â”€ AuditorLogController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ EventSearchService.java
â”‚   â”‚   â”œâ”€â”€ EventSyncService.java
â”‚   â”‚   â””â”€â”€ AuditorLogService.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ Event.java
â”‚   â”‚   â”œâ”€â”€ AuditorLog.java
â”‚   â”‚   â””â”€â”€ PositionTracker.java
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ ScalarDbEventRepository.java  # CassandraçµŒç”±
â”‚       â””â”€â”€ BoxIntegrationClient.java
</code></pre>

<h3 id="45">4.5 æˆæœç‰©<a class="headerlink" href="#45" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] File Serviceæœ¬ç•ªç¨¼åƒ</li>
<li>[ ] Event Serviceæœ¬ç•ªç¨¼åƒï¼ˆCassandraï¼‰</li>
<li>[ ] ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿Cassandraç§»è¡Œå®Œäº†</li>
<li>[ ] æ—§ã‚µãƒ¼ãƒ“ã‚¹æ©Ÿèƒ½å»ƒæ­¢</li>
</ul>
<hr />
<h2 id="5-phase-4-audit-verification3">5. Phase 4: Audit &amp; Verificationåˆ†é›¢ï¼ˆ3ãƒ¶æœˆï¼‰<a class="headerlink" href="#5-phase-4-audit-verification3" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 åˆ†é›¢å¯¾è±¡<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ç¾è¡Œ"
        ASS_OLD[AuditSetService<br/>845è¡Œ]
        ASIS_OLD[AuditSetItemService<br/>899è¡Œ]
        ASCS_OLD[AuditSetCollaboratorService<br/>288è¡Œ]
        AGS_OLD[AuditGroupService<br/>439è¡Œ]
        AS_OLD[AssetService<br/>199è¡Œ]
    end

    subgraph "ç›®æ¨™"
        AS_NEW[Audit Service<br/>~800è¡Œ]
        VS_NEW[Verification Service<br/>~300è¡Œ]
    end

    ASS_OLD --> AS_NEW
    ASIS_OLD --> AS_NEW
    ASCS_OLD --> AS_NEW
    AGS_OLD --> AS_NEW
    AS_OLD --> VS_NEW
</div>

<h3 id="52">5.2 ã‚¿ã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ‹…å½“</th>
<th>å·¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>4.1</td>
<td>Audit Serviceãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>4.2</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>3é€±é–“</td>
</tr>
<tr>
<td>4.3</td>
<td>å¾ªç’°ä¾å­˜è§£æ¶ˆ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.4</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.5</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ©Ÿèƒ½ç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.6</td>
<td>Verification Serviceä½œæˆ</td>
<td>Dev</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>4.7</td>
<td>ScalarDLé€£æºç§»è¡Œ</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.8</td>
<td>Sagaãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.9</td>
<td>çµ±åˆãƒ†ã‚¹ãƒˆ</td>
<td>QA</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>4.10</td>
<td>æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆ</td>
<td>DevOps</td>
<td>2é€±é–“</td>
</tr>
</tbody>
</table>
<h3 id="53">5.3 å¾ªç’°ä¾å­˜è§£æ¶ˆ<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// Before: å¾ªç’°ä¾å­˜
AuditSetItemService --&gt; AuditSetService
AuditSetService --&gt; AuditSetItemRepository (ç›´æ¥åˆ©ç”¨)

// After: ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹åˆ†é›¢
interface AuditSetQueryPort {
    boolean isItemExist(String auditSetId, Long itemId);
    AuditSet findById(String auditSetId);
}

class AuditSetQueryAdapter implements AuditSetQueryPort {
    // AuditSetRepositoryã‚’ç›´æ¥åˆ©ç”¨
}

class AuditSetItemService {
    private final AuditSetQueryPort auditSetQuery;  // ä¾å­˜é€†è»¢
}
</code></pre>

<h3 id="54-audit-service">5.4 Audit Serviceå®Ÿè£…<a class="headerlink" href="#54-audit-service" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// Audit Serviceæ§‹é€ 
audit-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/audit/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ AuditSetController.java
â”‚   â”‚   â”œâ”€â”€ AuditSetItemController.java
â”‚   â”‚   â”œâ”€â”€ CollaboratorController.java
â”‚   â”‚   â””â”€â”€ AuditGroupController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ AuditSetService.java
â”‚   â”‚   â”œâ”€â”€ AuditSetItemService.java
â”‚   â”‚   â”œâ”€â”€ CollaboratorService.java
â”‚   â”‚   â”œâ”€â”€ AuditGroupService.java
â”‚   â”‚   â””â”€â”€ saga/
â”‚   â”‚       â””â”€â”€ AuditSetDeletionSaga.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ AuditSet.java
â”‚   â”‚   â”œâ”€â”€ AuditSetItem.java
â”‚   â”‚   â”œâ”€â”€ Collaborator.java
â”‚   â”‚   â””â”€â”€ AuditGroup.java
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ ScalarDbAuditSetRepository.java
â”‚       â”œâ”€â”€ IdentityServiceClient.java
â”‚       â”œâ”€â”€ FileServiceClient.java
â”‚       â””â”€â”€ VerificationServiceClient.java
</code></pre>

<h3 id="55-verification-service">5.5 Verification Serviceå®Ÿè£…<a class="headerlink" href="#55-verification-service" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// Verification Serviceæ§‹é€ 
verification-service/
â”œâ”€â”€ src/main/java/com/scalar/auditor/verification/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ VerificationController.java
â”‚   â”œâ”€â”€ application/
â”‚   â”‚   â”œâ”€â”€ AssetRegistrationService.java
â”‚   â”‚   â”œâ”€â”€ TamperDetectionService.java
â”‚   â”‚   â””â”€â”€ VerificationHistoryService.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ Asset.java
â”‚   â”‚   â”œâ”€â”€ VerificationResult.java
â”‚   â”‚   â””â”€â”€ TamperingStatus.java
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ ScalarDlClient.java
â”‚       â””â”€â”€ FileServiceClient.java
</code></pre>

<h3 id="56">5.6 æˆæœç‰©<a class="headerlink" href="#56" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Audit Serviceæœ¬ç•ªç¨¼åƒ</li>
<li>[ ] Verification Serviceæœ¬ç•ªç¨¼åƒ</li>
<li>[ ] å¾ªç’°ä¾å­˜å®Œå…¨è§£æ¶ˆ</li>
<li>[ ] Sagaãƒ‘ã‚¿ãƒ¼ãƒ³ç¨¼åƒ</li>
</ul>
<hr />
<h2 id="6-phase-5-2">6. Phase 5: æœ€é©åŒ–ãƒ»å®Œå…¨ç§»è¡Œï¼ˆ2ãƒ¶æœˆï¼‰<a class="headerlink" href="#6-phase-5-2" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ã‚¿ã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ‹…å½“</th>
<th>å·¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>5.1</td>
<td>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</td>
<td>Dev</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>5.2</td>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»</td>
<td>Security</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>5.3</td>
<td>è² è·ãƒ†ã‚¹ãƒˆ</td>
<td>QA</td>
<td>2é€±é–“</td>
</tr>
<tr>
<td>5.4</td>
<td>DRè¨“ç·´</td>
<td>Ops</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>5.5</td>
<td>æ—§ãƒ¢ãƒãƒªã‚¹å»ƒæ­¢</td>
<td>DevOps</td>
<td>1é€±é–“</td>
</tr>
<tr>
<td>5.6</td>
<td>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™</td>
<td>All</td>
<td>1é€±é–“</td>
</tr>
</tbody>
</table>
<h3 id="62">6.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°é …ç›®
performance:
  - name: Connection Pool
    current: 50
    target: 100
    tuning: &quot;ScalarDB connection pool max&quot;

  - name: Cache Hit Rate
    current: 60%
    target: 90%
    tuning: &quot;Redis caching for user/file info&quot;

  - name: Query Optimization
    current: P99 500ms
    target: P99 200ms
    tuning: &quot;Secondary indexè¿½åŠ ã€N+1è§£æ¶ˆ&quot;

  - name: Async Processing
    current: Sync
    target: Async
    tuning: &quot;ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œã®éåŒæœŸåŒ–&quot;
</code></pre>

<h3 id="63">6.3 æœ€çµ‚æ¤œè¨¼<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ¤œè¨¼é …ç›®</th>
<th>åŸºæº–</th>
<th>çµæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚¿ã‚¤ãƒ  P99</td>
<td>&lt; 500ms</td>
<td>-</td>
</tr>
<tr>
<td>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</td>
<td>&gt; 1000 TPS</td>
<td>-</td>
</tr>
<tr>
<td>å¯ç”¨æ€§</td>
<td>99.9%</td>
<td>-</td>
</tr>
<tr>
<td>ã‚¨ãƒ©ãƒ¼ç‡</td>
<td>&lt; 0.1%</td>
<td>-</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§</td>
<td>100%</td>
<td>-</td>
</tr>
</tbody>
</table>
<h3 id="64">6.4 æˆæœç‰©<a class="headerlink" href="#64" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] å…¨ã‚µãƒ¼ãƒ“ã‚¹æœ€é©åŒ–å®Œäº†</li>
<li>[ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£æŸ»åˆæ ¼</li>
<li>[ ] è² è·ãƒ†ã‚¹ãƒˆåˆæ ¼</li>
<li>[ ] DRè¨“ç·´å®Œäº†</li>
<li>[ ] æ—§ãƒ¢ãƒãƒªã‚¹å»ƒæ­¢</li>
<li>[ ] é‹ç”¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå®Œæˆ</li>
</ul>
<hr />
<h2 id="7">7. ãƒªã‚¹ã‚¯ç®¡ç†<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ãƒªã‚¹ã‚¯ä¸€è¦§<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚¹ã‚¯</th>
<th>ç¢ºç‡</th>
<th>å½±éŸ¿</th>
<th>å¯¾ç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ©Ÿèƒ½é€€è¡Œ</td>
<td>é«˜</td>
<td>é«˜</td>
<td>åŒ…æ‹¬çš„ãƒ†ã‚¹ãƒˆã€æ®µéšçš„ç§»è¡Œ</td>
</tr>
<tr>
<td>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åŠ£åŒ–</td>
<td>ä¸­</td>
<td>é«˜</td>
<td>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ç¶™ç¶šã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥å°å…¥</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ</td>
<td>ä¸­</td>
<td>é«˜</td>
<td>ScalarDB TXã€ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãƒãƒƒãƒ</td>
</tr>
<tr>
<td>ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«é…å»¶</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>ãƒãƒƒãƒ•ã‚¡ç¢ºä¿ã€å„ªå…ˆé †ä½ä»˜ã‘</td>
</tr>
<tr>
<td>ãƒãƒ¼ãƒ ç¿’ç†Ÿåº¦</td>
<td>ä¸­</td>
<td>ä¸­</td>
<td>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã€ãƒšã‚¢ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯è¨ˆç”»<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<div class="mermaid">
stateDiagram-v2
    [*] --> NewService
    NewService --> Monitoring: Deploy
    Monitoring --> Stable: Health OK
    Monitoring --> Rollback: Error Rate > 5%
    Rollback --> OldService: Feature Flag
    OldService --> [*]
    Stable --> [*]
</div>

<hr />
<h2 id="8">8. ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<div class="mermaid">
gantt
    title ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹å¤‰æ›ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³
    dateFormat YYYY-MM
    section Phase 1
    ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰          :p1, 2025-01, 3M

    section Phase 2
    Identityåˆ†é›¢          :p2-1, after p1, 2M
    BOX Integrationåˆ†é›¢   :p2-2, after p1, 2M

    section Phase 3
    Fileåˆ†é›¢              :p3-1, after p2-1, 2M
    Eventåˆ†é›¢             :p3-2, after p2-1, 2M

    section Phase 4
    Auditåˆ†é›¢             :p4-1, after p3-1, 2M
    Verificationåˆ†é›¢      :p4-2, after p3-1, 1M

    section Phase 5
    æœ€é©åŒ–                :p5-1, after p4-1, 1M
    å®Œå…¨ç§»è¡Œ              :p5-2, after p5-1, 1M
</div>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: scalar-event-log-fetcher-main</em></p>
</article>
<article id="design-operations-plan">
<h1 id="_1">é‹ç”¨è¨ˆç”»æ›¸<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 é‹ç”¨ç›®æ¨™<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>ç›®æ¨™å€¤</th>
<th>æ¸¬å®šæ–¹æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å¯ç”¨æ€§</strong></td>
<td>99.9% (æœˆé–“43åˆ†ä»¥ä¸‹ã®ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ )</td>
<td>Prometheus/Grafana</td>
</tr>
<tr>
<td><strong>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P99</strong></td>
<td>&lt; 500ms</td>
<td>APM (Datadog/NewRelic)</td>
</tr>
<tr>
<td><strong>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</strong></td>
<td>&gt; 1000 TPS</td>
<td>Load Testing</td>
</tr>
<tr>
<td><strong>MTTR</strong></td>
<td>&lt; 30åˆ†</td>
<td>Incident Tracking</td>
</tr>
<tr>
<td><strong>ãƒ‡ãƒ—ãƒ­ã‚¤é »åº¦</strong></td>
<td>é€±1å›ä»¥ä¸Š</td>
<td>CI/CD Pipeline</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 é‹ç”¨ä½“åˆ¶<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "é‹ç”¨ãƒãƒ¼ãƒ "
        SRE[SRE Team<br/>2-3å]
        DEV[Development Team<br/>5-7å]
        SEC[Security Team<br/>1-2å]
    end

    subgraph "ã‚ªãƒ³ã‚³ãƒ¼ãƒ«"
        P1[Primary On-Call]
        S1[Secondary On-Call]
    end

    subgraph "ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"
        L1[L1: è‡ªå‹•å¯¾å¿œ]
        L2[L2: ã‚ªãƒ³ã‚³ãƒ¼ãƒ«å¯¾å¿œ]
        L3[L3: é–‹ç™ºãƒãƒ¼ãƒ å¯¾å¿œ]
    end

    SRE --> P1
    DEV --> S1
    L1 --> L2
    L2 --> L3
</div>

<hr />
<h2 id="2">2. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£é‹ç”¨<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-kubernetes">2.1 Kubernetes ã‚¯ãƒ©ã‚¹ã‚¿ç®¡ç†<a class="headerlink" href="#21-kubernetes" title="Permanent link">&para;</a></h3>
<h4 id="_2">ã‚¯ãƒ©ã‚¹ã‚¿æ§‹æˆ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-yaml"># æœ¬ç•ªç’°å¢ƒã‚¯ãƒ©ã‚¹ã‚¿æ§‹æˆ
production:
  control_plane:
    nodes: 3
    instance_type: m5.xlarge

  worker_pools:
    - name: general
      nodes: 3-10
      instance_type: m5.2xlarge
      autoscaling: true

    - name: scalardb
      nodes: 3
      instance_type: r5.2xlarge
      taints:
        - key: workload
          value: scalardb
          effect: NoSchedule

    - name: monitoring
      nodes: 2
      instance_type: m5.large
</code></pre>

<h4 id="_3">ãƒãƒ¼ãƒ‰ç®¡ç†æ‰‹é †<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-bash"># ãƒãƒ¼ãƒ‰ã®ãƒ‰ãƒ¬ã‚¤ãƒ³ï¼ˆãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å‰ï¼‰
kubectl drain &lt;node-name&gt; --ignore-daemonsets --delete-emptydir-data

# ãƒãƒ¼ãƒ‰ã®å¾©å¸°
kubectl uncordon &lt;node-name&gt;

# ãƒãƒ¼ãƒ‰ã®çŠ¶æ…‹ç¢ºèª
kubectl get nodes -o wide
kubectl describe node &lt;node-name&gt;
</code></pre>

<h3 id="22">2.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é‹ç”¨<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<h4 id="postgresql">PostgreSQLé‹ç”¨<a class="headerlink" href="#postgresql" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>é »åº¦</th>
<th>æ‹…å½“</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª</td>
<td>æ—¥æ¬¡</td>
<td>è‡ªå‹• + ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>VACUUM ANALYZE</td>
<td>é€±æ¬¡</td>
<td>è‡ªå‹•</td>
</tr>
<tr>
<td>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å†æ§‹ç¯‰</td>
<td>æœˆæ¬¡</td>
<td>æ‰‹å‹•</td>
</tr>
<tr>
<td>çµ±è¨ˆæƒ…å ±æ›´æ–°</td>
<td>æ—¥æ¬¡</td>
<td>è‡ªå‹•</td>
</tr>
<tr>
<td>ãƒ¬ãƒ—ãƒªã‚«é…å»¶ç›£è¦–</td>
<td>å¸¸æ™‚</td>
<td>è‡ªå‹•</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-sql">-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ã‚¯ã‚¨ãƒª
SELECT
    schemaname,
    relname,
    seq_scan,
    idx_scan,
    n_live_tup,
    n_dead_tup,
    last_vacuum,
    last_autovacuum
FROM pg_stat_user_tables
WHERE schemaname IN ('identity', 'audit', 'file')
ORDER BY n_dead_tup DESC;

-- é•·æ™‚é–“ã‚¯ã‚¨ãƒªã®æ¤œå‡º
SELECT
    pid,
    now() - pg_stat_activity.query_start AS duration,
    query,
    state
FROM pg_stat_activity
WHERE (now() - pg_stat_activity.query_start) &gt; interval '5 minutes';
</code></pre>

<h4 id="cassandra">Cassandraé‹ç”¨<a class="headerlink" href="#cassandra" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>é »åº¦</th>
<th>æ‹…å½“</th>
</tr>
</thead>
<tbody>
<tr>
<td>nodetool repair</td>
<td>é€±æ¬¡</td>
<td>è‡ªå‹•</td>
</tr>
<tr>
<td>Compactionç›£è¦–</td>
<td>å¸¸æ™‚</td>
<td>è‡ªå‹•</td>
</tr>
<tr>
<td>ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ</td>
<td>æ—¥æ¬¡</td>
<td>è‡ªå‹•</td>
</tr>
<tr>
<td>ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</td>
<td>é€±æ¬¡</td>
<td>è‡ªå‹•</td>
</tr>
</tbody>
</table>
<pre class="codehilite"><code class="language-bash"># ã‚¯ãƒ©ã‚¹ã‚¿çŠ¶æ…‹ç¢ºèª
nodetool status

# ãƒªãƒšã‚¢å®Ÿè¡Œ
nodetool repair -pr event

# CompactionçŠ¶æ…‹
nodetool compactionstats
</code></pre>

<hr />
<h2 id="3">3. ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­è¨ˆ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ç›£è¦–ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Application Layer"
        IS[Identity Service]
        AS[Audit Service]
        FS[File Service]
        ES[Event Service]
        VS[Verification Service]
    end

    subgraph "Observability Stack"
        PROM[Prometheus]
        GRAF[Grafana]
        LOKI[Loki]
        TEMPO[Tempo]
        ALERT[AlertManager]
    end

    subgraph "Notification"
        SLACK[Slack]
        PD[PagerDuty]
        EMAIL[Email]
    end

    IS -->|metrics| PROM
    AS -->|metrics| PROM
    FS -->|metrics| PROM
    ES -->|metrics| PROM
    VS -->|metrics| PROM

    IS -->|logs| LOKI
    AS -->|logs| LOKI
    FS -->|logs| LOKI
    ES -->|logs| LOKI
    VS -->|logs| LOKI

    IS -->|traces| TEMPO
    AS -->|traces| TEMPO
    FS -->|traces| TEMPO
    ES -->|traces| TEMPO
    VS -->|traces| TEMPO

    PROM --> GRAF
    LOKI --> GRAF
    TEMPO --> GRAF
    PROM --> ALERT

    ALERT --> SLACK
    ALERT --> PD
    ALERT --> EMAIL
</div>

<h3 id="32">3.2 ã‚¢ãƒ©ãƒ¼ãƒˆãƒ«ãƒ¼ãƒ«<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<h4 id="critical">Critical ã‚¢ãƒ©ãƒ¼ãƒˆ (å³æ™‚å¯¾å¿œ)<a class="headerlink" href="#critical" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-yaml">groups:
  - name: critical
    rules:
      - alert: ServiceDown
        expr: up{job=~&quot;identity-service|audit-service|file-service|event-service|verification-service&quot;} == 0
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: &quot;Service {{ $labels.job }} is down&quot;

      - alert: ScalarDBClusterUnhealthy
        expr: scalardb_cluster_healthy_nodes &lt; 2
        for: 1m
        labels:
          severity: critical
        annotations:
          summary: &quot;ScalarDB Cluster has less than 2 healthy nodes&quot;

      - alert: DatabaseConnectionExhausted
        expr: scalardb_jdbc_connection_pool_active / scalardb_jdbc_connection_pool_max &gt; 0.9
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: &quot;Database connection pool is nearly exhausted&quot;

      - alert: TransactionErrorRateHigh
        expr: rate(scalardb_transaction_errors_total[5m]) / rate(scalardb_transactions_total[5m]) &gt; 0.05
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: &quot;Transaction error rate exceeds 5%&quot;
</code></pre>

<h4 id="warning-1">Warning ã‚¢ãƒ©ãƒ¼ãƒˆ (1æ™‚é–“ä»¥å†…å¯¾å¿œ)<a class="headerlink" href="#warning-1" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-yaml">groups:
  - name: warning
    rules:
      - alert: HighLatency
        expr: histogram_quantile(0.99, rate(http_request_duration_seconds_bucket[5m])) &gt; 0.5
        for: 10m
        labels:
          severity: warning
        annotations:
          summary: &quot;P99 latency exceeds 500ms&quot;

      - alert: PodRestartLoop
        expr: increase(kube_pod_container_status_restarts_total[1h]) &gt; 3
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: &quot;Pod {{ $labels.pod }} is in restart loop&quot;

      - alert: DiskSpaceRunningLow
        expr: (node_filesystem_avail_bytes / node_filesystem_size_bytes) * 100 &lt; 20
        for: 30m
        labels:
          severity: warning
        annotations:
          summary: &quot;Disk space is below 20%&quot;
</code></pre>

<h3 id="33">3.3 ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<h4 id="_4">ã‚µãƒ¼ãƒ“ã‚¹æ¦‚è¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ãƒ‘ãƒãƒ«</th>
<th>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</th>
<th>é–¾å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆ</td>
<td><code>rate(http_requests_total[5m])</code></td>
<td>-</td>
</tr>
<tr>
<td>ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆ</td>
<td><code>rate(http_requests_total{status=~"5.."}[5m])</code></td>
<td>&lt; 1%</td>
</tr>
<tr>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P50/P99</td>
<td><code>histogram_quantile(0.99, ...)</code></td>
<td>&lt; 500ms</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹å¯ç”¨æ€§</td>
<td><code>avg(up{job="..."})</code></td>
<td>&gt; 99.9%</td>
</tr>
<tr>
<td>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³</td>
<td><code>scalardb_jdbc_connection_pool_active</code></td>
<td>&lt; 80%</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç®¡ç†<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆåˆ†é¡<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¬ãƒ™ãƒ«</th>
<th>å½±éŸ¿</th>
<th>å¯¾å¿œæ™‚é–“</th>
<th>ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>P1 (Critical)</strong></td>
<td>ã‚µãƒ¼ãƒ“ã‚¹å…¨åœæ­¢</td>
<td>15åˆ†ä»¥å†…</td>
<td>å³æ™‚ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td><strong>P2 (High)</strong></td>
<td>ä¸»è¦æ©Ÿèƒ½éšœå®³</td>
<td>30åˆ†ä»¥å†…</td>
<td>1æ™‚é–“å¾Œã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td><strong>P3 (Medium)</strong></td>
<td>ä¸€éƒ¨æ©Ÿèƒ½éšœå®³</td>
<td>4æ™‚é–“ä»¥å†…</td>
<td>ç¿Œå–¶æ¥­æ—¥</td>
</tr>
<tr>
<td><strong>P4 (Low)</strong></td>
<td>è»½å¾®ãªå•é¡Œ</td>
<td>ç¿Œå–¶æ¥­æ—¥</td>
<td>ãªã—</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<div class="mermaid">
stateDiagram-v2
    [*] --> Detected: ã‚¢ãƒ©ãƒ¼ãƒˆç™ºå ±
    Detected --> Triaged: å½±éŸ¿ç¯„å›²ç¢ºèª
    Triaged --> Investigating: èª¿æŸ»é–‹å§‹
    Investigating --> Identified: åŸå› ç‰¹å®š
    Identified --> Mitigating: ç·©å’Œæªç½®å®Ÿæ–½
    Mitigating --> Resolved: è§£æ±ºç¢ºèª
    Resolved --> PostMortem: æŒ¯ã‚Šè¿”ã‚Š
    PostMortem --> [*]: å®Œäº†

    Investigating --> Escalated: ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    Escalated --> Identified
</div>

<h3 id="43">4.3 ãƒ©ãƒ³ãƒ–ãƒƒã‚¯<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<h4 id="_5">ã‚µãƒ¼ãƒ“ã‚¹éšœå®³æ™‚ã®å¯¾å¿œ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-bash"># 1. PodçŠ¶æ…‹ç¢ºèª
kubectl get pods -n production -l app=&lt;service-name&gt;

# 2. ãƒ­ã‚°ç¢ºèª
kubectl logs -n production -l app=&lt;service-name&gt; --tail=100

# 3. ã‚¤ãƒ™ãƒ³ãƒˆç¢ºèª
kubectl get events -n production --sort-by='.lastTimestamp'

# 4. å¼·åˆ¶å†èµ·å‹•ï¼ˆå¿…è¦ãªå ´åˆï¼‰
kubectl rollout restart deployment/&lt;service-name&gt; -n production

# 5. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå¿…è¦ãªå ´åˆï¼‰
kubectl rollout undo deployment/&lt;service-name&gt; -n production
</code></pre>

<h4 id="scalardb">ScalarDBéšœå®³æ™‚ã®å¯¾å¿œ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-bash"># 1. ã‚¯ãƒ©ã‚¹ã‚¿çŠ¶æ…‹ç¢ºèª
kubectl get pods -n scalardb-system

# 2. CoordinatorçŠ¶æ…‹ç¢ºèª
kubectl exec -n scalardb-system scalardb-0 -- \
  curl -s http://localhost:8080/health

# 3. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°ç¢ºèª
kubectl logs -n scalardb-system scalardb-0 | grep -i &quot;transaction&quot;

# 4. å¼·åˆ¶ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå¿…è¦ãªå ´åˆï¼‰
# â€» å°‚é–€å®¶ã®åˆ¤æ–­ãŒå¿…è¦
</code></pre>

<h4 id="_6">ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹éšœå®³æ™‚ã®å¯¾å¿œ<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-bash"># PostgreSQL
# 1. æ¥ç¶šç¢ºèª
psql -h postgres-primary -U admin -c &quot;SELECT 1&quot;

# 2. ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çŠ¶æ…‹
psql -h postgres-primary -U admin -c &quot;SELECT * FROM pg_stat_replication&quot;

# 3. ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼å®Ÿè¡Œï¼ˆPatroniä½¿ç”¨æ™‚ï¼‰
patronictl -c /etc/patroni/patroni.yml failover

# Cassandra
# 1. ã‚¯ãƒ©ã‚¹ã‚¿çŠ¶æ…‹
nodetool status

# 2. ãƒãƒ¼ãƒ‰å†èµ·å‹•
sudo systemctl restart cassandra
</code></pre>

<hr />
<h2 id="5">5. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆé‹ç”¨<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆæˆ¦ç•¥<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "Blue-Green Deployment"
        LB[Load Balancer]
        BLUE[Blue Environment<br/>Current]
        GREEN[Green Environment<br/>New]
    end

    LB -->|100%| BLUE
    LB -.->|0%| GREEN

    subgraph "Canary Deployment"
        LB2[Load Balancer]
        STABLE[Stable<br/>90%]
        CANARY[Canary<br/>10%]
    end

    LB2 -->|90%| STABLE
    LB2 -->|10%| CANARY
</div>

<h3 id="52">5.2 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<h4 id="_7">ãƒ‡ãƒ—ãƒ­ã‚¤å‰<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<ul>
<li>[ ] å…¨ãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹</li>
<li>[ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†</li>
<li>[ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆå®Œäº†</li>
<li>[ ] DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†</li>
<li>[ ] ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †ç¢ºèª</li>
<li>[ ] å¤‰æ›´å†…å®¹ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–</li>
</ul>
<h4 id="_8">ãƒ‡ãƒ—ãƒ­ã‚¤ä¸­<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<ul>
<li>[ ] Canary ãƒ‡ãƒ—ãƒ­ã‚¤å®Ÿè¡Œ</li>
<li>[ ] ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ¼ãƒˆç›£è¦–</li>
<li>[ ] ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ç›£è¦–</li>
<li>[ ] ãƒ­ã‚°ç•°å¸¸ç¢ºèª</li>
<li>[ ] 10åˆ†é–“ã®å®‰å®šæ€§ç¢ºèª</li>
</ul>
<h4 id="_9">ãƒ‡ãƒ—ãƒ­ã‚¤å¾Œ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ul>
<li>[ ] ãƒ•ãƒ«ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆå®Œäº†</li>
<li>[ ] Smoke Testå®Ÿè¡Œ</li>
<li>[ ] ã‚¢ãƒ©ãƒ¼ãƒˆç¢ºèª</li>
<li>[ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°</li>
</ul>
<h3 id="53">5.3 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash"># 1. å³æ™‚ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆDeploymentï¼‰
kubectl rollout undo deployment/&lt;service-name&gt; -n production

# 2. ç‰¹å®šãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
kubectl rollout undo deployment/&lt;service-name&gt; -n production --to-revision=&lt;revision&gt;

# 3. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯çŠ¶æ…‹ç¢ºèª
kubectl rollout status deployment/&lt;service-name&gt; -n production

# 4. DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå¿…è¦ãªå ´åˆï¼‰
flyway -url=jdbc:postgresql://... -user=... -password=... undo
</code></pre>

<hr />
<h2 id="6-dr">6. ç½å®³å¾©æ—§è¨ˆç”» (DR)<a class="headerlink" href="#6-dr" title="Permanent link">&para;</a></h2>
<h3 id="61-dr">6.1 DRç›®æ¨™<a class="headerlink" href="#61-dr" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>ç›®æ¨™å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>RTO</strong> (Recovery Time Objective)</td>
<td>1æ™‚é–“</td>
</tr>
<tr>
<td><strong>RPO</strong> (Recovery Point Objective)</td>
<td>5åˆ†</td>
</tr>
</tbody>
</table>
<h3 id="62">6.2 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Primary Region (ap-northeast-1)"
        PG_P[(PostgreSQL<br/>Primary)]
        CS_P[(Cassandra<br/>Cluster)]
        S3_P[S3 Backup]
    end

    subgraph "DR Region (ap-northeast-3)"
        PG_DR[(PostgreSQL<br/>Standby)]
        CS_DR[(Cassandra<br/>Replica)]
        S3_DR[S3 Replica]
    end

    PG_P -->|Streaming Replication| PG_DR
    CS_P -->|Multi-DC Replication| CS_DR
    S3_P -->|Cross-Region Replication| S3_DR
</div>

<h3 id="63">6.3 å¾©æ—§æ‰‹é †<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<h4 id="_10">ãƒªãƒ¼ã‚¸ãƒ§ãƒ³éšœå®³æ™‚<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-bash"># 1. DRãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¸ã®DNSåˆ‡ã‚Šæ›¿ãˆ
aws route53 change-resource-record-sets \
  --hosted-zone-id $ZONE_ID \
  --change-batch file://dr-dns-switch.json

# 2. PostgreSQL ã‚¹ã‚¿ãƒ³ãƒã‚¤æ˜‡æ ¼
patronictl -c /etc/patroni/patroni.yml switchover --master &lt;dr-node&gt;

# 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ¥ç¶šå…ˆæ›´æ–°
kubectl set env deployment/identity-service \
  DATABASE_URL=jdbc:postgresql://dr-postgres:5432/scalardb

# 4. å‹•ä½œç¢ºèª
curl https://api.dr.example.com/health
</code></pre>

<hr />
<h2 id="7">7. å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>é »åº¦</th>
<th>æ‰€è¦æ™‚é–“</th>
<th>ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒé©ç”¨</td>
<td>æœˆæ¬¡</td>
<td>2æ™‚é–“</td>
<td>ãªã— (ãƒ­ãƒ¼ãƒªãƒ³ã‚°)</td>
</tr>
<tr>
<td>Kubernetesã‚¢ãƒƒãƒ—ã‚°ãƒ¬ãƒ¼ãƒ‰</td>
<td>å››åŠæœŸ</td>
<td>4æ™‚é–“</td>
<td>ãªã— (ãƒ­ãƒ¼ãƒªãƒ³ã‚°)</td>
</tr>
<tr>
<td>DBãƒã‚­ãƒ¥ãƒ¼ãƒ </td>
<td>é€±æ¬¡</td>
<td>1æ™‚é–“</td>
<td>ãªã—</td>
</tr>
<tr>
<td>è¨¼æ˜æ›¸æ›´æ–°</td>
<td>å¹´æ¬¡</td>
<td>1æ™‚é–“</td>
<td>ãªã—</td>
</tr>
<tr>
<td>è² è·ãƒ†ã‚¹ãƒˆ</td>
<td>å››åŠæœŸ</td>
<td>4æ™‚é–“</td>
<td>ãªã— (ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°)</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</strong>: æ¯æœˆç¬¬3æ—¥æ›œæ—¥ 02:00-06:00 JST</li>
<li><strong>ç·Šæ€¥ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</strong>: éšæ™‚ï¼ˆäº‹å‰é€šçŸ¥24æ™‚é–“å‰ï¼‰</li>
</ul>
<h3 id="73">7.3 ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é€šçŸ¥ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-markdown">## ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹é€šçŸ¥

**æ—¥æ™‚**: 2025-XX-XX 02:00 - 06:00 (JST)
**å¯¾è±¡**: Scalar Auditor for BOX
**å½±éŸ¿**: ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®å½±éŸ¿ãªã—ï¼ˆãƒ­ãƒ¼ãƒªãƒ³ã‚°ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆï¼‰

### ä½œæ¥­å†…å®¹
- Kubernetesãƒãƒ¼ãƒ‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒé©ç”¨
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

### å•ã„åˆã‚ã›å…ˆ
- Slack: #scalar-auditor-support
- Email: support@example.com
</code></pre>

<hr />
<h2 id="8">8. å®¹é‡è¨ˆç”»<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡äºˆæ¸¬<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ç¾åœ¨</th>
<th>6ãƒ¶æœˆå¾Œ</th>
<th>12ãƒ¶æœˆå¾Œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>CPU</td>
<td>40%</td>
<td>55%</td>
<td>70%</td>
</tr>
<tr>
<td>Memory</td>
<td>50%</td>
<td>65%</td>
<td>80%</td>
</tr>
<tr>
<td>Storage (PostgreSQL)</td>
<td>100GB</td>
<td>200GB</td>
<td>400GB</td>
</tr>
<tr>
<td>Storage (Cassandra)</td>
<td>500GB</td>
<td>1TB</td>
<td>2TB</td>
</tr>
</tbody>
</table>
<h3 id="82">8.2 ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ãƒˆãƒªã‚¬ãƒ¼<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># HPAè¨­å®š
apiVersion: autoscaling/v2
kind: HorizontalPodAutoscaler
metadata:
  name: identity-service-hpa
spec:
  scaleTargetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: identity-service
  minReplicas: 3
  maxReplicas: 10
  metrics:
    - type: Resource
      resource:
        name: cpu
        target:
          type: Utilization
          averageUtilization: 70
    - type: Resource
      resource:
        name: memory
        target:
          type: Utilization
          averageUtilization: 80
</code></pre>

<hr />
<h2 id="9">9. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‹ç”¨<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç›£è¦–é …ç›®</th>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>é »åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³</td>
<td>Trivy</td>
<td>ãƒ‡ãƒ—ãƒ­ã‚¤æ¯</td>
</tr>
<tr>
<td>ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>Falco</td>
<td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </td>
</tr>
<tr>
<td>ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç›£æŸ»</td>
<td>Vault Audit</td>
<td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </td>
</tr>
<tr>
<td>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒãƒªã‚·ãƒ¼</td>
<td>Cilium</td>
<td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ </td>
</tr>
</tbody>
</table>
<h3 id="92">9.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œ<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TD
    A[ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒ©ãƒ¼ãƒˆ] --> B{é‡è¦åº¦åˆ¤å®š}
    B -->|Critical| C[å³æ™‚éš”é›¢]
    B -->|High| D[èª¿æŸ»é–‹å§‹]
    B -->|Medium/Low| E[ãƒã‚±ãƒƒãƒˆèµ·ç¥¨]

    C --> F[ãƒ•ã‚©ãƒ¬ãƒ³ã‚¸ãƒƒã‚¯]
    D --> F
    F --> G[æ ¹æœ¬åŸå› åˆ†æ]
    G --> H[æ˜¯æ­£æªç½®]
    H --> I[å ±å‘Šæ›¸ä½œæˆ]
</div>

<hr />
<h2 id="10-slaslo">10. SLA/SLOç®¡ç†<a class="headerlink" href="#10-slaslo" title="Permanent link">&para;</a></h2>
<h3 id="101-slo">10.1 SLOå®šç¾©<a class="headerlink" href="#101-slo" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>SLI</th>
<th>SLO</th>
<th>Error Budget</th>
</tr>
</thead>
<tbody>
<tr>
<td>Identity Service</td>
<td>å¯ç”¨æ€§</td>
<td>99.9%</td>
<td>43åˆ†/æœˆ</td>
</tr>
<tr>
<td>Audit Service</td>
<td>å¯ç”¨æ€§</td>
<td>99.95%</td>
<td>21åˆ†/æœˆ</td>
</tr>
<tr>
<td>Verification Service</td>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P99</td>
<td>&lt; 1ç§’</td>
<td>-</td>
</tr>
<tr>
<td>Event Service</td>
<td>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</td>
<td>&gt; 500 TPS</td>
<td>-</td>
</tr>
</tbody>
</table>
<h3 id="102-error-budget">10.2 Error Budget ãƒãƒªã‚·ãƒ¼<a class="headerlink" href="#102-error-budget" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>Error Budgetæ®‹é‡ &gt; 50%: é€šå¸¸é–‹ç™º
Error Budgetæ®‹é‡ 20-50%: æ–°æ©Ÿèƒ½å‡çµã€ä¿¡é ¼æ€§æ”¹å–„å„ªå…ˆ
Error Budgetæ®‹é‡ &lt; 20%: ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆå¯¾å¿œã®ã¿
Error Budgetæ¯æ¸‡: ã‚µãƒ¼ãƒ“ã‚¹å‡çµã€å…¨ãƒªã‚½ãƒ¼ã‚¹æŠ•å…¥
</code></pre>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Version: 1.0.0</em>
<em>Source: Scalar Auditor for BOX - Microservices Design</em></p>
</article>
<article id="design-api-design-overview">
<h1 id="api">APIè¨­è¨ˆæ¦‚è¦<a class="headerlink" href="#api" title="Permanent link">&para;</a></h1>
<h2 id="1-api">1. APIè¨­è¨ˆæ–¹é‡<a class="headerlink" href="#1-api" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 è¨­è¨ˆåŸå‰‡<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>åŸå‰‡</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>RESTæº–æ‹ </td>
<td>RESTful APIè¨­è¨ˆåŸå‰‡ã«å¾“ã†</td>
</tr>
<tr>
<td>API First</td>
<td>OpenAPIä»•æ§˜ã‚’å…ˆè¡Œã—ã¦è¨­è¨ˆ</td>
</tr>
<tr>
<td>ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°</td>
<td>URLãƒ‘ã‚¹ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ï¼ˆ/api/v1/ï¼‰</td>
</tr>
<tr>
<td>ä¸€è²«æ€§</td>
<td>å‘½åè¦å‰‡ã€ã‚¨ãƒ©ãƒ¼å½¢å¼ã®çµ±ä¸€</td>
</tr>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</td>
<td>OAuth 2.0 + JWTèªè¨¼</td>
</tr>
</tbody>
</table>
<h3 id="12-api">1.2 APIã‚¿ã‚¤ãƒ—åˆ¥æ¡ç”¨åŸºæº–<a class="headerlink" href="#12-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¤ãƒ—</th>
<th>ç”¨é€”</th>
<th>æ¡ç”¨ã‚µãƒ¼ãƒ“ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>REST</td>
<td>å¤–éƒ¨å…¬é–‹APIã€CRUDæ“ä½œ</td>
<td>å…¨ã‚µãƒ¼ãƒ“ã‚¹</td>
</tr>
<tr>
<td>gRPC</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹é–“é«˜é€Ÿé€šä¿¡</td>
<td>Verification â†” ScalarDL</td>
</tr>
<tr>
<td>AsyncAPI</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•é€šä¿¡</td>
<td>Event Service</td>
</tr>
<tr>
<td>GraphQL</td>
<td>å°†æ¥æ¤œè¨ï¼ˆè¤‡é›‘ãªã‚¯ã‚¨ãƒªï¼‰</td>
<td>-</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-rest-api">2. REST APIè¨­è¨ˆè¦ç´„<a class="headerlink" href="#2-rest-api" title="Permanent link">&para;</a></h2>
<h3 id="21-url">2.1 URLè¨­è¨ˆ<a class="headerlink" href="#21-url" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>https://api.scalar-auditor.example.com/api/v1/{resource}

ä¾‹:
GET  /api/v1/audit-sets
POST /api/v1/audit-sets
GET  /api/v1/audit-sets/{id}
PUT  /api/v1/audit-sets/{id}
DELETE /api/v1/audit-sets/{id}
GET  /api/v1/audit-sets/{id}/items
POST /api/v1/audit-sets/{id}/items
</code></pre>

<h3 id="22-http">2.2 HTTPãƒ¡ã‚½ãƒƒãƒ‰<a class="headerlink" href="#22-http" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>ç”¨é€”</th>
<th>å†ªç­‰æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>ãƒªã‚½ãƒ¼ã‚¹å–å¾—</td>
<td>âœ“</td>
</tr>
<tr>
<td>POST</td>
<td>ãƒªã‚½ãƒ¼ã‚¹ä½œæˆ</td>
<td>âœ—</td>
</tr>
<tr>
<td>PUT</td>
<td>ãƒªã‚½ãƒ¼ã‚¹å…¨ä½“æ›´æ–°</td>
<td>âœ“</td>
</tr>
<tr>
<td>PATCH</td>
<td>ãƒªã‚½ãƒ¼ã‚¹éƒ¨åˆ†æ›´æ–°</td>
<td>âœ—</td>
</tr>
<tr>
<td>DELETE</td>
<td>ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤</td>
<td>âœ“</td>
</tr>
</tbody>
</table>
<h3 id="23-http">2.3 HTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰<a class="headerlink" href="#23-http" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚³ãƒ¼ãƒ‰</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>200</td>
<td>æˆåŠŸï¼ˆãƒ‡ãƒ¼ã‚¿ã‚ã‚Šï¼‰</td>
</tr>
<tr>
<td>201</td>
<td>ä½œæˆæˆåŠŸ</td>
</tr>
<tr>
<td>204</td>
<td>æˆåŠŸï¼ˆãƒ‡ãƒ¼ã‚¿ãªã—ï¼‰</td>
</tr>
<tr>
<td>400</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆä¸æ­£</td>
</tr>
<tr>
<td>401</td>
<td>èªè¨¼ã‚¨ãƒ©ãƒ¼</td>
</tr>
<tr>
<td>403</td>
<td>èªå¯ã‚¨ãƒ©ãƒ¼</td>
</tr>
<tr>
<td>404</td>
<td>ãƒªã‚½ãƒ¼ã‚¹æœªç™ºè¦‹</td>
</tr>
<tr>
<td>409</td>
<td>ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆ</td>
</tr>
<tr>
<td>422</td>
<td>ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼</td>
</tr>
<tr>
<td>500</td>
<td>ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼</td>
</tr>
<tr>
<td>503</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä¸å¯</td>
</tr>
</tbody>
</table>
<h3 id="24">2.4 ãƒ¬ã‚¹ãƒãƒ³ã‚¹å½¢å¼<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<p><strong>æˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹</strong>:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: {
    &quot;id&quot;: &quot;audit-set-123&quot;,
    &quot;name&quot;: &quot;2024 Financial Audit&quot;,
    &quot;description&quot;: &quot;Annual financial document audit&quot;,
    &quot;owner&quot;: {
      &quot;id&quot;: &quot;user-456&quot;,
      &quot;email&quot;: &quot;admin@example.com&quot;
    },
    &quot;createdAt&quot;: &quot;2024-01-15T10:30:00Z&quot;,
    &quot;updatedAt&quot;: &quot;2024-01-15T10:30:00Z&quot;
  },
  &quot;meta&quot;: {
    &quot;requestId&quot;: &quot;req-abc-123&quot;
  }
}
</code></pre>

<p><strong>ä¸€è¦§ãƒ¬ã‚¹ãƒãƒ³ã‚¹</strong>:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;data&quot;: [
    { &quot;id&quot;: &quot;audit-set-1&quot;, &quot;name&quot;: &quot;Audit Set 1&quot; },
    { &quot;id&quot;: &quot;audit-set-2&quot;, &quot;name&quot;: &quot;Audit Set 2&quot; }
  ],
  &quot;meta&quot;: {
    &quot;requestId&quot;: &quot;req-abc-123&quot;,
    &quot;pagination&quot;: {
      &quot;page&quot;: 1,
      &quot;limit&quot;: 20,
      &quot;total&quot;: 45,
      &quot;totalPages&quot;: 3
    }
  }
}
</code></pre>

<p><strong>ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹</strong>:</p>
<pre class="codehilite"><code class="language-json">{
  &quot;error&quot;: {
    &quot;code&quot;: &quot;VALIDATION_ERROR&quot;,
    &quot;message&quot;: &quot;Request validation failed&quot;,
    &quot;details&quot;: [
      {
        &quot;field&quot;: &quot;name&quot;,
        &quot;message&quot;: &quot;Name is required&quot;
      }
    ]
  },
  &quot;meta&quot;: {
    &quot;requestId&quot;: &quot;req-abc-123&quot;
  }
}
</code></pre>

<hr />
<h2 id="3-api">3. ã‚µãƒ¼ãƒ“ã‚¹åˆ¥APIæ¦‚è¦<a class="headerlink" href="#3-api" title="Permanent link">&para;</a></h2>
<h3 id="31-audit-management-service-api">3.1 Audit Management Service API<a class="headerlink" href="#31-audit-management-service-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/audit-sets</td>
<td>GET</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/audit-sets</td>
<td>POST</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}</td>
<td>GET</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆè©³ç´°</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}</td>
<td>PUT</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–°</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}</td>
<td>DELETE</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/items</td>
<td>GET</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/items</td>
<td>POST</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ </td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/items/{itemId}</td>
<td>DELETE</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/collaborators</td>
<td>GET</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/collaborators</td>
<td>POST</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼è¿½åŠ </td>
</tr>
<tr>
<td>/api/v1/audit-groups</td>
<td>GET</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/audit-groups</td>
<td>POST</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ</td>
</tr>
<tr>
<td>/api/v1/audit-groups/{id}</td>
<td>PUT</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—æ›´æ–°</td>
</tr>
<tr>
<td>/api/v1/audit-groups/{id}</td>
<td>DELETE</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—å‰Šé™¤</td>
</tr>
</tbody>
</table>
<h3 id="32-verification-service-api">3.2 Verification Service API<a class="headerlink" href="#32-verification-service-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/items/{id}/validate</td>
<td>POST</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æ¤œè¨¼å®Ÿè¡Œ</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/validate</td>
<td>POST</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå…¨ä½“æ¤œè¨¼</td>
</tr>
<tr>
<td>/api/v1/items/{id}/status</td>
<td>GET</td>
<td>æ”¹ã–ã‚“ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—</td>
</tr>
<tr>
<td>/api/v1/items/{id}/register</td>
<td>POST</td>
<td>ç›£è¦–å¯¾è±¡ã¨ã—ã¦ç™»éŒ²</td>
</tr>
</tbody>
</table>
<h3 id="33-event-service-api">3.3 Event Service API<a class="headerlink" href="#33-event-service-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/events</td>
<td>GET</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ä»˜ãï¼‰</td>
</tr>
<tr>
<td>/api/v1/items/{id}/events</td>
<td>GET</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>/api/v1/audit-sets/{id}/events</td>
<td>GET</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆåˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
</tr>
<tr>
<td>/api/v1/auditor-logs</td>
<td>GET</td>
<td>ç›£æŸ»äººãƒ­ã‚°</td>
</tr>
</tbody>
</table>
<h3 id="34-item-service-api">3.4 Item Service API<a class="headerlink" href="#34-item-service-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/items/{id}</td>
<td>GET</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ è©³ç´°</td>
</tr>
<tr>
<td>/api/v1/files/{id}/versions</td>
<td>GET</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/files/by-sha1/{sha1}</td>
<td>GET</td>
<td>SHA1ãƒãƒƒã‚·ãƒ¥ã§ã‚³ãƒ”ãƒ¼æ¤œç´¢</td>
</tr>
<tr>
<td>/api/v1/folders/{id}/children</td>
<td>GET</td>
<td>ãƒ•ã‚©ãƒ«ãƒ€å†…å®¹</td>
</tr>
</tbody>
</table>
<h3 id="35-identity-service-api">3.5 Identity Service API<a class="headerlink" href="#35-identity-service-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>ãƒ¡ã‚½ãƒƒãƒ‰</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>/api/v1/auth/login</td>
<td>POST</td>
<td>ãƒ­ã‚°ã‚¤ãƒ³</td>
</tr>
<tr>
<td>/api/v1/auth/logout</td>
<td>POST</td>
<td>ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</td>
</tr>
<tr>
<td>/api/v1/auth/refresh</td>
<td>POST</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°</td>
</tr>
<tr>
<td>/api/v1/auth/box/callback</td>
<td>GET</td>
<td>BOX OAuthã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯</td>
</tr>
<tr>
<td>/api/v1/users</td>
<td>GET</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§</td>
</tr>
<tr>
<td>/api/v1/users</td>
<td>POST</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ</td>
</tr>
<tr>
<td>/api/v1/users/{id}</td>
<td>GET</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°</td>
</tr>
<tr>
<td>/api/v1/users/{id}</td>
<td>PUT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°</td>
</tr>
<tr>
<td>/api/v1/users/{id}/roles</td>
<td>PUT</td>
<td>ãƒ­ãƒ¼ãƒ«æ›´æ–°</td>
</tr>
<tr>
<td>/api/v1/users/password/reset</td>
<td>POST</td>
<td>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ</td>
</tr>
<tr>
<td>/api/v1/users/password/otp</td>
<td>POST</td>
<td>OTPé€ä¿¡</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. å…±é€šæ©Ÿèƒ½<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>GET /api/v1/audit-sets?page=2&amp;limit=20&amp;sort=createdAt:desc
</code></pre>

<p>ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:
| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
|-----------|------|-----------|
| page | ãƒšãƒ¼ã‚¸ç•ªå·ï¼ˆ1å§‹ã¾ã‚Šï¼‰ | 1 |
| limit | 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šä»¶æ•° | 20 |
| sort | ã‚½ãƒ¼ãƒˆé †ï¼ˆfield:asc/descï¼‰ | createdAt:desc |</p>
<h3 id="42">4.2 ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>GET /api/v1/events?startDate=2024-01-01&amp;endDate=2024-01-31&amp;eventType=ITEM_UPLOAD
</code></pre>

<h3 id="43">4.3 éƒ¨åˆ†ãƒ¬ã‚¹ãƒãƒ³ã‚¹<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>GET /api/v1/audit-sets/{id}?fields=id,name,owner
</code></pre>

<h3 id="44">4.4 ãƒªã‚½ãƒ¼ã‚¹å±•é–‹<a class="headerlink" href="#44" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>GET /api/v1/audit-sets/{id}?expand=owner,items
</code></pre>

<hr />
<h2 id="5-api">5. APIä»•æ§˜æ›¸<a class="headerlink" href="#5-api" title="Permanent link">&para;</a></h2>
<p>è©³ç´°ãªOpenAPIä»•æ§˜æ›¸ã¯ä»¥ä¸‹ã«æ ¼ç´:</p>
<ul>
<li><code>api-specifications/audit-management-api.yaml</code></li>
<li><code>api-specifications/verification-api.yaml</code></li>
<li><code>api-specifications/event-api.yaml</code></li>
<li><code>api-specifications/item-api.yaml</code></li>
<li><code>api-specifications/identity-api.yaml</code></li>
</ul>
<hr />
<h2 id="6">6. æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>API Gatewayè¨­è¨ˆ</strong> - ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€CORSè¨­å®š</li>
<li><strong>API Securityè¨­è¨ˆ</strong> - OAuth 2.0ã€JWTã€RBAC</li>
<li><strong>OpenAPIä»•æ§˜æ›¸</strong> - å„ã‚µãƒ¼ãƒ“ã‚¹ã®è©³ç´°APIå®šç¾©</li>
</ol>
</article>
<article id="design-api-gateway-design">
<h1 id="api-gateway">API Gatewayè¨­è¨ˆ<a class="headerlink" href="#api-gateway" title="Permanent link">&para;</a></h1>
<h2 id="1-api-gateway">1. API Gatewayæ¦‚è¦<a class="headerlink" href="#1-api-gateway" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 å½¹å‰²<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "Clients"
        WEB[Web App]
        BOX[BOX Integration]
        EXT[External Clients]
    end

    subgraph "API Gateway"
        AUTH[èªè¨¼/èªå¯]
        RATE[ãƒ¬ãƒ¼ãƒˆåˆ¶é™]
        ROUTE[ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°]
        CORS[CORS]
        LOG[ãƒ­ã‚®ãƒ³ã‚°]
    end

    subgraph "Services"
        AMS[Audit Management]
        VS[Verification]
        ES[Event]
        IS[Item]
        IDS[Identity]
    end

    WEB --> AUTH
    BOX --> AUTH
    EXT --> AUTH
    AUTH --> RATE
    RATE --> ROUTE
    ROUTE --> CORS
    CORS --> LOG
    LOG --> AMS
    LOG --> VS
    LOG --> ES
    LOG --> IS
    LOG --> IDS
</div>

<h3 id="12">1.2 æŠ€è¡“é¸å®š<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</th>
<th>ç‰¹å¾´</th>
<th>æ¨å¥¨åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kong</td>
<td>OSSã€è±Šå¯Œãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€Kuberneteså¯¾å¿œ</td>
<td>â˜…â˜…â˜…</td>
</tr>
<tr>
<td>AWS API Gateway</td>
<td>ãƒãƒãƒ¼ã‚¸ãƒ‰ã€Lambdaçµ±åˆã€é«˜ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£</td>
<td>â˜…â˜…â˜…</td>
</tr>
<tr>
<td>NGINX</td>
<td>è»½é‡ã€é«˜æ€§èƒ½ã€è¨­å®šæŸ”è»Ÿ</td>
<td>â˜…â˜…â˜†</td>
</tr>
<tr>
<td>Istio Gateway</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹ãƒ¡ãƒƒã‚·ãƒ¥çµ±åˆ</td>
<td>â˜…â˜…â˜†</td>
</tr>
</tbody>
</table>
<p><strong>æ¨å¥¨</strong>: Kong ã¾ãŸã¯ AWS API Gateway</p>
<hr />
<h2 id="2">2. ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­è¨ˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ãƒ‘ã‚¹ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">routes:
  # Audit Management Service
  - name: audit-management
    paths:
      - /api/v1/audit-sets
      - /api/v1/audit-groups
    service: audit-management-service
    strip_path: false

  # Verification Service
  - name: verification
    paths:
      - /api/v1/items/*/validate
      - /api/v1/items/*/status
      - /api/v1/items/*/register
    service: verification-service
    strip_path: false

  # Event Service
  - name: event
    paths:
      - /api/v1/events
      - /api/v1/auditor-logs
    service: event-service
    strip_path: false

  # Item Service
  - name: item
    paths:
      - /api/v1/items
      - /api/v1/files
      - /api/v1/folders
    service: item-service
    strip_path: false

  # Identity Service
  - name: identity
    paths:
      - /api/v1/auth
      - /api/v1/users
    service: identity-service
    strip_path: false
</code></pre>

<h3 id="22">2.2 ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ è¨­å®š<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">upstreams:
  - name: audit-management-service
    targets:
      - target: audit-management.default.svc.cluster.local:8080
        weight: 100
    healthchecks:
      active:
        http_path: /health
        interval: 10

  - name: verification-service
    targets:
      - target: verification.default.svc.cluster.local:8080
        weight: 100

  - name: event-service
    targets:
      - target: event.default.svc.cluster.local:8080
        weight: 100

  - name: item-service
    targets:
      - target: item.default.svc.cluster.local:8080
        weight: 100

  - name: identity-service
    targets:
      - target: identity.default.svc.cluster.local:8080
        weight: 100
</code></pre>

<hr />
<h2 id="3">3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒãƒªã‚·ãƒ¼<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¿ã‚¤ãƒ—</th>
<th>åˆ¶é™</th>
<th>å˜ä½</th>
</tr>
</thead>
<tbody>
<tr>
<td>èªè¨¼æ¸ˆã¿ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>1000</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>500</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†</td>
</tr>
<tr>
<td>æœªèªè¨¼</td>
<td>60</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†</td>
</tr>
<tr>
<td>BOXçµ±åˆ</td>
<td>2000</td>
<td>ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†</td>
</tr>
</tbody>
</table>
<h3 id="32-kong-rate-limiting">3.2 Kong Rate Limitingè¨­å®š<a class="headerlink" href="#32-kong-rate-limiting" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: rate-limiting
    config:
      minute: 1000
      policy: cluster
      fault_tolerant: true
      hide_client_headers: false
      redis_host: redis.default.svc.cluster.local
      redis_port: 6379
</code></pre>

<h3 id="33">3.3 ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆåˆ¥åˆ¶é™<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># é«˜è² è·APIç”¨ã®è¿½åŠ åˆ¶é™
plugins:
  - name: rate-limiting
    route: verification
    config:
      minute: 100  # æ¤œè¨¼ã¯å‡¦ç†ãŒé‡ã„ãŸã‚åˆ¶é™

  - name: rate-limiting
    route: event
    config:
      minute: 500  # ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ã¯ä¸­ç¨‹åº¦
</code></pre>

<hr />
<h2 id="4-cors">4. CORSè¨­å®š<a class="headerlink" href="#4-cors" title="Permanent link">&para;</a></h2>
<h3 id="41-cors">4.1 CORS ãƒãƒªã‚·ãƒ¼<a class="headerlink" href="#41-cors" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: cors
    config:
      origins:
        - https://app.scalar-auditor.example.com
        - https://box-integration.example.com
      methods:
        - GET
        - POST
        - PUT
        - PATCH
        - DELETE
        - OPTIONS
      headers:
        - Accept
        - Authorization
        - Content-Type
        - X-Request-ID
      exposed_headers:
        - X-Request-ID
        - X-RateLimit-Remaining
      credentials: true
      max_age: 3600
      preflight_continue: false
</code></pre>

<h3 id="42">4.2 ç’°å¢ƒåˆ¥è¨­å®š<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>è¨±å¯ã‚ªãƒªã‚¸ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>localhost:<em>, </em>.dev.example.com</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>*.staging.example.com</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>app.scalar-auditor.example.com</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. èªè¨¼ãƒ»èªå¯<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-jwt">5.1 JWTæ¤œè¨¼<a class="headerlink" href="#51-jwt" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: jwt
    config:
      uri_param_names:
        - jwt
      cookie_names:
        - token
      header_names:
        - authorization
      claims_to_verify:
        - exp
      secret_is_base64: false
</code></pre>

<h3 id="52">5.2 èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ãƒ«ãƒ¼ãƒˆ<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># èªè¨¼ä¸è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
routes:
  - name: auth-public
    paths:
      - /api/v1/auth/login
      - /api/v1/auth/box/callback
      - /api/v1/users/password/reset
      - /api/v1/users/password/otp
      - /health
      - /api-docs
    plugins: []  # èªè¨¼ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãªã—
</code></pre>

<hr />
<h2 id="6">6. ãƒªã‚¯ã‚¨ã‚¹ãƒˆå¤‰æ›<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ <a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: request-transformer
    config:
      add:
        headers:
          - X-Gateway-Timestamp:$(date)
          - X-Forwarded-Service:scalar-auditor
</code></pre>

<h3 id="62">6.2 ãƒ¬ã‚¹ãƒãƒ³ã‚¹å¤‰æ›<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: response-transformer
    config:
      add:
        headers:
          - X-Request-ID:$(ctx.request_id)
          - X-Response-Time:$(latency)
</code></pre>

<hr />
<h2 id="7">7. ãƒ­ã‚®ãƒ³ã‚°ãƒ»ç›£è¦–<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: file-log
    config:
      path: /var/log/kong/access.log
      reopen: true

  - name: tcp-log
    config:
      host: logstash.monitoring.svc.cluster.local
      port: 5000
      tls: true
</code></pre>

<h3 id="72">7.2 ãƒ­ã‚°å½¢å¼<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;timestamp&quot;: &quot;2024-01-15T10:30:00.000Z&quot;,
  &quot;request&quot;: {
    &quot;id&quot;: &quot;req-abc-123&quot;,
    &quot;method&quot;: &quot;GET&quot;,
    &quot;uri&quot;: &quot;/api/v1/audit-sets&quot;,
    &quot;size&quot;: 0,
    &quot;headers&quot;: {
      &quot;authorization&quot;: &quot;[REDACTED]&quot;,
      &quot;user-agent&quot;: &quot;Mozilla/5.0...&quot;
    }
  },
  &quot;response&quot;: {
    &quot;status&quot;: 200,
    &quot;size&quot;: 1234,
    &quot;latencies&quot;: {
      &quot;kong&quot;: 2,
      &quot;proxy&quot;: 45,
      &quot;request&quot;: 47
    }
  },
  &quot;client&quot;: {
    &quot;ip&quot;: &quot;192.168.1.100&quot;
  },
  &quot;route&quot;: {
    &quot;name&quot;: &quot;audit-management&quot;
  },
  &quot;service&quot;: {
    &quot;name&quot;: &quot;audit-management-service&quot;
  },
  &quot;authenticated_entity&quot;: {
    &quot;id&quot;: &quot;user-456&quot;
  }
}
</code></pre>

<h3 id="73">7.3 ãƒ¡ãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: prometheus
    config:
      per_consumer: true
      status_code_metrics: true
      latency_metrics: true
      bandwidth_metrics: true
      upstream_health_metrics: true
</code></pre>

<hr />
<h2 id="8">8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: request-termination
    route: maintenance
    config:
      status_code: 503
      message: &quot;Service is under maintenance&quot;
      content_type: &quot;application/json&quot;
      body: |
        {
          &quot;error&quot;: {
            &quot;code&quot;: &quot;SERVICE_MAINTENANCE&quot;,
            &quot;message&quot;: &quot;The service is temporarily unavailable&quot;
          }
        }
</code></pre>

<h3 id="82">8.2 ã‚µãƒ¼ã‚­ãƒƒãƒˆãƒ–ãƒ¬ãƒ¼ã‚«ãƒ¼<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">upstreams:
  - name: audit-management-service
    healthchecks:
      active:
        healthy:
          interval: 5
          successes: 2
        unhealthy:
          interval: 5
          http_failures: 3
    circuit_breaker:
      threshold: 50
      timeout: 30
</code></pre>

<hr />
<h2 id="9">9. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91-ipapi">9.1 IPåˆ¶é™ï¼ˆç®¡ç†APIç”¨ï¼‰<a class="headerlink" href="#91-ipapi" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: ip-restriction
    route: admin
    config:
      allow:
        - 10.0.0.0/8
        - 192.168.1.0/24
</code></pre>

<h3 id="92-bot">9.2 Botæ¤œå‡º<a class="headerlink" href="#92-bot" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: bot-detection
    config:
      allow:
        - googlebot
        - bingbot
      deny:
        - curl
        - wget
</code></pre>

<h3 id="93">9.3 ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚µã‚¤ã‚ºåˆ¶é™<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">plugins:
  - name: request-size-limiting
    config:
      allowed_payload_size: 10  # MB
</code></pre>

<hr />
<h2 id="10">10. ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="101-kubernetes-ingress">10.1 Kubernetes Ingress<a class="headerlink" href="#101-kubernetes-ingress" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: api-gateway
  annotations:
    kubernetes.io/ingress.class: kong
    konghq.com/strip-path: &quot;false&quot;
    cert-manager.io/cluster-issuer: letsencrypt-prod
spec:
  tls:
    - hosts:
        - api.scalar-auditor.example.com
      secretName: api-tls
  rules:
    - host: api.scalar-auditor.example.com
      http:
        paths:
          - path: /api
            pathType: Prefix
            backend:
              service:
                name: kong-proxy
                port:
                  number: 80
</code></pre>

<h3 id="102">10.2 é«˜å¯ç”¨æ€§æ§‹æˆ<a class="headerlink" href="#102" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: kong
spec:
  replicas: 3
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: 1
      maxUnavailable: 0
  template:
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - topologyKey: kubernetes.io/hostname
</code></pre>
</article>
<article id="design-api-security-design">
<h1 id="api-security">API Securityè¨­è¨ˆ<a class="headerlink" href="#api-security" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 èªè¨¼ãƒ»èªå¯ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant U as User
    participant C as Client App
    participant GW as API Gateway
    participant IDS as Identity Service
    participant SVC as Backend Service

    U->>C: ãƒ­ã‚°ã‚¤ãƒ³è¦æ±‚
    C->>GW: POST /auth/login
    GW->>IDS: èªè¨¼è¦æ±‚
    IDS->>IDS: èªè¨¼æƒ…å ±æ¤œè¨¼
    IDS-->>GW: JWT Token
    GW-->>C: Token Response

    U->>C: APIå‘¼ã³å‡ºã—
    C->>GW: GET /api/v1/resource + JWT
    GW->>GW: JWTæ¤œè¨¼
    GW->>SVC: Request + User Context
    SVC->>SVC: èªå¯ãƒã‚§ãƒƒã‚¯
    SVC-->>GW: Response
    GW-->>C: Response
</div>

<h3 id="12">1.2 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å±¤<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å±¤</th>
<th>è²¬å‹™</th>
<th>æŠ€è¡“</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆ</td>
<td>é€šä¿¡æš—å·åŒ–</td>
<td>TLS 1.3</td>
</tr>
<tr>
<td>èªè¨¼</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼è­˜åˆ¥</td>
<td>OAuth 2.0, JWT</td>
</tr>
<tr>
<td>èªå¯</td>
<td>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</td>
<td>RBAC, ABAC</td>
</tr>
<tr>
<td>å…¥åŠ›æ¤œè¨¼</td>
<td>ä¸æ­£å…¥åŠ›é˜²æ­¢</td>
<td>ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td>ç›£æŸ»</td>
<td>æ“ä½œè¨˜éŒ²</td>
<td>ãƒ­ã‚°</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. èªè¨¼è¨­è¨ˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 èªè¨¼æ–¹å¼<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¿ã‚¤ãƒ—</th>
<th>èªè¨¼æ–¹å¼</th>
<th>ãƒ•ãƒ­ãƒ¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>BOX OAuth 2.0</td>
<td>Authorization Code</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>Email/Password</td>
<td>Resource Owner Password</td>
</tr>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹é–“</td>
<td>Client Credentials</td>
<td>Client Credentials</td>
</tr>
<tr>
<td>BOXçµ±åˆ</td>
<td>BOX JWT</td>
<td>JWT Bearer</td>
</tr>
</tbody>
</table>
<h3 id="22-box-oauth-20">2.2 BOX OAuth 2.0ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#22-box-oauth-20" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant U as çµ„ç¹”ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant APP as Scalar Auditor
    participant IDS as Identity Service
    participant BOX as BOX OAuth

    U->>APP: ãƒ­ã‚°ã‚¤ãƒ³ã‚¯ãƒªãƒƒã‚¯
    APP->>BOX: Authorization Request
    BOX->>U: èªè¨¼ç”»é¢
    U->>BOX: èªè¨¼æƒ…å ±å…¥åŠ›
    BOX->>APP: Authorization Code
    APP->>IDS: Code + Client Secret
    IDS->>BOX: Token Request
    BOX->>IDS: Access Token + Refresh Token
    IDS->>IDS: JWTç”Ÿæˆ
    IDS->>APP: Scalar JWT
</div>

<h3 id="23">2.3 å¤–éƒ¨ç›£æŸ»äººèªè¨¼ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant U as å¤–éƒ¨ç›£æŸ»äºº
    participant APP as Scalar Auditor
    participant IDS as Identity Service
    participant DB as ScalarDB

    U->>APP: Email/Passwordå…¥åŠ›
    APP->>IDS: POST /auth/login
    IDS->>DB: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢
    DB->>IDS: User Record
    IDS->>IDS: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼(bcrypt)
    IDS->>IDS: JWTç”Ÿæˆ
    IDS->>APP: JWT Token
</div>

<hr />
<h2 id="3-jwt">3. JWTè¨­è¨ˆ<a class="headerlink" href="#3-jwt" title="Permanent link">&para;</a></h2>
<h3 id="31-jwt">3.1 JWTãƒšã‚¤ãƒ­ãƒ¼ãƒ‰<a class="headerlink" href="#31-jwt" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;sub&quot;: &quot;user-456&quot;,
  &quot;email&quot;: &quot;user@example.com&quot;,
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;roles&quot;: [&quot;AUDIT_ADMIN&quot;, &quot;GENERAL_USER&quot;],
  &quot;org_id&quot;: &quot;org-123&quot;,
  &quot;type&quot;: &quot;access&quot;,
  &quot;iat&quot;: 1705312200,
  &quot;exp&quot;: 1705315800,
  &quot;iss&quot;: &quot;scalar-auditor-identity-service&quot;,
  &quot;aud&quot;: &quot;scalar-auditor-api&quot;
}
</code></pre>

<h3 id="32">3.2 ãƒˆãƒ¼ã‚¯ãƒ³ä»•æ§˜<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>Access Token</th>
<th>Refresh Token</th>
</tr>
</thead>
<tbody>
<tr>
<td>æœ‰åŠ¹æœŸé™</td>
<td>1æ™‚é–“</td>
<td>7æ—¥</td>
</tr>
<tr>
<td>ç½²åã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </td>
<td>RS256</td>
<td>RS256</td>
</tr>
<tr>
<td>ä¿å­˜å ´æ‰€</td>
<td>ãƒ¡ãƒ¢ãƒª/Cookie</td>
<td>HttpOnly Cookie</td>
</tr>
<tr>
<td>ã‚¹ã‚³ãƒ¼ãƒ—</td>
<td>API ã‚¢ã‚¯ã‚»ã‚¹</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ã®ã¿</td>
</tr>
</tbody>
</table>
<h3 id="33">3.3 ãƒˆãƒ¼ã‚¯ãƒ³æ›´æ–°ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Client
    participant GW as API Gateway
    participant IDS as Identity Service

    C->>GW: API Request + Expired JWT
    GW-->>C: 401 Token Expired
    C->>GW: POST /auth/refresh + Refresh Token
    GW->>IDS: Refresh Request
    IDS->>IDS: Refresh Tokenæ¤œè¨¼
    IDS->>IDS: æ–°Access Tokenç”Ÿæˆ
    IDS-->>GW: New Access Token
    GW-->>C: New Access Token
    C->>GW: Retry API Request + New JWT
</div>

<hr />
<h2 id="4">4. èªå¯è¨­è¨ˆ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41-rbac">4.1 RBACãƒ¢ãƒ‡ãƒ«<a class="headerlink" href="#41-rbac" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TD
    subgraph "Roles"
        AA[AUDIT_ADMIN]
        GU[GENERAL_USER]
        EA[EXTERNAL_AUDITOR]
    end

    subgraph "Permissions"
        P1[audit-set:create]
        P2[audit-set:read]
        P3[audit-set:update]
        P4[audit-set:delete]
        P5[user:manage]
        P6[event:read]
        P7[file:preview]
        P8[file:download]
        P9[validate:execute]
    end

    AA --> P1
    AA --> P2
    AA --> P3
    AA --> P4
    AA --> P5
    AA --> P6

    GU --> P2
    GU --> P6
    GU --> P7
    GU --> P8

    EA --> P2
    EA --> P7
    EA --> P8
    EA --> P9
</div>

<h3 id="42">4.2 ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³å®šç¾©<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">public enum Permission {
    // Audit Set
    AUDIT_SET_CREATE(&quot;audit-set:create&quot;),
    AUDIT_SET_READ(&quot;audit-set:read&quot;),
    AUDIT_SET_UPDATE(&quot;audit-set:update&quot;),
    AUDIT_SET_DELETE(&quot;audit-set:delete&quot;),

    // User
    USER_MANAGE(&quot;user:manage&quot;),
    USER_READ(&quot;user:read&quot;),

    // Event
    EVENT_READ(&quot;event:read&quot;),
    EVENT_READ_ALL(&quot;event:read-all&quot;),

    // File
    FILE_PREVIEW(&quot;file:preview&quot;),
    FILE_DOWNLOAD(&quot;file:download&quot;),

    // Validation
    VALIDATE_EXECUTE(&quot;validate:execute&quot;);
}
</code></pre>

<h3 id="43-abac">4.3 ãƒªã‚½ãƒ¼ã‚¹ãƒ™ãƒ¼ã‚¹èªå¯ (ABAC)<a class="headerlink" href="#43-abac" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã¯ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ«ã«åŸºã¥ã:</p>
<pre class="codehilite"><code class="language-java">public class AuditSetAccessPolicy {
    public boolean canAccess(User user, AuditSet auditSet, Action action) {
        // æ‰€æœ‰è€…ã¯å…¨æ¨©é™
        if (auditSet.getOwnerId().equals(user.getId())) {
            return true;
        }

        // ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ­ãƒ¼ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
        CollaboratorRole role = getCollaboratorRole(user, auditSet);

        return switch (action) {
            case READ -&gt; role != null;
            case UPDATE -&gt; role == OWNER || role == CO_OWNER;
            case DELETE -&gt; role == OWNER;
            case ADD_ITEM -&gt; role != REVIEWER;
            case REMOVE_ITEM -&gt; role == OWNER || role == CO_OWNER;
        };
    }
}
</code></pre>

<h3 id="44-api">4.4 APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆèªå¯ãƒãƒˆãƒªãƒƒã‚¯ã‚¹<a class="headerlink" href="#44-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ</th>
<th>AUDIT_ADMIN</th>
<th>GENERAL_USER</th>
<th>EXTERNAL_AUDITOR</th>
</tr>
</thead>
<tbody>
<tr>
<td>POST /audit-sets</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>GET /audit-sets</td>
<td>âœ“</td>
<td>âœ“ (è‡ªåˆ†ã®ã¿)</td>
<td>âœ“ (å‰²å½“ã®ã¿)</td>
</tr>
<tr>
<td>PUT /audit-sets/{id}</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>DELETE /audit-sets/{id}</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>GET /events</td>
<td>âœ“ (å…¨ã¦)</td>
<td>âœ“ (è‡ªåˆ†ã®ã¿)</td>
<td>âœ—</td>
</tr>
<tr>
<td>GET /items/{id}/events</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>POST /items/{id}/validate</td>
<td>âœ“</td>
<td>âœ“</td>
<td>âœ“</td>
</tr>
<tr>
<td>GET /users</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
<tr>
<td>POST /users</td>
<td>âœ“</td>
<td>âœ—</td>
<td>âœ—</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@RestController
public class AuditSetController {

    @PostMapping(&quot;/audit-sets&quot;)
    public ResponseEntity&lt;AuditSet&gt; create(
            @Valid @RequestBody CreateAuditSetRequest request) {
        // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³æ¸ˆã¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    }
}

public record CreateAuditSetRequest(
    @NotBlank @Size(max = 255) String name,
    @Size(max = 1000) String description,
    @Email String ownerEmail
) {}
</code></pre>

<h3 id="52-sql">5.2 SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–<a class="headerlink" href="#52-sql" title="Permanent link">&para;</a></h3>
<p>ScalarDBã‚’ä½¿ç”¨ã—ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¼·åˆ¶:</p>
<pre class="codehilite"><code class="language-java">public Optional&lt;AuditSet&gt; findById(String id) {
    Get get = Get.newBuilder()
        .namespace(NAMESPACE)
        .table(TABLE)
        .partitionKey(Key.of(&quot;audit_set_id&quot;, id))  // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰
        .build();
    return storage.get(get).map(this::mapToEntity);
}
</code></pre>

<h3 id="53-xss">5.3 XSSå¯¾ç­–<a class="headerlink" href="#53-xss" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—
@Configuration
public class JacksonConfig {
    @Bean
    public Jackson2ObjectMapperBuilder jacksonBuilder() {
        return new Jackson2ObjectMapperBuilder()
            .featuresToEnable(SerializationFeature.ESCAPE_NON_ASCII);
    }
}

// Content Security Policy
@Configuration
public class SecurityHeadersConfig {
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        http.headers()
            .contentSecurityPolicy(&quot;default-src 'self'; script-src 'self'&quot;)
            .and()
            .xssProtection();
        return http.build();
    }
}
</code></pre>

<h3 id="54-csrf">5.4 CSRFå¯¾ç­–<a class="headerlink" href="#54-csrf" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Configuration
public class SecurityConfig {
    @Bean
    public SecurityFilterChain filterChain(HttpSecurity http) {
        http
            .csrf()
                .csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse())
                .ignoringRequestMatchers(&quot;/api/**&quot;); // REST APIã¯ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹
        return http.build();
    }
}
</code></pre>

<h3 id="55">5.5 ãƒ¬ãƒ¼ãƒˆåˆ¶é™<a class="headerlink" href="#55" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class RateLimitingFilter extends OncePerRequestFilter {

    private final RateLimiter rateLimiter;

    @Override
    protected void doFilterInternal(HttpServletRequest request, 
                                     HttpServletResponse response,
                                     FilterChain filterChain) {
        String clientId = extractClientId(request);

        if (!rateLimiter.tryAcquire(clientId)) {
            response.setStatus(429);
            response.getWriter().write(&quot;{\&quot;error\&quot;: \&quot;Too many requests\&quot;}&quot;);
            return;
        }

        filterChain.doFilter(request, response);
    }
}
</code></pre>

<hr />
<h2 id="6">6. ç›£æŸ»ãƒ­ã‚°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ç›£æŸ»ã‚¤ãƒ™ãƒ³ãƒˆ<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¤ãƒ™ãƒ³ãƒˆ</th>
<th>è¨˜éŒ²å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>LOGIN_SUCCESS</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã€IPã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—</td>
</tr>
<tr>
<td>LOGIN_FAILURE</td>
<td>è©¦è¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼ã€IPã€å¤±æ•—ç†ç”±</td>
</tr>
<tr>
<td>RESOURCE_ACCESS</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒªã‚½ãƒ¼ã‚¹ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td>PERMISSION_DENIED</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€ãƒªã‚½ãƒ¼ã‚¹ã€å¿…è¦æ¨©é™</td>
</tr>
<tr>
<td>DATA_MODIFICATION</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€å¤‰æ›´å‰å¾Œã€ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—</td>
</tr>
</tbody>
</table>
<h3 id="62">6.2 ç›£æŸ»ãƒ­ã‚°ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;timestamp&quot;: &quot;2024-01-15T10:30:00.000Z&quot;,
  &quot;eventType&quot;: &quot;RESOURCE_ACCESS&quot;,
  &quot;actor&quot;: {
    &quot;id&quot;: &quot;user-456&quot;,
    &quot;email&quot;: &quot;admin@example.com&quot;,
    &quot;roles&quot;: [&quot;AUDIT_ADMIN&quot;]
  },
  &quot;resource&quot;: {
    &quot;type&quot;: &quot;audit-set&quot;,
    &quot;id&quot;: &quot;audit-set-123&quot;
  },
  &quot;action&quot;: &quot;UPDATE&quot;,
  &quot;result&quot;: &quot;SUCCESS&quot;,
  &quot;requestId&quot;: &quot;req-abc-123&quot;,
  &quot;clientIp&quot;: &quot;192.168.1.100&quot;,
  &quot;userAgent&quot;: &quot;Mozilla/5.0...&quot;
}
</code></pre>

<hr />
<h2 id="7">7. ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆä¸€è¦§<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ</th>
<th>ç”¨é€”</th>
<th>ä¿å­˜å ´æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>JWTç½²åéµ</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³ç½²å</td>
<td>Vault / AWS Secrets Manager</td>
</tr>
<tr>
<td>DBèªè¨¼æƒ…å ±</td>
<td>ScalarDBæ¥ç¶š</td>
<td>Vault / AWS Secrets Manager</td>
</tr>
<tr>
<td>BOX Client Secret</td>
<td>OAuthèªè¨¼</td>
<td>Vault / AWS Secrets Manager</td>
</tr>
<tr>
<td>SMTPèªè¨¼æƒ…å ±</td>
<td>ãƒ¡ãƒ¼ãƒ«é€ä¿¡</td>
<td>Vault / AWS Secrets Manager</td>
</tr>
</tbody>
</table>
<h3 id="72-kubernetes-secrets">7.2 Kubernetes Secrets<a class="headerlink" href="#72-kubernetes-secrets" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">apiVersion: v1
kind: Secret
metadata:
  name: identity-service-secrets
type: Opaque
data:
  jwt-private-key: &lt;base64 encoded&gt;
  jwt-public-key: &lt;base64 encoded&gt;
  box-client-secret: &lt;base64 encoded&gt;
</code></pre>

<h3 id="73">7.3 ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ</th>
<th>ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é–“éš”</th>
</tr>
</thead>
<tbody>
<tr>
<td>JWTç½²åéµ</td>
<td>90æ—¥</td>
</tr>
<tr>
<td>DBèªè¨¼æƒ…å ±</td>
<td>30æ—¥</td>
</tr>
<tr>
<td>APIã‚­ãƒ¼</td>
<td>90æ—¥</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8-tls">8. TLSè¨­å®š<a class="headerlink" href="#8-tls" title="Permanent link">&para;</a></h2>
<h3 id="81-tls">8.1 TLSãƒãƒ¼ã‚¸ãƒ§ãƒ³<a class="headerlink" href="#81-tls" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># Nginx/Kongè¨­å®š
ssl_protocols TLSv1.3 TLSv1.2;
ssl_prefer_server_ciphers on;
ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;
ssl_session_cache shared:SSL:10m;
ssl_session_timeout 1d;
ssl_stapling on;
ssl_stapling_verify on;
</code></pre>

<h3 id="82-mtls">8.2 ã‚µãƒ¼ãƒ“ã‚¹é–“mTLS<a class="headerlink" href="#82-mtls" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># Istioè¨­å®š
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: scalar-auditor
spec:
  mtls:
    mode: STRICT
</code></pre>
</article>
<article id="design-scalardb-architecture">
<h1 id="scalardb">ScalarDB ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1-scalardb">1. ScalarDBæ¦‚è¦<a class="headerlink" href="#1-scalardb" title="Permanent link">&para;</a></h2>
<h3 id="11-scalardb">1.1 ScalarDBã®å½¹å‰²<a class="headerlink" href="#11-scalardb" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Application Layer"
        AMS[Audit Management]
        VS[Verification]
        ES[Event]
        IS[Item]
        IDS[Identity]
    end

    subgraph "ScalarDB Layer"
        SC[ScalarDB Cluster]
        TX[Transaction Coordinator]
        SM[Schema Manager]
    end

    subgraph "Storage Layer"
        C1[(Cassandra<br/>Primary)]
        C2[(DynamoDB<br/>Secondary)]
    end

    AMS --> SC
    VS --> SC
    ES --> SC
    IS --> SC
    IDS --> SC

    SC --> TX
    SC --> SM
    TX --> C1
    TX --> C2
</div>

<h3 id="12">1.2 æ¡ç”¨ç†ç”±<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç‰¹å¾´</th>
<th>åˆ©ç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</td>
<td>è¤‡æ•°ãƒ†ãƒ¼ãƒ–ãƒ«é–“ã®ACIDä¿è¨¼</td>
</tr>
<tr>
<td>ãƒãƒ«ãƒã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
<td>Cassandra + ä»–DBã®çµ±åˆ</td>
</tr>
<tr>
<td>ã‚¹ã‚­ãƒ¼ãƒç®¡ç†</td>
<td>ä¸€è²«ã—ãŸã‚¹ã‚­ãƒ¼ãƒæ“ä½œ</td>
</tr>
<tr>
<td>ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£</td>
<td>æ°´å¹³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å¯¾å¿œ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ§‹æˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 æœ¬ç•ªç’°å¢ƒæ§‹æˆ<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Kubernetes Cluster"
        subgraph "ScalarDB Cluster Pods"
            SDB1[ScalarDB Node 1]
            SDB2[ScalarDB Node 2]
            SDB3[ScalarDB Node 3]
        end

        subgraph "Coordinator"
            COORD[Transaction Coordinator]
        end

        LB[Load Balancer]
    end

    subgraph "Cassandra Cluster"
        C1[(Cassandra 1)]
        C2[(Cassandra 2)]
        C3[(Cassandra 3)]
    end

    LB --> SDB1
    LB --> SDB2
    LB --> SDB3

    SDB1 --> COORD
    SDB2 --> COORD
    SDB3 --> COORD

    COORD --> C1
    COORD --> C2
    COORD --> C3
</div>

<h3 id="22">2.2 ç’°å¢ƒåˆ¥æ§‹æˆ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ScalarDB Nodes</th>
<th>Cassandra Nodes</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>1</td>
<td>1</td>
<td>ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>2</td>
<td>3</td>
<td>æ¤œè¨¼ç’°å¢ƒ</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>3</td>
<td>3</td>
<td>é«˜å¯ç”¨æ€§</td>
</tr>
</tbody>
</table>
<h3 id="23">2.3 ãƒªã‚½ãƒ¼ã‚¹è¦ä»¶<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>CPU</th>
<th>Memory</th>
<th>Storage</th>
</tr>
</thead>
<tbody>
<tr>
<td>ScalarDB Node</td>
<td>2 cores</td>
<td>4GB</td>
<td>10GB</td>
</tr>
<tr>
<td>Cassandra Node</td>
<td>4 cores</td>
<td>8GB</td>
<td>100GB SSD</td>
</tr>
<tr>
<td>Coordinator</td>
<td>1 core</td>
<td>2GB</td>
<td>5GB</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. æ¥ç¶šè¨­å®š<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-scalardbproperties">3.1 scalardb.properties<a class="headerlink" href="#31-scalardbproperties" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-properties"># Transaction mode
scalar.db.transaction_manager=consensus-commit

# Storage configuration
scalar.db.storage=cassandra
scalar.db.contact_points=cassandra-0,cassandra-1,cassandra-2
scalar.db.contact_port=9042
scalar.db.username=${SCALARDB_USERNAME}
scalar.db.password=${SCALARDB_PASSWORD}

# Consensus commit settings
scalar.db.consensus_commit.isolation_level=SERIALIZABLE
scalar.db.consensus_commit.serializable_strategy=EXTRA_READ

# Connection pool
scalar.db.connection_pool.min_idle=5
scalar.db.connection_pool.max_idle=10
scalar.db.connection_pool.max_total=20

# Retry settings
scalar.db.retry.max_retries=10
scalar.db.retry.initial_interval_millis=100
scalar.db.retry.max_interval_millis=10000
scalar.db.retry.multiplier=2.0
</code></pre>

<h3 id="32-spring-boot">3.2 Spring Bootçµ±åˆ<a class="headerlink" href="#32-spring-boot" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Configuration
public class ScalarDbConfig {

    @Bean
    public DistributedTransactionManager transactionManager() throws Exception {
        Properties props = new Properties();
        props.load(getClass().getResourceAsStream(&quot;/scalardb.properties&quot;));
        return TransactionFactory.create(props).getTransactionManager();
    }

    @Bean
    public DistributedStorage storage() throws Exception {
        Properties props = new Properties();
        props.load(getClass().getResourceAsStream(&quot;/scalardb.properties&quot;));
        return StorageFactory.create(props);
    }
}
</code></pre>

<hr />
<h2 id="4">4. ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹è¨­è¨ˆ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ã‚µãƒ¼ãƒ“ã‚¹åˆ¥ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>scalar_auditor/
â”œâ”€â”€ audit/          # Audit Management Service
â”‚   â”œâ”€â”€ audit_set
â”‚   â”œâ”€â”€ audit_group
â”‚   â”œâ”€â”€ audit_set_collaborators
â”‚   â””â”€â”€ audit_set_item
â”œâ”€â”€ verification/   # Verification Service
â”‚   â”œâ”€â”€ item_status
â”‚   â””â”€â”€ items_by_sha1
â”œâ”€â”€ event/          # Event Service
â”‚   â”œâ”€â”€ events
â”‚   â”œâ”€â”€ item_events
â”‚   â”œâ”€â”€ auditor_logs
â”‚   â””â”€â”€ position_tracker
â”œâ”€â”€ item/           # Item Service
â”‚   â””â”€â”€ item
â”œâ”€â”€ identity/       # Identity Service
â”‚   â”œâ”€â”€ user
â”‚   â”œâ”€â”€ role_user
â”‚   â”œâ”€â”€ user_token
â”‚   â”œâ”€â”€ user_otp
â”‚   â”œâ”€â”€ user_audit_group
â”‚   â””â”€â”€ organization
â””â”€â”€ coordinator/    # ScalarDB internal
    â””â”€â”€ coordinator_state
</code></pre>

<h3 id="42">4.2 ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹åˆ†é›¢ã®åˆ©ç‚¹<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>åˆ©ç‚¹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚µãƒ¼ãƒ“ã‚¹ç‹¬ç«‹æ€§</td>
<td>å„ã‚µãƒ¼ãƒ“ã‚¹ãŒè‡ªèº«ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†</td>
</tr>
<tr>
<td>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</td>
<td>ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹å˜ä½ã§æ¨©é™è¨­å®šå¯èƒ½</td>
</tr>
<tr>
<td>ç§»è¡Œå®¹æ˜“æ€§</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹å˜ä½ã§ã®ãƒ‡ãƒ¼ã‚¿ç§»è¡ŒãŒå®¹æ˜“</td>
</tr>
<tr>
<td>ç›£è¦–å®¹æ˜“æ€§</td>
<td>ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹å˜ä½ã§ãƒ¡ãƒˆãƒªã‚¯ã‚¹å–å¾—</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¨­è¨ˆ<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "Consensus Commit"
        TX1[Transaction Start]
        READ[Read Operations]
        WRITE[Write Operations]
        PREP[Prepare Phase]
        COMMIT[Commit Phase]
    end

    TX1 --> READ
    READ --> WRITE
    WRITE --> PREP
    PREP --> COMMIT
</div>

<h3 id="52">5.2 åˆ†é›¢ãƒ¬ãƒ™ãƒ«<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¬ãƒ™ãƒ«</th>
<th>ç”¨é€”</th>
<th>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>SERIALIZABLE</td>
<td>å¼·æ•´åˆæ€§å¿…é ˆæ“ä½œ</td>
<td>ä½</td>
</tr>
<tr>
<td>SNAPSHOT</td>
<td>èª­ã¿å–ã‚Šä¸­å¿ƒæ“ä½œ</td>
<td>é«˜</td>
</tr>
</tbody>
</table>
<p><strong>æ¨å¥¨è¨­å®š</strong>:
- æ›¸ãè¾¼ã¿æ“ä½œ: SERIALIZABLE
- èª­ã¿å–ã‚Šå°‚ç”¨: SNAPSHOT</p>
<h3 id="53">5.3 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetService {

    private final DistributedTransactionManager manager;

    public AuditSet createAuditSet(CreateAuditSetRequest request) {
        DistributedTransaction tx = manager.start();
        try {
            // ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ
            Put auditSetPut = createAuditSetPut(request);
            tx.put(auditSetPut);

            // æ‰€æœ‰è€…ã‚’ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦è¿½åŠ 
            Put collaboratorPut = createCollaboratorPut(request);
            tx.put(collaboratorPut);

            tx.commit();
            return mapToAuditSet(auditSetPut);
        } catch (Exception e) {
            tx.abort();
            throw new ServiceException(&quot;Failed to create audit set&quot;, e);
        }
    }
}
</code></pre>

<hr />
<h2 id="6">6. é«˜å¯ç”¨æ€§è¨­è¨ˆ<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-kubernetes">6.1 Kubernetesé…ç½®<a class="headerlink" href="#61-kubernetes" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: scalardb-cluster
spec:
  replicas: 3
  selector:
    matchLabels:
      app: scalardb
  serviceName: scalardb
  template:
    spec:
      affinity:
        podAntiAffinity:
          requiredDuringSchedulingIgnoredDuringExecution:
            - labelSelector:
                matchExpressions:
                  - key: app
                    operator: In
                    values:
                      - scalardb
              topologyKey: kubernetes.io/hostname
      containers:
        - name: scalardb
          image: ghcr.io/scalar-labs/scalardb-cluster-node:3.14
          ports:
            - containerPort: 60053
          resources:
            requests:
              cpu: &quot;2&quot;
              memory: &quot;4Gi&quot;
            limits:
              cpu: &quot;4&quot;
              memory: &quot;8Gi&quot;
          livenessProbe:
            grpc:
              port: 60053
            initialDelaySeconds: 30
            periodSeconds: 10
          readinessProbe:
            grpc:
              port: 60053
            initialDelaySeconds: 5
            periodSeconds: 5
</code></pre>

<h3 id="62">6.2 éšœå®³å¾©æ—§<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚·ãƒŠãƒªã‚ª</th>
<th>å¯¾å¿œ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒ¼ãƒ‰éšœå®³</td>
<td>è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ç ´æ</td>
<td>Cassandraãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</td>
</tr>
<tr>
<td>å…¨ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼éšœå®³</td>
<td>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7">7. ç›£è¦–ãƒ»é‹ç”¨<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ãƒ¡ãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</th>
<th>èª¬æ˜</th>
<th>é–¾å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>transaction_latency</td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é…å»¶</td>
<td>&lt; 100ms</td>
</tr>
<tr>
<td>transaction_throughput</td>
<td>ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</td>
<td>&gt; 1000 TPS</td>
</tr>
<tr>
<td>commit_success_rate</td>
<td>ã‚³ãƒŸãƒƒãƒˆæˆåŠŸç‡</td>
<td>&gt; 99.9%</td>
</tr>
<tr>
<td>abort_rate</td>
<td>ã‚¢ãƒœãƒ¼ãƒˆç‡</td>
<td>&lt; 0.1%</td>
</tr>
</tbody>
</table>
<h3 id="72-prometheus">7.2 Prometheusè¨­å®š<a class="headerlink" href="#72-prometheus" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">scrape_configs:
  - job_name: 'scalardb-cluster'
    static_configs:
      - targets: ['scalardb-0:8080', 'scalardb-1:8080', 'scalardb-2:8080']
    metrics_path: '/metrics'
</code></pre>

<h3 id="73">7.3 ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">groups:
  - name: scalardb
    rules:
      - alert: ScalarDBHighLatency
        expr: histogram_quantile(0.99, scalardb_transaction_latency_seconds_bucket) &gt; 0.5
        for: 5m
        labels:
          severity: warning
        annotations:
          summary: &quot;ScalarDB high latency detected&quot;

      - alert: ScalarDBHighAbortRate
        expr: rate(scalardb_transaction_abort_total[5m]) / rate(scalardb_transaction_total[5m]) &gt; 0.01
        for: 5m
        labels:
          severity: critical
        annotations:
          summary: &quot;ScalarDB high abort rate detected&quot;
</code></pre>

<hr />
<h2 id="8">8. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»ãƒªã‚«ãƒãƒª<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¤ãƒ—</th>
<th>é »åº¦</th>
<th>ä¿æŒæœŸé–“</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ•ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</td>
<td>æ—¥æ¬¡</td>
<td>30æ—¥</td>
</tr>
<tr>
<td>å¢—åˆ†ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</td>
<td>æ™‚é–“æ¯</td>
<td>7æ—¥</td>
</tr>
<tr>
<td>ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ</td>
<td>é€±æ¬¡</td>
<td>90æ—¥</td>
</tr>
</tbody>
</table>
<h3 id="82">8.2 ãƒªã‚«ãƒãƒªæ‰‹é †<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<ol>
<li>Cassandraã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢</li>
<li>ScalarDBãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°é©ç”¨</li>
<li>æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ</li>
<li>ã‚µãƒ¼ãƒ“ã‚¹å†é–‹</li>
</ol>
</article>
<article id="design-scalardb-schema-design">
<h1 id="scalardb">ScalarDB ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚¹ã‚­ãƒ¼ãƒæ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ãƒ†ãƒ¼ãƒ–ãƒ«ä¸€è¦§<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹</th>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«å</th>
<th>èª¬æ˜</th>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit</td>
<td>audit_set</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>Audit Management</td>
</tr>
<tr>
<td>audit</td>
<td>audit_group</td>
<td>ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>Audit Management</td>
</tr>
<tr>
<td>audit</td>
<td>audit_set_collaborators</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>Audit Management</td>
</tr>
<tr>
<td>audit</td>
<td>audit_set_item</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ </td>
<td>Audit Management</td>
</tr>
<tr>
<td>audit</td>
<td>audit_grp_audit_set_mapping</td>
<td>ã‚°ãƒ«ãƒ¼ãƒ—-ã‚»ãƒƒãƒˆãƒãƒƒãƒ”ãƒ³ã‚°</td>
<td>Audit Management</td>
</tr>
<tr>
<td>verification</td>
<td>item_status</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</td>
<td>Verification</td>
</tr>
<tr>
<td>verification</td>
<td>items_by_sha1</td>
<td>SHA1ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</td>
<td>Verification</td>
</tr>
<tr>
<td>event</td>
<td>events</td>
<td>BOXã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>Event</td>
</tr>
<tr>
<td>event</td>
<td>item_events</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>Event</td>
</tr>
<tr>
<td>event</td>
<td>auditor_logs</td>
<td>ç›£æŸ»äººãƒ­ã‚°</td>
<td>Event</td>
</tr>
<tr>
<td>event</td>
<td>position_tracker</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆä½ç½®</td>
<td>Event</td>
</tr>
<tr>
<td>item</td>
<td>item</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ æƒ…å ±</td>
<td>Item</td>
</tr>
<tr>
<td>identity</td>
<td>user</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>Identity</td>
</tr>
<tr>
<td>identity</td>
<td>role_user</td>
<td>ãƒ­ãƒ¼ãƒ«ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>Identity</td>
</tr>
<tr>
<td>identity</td>
<td>user_token</td>
<td>ãƒˆãƒ¼ã‚¯ãƒ³</td>
<td>Identity</td>
</tr>
<tr>
<td>identity</td>
<td>user_otp</td>
<td>OTP</td>
<td>Identity</td>
</tr>
<tr>
<td>identity</td>
<td>user_audit_group</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼-ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>Identity</td>
</tr>
<tr>
<td>identity</td>
<td>organization</td>
<td>çµ„ç¹”</td>
<td>Identity</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ãƒ†ãƒ¼ãƒ–ãƒ«å®šç¾©<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-audit">2.1 Audit ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#21-audit" title="Permanent link">&para;</a></h3>
<h4 id="audit_set">audit_set<a class="headerlink" href="#audit_set" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;audit.audit_set&quot;,
    &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;audit_set_id&quot;: &quot;TEXT&quot;,
      &quot;name&quot;: &quot;TEXT&quot;,
      &quot;description&quot;: &quot;TEXT&quot;,
      &quot;owner_user_id&quot;: &quot;TEXT&quot;,
      &quot;owner_email&quot;: &quot;TEXT&quot;,
      &quot;acl_json&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;,
      &quot;updated_at&quot;: &quot;BIGINT&quot;
    },
    &quot;secondary_index&quot;: [&quot;owner_user_id&quot;]
  }]
}
</code></pre>

<h4 id="audit_group">audit_group<a class="headerlink" href="#audit_group" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;audit.audit_group&quot;,
    &quot;partition_key&quot;: [&quot;audit_group_id&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;audit_group_id&quot;: &quot;TEXT&quot;,
      &quot;name&quot;: &quot;TEXT&quot;,
      &quot;description&quot;: &quot;TEXT&quot;,
      &quot;owner_user_id&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;,
      &quot;updated_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="audit_set_collaborators">audit_set_collaborators<a class="headerlink" href="#audit_set_collaborators" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;audit.audit_set_collaborators&quot;,
    &quot;partition_key&quot;: [&quot;user_email&quot;],
    &quot;clustering_key&quot;: [&quot;audit_set_id&quot;],
    &quot;columns&quot;: {
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;audit_set_id&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;role&quot;: &quot;TEXT&quot;,
      &quot;added_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="audit_set_item">audit_set_item<a class="headerlink" href="#audit_set_item" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;audit.audit_set_item&quot;,
    &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
    &quot;clustering_key&quot;: [&quot;item_id&quot;],
    &quot;columns&quot;: {
      &quot;audit_set_id&quot;: &quot;TEXT&quot;,
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;item_type&quot;: &quot;TEXT&quot;,
      &quot;item_name&quot;: &quot;TEXT&quot;,
      &quot;parent_id&quot;: &quot;TEXT&quot;,
      &quot;sha1_hash&quot;: &quot;TEXT&quot;,
      &quot;added_by&quot;: &quot;TEXT&quot;,
      &quot;added_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<hr />
<h3 id="22-verification">2.2 Verification ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#22-verification" title="Permanent link">&para;</a></h3>
<h4 id="item_status">item_status<a class="headerlink" href="#item_status" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;verification.item_status&quot;,
    &quot;partition_key&quot;: [&quot;item_id&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;tampering_status&quot;: &quot;TEXT&quot;,
      &quot;last_verified_at&quot;: &quot;BIGINT&quot;,
      &quot;last_sha1_hash&quot;: &quot;TEXT&quot;,
      &quot;version_id&quot;: &quot;TEXT&quot;,
      &quot;registered_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="items_by_sha1">items_by_sha1<a class="headerlink" href="#items_by_sha1" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;verification.items_by_sha1&quot;,
    &quot;partition_key&quot;: [&quot;sha1_hash&quot;],
    &quot;clustering_key&quot;: [&quot;item_id&quot;],
    &quot;columns&quot;: {
      &quot;sha1_hash&quot;: &quot;TEXT&quot;,
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;item_name&quot;: &quot;TEXT&quot;,
      &quot;version_id&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<hr />
<h3 id="23-event">2.3 Event ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#23-event" title="Permanent link">&para;</a></h3>
<h4 id="events">events<a class="headerlink" href="#events" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;event.events&quot;,
    &quot;partition_key&quot;: [&quot;yyyy_mm_dd&quot;],
    &quot;clustering_key&quot;: [&quot;event_id&quot;],
    &quot;clustering_order&quot;: {&quot;event_id&quot;: &quot;DESC&quot;},
    &quot;columns&quot;: {
      &quot;yyyy_mm_dd&quot;: &quot;TEXT&quot;,
      &quot;event_id&quot;: &quot;TEXT&quot;,
      &quot;event_type&quot;: &quot;TEXT&quot;,
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;item_type&quot;: &quot;TEXT&quot;,
      &quot;item_name&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;source_id&quot;: &quot;TEXT&quot;,
      &quot;additional_details&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="item_events">item_events<a class="headerlink" href="#item_events" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;event.item_events&quot;,
    &quot;partition_key&quot;: [&quot;item_id&quot;],
    &quot;clustering_key&quot;: [&quot;event_id&quot;],
    &quot;clustering_order&quot;: {&quot;event_id&quot;: &quot;DESC&quot;},
    &quot;columns&quot;: {
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;event_id&quot;: &quot;TEXT&quot;,
      &quot;event_type&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="auditor_logs">auditor_logs<a class="headerlink" href="#auditor_logs" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;event.auditor_logs&quot;,
    &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
    &quot;clustering_key&quot;: [&quot;log_id&quot;],
    &quot;clustering_order&quot;: {&quot;log_id&quot;: &quot;DESC&quot;},
    &quot;columns&quot;: {
      &quot;audit_set_id&quot;: &quot;TEXT&quot;,
      &quot;log_id&quot;: &quot;TEXT&quot;,
      &quot;action_type&quot;: &quot;TEXT&quot;,
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="position_tracker">position_tracker<a class="headerlink" href="#position_tracker" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;event.position_tracker&quot;,
    &quot;partition_key&quot;: [&quot;user_id&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;stream_position&quot;: &quot;TEXT&quot;,
      &quot;last_updated_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<hr />
<h3 id="24-item">2.4 Item ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#24-item" title="Permanent link">&para;</a></h3>
<h4 id="item">item<a class="headerlink" href="#item" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;item.item&quot;,
    &quot;partition_key&quot;: [&quot;item_id&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;item_id&quot;: &quot;TEXT&quot;,
      &quot;item_type&quot;: &quot;TEXT&quot;,
      &quot;name&quot;: &quot;TEXT&quot;,
      &quot;parent_id&quot;: &quot;TEXT&quot;,
      &quot;sha1_hash&quot;: &quot;TEXT&quot;,
      &quot;size&quot;: &quot;BIGINT&quot;,
      &quot;owner_id&quot;: &quot;TEXT&quot;,
      &quot;owner_email&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;,
      &quot;modified_at&quot;: &quot;BIGINT&quot;,
      &quot;box_version_id&quot;: &quot;TEXT&quot;
    }
  }]
}
</code></pre>

<hr />
<h3 id="25-identity">2.5 Identity ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹<a class="headerlink" href="#25-identity" title="Permanent link">&para;</a></h3>
<h4 id="user">user<a class="headerlink" href="#user" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;identity.user&quot;,
    &quot;partition_key&quot;: [&quot;user_email&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;name&quot;: &quot;TEXT&quot;,
      &quot;password_hash&quot;: &quot;TEXT&quot;,
      &quot;user_type&quot;: &quot;TEXT&quot;,
      &quot;status&quot;: &quot;TEXT&quot;,
      &quot;language&quot;: &quot;TEXT&quot;,
      &quot;org_id&quot;: &quot;TEXT&quot;,
      &quot;box_user_id&quot;: &quot;TEXT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;,
      &quot;updated_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="role_user">role_user<a class="headerlink" href="#role_user" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;identity.role_user&quot;,
    &quot;partition_key&quot;: [&quot;role_name&quot;],
    &quot;clustering_key&quot;: [&quot;user_email&quot;],
    &quot;columns&quot;: {
      &quot;role_name&quot;: &quot;TEXT&quot;,
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;user_id&quot;: &quot;TEXT&quot;,
      &quot;assigned_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<h4 id="user_token">user_token<a class="headerlink" href="#user_token" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code class="language-json">{
  &quot;tables&quot;: [{
    &quot;table&quot;: &quot;identity.user_token&quot;,
    &quot;partition_key&quot;: [&quot;user_email&quot;],
    &quot;clustering_key&quot;: [],
    &quot;columns&quot;: {
      &quot;user_email&quot;: &quot;TEXT&quot;,
      &quot;access_token&quot;: &quot;TEXT&quot;,
      &quot;refresh_token&quot;: &quot;TEXT&quot;,
      &quot;token_type&quot;: &quot;TEXT&quot;,
      &quot;expires_at&quot;: &quot;BIGINT&quot;,
      &quot;created_at&quot;: &quot;BIGINT&quot;
    }
  }]
}
</code></pre>

<hr />
<h2 id="3">3. ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³è¨­è¨ˆ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼é¸å®šåŸºæº–<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>events</td>
<td>yyyy_mm_dd</td>
<td>æ—¥ä»˜ã§ãƒ‡ãƒ¼ã‚¿åˆ†æ•£ã€ç¯„å›²ã‚¯ã‚¨ãƒªåŠ¹ç‡åŒ–</td>
</tr>
<tr>
<td>audit_set</td>
<td>audit_set_id</td>
<td>UUID ã§å‡ç­‰åˆ†æ•£</td>
</tr>
<tr>
<td>audit_set_collaborators</td>
<td>user_email</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å˜ä½ã‚¢ã‚¯ã‚»ã‚¹æœ€é©åŒ–</td>
</tr>
<tr>
<td>item_events</td>
<td>item_id</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ å˜ä½ã‚¯ã‚¨ãƒªæœ€é©åŒ–</td>
</tr>
</tbody>
</table>
<h3 id="32">3.2 ãƒ›ãƒƒãƒˆã‚¹ãƒãƒƒãƒˆå¯¾ç­–<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<p><strong>å•é¡Œ</strong>: <code>events</code>ãƒ†ãƒ¼ãƒ–ãƒ«ã§å½“æ—¥ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«è² è·é›†ä¸­</p>
<p><strong>å¯¾ç­–</strong>:</p>
<pre class="codehilite"><code>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: yyyy_mm_dd + shard_id (0-9)
ä¾‹: 2024-01-15-3
</code></pre>

<pre class="codehilite"><code class="language-json">{
  &quot;table&quot;: &quot;event.events_sharded&quot;,
  &quot;partition_key&quot;: [&quot;partition_key&quot;],
  &quot;clustering_key&quot;: [&quot;event_id&quot;],
  &quot;columns&quot;: {
    &quot;partition_key&quot;: &quot;TEXT&quot;,  // &quot;2024-01-15-3&quot;
    &quot;event_id&quot;: &quot;TEXT&quot;,
    ...
  }
}
</code></pre>

<hr />
<h2 id="4">4. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>audit_set</td>
<td>owner_user_id</td>
<td>æ‰€æœ‰è€…ã§ãƒ•ã‚£ãƒ«ã‚¿</td>
</tr>
<tr>
<td>user</td>
<td>org_id</td>
<td>çµ„ç¹”ã§ãƒ•ã‚£ãƒ«ã‚¿</td>
</tr>
<tr>
<td>item</td>
<td>parent_id</td>
<td>è¦ªãƒ•ã‚©ãƒ«ãƒ€ã§ãƒ•ã‚£ãƒ«ã‚¿</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ‰ãƒ“ãƒ¥ãƒ¼ä»£æ›¿<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<p>ScalarDBã§ã¯ãƒãƒ†ãƒªã‚¢ãƒ©ã‚¤ã‚ºãƒ‰ãƒ“ãƒ¥ãƒ¼ãŒä½¿ãˆãªã„ãŸã‚ã€
é€†å¼•ãç”¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”¨æ„:</p>
<pre class="codehilite"><code class="language-json">// ç›£æŸ»ã‚»ãƒƒãƒˆ â†’ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ (é †æ–¹å‘)
{
  &quot;table&quot;: &quot;audit.audit_set_collaborators&quot;,
  &quot;partition_key&quot;: [&quot;user_email&quot;],
  &quot;clustering_key&quot;: [&quot;audit_set_id&quot;]
}

// ç›£æŸ»ã‚»ãƒƒãƒˆ â† ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ (é€†æ–¹å‘)
{
  &quot;table&quot;: &quot;audit.collaborators_by_audit_set&quot;,
  &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
  &quot;clustering_key&quot;: [&quot;user_email&quot;]
}
</code></pre>

<hr />
<h2 id="5">5. ãƒ‡ãƒ¼ã‚¿ç§»è¡Œ<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ç¾è¡Œã‚¹ã‚­ãƒ¼ãƒã‹ã‚‰ã®å¤‰æ›´ç‚¹<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å¤‰æ›´ã‚¿ã‚¤ãƒ—</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹åˆ†å‰²</td>
<td>å˜ä¸€namespace â†’ ã‚µãƒ¼ãƒ“ã‚¹åˆ¥</td>
</tr>
<tr>
<td>ãƒ†ãƒ¼ãƒ–ãƒ«åå¤‰æ›´</td>
<td>snake_caseçµ±ä¸€</td>
</tr>
<tr>
<td>ã‚«ãƒ©ãƒ å‹çµ±ä¸€</td>
<td>TIMESTAMP â†’ BIGINT</td>
</tr>
<tr>
<td>é€†å¼•ããƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ </td>
<td>ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æœ€é©åŒ–</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 ç§»è¡Œæ‰‹é †<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<ol>
<li>æ–°ã‚¹ã‚­ãƒ¼ãƒä½œæˆ</li>
<li>ãƒ‡ãƒ¼ã‚¿äºŒé‡æ›¸ãè¾¼ã¿é–‹å§‹</li>
<li>æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ç§»è¡Œï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰</li>
<li>ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§æ¤œè¨¼</li>
<li>èª­ã¿å–ã‚Šå…ˆåˆ‡ã‚Šæ›¿ãˆ</li>
<li>äºŒé‡æ›¸ãè¾¼ã¿åœæ­¢</li>
<li>æ—§ãƒ†ãƒ¼ãƒ–ãƒ«å‰Šé™¤</li>
</ol>
<hr />
<h2 id="6">6. ã‚¹ã‚­ãƒ¼ãƒç®¡ç†<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-schema-loader">6.1 Schema Loaderä½¿ç”¨<a class="headerlink" href="#61-schema-loader" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash"># ã‚¹ã‚­ãƒ¼ãƒä½œæˆ
java -jar scalardb-schema-loader-3.14.0.jar \
  --config scalardb.properties \
  --schema-file schema.json \
  --coordinator

# ã‚¹ã‚­ãƒ¼ãƒå‰Šé™¤
java -jar scalardb-schema-loader-3.14.0.jar \
  --config scalardb.properties \
  --schema-file schema.json \
  --delete-all
</code></pre>

<h3 id="62">6.2 çµ±åˆã‚¹ã‚­ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;scalar_auditor.audit.audit_set&quot;: {
    &quot;partition-key&quot;: [&quot;audit_set_id&quot;],
    &quot;clustering-key&quot;: [],
    &quot;columns&quot;: {
      &quot;audit_set_id&quot;: &quot;TEXT&quot;,
      &quot;name&quot;: &quot;TEXT&quot;,
      ...
    }
  },
  &quot;scalar_auditor.verification.item_status&quot;: {
    ...
  }
}
</code></pre>
</article>
<article id="design-scalardb-schema">
<h1 id="scalardb">ScalarDB ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1-namespace">1. Namespaceè¨­è¨ˆ<a class="headerlink" href="#1-namespace" title="Permanent link">&para;</a></h2>
<h3 id="11-namespace">1.1 Namespaceä¸€è¦§<a class="headerlink" href="#11-namespace" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>èª¬æ˜</th>
<th>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</th>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>identity</code></td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»èªè¨¼ç®¡ç†</td>
<td>PostgreSQL</td>
<td>5</td>
</tr>
<tr>
<td><code>audit</code></td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆãƒ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†</td>
<td>PostgreSQL</td>
<td>6</td>
</tr>
<tr>
<td><code>file</code></td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ•ã‚©ãƒ«ãƒ€ç®¡ç†</td>
<td>PostgreSQL</td>
<td>4</td>
</tr>
<tr>
<td><code>event</code></td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ç®¡ç†</td>
<td>Cassandra</td>
<td>5</td>
</tr>
<tr>
<td><code>coordinator</code></td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³èª¿æ•´</td>
<td>PostgreSQL</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="12-namespace">1.2 Namespaceé–¢ä¿‚å›³<a class="headerlink" href="#12-namespace" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "PostgreSQL"
        IDENTITY[identity]
        AUDIT[audit]
        FILE[file]
        COORD[coordinator]
    end

    subgraph "Cassandra"
        EVENT[event]
    end

    AUDIT -->|user_idå‚ç…§| IDENTITY
    AUDIT -->|item_idå‚ç…§| FILE
    FILE -->|user_idå‚ç…§| IDENTITY
    EVENT -->|user_idå‚ç…§| IDENTITY
    EVENT -->|item_idå‚ç…§| FILE
</div>

<hr />
<h2 id="2-identity-namespace">2. Identity Namespace<a class="headerlink" href="#2-identity-namespace" title="Permanent link">&para;</a></h2>
<h3 id="21-users">2.1 users ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#21-users" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;identity&quot;,
  &quot;table&quot;: &quot;users&quot;,
  &quot;partition_key&quot;: [&quot;user_email&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;user_id&quot;: &quot;BIGINT&quot;,
    &quot;name&quot;: &quot;TEXT&quot;,
    &quot;password_hash&quot;: &quot;TEXT&quot;,
    &quot;role&quot;: &quot;TEXT&quot;,
    &quot;org_id&quot;: &quot;TEXT&quot;,
    &quot;organization_name&quot;: &quot;TEXT&quot;,
    &quot;image_url&quot;: &quot;TEXT&quot;,
    &quot;is_deleted&quot;: &quot;BOOLEAN&quot;,
    &quot;is_box_admin&quot;: &quot;BOOLEAN&quot;,
    &quot;language_code&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;user_id&quot;, &quot;org_id&quot;]
}
</code></pre>

<p><strong>Javaå®šç¾©:</strong></p>
<pre class="codehilite"><code class="language-java">TableMetadata usersMetadata = TableMetadata.newBuilder()
    .addPartitionKey(&quot;user_email&quot;)
    .addColumn(&quot;user_email&quot;, DataType.TEXT)
    .addColumn(&quot;user_id&quot;, DataType.BIGINT)
    .addColumn(&quot;name&quot;, DataType.TEXT)
    .addColumn(&quot;password_hash&quot;, DataType.TEXT)
    .addColumn(&quot;role&quot;, DataType.TEXT)
    .addColumn(&quot;org_id&quot;, DataType.TEXT)
    .addColumn(&quot;organization_name&quot;, DataType.TEXT)
    .addColumn(&quot;image_url&quot;, DataType.TEXT)
    .addColumn(&quot;is_deleted&quot;, DataType.BOOLEAN)
    .addColumn(&quot;is_box_admin&quot;, DataType.BOOLEAN)
    .addColumn(&quot;language_code&quot;, DataType.TEXT)
    .addColumn(&quot;created_at&quot;, DataType.BIGINT)
    .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
    .addSecondaryIndex(&quot;user_id&quot;)
    .addSecondaryIndex(&quot;org_id&quot;)
    .build();
</code></pre>

<h3 id="22-user_tokens">2.2 user_tokens ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#22-user_tokens" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;identity&quot;,
  &quot;table&quot;: &quot;user_tokens&quot;,
  &quot;partition_key&quot;: [&quot;user_email&quot;],
  &quot;clustering_key&quot;: [&quot;token_type&quot;],
  &quot;columns&quot;: {
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;token_type&quot;: &quot;TEXT&quot;,
    &quot;refresh_token&quot;: &quot;TEXT&quot;,
    &quot;access_token&quot;: &quot;TEXT&quot;,
    &quot;expires_at&quot;: &quot;BIGINT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<h3 id="23-user_otps">2.3 user_otps ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#23-user_otps" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;identity&quot;,
  &quot;table&quot;: &quot;user_otps&quot;,
  &quot;partition_key&quot;: [&quot;user_email&quot;],
  &quot;clustering_key&quot;: [&quot;otp_type&quot;],
  &quot;columns&quot;: {
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;otp_type&quot;: &quot;TEXT&quot;,
    &quot;otp_code&quot;: &quot;TEXT&quot;,
    &quot;expires_at&quot;: &quot;BIGINT&quot;,
    &quot;is_used&quot;: &quot;BOOLEAN&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<h3 id="24-organizations">2.4 organizations ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#24-organizations" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;identity&quot;,
  &quot;table&quot;: &quot;organizations&quot;,
  &quot;partition_key&quot;: [&quot;org_id&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;org_id&quot;: &quot;TEXT&quot;,
    &quot;enterprise_id&quot;: &quot;TEXT&quot;,
    &quot;org_name&quot;: &quot;TEXT&quot;,
    &quot;admin_email&quot;: &quot;TEXT&quot;,
    &quot;is_active&quot;: &quot;BOOLEAN&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;enterprise_id&quot;]
}
</code></pre>

<h3 id="25-role_users">2.5 role_users ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#25-role_users" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;identity&quot;,
  &quot;table&quot;: &quot;role_users&quot;,
  &quot;partition_key&quot;: [&quot;user_email&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;role_type&quot;: &quot;TEXT&quot;,
    &quot;permissions&quot;: &quot;TEXT&quot;,
    &quot;assigned_at&quot;: &quot;BIGINT&quot;,
    &quot;assigned_by&quot;: &quot;TEXT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;role_type&quot;]
}
</code></pre>

<hr />
<h2 id="3-audit-namespace">3. Audit Namespace<a class="headerlink" href="#3-audit-namespace" title="Permanent link">&para;</a></h2>
<h3 id="31-audit_sets">3.1 audit_sets ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#31-audit_sets" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_sets&quot;,
  &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;audit_set_id&quot;: &quot;TEXT&quot;,
    &quot;audit_set_name&quot;: &quot;TEXT&quot;,
    &quot;description&quot;: &quot;TEXT&quot;,
    &quot;owner_id&quot;: &quot;BIGINT&quot;,
    &quot;owner_email&quot;: &quot;TEXT&quot;,
    &quot;owner_name&quot;: &quot;TEXT&quot;,
    &quot;is_deleted&quot;: &quot;BOOLEAN&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;owner_id&quot;, &quot;owner_email&quot;]
}
</code></pre>

<p><strong>Javaå®šç¾©:</strong></p>
<pre class="codehilite"><code class="language-java">TableMetadata auditSetsMetadata = TableMetadata.newBuilder()
    .addPartitionKey(&quot;audit_set_id&quot;)
    .addColumn(&quot;audit_set_id&quot;, DataType.TEXT)
    .addColumn(&quot;audit_set_name&quot;, DataType.TEXT)
    .addColumn(&quot;description&quot;, DataType.TEXT)
    .addColumn(&quot;owner_id&quot;, DataType.BIGINT)
    .addColumn(&quot;owner_email&quot;, DataType.TEXT)
    .addColumn(&quot;owner_name&quot;, DataType.TEXT)
    .addColumn(&quot;is_deleted&quot;, DataType.BOOLEAN)
    .addColumn(&quot;created_at&quot;, DataType.BIGINT)
    .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
    .addSecondaryIndex(&quot;owner_id&quot;)
    .addSecondaryIndex(&quot;owner_email&quot;)
    .build();
</code></pre>

<h3 id="32-audit_set_items">3.2 audit_set_items ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#32-audit_set_items" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_set_items&quot;,
  &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
  &quot;clustering_key&quot;: [&quot;item_id&quot;],
  &quot;clustering_key_order&quot;: {&quot;item_id&quot;: &quot;ASC&quot;},
  &quot;columns&quot;: {
    &quot;audit_set_id&quot;: &quot;TEXT&quot;,
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;item_name&quot;: &quot;TEXT&quot;,
    &quot;item_type&quot;: &quot;TEXT&quot;,
    &quot;monitoring_status&quot;: &quot;TEXT&quot;,
    &quot;verification_status&quot;: &quot;TEXT&quot;,
    &quot;assigned_by_user_id&quot;: &quot;BIGINT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;monitoring_status&quot;, &quot;verification_status&quot;]
}
</code></pre>

<p><strong>Javaå®šç¾©:</strong></p>
<pre class="codehilite"><code class="language-java">TableMetadata auditSetItemsMetadata = TableMetadata.newBuilder()
    .addPartitionKey(&quot;audit_set_id&quot;)
    .addClusteringKey(&quot;item_id&quot;, Scan.Ordering.Order.ASC)
    .addColumn(&quot;audit_set_id&quot;, DataType.TEXT)
    .addColumn(&quot;item_id&quot;, DataType.BIGINT)
    .addColumn(&quot;item_name&quot;, DataType.TEXT)
    .addColumn(&quot;item_type&quot;, DataType.TEXT)
    .addColumn(&quot;monitoring_status&quot;, DataType.TEXT)
    .addColumn(&quot;verification_status&quot;, DataType.TEXT)
    .addColumn(&quot;assigned_by_user_id&quot;, DataType.BIGINT)
    .addColumn(&quot;created_at&quot;, DataType.BIGINT)
    .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
    .addSecondaryIndex(&quot;monitoring_status&quot;)
    .addSecondaryIndex(&quot;verification_status&quot;)
    .build();
</code></pre>

<h3 id="33-audit_set_collaborators">3.3 audit_set_collaborators ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#33-audit_set_collaborators" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_set_collaborators&quot;,
  &quot;partition_key&quot;: [&quot;audit_set_id&quot;],
  &quot;clustering_key&quot;: [&quot;user_email&quot;],
  &quot;columns&quot;: {
    &quot;audit_set_id&quot;: &quot;TEXT&quot;,
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;user_id&quot;: &quot;BIGINT&quot;,
    &quot;user_name&quot;: &quot;TEXT&quot;,
    &quot;collaborator_role&quot;: &quot;TEXT&quot;,
    &quot;invited_by&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;user_id&quot;, &quot;collaborator_role&quot;]
}
</code></pre>

<h3 id="34-audit_groups">3.4 audit_groups ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#34-audit_groups" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_groups&quot;,
  &quot;partition_key&quot;: [&quot;audit_group_id&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;audit_group_id&quot;: &quot;TEXT&quot;,
    &quot;audit_group_name&quot;: &quot;TEXT&quot;,
    &quot;description&quot;: &quot;TEXT&quot;,
    &quot;owner_id&quot;: &quot;BIGINT&quot;,
    &quot;owner_email&quot;: &quot;TEXT&quot;,
    &quot;owner_name&quot;: &quot;TEXT&quot;,
    &quot;is_deleted&quot;: &quot;BOOLEAN&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;owner_id&quot;]
}
</code></pre>

<h3 id="35-audit_group_members">3.5 audit_group_members ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#35-audit_group_members" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_group_members&quot;,
  &quot;partition_key&quot;: [&quot;audit_group_id&quot;],
  &quot;clustering_key&quot;: [&quot;user_email&quot;],
  &quot;columns&quot;: {
    &quot;audit_group_id&quot;: &quot;TEXT&quot;,
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;user_id&quot;: &quot;BIGINT&quot;,
    &quot;member_role&quot;: &quot;TEXT&quot;,
    &quot;added_by&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;user_id&quot;]
}
</code></pre>

<h3 id="36-audit_group_set_mappings">3.6 audit_group_set_mappings ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#36-audit_group_set_mappings" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;audit&quot;,
  &quot;table&quot;: &quot;audit_group_set_mappings&quot;,
  &quot;partition_key&quot;: [&quot;audit_group_id&quot;],
  &quot;clustering_key&quot;: [&quot;audit_set_id&quot;],
  &quot;columns&quot;: {
    &quot;audit_group_id&quot;: &quot;TEXT&quot;,
    &quot;audit_set_id&quot;: &quot;TEXT&quot;,
    &quot;linked_at&quot;: &quot;BIGINT&quot;,
    &quot;linked_by&quot;: &quot;TEXT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<hr />
<h2 id="4-file-namespace">4. File Namespace<a class="headerlink" href="#4-file-namespace" title="Permanent link">&para;</a></h2>
<h3 id="41-items">4.1 items ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#41-items" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;file&quot;,
  &quot;table&quot;: &quot;items&quot;,
  &quot;partition_key&quot;: [&quot;item_id&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;item_type&quot;: &quot;TEXT&quot;,
    &quot;item_name&quot;: &quot;TEXT&quot;,
    &quot;parent_folder_id&quot;: &quot;BIGINT&quot;,
    &quot;sha1_hash&quot;: &quot;TEXT&quot;,
    &quot;size&quot;: &quot;BIGINT&quot;,
    &quot;storage_provider&quot;: &quot;TEXT&quot;,
    &quot;is_deleted&quot;: &quot;BOOLEAN&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;sha1_hash&quot;, &quot;parent_folder_id&quot;]
}
</code></pre>

<p><strong>Javaå®šç¾©:</strong></p>
<pre class="codehilite"><code class="language-java">TableMetadata itemsMetadata = TableMetadata.newBuilder()
    .addPartitionKey(&quot;item_id&quot;)
    .addColumn(&quot;item_id&quot;, DataType.BIGINT)
    .addColumn(&quot;item_type&quot;, DataType.TEXT)
    .addColumn(&quot;item_name&quot;, DataType.TEXT)
    .addColumn(&quot;parent_folder_id&quot;, DataType.BIGINT)
    .addColumn(&quot;sha1_hash&quot;, DataType.TEXT)
    .addColumn(&quot;size&quot;, DataType.BIGINT)
    .addColumn(&quot;storage_provider&quot;, DataType.TEXT)
    .addColumn(&quot;is_deleted&quot;, DataType.BOOLEAN)
    .addColumn(&quot;created_at&quot;, DataType.BIGINT)
    .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
    .addSecondaryIndex(&quot;sha1_hash&quot;)
    .addSecondaryIndex(&quot;parent_folder_id&quot;)
    .build();
</code></pre>

<h3 id="42-item_monitoring_status">4.2 item_monitoring_status ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#42-item_monitoring_status" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;file&quot;,
  &quot;table&quot;: &quot;item_monitoring_status&quot;,
  &quot;partition_key&quot;: [&quot;item_id&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;monitoring_status&quot;: &quot;TEXT&quot;,
    &quot;last_checked_at&quot;: &quot;BIGINT&quot;,
    &quot;last_version_id&quot;: &quot;BIGINT&quot;,
    &quot;last_sha1_hash&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;monitoring_status&quot;]
}
</code></pre>

<h3 id="43-items_by_sha1">4.3 items_by_sha1 ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#43-items_by_sha1" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;file&quot;,
  &quot;table&quot;: &quot;items_by_sha1&quot;,
  &quot;partition_key&quot;: [&quot;sha1_hash&quot;],
  &quot;clustering_key&quot;: [&quot;item_id&quot;],
  &quot;columns&quot;: {
    &quot;sha1_hash&quot;: &quot;TEXT&quot;,
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;item_name&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<h3 id="44-file_versions">4.4 file_versions ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#44-file_versions" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;file&quot;,
  &quot;table&quot;: &quot;file_versions&quot;,
  &quot;partition_key&quot;: [&quot;item_id&quot;],
  &quot;clustering_key&quot;: [&quot;version_id&quot;],
  &quot;clustering_key_order&quot;: {&quot;version_id&quot;: &quot;DESC&quot;},
  &quot;columns&quot;: {
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;version_id&quot;: &quot;BIGINT&quot;,
    &quot;version_name&quot;: &quot;TEXT&quot;,
    &quot;sha1_hash&quot;: &quot;TEXT&quot;,
    &quot;size&quot;: &quot;BIGINT&quot;,
    &quot;modified_by_id&quot;: &quot;BIGINT&quot;,
    &quot;modified_by_name&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<hr />
<h2 id="5-event-namespace-cassandra">5. Event Namespace (Cassandra)<a class="headerlink" href="#5-event-namespace-cassandra" title="Permanent link">&para;</a></h2>
<h3 id="51-events">5.1 events ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#51-events" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;event&quot;,
  &quot;table&quot;: &quot;events&quot;,
  &quot;partition_key&quot;: [&quot;yyyymmdd&quot;],
  &quot;clustering_key&quot;: [&quot;event_id&quot;],
  &quot;clustering_key_order&quot;: {&quot;event_id&quot;: &quot;DESC&quot;},
  &quot;columns&quot;: {
    &quot;yyyymmdd&quot;: &quot;TEXT&quot;,
    &quot;event_id&quot;: &quot;TEXT&quot;,
    &quot;event_type&quot;: &quot;TEXT&quot;,
    &quot;timestamp&quot;: &quot;BIGINT&quot;,
    &quot;user_id&quot;: &quot;BIGINT&quot;,
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;user_name&quot;: &quot;TEXT&quot;,
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;item_name&quot;: &quot;TEXT&quot;,
    &quot;item_type&quot;: &quot;TEXT&quot;,
    &quot;sha1_hash&quot;: &quot;TEXT&quot;,
    &quot;parent_folder_id&quot;: &quot;BIGINT&quot;,
    &quot;source_json&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;user_id&quot;, &quot;item_id&quot;, &quot;event_type&quot;]
}
</code></pre>

<p><strong>Javaå®šç¾©:</strong></p>
<pre class="codehilite"><code class="language-java">TableMetadata eventsMetadata = TableMetadata.newBuilder()
    .addPartitionKey(&quot;yyyymmdd&quot;)
    .addClusteringKey(&quot;event_id&quot;, Scan.Ordering.Order.DESC)
    .addColumn(&quot;yyyymmdd&quot;, DataType.TEXT)
    .addColumn(&quot;event_id&quot;, DataType.TEXT)
    .addColumn(&quot;event_type&quot;, DataType.TEXT)
    .addColumn(&quot;timestamp&quot;, DataType.BIGINT)
    .addColumn(&quot;user_id&quot;, DataType.BIGINT)
    .addColumn(&quot;user_email&quot;, DataType.TEXT)
    .addColumn(&quot;user_name&quot;, DataType.TEXT)
    .addColumn(&quot;item_id&quot;, DataType.BIGINT)
    .addColumn(&quot;item_name&quot;, DataType.TEXT)
    .addColumn(&quot;item_type&quot;, DataType.TEXT)
    .addColumn(&quot;sha1_hash&quot;, DataType.TEXT)
    .addColumn(&quot;parent_folder_id&quot;, DataType.BIGINT)
    .addColumn(&quot;source_json&quot;, DataType.TEXT)
    .addColumn(&quot;created_at&quot;, DataType.BIGINT)
    .addSecondaryIndex(&quot;user_id&quot;)
    .addSecondaryIndex(&quot;item_id&quot;)
    .addSecondaryIndex(&quot;event_type&quot;)
    .build();
</code></pre>

<h3 id="52-events_by_item">5.2 events_by_item ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆé€†å¼•ãç”¨ï¼‰<a class="headerlink" href="#52-events_by_item" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;event&quot;,
  &quot;table&quot;: &quot;events_by_item&quot;,
  &quot;partition_key&quot;: [&quot;item_id&quot;],
  &quot;clustering_key&quot;: [&quot;timestamp&quot;, &quot;event_id&quot;],
  &quot;clustering_key_order&quot;: {&quot;timestamp&quot;: &quot;DESC&quot;, &quot;event_id&quot;: &quot;DESC&quot;},
  &quot;columns&quot;: {
    &quot;item_id&quot;: &quot;BIGINT&quot;,
    &quot;timestamp&quot;: &quot;BIGINT&quot;,
    &quot;event_id&quot;: &quot;TEXT&quot;,
    &quot;event_type&quot;: &quot;TEXT&quot;,
    &quot;user_id&quot;: &quot;BIGINT&quot;,
    &quot;user_name&quot;: &quot;TEXT&quot;,
    &quot;yyyymmdd&quot;: &quot;TEXT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<h3 id="53-position_tracker">5.3 position_tracker ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#53-position_tracker" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;event&quot;,
  &quot;table&quot;: &quot;position_tracker&quot;,
  &quot;partition_key&quot;: [&quot;tracker_type&quot;],
  &quot;clustering_key&quot;: [],
  &quot;columns&quot;: {
    &quot;tracker_type&quot;: &quot;TEXT&quot;,
    &quot;stream_position&quot;: &quot;TEXT&quot;,
    &quot;last_event_id&quot;: &quot;TEXT&quot;,
    &quot;last_synced_at&quot;: &quot;BIGINT&quot;,
    &quot;updated_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<h3 id="54-auditor_logs">5.4 auditor_logs ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#54-auditor_logs" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;event&quot;,
  &quot;table&quot;: &quot;auditor_logs&quot;,
  &quot;partition_key&quot;: [&quot;yyyymmdd&quot;],
  &quot;clustering_key&quot;: [&quot;log_id&quot;],
  &quot;clustering_key_order&quot;: {&quot;log_id&quot;: &quot;DESC&quot;},
  &quot;columns&quot;: {
    &quot;yyyymmdd&quot;: &quot;TEXT&quot;,
    &quot;log_id&quot;: &quot;TEXT&quot;,
    &quot;user_email&quot;: &quot;TEXT&quot;,
    &quot;user_name&quot;: &quot;TEXT&quot;,
    &quot;action&quot;: &quot;TEXT&quot;,
    &quot;resource_type&quot;: &quot;TEXT&quot;,
    &quot;resource_id&quot;: &quot;TEXT&quot;,
    &quot;ip_address&quot;: &quot;TEXT&quot;,
    &quot;user_agent&quot;: &quot;TEXT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: [&quot;user_email&quot;]
}
</code></pre>

<h3 id="55-system_event_dates">5.5 system_event_dates ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#55-system_event_dates" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-json">{
  &quot;namespace&quot;: &quot;event&quot;,
  &quot;table&quot;: &quot;system_event_dates&quot;,
  &quot;partition_key&quot;: [&quot;date_type&quot;],
  &quot;clustering_key&quot;: [&quot;yyyymmdd&quot;],
  &quot;clustering_key_order&quot;: {&quot;yyyymmdd&quot;: &quot;DESC&quot;},
  &quot;columns&quot;: {
    &quot;date_type&quot;: &quot;TEXT&quot;,
    &quot;yyyymmdd&quot;: &quot;TEXT&quot;,
    &quot;event_count&quot;: &quot;BIGINT&quot;,
    &quot;created_at&quot;: &quot;BIGINT&quot;
  },
  &quot;secondary_indexes&quot;: []
}
</code></pre>

<hr />
<h2 id="6">6. ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³æˆ¦ç•¥<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼è¨­è¨ˆåŸå‰‡<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>identity</td>
<td>users</td>
<td>user_email</td>
<td>ãƒ¦ãƒ‹ãƒ¼ã‚¯è­˜åˆ¥å­ã€å‡ç­‰åˆ†æ•£</td>
</tr>
<tr>
<td>audit</td>
<td>audit_sets</td>
<td>audit_set_id</td>
<td>UUIDã€å‡ç­‰åˆ†æ•£</td>
</tr>
<tr>
<td>audit</td>
<td>audit_set_items</td>
<td>audit_set_id</td>
<td>ã‚»ãƒƒãƒˆå˜ä½ã§ã®ã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³</td>
</tr>
<tr>
<td>file</td>
<td>items</td>
<td>item_id</td>
<td>BOX IDã€ãƒ¦ãƒ‹ãƒ¼ã‚¯</td>
</tr>
<tr>
<td>event</td>
<td>events</td>
<td>yyyymmdd</td>
<td>æ—¥ä»˜ãƒ™ãƒ¼ã‚¹ã®æ™‚ç³»åˆ—ã‚¢ã‚¯ã‚»ã‚¹</td>
</tr>
</tbody>
</table>
<h3 id="62">6.2 ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚µã‚¤ã‚ºè¦‹ç©ã‚‚ã‚Š<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "identity.users"
        U[1ãƒ¬ã‚³ãƒ¼ãƒ‰ â‰ˆ 500B]
        U --> UT[ç·ãƒ¬ã‚³ãƒ¼ãƒ‰: 10,000]
        UT --> US[ç·ã‚µã‚¤ã‚º: ~5MB]
    end

    subgraph "audit.audit_set_items"
        ASI[1ãƒ¬ã‚³ãƒ¼ãƒ‰ â‰ˆ 300B]
        ASI --> ASIT[å¹³å‡100ã‚¢ã‚¤ãƒ†ãƒ /ã‚»ãƒƒãƒˆ]
        ASIT --> ASIS[ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³: ~30KB]
    end

    subgraph "event.events"
        E[1ãƒ¬ã‚³ãƒ¼ãƒ‰ â‰ˆ 800B]
        E --> ET[1æ—¥10,000ã‚¤ãƒ™ãƒ³ãƒˆ]
        ET --> ES[ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³: ~8MB/æ—¥]
    end
</div>

<h3 id="63">6.3 ãƒ›ãƒƒãƒˆãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å¯¾ç­–<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<p><strong>ã‚¤ãƒ™ãƒ³ãƒˆãƒ†ãƒ¼ãƒ–ãƒ«:</strong>
- æ—¥ä»˜ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ï¼ˆyyyymmddï¼‰ã§è‡ªç„¶åˆ†æ•£
- å¤ã„ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã¯èª­ã¿å–ã‚Šå°‚ç”¨</p>
<p><strong>ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ :</strong>
- ã‚»ãƒƒãƒˆIDã§åˆ†æ•£
- å¤§è¦æ¨¡ã‚»ãƒƒãƒˆï¼ˆ10,000+ã‚¢ã‚¤ãƒ†ãƒ ï¼‰ã¯ãƒšãƒ¼ã‚¸ãƒ³ã‚°</p>
<hr />
<h2 id="7">7. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹è¨­è¨ˆ<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ã‚»ã‚«ãƒ³ãƒ€ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä¸€è¦§<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Namespace</th>
<th>ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚«ãƒ©ãƒ </th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>identity</td>
<td>users</td>
<td>user_id</td>
<td>BOX IDæ¤œç´¢</td>
</tr>
<tr>
<td>identity</td>
<td>users</td>
<td>org_id</td>
<td>çµ„ç¹”åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢</td>
</tr>
<tr>
<td>audit</td>
<td>audit_sets</td>
<td>owner_id</td>
<td>ã‚ªãƒ¼ãƒŠãƒ¼åˆ¥æ¤œç´¢</td>
</tr>
<tr>
<td>audit</td>
<td>audit_set_items</td>
<td>monitoring_status</td>
<td>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¥ãƒ•ã‚£ãƒ«ã‚¿</td>
</tr>
<tr>
<td>file</td>
<td>items</td>
<td>sha1_hash</td>
<td>é‡è¤‡ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢</td>
</tr>
<tr>
<td>event</td>
<td>events</td>
<td>user_id</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢</td>
</tr>
<tr>
<td>event</td>
<td>events</td>
<td>item_id</td>
<td>ã‚¢ã‚¤ãƒ†ãƒ åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 è¤‡åˆã‚¯ã‚¨ãƒªãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// ãƒ‘ã‚¿ãƒ¼ãƒ³1: ç›£æŸ»ã‚»ãƒƒãƒˆã®ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ï¼ˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ï¼‰
Scan scan = Scan.newBuilder()
    .namespace(&quot;audit&quot;)
    .table(&quot;audit_set_items&quot;)
    .partitionKey(Key.ofText(&quot;audit_set_id&quot;, auditSetId))
    .orderings(Scan.Ordering.asc(&quot;item_id&quot;))
    .build();

// ãƒ‘ã‚¿ãƒ¼ãƒ³2: æ—¥ä»˜ç¯„å›²ã®ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢
Scan scan = Scan.newBuilder()
    .namespace(&quot;event&quot;)
    .table(&quot;events&quot;)
    .partitionKey(Key.ofText(&quot;yyyymmdd&quot;, &quot;20250101&quot;))
    .start(Key.ofText(&quot;event_id&quot;, startEventId))
    .limit(100)
    .build();

// ãƒ‘ã‚¿ãƒ¼ãƒ³3: SHA1ã«ã‚ˆã‚‹ãƒ•ã‚¡ã‚¤ãƒ«æ¤œç´¢
Scan scan = Scan.newBuilder()
    .namespace(&quot;file&quot;)
    .table(&quot;items_by_sha1&quot;)
    .partitionKey(Key.ofText(&quot;sha1_hash&quot;, sha1Hash))
    .build();
</code></pre>

<hr />
<h2 id="8">8. ãƒ‡ãƒ¼ã‚¿å‹ãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81-scalardb">8.1 ç¾è¡Œãƒ¢ãƒ‡ãƒ« â†’ ScalarDBãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#81-scalardb" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Javaãƒ¢ãƒ‡ãƒ«å‹</th>
<th>ç¾è¡ŒDBå‹</th>
<th>ScalarDBå‹</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>String</td>
<td>VARCHAR</td>
<td>TEXT</td>
<td>-</td>
</tr>
<tr>
<td>Long</td>
<td>BIGINT</td>
<td>BIGINT</td>
<td>-</td>
</tr>
<tr>
<td>Integer</td>
<td>INT</td>
<td>INT</td>
<td>-</td>
</tr>
<tr>
<td>Boolean</td>
<td>BOOLEAN</td>
<td>BOOLEAN</td>
<td>-</td>
</tr>
<tr>
<td>Instant</td>
<td>TIMESTAMP</td>
<td>BIGINT</td>
<td>Epoch millis</td>
</tr>
<tr>
<td>LocalDate</td>
<td>DATE</td>
<td>TEXT</td>
<td>yyyyMMddå½¢å¼</td>
</tr>
<tr>
<td>JSON String</td>
<td>VARCHAR</td>
<td>TEXT</td>
<td>æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿</td>
</tr>
</tbody>
</table>
<h3 id="82-json">8.2 JSONåˆ—ã®æ­£è¦åŒ–<a class="headerlink" href="#82-json" title="Permanent link">&para;</a></h3>
<p><strong>ç¾è¡Œï¼ˆéæ¨å¥¨ï¼‰:</strong></p>
<pre class="codehilite"><code class="language-java">// AuditSet.aclJson - JSONæ–‡å­—åˆ—ã¨ã—ã¦ä¿å­˜
private String aclJson;
</code></pre>

<p><strong>ç›®æ¨™ï¼ˆæ­£è¦åŒ–ï¼‰:</strong></p>
<pre class="codehilite"><code class="language-java">// audit_set_collaboratorsãƒ†ãƒ¼ãƒ–ãƒ«ã§æ­£è¦åŒ–
// ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚­ãƒ¼: audit_set_id
// ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚­ãƒ¼: user_email
</code></pre>

<hr />
<h2 id="9">9. ã‚¹ã‚­ãƒ¼ãƒä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 åˆæœŸåŒ–ã‚³ãƒ¼ãƒ‰<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">public class SchemaInitializer {
    private final Admin admin;

    public void initializeSchema() throws Exception {
        // Namespaces
        admin.createNamespace(&quot;identity&quot;, true);
        admin.createNamespace(&quot;audit&quot;, true);
        admin.createNamespace(&quot;file&quot;, true);
        admin.createNamespace(&quot;event&quot;, true);

        // Identity tables
        createUsersTable();
        createUserTokensTable();
        createUserOtpsTable();
        createOrganizationsTable();
        createRoleUsersTable();

        // Audit tables
        createAuditSetsTable();
        createAuditSetItemsTable();
        createAuditSetCollaboratorsTable();
        createAuditGroupsTable();
        createAuditGroupMembersTable();
        createAuditGroupSetMappingsTable();

        // File tables
        createItemsTable();
        createItemMonitoringStatusTable();
        createItemsBySha1Table();
        createFileVersionsTable();

        // Event tables
        createEventsTable();
        createEventsByItemTable();
        createPositionTrackerTable();
        createAuditorLogsTable();
        createSystemEventDatesTable();
    }
}
</code></pre>

<h3 id="92">9.2 ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆä¾‹<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">private void createAuditSetsTable() throws Exception {
    TableMetadata metadata = TableMetadata.newBuilder()
        .addPartitionKey(&quot;audit_set_id&quot;)
        .addColumn(&quot;audit_set_id&quot;, DataType.TEXT)
        .addColumn(&quot;audit_set_name&quot;, DataType.TEXT)
        .addColumn(&quot;description&quot;, DataType.TEXT)
        .addColumn(&quot;owner_id&quot;, DataType.BIGINT)
        .addColumn(&quot;owner_email&quot;, DataType.TEXT)
        .addColumn(&quot;owner_name&quot;, DataType.TEXT)
        .addColumn(&quot;is_deleted&quot;, DataType.BOOLEAN)
        .addColumn(&quot;created_at&quot;, DataType.BIGINT)
        .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
        .addSecondaryIndex(&quot;owner_id&quot;)
        .addSecondaryIndex(&quot;owner_email&quot;)
        .build();

    admin.createTable(&quot;audit&quot;, &quot;audit_sets&quot;, metadata, true);
}
</code></pre>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: scalar-event-log-fetcher-main</em>
<em>ScalarDB Version: 3.14.x</em></p>
</article>
<article id="design-scalardb-transaction-design">
<h1 id="scalardb">ScalarDB ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¨­è¨ˆ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 å˜ä¸€ã‚µãƒ¼ãƒ“ã‚¹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Controller
    participant S as Service
    participant TM as TransactionManager
    participant R as Repository
    participant DB as ScalarDB

    C->>S: createAuditSet(request)
    S->>TM: start()
    TM-->>S: Transaction
    S->>R: save(auditSet)
    R->>DB: put(auditSet)
    R->>DB: put(collaborator)
    S->>TM: commit()
    TM->>DB: prepare + commit
    S-->>C: AuditSet
</div>

<p><strong>å®Ÿè£…ä¾‹</strong>:</p>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetService {

    @Autowired
    private DistributedTransactionManager transactionManager;

    public AuditSet createAuditSet(CreateAuditSetRequest request) {
        DistributedTransaction tx = transactionManager.start();
        try {
            // ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ
            AuditSet auditSet = AuditSet.builder()
                .id(UUID.randomUUID().toString())
                .name(request.getName())
                .description(request.getDescription())
                .ownerUserId(request.getOwnerId())
                .build();

            tx.put(auditSetRepository.toPut(auditSet));

            // æ‰€æœ‰è€…ã‚’ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦è¿½åŠ 
            AuditSetCollaborator collaborator = AuditSetCollaborator.builder()
                .auditSetId(auditSet.getId())
                .userEmail(request.getOwnerEmail())
                .role(CollaboratorRole.OWNER)
                .build();

            tx.put(collaboratorRepository.toPut(collaborator));

            tx.commit();
            return auditSet;

        } catch (Exception e) {
            tx.abort();
            throw new ServiceException(&quot;Failed to create audit set&quot;, e);
        }
    }
}
</code></pre>

<hr />
<h3 id="12-saga">1.2 ã‚¯ãƒ­ã‚¹ã‚µãƒ¼ãƒ“ã‚¹ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆSagaï¼‰<a class="headerlink" href="#12-saga" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant O as Orchestrator
    participant AMS as Audit Management
    participant IS as Item Service
    participant VS as Verification

    O->>AMS: addItemToAuditSet(auditSetId, itemId)
    AMS->>AMS: validateAuditSet()
    AMS->>IS: getItem(itemId)
    IS-->>AMS: Item
    AMS->>AMS: addItemRecord()
    AMS->>VS: registerForMonitoring(itemId)

    alt Success
        VS-->>AMS: success
        AMS->>AMS: commit()
        AMS-->>O: success
    else Failure
        VS-->>AMS: failure
        AMS->>AMS: removeItemRecord() [compensate]
        AMS-->>O: failure
    end
</div>

<p><strong>Sagaã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¿ãƒ¼å®Ÿè£…</strong>:</p>
<pre class="codehilite"><code class="language-java">@Service
public class AddItemSaga {

    @Autowired
    private AuditSetService auditSetService;

    @Autowired
    private ItemServiceClient itemClient;

    @Autowired
    private VerificationServiceClient verificationClient;

    public void execute(String auditSetId, String itemId) {
        SagaContext context = new SagaContext();

        try {
            // Step 1: ã‚¢ã‚¤ãƒ†ãƒ æƒ…å ±å–å¾—
            Item item = itemClient.getItem(itemId);

            // Step 2: ç›£æŸ»ã‚»ãƒƒãƒˆã«ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
            auditSetService.addItem(auditSetId, item);
            context.markCompleted(&quot;addItem&quot;);

            // Step 3: æ¤œè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã«ç™»éŒ²
            verificationClient.registerForMonitoring(itemId);
            context.markCompleted(&quot;registerMonitoring&quot;);

        } catch (Exception e) {
            compensate(context, auditSetId, itemId);
            throw new SagaException(&quot;Add item saga failed&quot;, e);
        }
    }

    private void compensate(SagaContext context, String auditSetId, String itemId) {
        if (context.isCompleted(&quot;registerMonitoring&quot;)) {
            verificationClient.unregisterFromMonitoring(itemId);
        }
        if (context.isCompleted(&quot;addItem&quot;)) {
            auditSetService.removeItem(auditSetId, itemId);
        }
    }
}
</code></pre>

<hr />
<h2 id="2">2. åˆ†é›¢ãƒ¬ãƒ™ãƒ«ã¨ãƒ­ãƒƒã‚¯æˆ¦ç•¥<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 åˆ†é›¢ãƒ¬ãƒ™ãƒ«é¸æŠ<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ“ä½œã‚¿ã‚¤ãƒ—</th>
<th>åˆ†é›¢ãƒ¬ãƒ™ãƒ«</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ</td>
<td>SERIALIZABLE</td>
<td>ä¸€æ„æ€§ä¿è¨¼</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ›´æ–°</td>
<td>SERIALIZABLE</td>
<td>ç«¶åˆé˜²æ­¢</td>
</tr>
<tr>
<td>ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ </td>
<td>SERIALIZABLE</td>
<td>æ•´åˆæ€§ä¿è¨¼</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆèª­ã¿å–ã‚Š</td>
<td>SNAPSHOT</td>
<td>èª­ã¿å–ã‚Šå°‚ç”¨ã€é«˜é€Ÿ</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ç¢ºèª</td>
<td>SNAPSHOT</td>
<td>èª­ã¿å–ã‚Šå°‚ç”¨</td>
</tr>
</tbody>
</table>
<h3 id="22">2.2 æ¥½è¦³çš„ãƒ­ãƒƒã‚¯<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetService {

    public void updateAuditSet(String id, UpdateRequest request) {
        DistributedTransaction tx = transactionManager.start();
        try {
            // ç¾åœ¨ã®çŠ¶æ…‹ã‚’å–å¾—
            Optional&lt;Result&gt; result = tx.get(
                Get.newBuilder()
                    .namespace(&quot;audit&quot;)
                    .table(&quot;audit_set&quot;)
                    .partitionKey(Key.ofText(&quot;audit_set_id&quot;, id))
                    .build()
            );

            if (result.isEmpty()) {
                throw new NotFoundException(&quot;Audit set not found&quot;);
            }

            // ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆæ¥½è¦³çš„ãƒ­ãƒƒã‚¯ï¼‰
            long currentVersion = result.get().getBigInt(&quot;version&quot;);
            if (currentVersion != request.getExpectedVersion()) {
                throw new OptimisticLockException(&quot;Concurrent modification detected&quot;);
            }

            // æ›´æ–°
            tx.put(
                Put.newBuilder()
                    .namespace(&quot;audit&quot;)
                    .table(&quot;audit_set&quot;)
                    .partitionKey(Key.ofText(&quot;audit_set_id&quot;, id))
                    .textValue(&quot;name&quot;, request.getName())
                    .bigIntValue(&quot;version&quot;, currentVersion + 1)
                    .build()
            );

            tx.commit();

        } catch (Exception e) {
            tx.abort();
            throw e;
        }
    }
}
</code></pre>

<hr />
<h2 id="3">3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Configuration
public class TransactionRetryConfig {

    @Bean
    public RetryTemplate transactionRetryTemplate() {
        return RetryTemplate.builder()
            .maxAttempts(3)
            .exponentialBackoff(100, 2, 1000)
            .retryOn(TransactionConflictException.class)
            .retryOn(TransactionRetryableException.class)
            .build();
    }
}

@Service
public class AuditSetService {

    @Autowired
    private RetryTemplate retryTemplate;

    public AuditSet createWithRetry(CreateAuditSetRequest request) {
        return retryTemplate.execute(context -&gt; {
            return createAuditSet(request);
        });
    }
}
</code></pre>

<h3 id="32">3.2 ãƒ‡ãƒƒãƒ‰ãƒ¬ã‚¿ãƒ¼å‡¦ç†<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class TransactionDeadLetterHandler {

    @Autowired
    private DeadLetterQueue deadLetterQueue;

    public void handleFailedTransaction(
            String transactionId, 
            Object payload, 
            Exception exception) {

        DeadLetter letter = DeadLetter.builder()
            .transactionId(transactionId)
            .payload(serialize(payload))
            .errorMessage(exception.getMessage())
            .errorType(exception.getClass().getName())
            .timestamp(Instant.now())
            .retryCount(0)
            .build();

        deadLetterQueue.enqueue(letter);

        // ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡
        alertService.sendAlert(&quot;Transaction failed: &quot; + transactionId);
    }
}
</code></pre>

<hr />
<h2 id="4">4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ãƒãƒƒãƒæ“ä½œ<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class EventService {

    public void saveEventsBatch(List&lt;Event&gt; events) {
        DistributedTransaction tx = transactionManager.start();
        try {
            for (Event event : events) {
                // events ãƒ†ãƒ¼ãƒ–ãƒ«
                tx.put(eventRepository.toPut(event));

                // item_events ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆéæ­£è¦åŒ–ï¼‰
                tx.put(itemEventRepository.toPut(event));
            }
            tx.commit();
        } catch (Exception e) {
            tx.abort();
            throw e;
        }
    }
}
</code></pre>

<h3 id="42">4.2 èª­ã¿å–ã‚Šæœ€é©åŒ–<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class EventQueryService {

    @Autowired
    private DistributedStorage storage;  // èª­ã¿å–ã‚Šå°‚ç”¨

    public List&lt;Event&gt; getEventsByDate(String date) {
        // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãªã—ã§é«˜é€Ÿèª­ã¿å–ã‚Š
        Scan scan = Scan.newBuilder()
            .namespace(&quot;event&quot;)
            .table(&quot;events&quot;)
            .partitionKey(Key.ofText(&quot;yyyy_mm_dd&quot;, date))
            .ordering(Ordering.desc(&quot;event_id&quot;))
            .limit(100)
            .build();

        return storage.scan(scan)
            .stream()
            .map(this::toEvent)
            .collect(Collectors.toList());
    }
}
</code></pre>

<hr />
<h2 id="5">5. åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-two-phase-commitscalardb">5.1 Two-Phase Commitï¼ˆScalarDBå†…éƒ¨ï¼‰<a class="headerlink" href="#51-two-phase-commitscalardb" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant App as Application
    participant Coord as Coordinator
    participant P1 as Partition 1
    participant P2 as Partition 2

    App->>Coord: commit()

    rect rgb(200, 220, 240)
        Note over Coord,P2: Prepare Phase
        Coord->>P1: prepare
        Coord->>P2: prepare
        P1-->>Coord: prepared
        P2-->>Coord: prepared
    end

    rect rgb(200, 240, 200)
        Note over Coord,P2: Commit Phase
        Coord->>P1: commit
        Coord->>P2: commit
        P1-->>Coord: committed
        P2-->>Coord: committed
    end

    Coord-->>App: success
</div>

<h3 id="52-outbox-pattern">5.2 Outbox Patternï¼ˆã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œï¼‰<a class="headerlink" href="#52-outbox-pattern" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetService {

    public AuditSet createAuditSet(CreateAuditSetRequest request) {
        DistributedTransaction tx = transactionManager.start();
        try {
            // 1. ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ
            AuditSet auditSet = createAuditSetEntity(request);
            tx.put(auditSetRepository.toPut(auditSet));

            // 2. Outboxã«ã‚¤ãƒ™ãƒ³ãƒˆç™»éŒ²ï¼ˆåŒä¸€ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
            OutboxEvent event = OutboxEvent.builder()
                .id(UUID.randomUUID().toString())
                .aggregateType(&quot;AuditSet&quot;)
                .aggregateId(auditSet.getId())
                .eventType(&quot;AuditSetCreated&quot;)
                .payload(serialize(auditSet))
                .status(&quot;PENDING&quot;)
                .build();
            tx.put(outboxRepository.toPut(event));

            tx.commit();
            return auditSet;

        } catch (Exception e) {
            tx.abort();
            throw e;
        }
    }
}

// Outboxã‚¤ãƒ™ãƒ³ãƒˆã‚’åˆ¥ãƒ—ãƒ­ã‚»ã‚¹ã§ç™ºè¡Œ
@Scheduled(fixedRate = 1000)
public void publishOutboxEvents() {
    List&lt;OutboxEvent&gt; pending = outboxRepository.findPending();
    for (OutboxEvent event : pending) {
        try {
            eventPublisher.publish(event);
            outboxRepository.markPublished(event.getId());
        } catch (Exception e) {
            log.error(&quot;Failed to publish event: {}&quot;, event.getId(), e);
        }
    }
}
</code></pre>

<hr />
<h2 id="6">6. ç›£è¦–ãƒ»ãƒ‡ãƒãƒƒã‚°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ­ã‚°<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Aspect
@Component
public class TransactionLoggingAspect {

    @Around(&quot;@annotation(Transactional)&quot;)
    public Object logTransaction(ProceedingJoinPoint pjp) throws Throwable {
        String txId = UUID.randomUUID().toString();
        long startTime = System.currentTimeMillis();

        MDC.put(&quot;transactionId&quot;, txId);
        log.info(&quot;Transaction started: {}&quot;, pjp.getSignature().getName());

        try {
            Object result = pjp.proceed();
            long duration = System.currentTimeMillis() - startTime;
            log.info(&quot;Transaction committed: {} ({}ms)&quot;, txId, duration);
            return result;
        } catch (Exception e) {
            long duration = System.currentTimeMillis() - startTime;
            log.error(&quot;Transaction aborted: {} ({}ms) - {}&quot;, txId, duration, e.getMessage());
            throw e;
        } finally {
            MDC.remove(&quot;transactionId&quot;);
        }
    }
}
</code></pre>

<h3 id="62">6.2 ãƒ¡ãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class TransactionMetrics {

    private final MeterRegistry meterRegistry;
    private final Counter commitCounter;
    private final Counter abortCounter;
    private final Timer transactionTimer;

    public TransactionMetrics(MeterRegistry meterRegistry) {
        this.meterRegistry = meterRegistry;
        this.commitCounter = Counter.builder(&quot;scalardb.transaction.commit&quot;)
            .description(&quot;Number of committed transactions&quot;)
            .register(meterRegistry);
        this.abortCounter = Counter.builder(&quot;scalardb.transaction.abort&quot;)
            .description(&quot;Number of aborted transactions&quot;)
            .register(meterRegistry);
        this.transactionTimer = Timer.builder(&quot;scalardb.transaction.duration&quot;)
            .description(&quot;Transaction duration&quot;)
            .register(meterRegistry);
    }

    public void recordCommit(long durationMs) {
        commitCounter.increment();
        transactionTimer.record(durationMs, TimeUnit.MILLISECONDS);
    }

    public void recordAbort(long durationMs, String reason) {
        abortCounter.increment();
        meterRegistry.counter(&quot;scalardb.transaction.abort.reason&quot;, &quot;reason&quot;, reason).increment();
    }
}
</code></pre>
</article>
<article id="design-scalardb-transaction">
<h1 id="scalardb">ScalarDB ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¨­è¨ˆ<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†é¡<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
<th>é©ç”¨å ´é¢</th>
<th>ç‰¹å¾´</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å˜ä¸€Namespace ACID</strong></td>
<td>åŒä¸€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆå†…æ“ä½œ</td>
<td>Consensus Commit</td>
</tr>
<tr>
<td><strong>åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</strong></td>
<td>è¤‡æ•°Namespaceæ¨ªæ–­</td>
<td>Two-Phase Commit</td>
</tr>
<tr>
<td><strong>Saga</strong></td>
<td>é•·æ™‚é–“ãƒ»è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</td>
<td>è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒãƒ¼ã‚¸ãƒ£è¨­å®š<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-properties"># ScalarDB Transactionè¨­å®š
scalar.db.transaction_manager=consensus-commit
scalar.db.consensus_commit.isolation_level=SERIALIZABLE
scalar.db.consensus_commit.serializable_strategy=EXTRA_READ

# Coordinatorè¨­å®š
scalar.db.consensus_commit.coordinator.namespace=coordinator
scalar.db.consensus_commit.coordinator.group_commit.enabled=true
</code></pre>

<hr />
<h2 id="2-consensus-commit">2. Consensus Commitãƒ—ãƒ­ãƒˆã‚³ãƒ«<a class="headerlink" href="#2-consensus-commit" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ãƒ—ãƒ­ãƒˆã‚³ãƒ«æ¦‚è¦<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant App as Application
    participant TM as Transaction Manager
    participant Coord as Coordinator
    participant S1 as Storage 1
    participant S2 as Storage 2

    App->>TM: begin()
    TM->>TM: Generate TX ID

    App->>TM: get(key1)
    TM->>S1: read(key1)
    S1-->>TM: value1

    App->>TM: put(key2, value2)
    TM->>TM: Buffer write

    App->>TM: commit()

    Note over TM,S2: Prepare Phase
    TM->>S1: prepare(key1)
    TM->>S2: prepare(key2)
    S1-->>TM: prepared
    S2-->>TM: prepared

    Note over TM,Coord: Commit Phase
    TM->>Coord: commit(TX ID)
    Coord-->>TM: committed

    Note over TM,S2: Finalize Phase
    TM->>S1: commit(key1)
    TM->>S2: commit(key2)

    TM-->>App: success
</div>

<h3 id="22-consensus-commit">2.2 Consensus CommitçŠ¶æ…‹é·ç§»<a class="headerlink" href="#22-consensus-commit" title="Permanent link">&para;</a></h3>
<div class="mermaid">
stateDiagram-v2
    [*] --> Initialized: begin()
    Initialized --> Active: first operation
    Active --> Preparing: commit()
    Preparing --> Prepared: all prepared
    Prepared --> Committing: coordinator committed
    Committing --> Committed: all finalized
    Committed --> [*]

    Active --> Aborting: abort() or error
    Preparing --> Aborting: prepare failed
    Prepared --> Aborting: coordinator commit failed
    Aborting --> Aborted: rollback complete
    Aborted --> [*]
</div>

<hr />
<h2 id="3">3. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹åˆ¥ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³è¨­è¨ˆ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Controller
    participant AS as AuditService
    participant TM as TransactionManager
    participant AuditDB as audit namespace
    participant IdentityDB as identity namespace

    C->>AS: createAuditSet(request)
    AS->>TM: begin()

    AS->>IdentityDB: get(user_email) // ä½œæˆè€…ç¢ºèª
    IdentityDB-->>AS: User

    AS->>AuditDB: put(audit_set)
    AS->>AuditDB: put(audit_set_collaborator) // ã‚ªãƒ¼ãƒŠãƒ¼ç™»éŒ²

    AS->>TM: commit()
    TM->>TM: Consensus Commit
    TM-->>AS: success

    AS-->>C: AuditSetResponse
</div>

<p><strong>å®Ÿè£…ã‚³ãƒ¼ãƒ‰:</strong></p>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetService {
    private final DistributedTransactionManager manager;

    @Transactional
    public AuditSet createAuditSet(CreateAuditSetRequest request) {
        DistributedTransaction tx = manager.start();
        try {
            // 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼å­˜åœ¨ç¢ºèª
            Get getUser = Get.newBuilder()
                .namespace(&quot;identity&quot;)
                .table(&quot;users&quot;)
                .partitionKey(Key.ofText(&quot;user_email&quot;, request.getOwnerEmail()))
                .build();
            Optional&lt;Result&gt; userResult = tx.get(getUser);
            if (userResult.isEmpty()) {
                throw new UserNotFoundException(request.getOwnerEmail());
            }

            // 2. ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ
            String auditSetId = UUID.randomUUID().toString();
            Put putAuditSet = Put.newBuilder()
                .namespace(&quot;audit&quot;)
                .table(&quot;audit_sets&quot;)
                .partitionKey(Key.ofText(&quot;audit_set_id&quot;, auditSetId))
                .textValue(&quot;audit_set_name&quot;, request.getName())
                .textValue(&quot;description&quot;, request.getDescription())
                .bigIntValue(&quot;owner_id&quot;, userResult.get().getBigInt(&quot;user_id&quot;))
                .textValue(&quot;owner_email&quot;, request.getOwnerEmail())
                .booleanValue(&quot;is_deleted&quot;, false)
                .bigIntValue(&quot;created_at&quot;, Instant.now().toEpochMilli())
                .build();
            tx.put(putAuditSet);

            // 3. ã‚ªãƒ¼ãƒŠãƒ¼ã‚’ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦ç™»éŒ²
            Put putCollaborator = Put.newBuilder()
                .namespace(&quot;audit&quot;)
                .table(&quot;audit_set_collaborators&quot;)
                .partitionKey(Key.ofText(&quot;audit_set_id&quot;, auditSetId))
                .clusteringKey(Key.ofText(&quot;user_email&quot;, request.getOwnerEmail()))
                .textValue(&quot;collaborator_role&quot;, &quot;OWNER&quot;)
                .bigIntValue(&quot;created_at&quot;, Instant.now().toEpochMilli())
                .build();
            tx.put(putCollaborator);

            tx.commit();
            return mapToAuditSet(auditSetId, request);

        } catch (Exception e) {
            tx.abort();
            throw new TransactionException(&quot;Failed to create audit set&quot;, e);
        }
    }
}
</code></pre>

<h3 id="32">3.2 ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ <a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Controller
    participant AS as AuditItemService
    participant TM as TransactionManager
    participant AuditDB as audit namespace
    participant FileDB as file namespace
    participant EventDB as event namespace

    C->>AS: addItem(auditSetId, itemId)
    AS->>TM: begin()

    AS->>AuditDB: get(audit_set) // å­˜åœ¨ç¢ºèª
    AS->>AuditDB: get(collaborator) // æ¨©é™ç¢ºèª
    AS->>FileDB: get(item) // ã‚¢ã‚¤ãƒ†ãƒ æƒ…å ±å–å¾—

    AS->>AuditDB: put(audit_set_item)
    AS->>FileDB: put(item_monitoring_status)
    AS->>EventDB: put(auditor_log) // ç›£æŸ»ãƒ­ã‚°

    AS->>TM: commit()
    TM->>TM: Consensus Commit (3 namespaces)
    TM-->>AS: success

    AS-->>C: AuditSetItemResponse
</div>

<p><strong>å®Ÿè£…ã‚³ãƒ¼ãƒ‰:</strong></p>
<pre class="codehilite"><code class="language-java">@Service
public class AuditItemService {
    private final DistributedTransactionManager manager;

    @Transactional
    public AuditSetItem addItemToAuditSet(String auditSetId, Long itemId, String userEmail) {
        DistributedTransaction tx = manager.start();
        try {
            // 1. ç›£æŸ»ã‚»ãƒƒãƒˆå­˜åœ¨ç¢ºèª
            validateAuditSetExists(tx, auditSetId);

            // 2. æ¨©é™ç¢ºèª
            validateUserPermission(tx, auditSetId, userEmail, &quot;ADD_ITEM&quot;);

            // 3. ã‚¢ã‚¤ãƒ†ãƒ æƒ…å ±å–å¾—
            Get getItem = Get.newBuilder()
                .namespace(&quot;file&quot;)
                .table(&quot;items&quot;)
                .partitionKey(Key.ofBigInt(&quot;item_id&quot;, itemId))
                .build();
            Result itemResult = tx.get(getItem)
                .orElseThrow(() -&gt; new ItemNotFoundException(itemId));

            // 4. ç›£æŸ»ã‚»ãƒƒãƒˆã‚¢ã‚¤ãƒ†ãƒ ç™»éŒ²
            Put putItem = Put.newBuilder()
                .namespace(&quot;audit&quot;)
                .table(&quot;audit_set_items&quot;)
                .partitionKey(Key.ofText(&quot;audit_set_id&quot;, auditSetId))
                .clusteringKey(Key.ofBigInt(&quot;item_id&quot;, itemId))
                .textValue(&quot;item_name&quot;, itemResult.getText(&quot;item_name&quot;))
                .textValue(&quot;item_type&quot;, itemResult.getText(&quot;item_type&quot;))
                .textValue(&quot;monitoring_status&quot;, &quot;PENDING&quot;)
                .textValue(&quot;verification_status&quot;, &quot;NOT_VERIFIED&quot;)
                .bigIntValue(&quot;created_at&quot;, Instant.now().toEpochMilli())
                .build();
            tx.put(putItem);

            // 5. ç›£è¦–ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
            Put putStatus = Put.newBuilder()
                .namespace(&quot;file&quot;)
                .table(&quot;item_monitoring_status&quot;)
                .partitionKey(Key.ofBigInt(&quot;item_id&quot;, itemId))
                .textValue(&quot;monitoring_status&quot;, &quot;MONITORING&quot;)
                .bigIntValue(&quot;updated_at&quot;, Instant.now().toEpochMilli())
                .build();
            tx.put(putStatus);

            // 6. ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²
            recordAuditLog(tx, userEmail, &quot;ADD_ITEM&quot;, auditSetId, itemId.toString());

            tx.commit();
            return mapToAuditSetItem(auditSetId, itemId);

        } catch (CrudConflictException e) {
            tx.abort();
            throw new ConflictException(&quot;Item already exists in audit set&quot;, e);
        } catch (Exception e) {
            tx.abort();
            throw new TransactionException(&quot;Failed to add item&quot;, e);
        }
    }
}
</code></pre>

<h3 id="33">3.3 ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼æ‹›å¾…<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant C as Controller
    participant CS as CollaboratorService
    participant TM as TransactionManager
    participant AuditDB as audit namespace
    participant IdentityDB as identity namespace

    C->>CS: inviteCollaborator(auditSetId, email, role)
    CS->>TM: begin()

    CS->>AuditDB: get(audit_set)
    CS->>AuditDB: get(inviter_collaborator) // æ‹›å¾…è€…æ¨©é™ç¢ºèª
    CS->>IdentityDB: get(invitee_user) // æ‹›å¾…å¯¾è±¡è€…ç¢ºèª

    alt ãƒ¦ãƒ¼ã‚¶ãƒ¼å­˜åœ¨
        CS->>AuditDB: put(audit_set_collaborator)
        CS->>TM: commit()
        CS-->>C: CollaboratorResponse
    else ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸åœ¨
        CS->>TM: abort()
        CS-->>C: UserNotFoundError
    end
</div>

<hr />
<h2 id="4-saga">4. Sagaãƒ‘ã‚¿ãƒ¼ãƒ³è¨­è¨ˆ<a class="headerlink" href="#4-saga" title="Permanent link">&para;</a></h2>
<h3 id="41-saga">4.1 ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤Saga<a class="headerlink" href="#41-saga" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant O as Orchestrator
    participant AS as AuditService
    participant IS as ItemService
    participant VS as VerificationService
    participant ES as EventService

    Note over O: Sagaé–‹å§‹
    O->>AS: 1. markAuditSetDeleted(id)
    AS-->>O: success

    O->>IS: 2. removeItemMonitoring(items)
    IS-->>O: success

    O->>VS: 3. archiveVerificationRecords(items)
    VS-->>O: success

    O->>ES: 4. logDeletionEvent(auditSetId)
    ES-->>O: success

    Note over O: Sagaå®Œäº†

    Note over O: è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ä¾‹
    alt Step 3 å¤±æ•—æ™‚
        O->>IS: compensate: restoreItemMonitoring(items)
        O->>AS: compensate: unmarkAuditSetDeleted(id)
    end
</div>

<p><strong>Sagaå®Ÿè£…:</strong></p>
<pre class="codehilite"><code class="language-java">@Service
public class AuditSetDeletionSaga {
    private final AuditService auditService;
    private final ItemService itemService;
    private final VerificationService verificationService;
    private final EventService eventService;

    public void deleteAuditSet(String auditSetId, String userId) {
        SagaContext context = new SagaContext();

        try {
            // Step 1: ç›£æŸ»ã‚»ãƒƒãƒˆè«–ç†å‰Šé™¤
            auditService.markDeleted(auditSetId);
            context.addCompensation(() -&gt; auditService.unmarkDeleted(auditSetId));

            // Step 2: ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§å–å¾—ã¨ç›£è¦–è§£é™¤
            List&lt;Long&gt; itemIds = auditService.getItemIds(auditSetId);
            itemService.removeMonitoring(itemIds);
            context.addCompensation(() -&gt; itemService.restoreMonitoring(itemIds));

            // Step 3: æ¤œè¨¼è¨˜éŒ²ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
            verificationService.archiveRecords(auditSetId);
            context.addCompensation(() -&gt; verificationService.restoreRecords(auditSetId));

            // Step 4: å‰Šé™¤ã‚¤ãƒ™ãƒ³ãƒˆè¨˜éŒ²
            eventService.logDeletion(auditSetId, userId);
            // ã‚¤ãƒ™ãƒ³ãƒˆè¨˜éŒ²ã¯è£œå„Ÿä¸è¦

            // Sagaå®Œäº†
            context.complete();

        } catch (Exception e) {
            // è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
            context.compensate();
            throw new SagaFailedException(&quot;Audit set deletion failed&quot;, e);
        }
    }
}

public class SagaContext {
    private final List&lt;Runnable&gt; compensations = new ArrayList&lt;&gt;();
    private boolean completed = false;

    public void addCompensation(Runnable compensation) {
        compensations.add(0, compensation); // é€†é †ã§å®Ÿè¡Œ
    }

    public void compensate() {
        if (!completed) {
            compensations.forEach(c -&gt; {
                try {
                    c.run();
                } catch (Exception e) {
                    log.error(&quot;Compensation failed&quot;, e);
                }
            });
        }
    }

    public void complete() {
        completed = true;
    }
}
</code></pre>

<h3 id="42-saga">4.2 æ”¹ã–ã‚“æ¤œè¨¼Saga<a class="headerlink" href="#42-saga" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant O as Orchestrator
    participant FS as FileService
    participant VS as VerificationService
    participant SDL as ScalarDL
    participant AS as AuditService
    participant ES as EventService

    Note over O: æ¤œè¨¼Sagaé–‹å§‹
    O->>FS: 1. getFileSha1(itemId)
    FS-->>O: sha1Hash

    O->>SDL: 2. validateAsset(itemId, sha1)
    SDL-->>O: validationResult

    O->>VS: 3. updateVerificationStatus(itemId, result)
    VS-->>O: success

    O->>AS: 4. updateItemVerificationStatus(auditSetId, itemId)
    AS-->>O: success

    O->>ES: 5. logVerificationEvent(itemId, result)
    ES-->>O: success

    Note over O: Sagaå®Œäº†
</div>

<hr />
<h2 id="5">5. ä¾‹å¤–å‡¦ç†æˆ¦ç•¥<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ä¾‹å¤–åˆ†é¡<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ä¾‹å¤–ã‚¿ã‚¤ãƒ—</th>
<th>å¯¾å¿œ</th>
<th>ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Transient</strong></td>
<td>ãƒªãƒˆãƒ©ã‚¤</td>
<td>CrudConflictException, CommitConflictException</td>
</tr>
<tr>
<td><strong>Non-Transient</strong></td>
<td>ã‚¨ãƒ©ãƒ¼è¿”å´</td>
<td>ValidationException, NotFoundException</td>
</tr>
<tr>
<td><strong>Unknown</strong></td>
<td>å†ªç­‰æ€§ãƒã‚§ãƒƒã‚¯</td>
<td>UnknownTransactionStatusException</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 ãƒªãƒˆãƒ©ã‚¤æˆ¦ç•¥<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class TransactionRetryHandler {
    private static final int MAX_RETRIES = 3;
    private static final long INITIAL_BACKOFF_MS = 100;

    public &lt;T&gt; T executeWithRetry(Supplier&lt;T&gt; operation) {
        int attempt = 0;
        while (true) {
            try {
                return operation.get();
            } catch (CrudConflictException | CommitConflictException e) {
                attempt++;
                if (attempt &gt;= MAX_RETRIES) {
                    throw new RetryExhaustedException(&quot;Max retries exceeded&quot;, e);
                }
                backoff(attempt);
            }
        }
    }

    private void backoff(int attempt) {
        long sleepMs = INITIAL_BACKOFF_MS * (1L &lt;&lt; (attempt - 1));
        try {
            Thread.sleep(sleepMs + ThreadLocalRandom.current().nextLong(50));
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
    }
}
</code></pre>

<h3 id="53-unknowntransactionstatus">5.3 UnknownTransactionStatuså‡¦ç†<a class="headerlink" href="#53-unknowntransactionstatus" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">public class IdempotentTransactionHandler {
    private final DistributedTransactionManager manager;
    private final IdempotencyKeyStore keyStore;

    public &lt;T&gt; T executeIdempotent(String idempotencyKey, Supplier&lt;T&gt; operation) {
        // 1. æ—¢å­˜çµæœãƒã‚§ãƒƒã‚¯
        Optional&lt;T&gt; existingResult = keyStore.get(idempotencyKey);
        if (existingResult.isPresent()) {
            return existingResult.get();
        }

        DistributedTransaction tx = manager.start();
        try {
            T result = operation.get();
            tx.commit();

            // çµæœã‚’ä¿å­˜
            keyStore.save(idempotencyKey, result);
            return result;

        } catch (UnknownTransactionStatusException e) {
            // ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³çŠ¶æ…‹ä¸æ˜
            // ã‚³ãƒ¼ãƒ‡ã‚£ãƒãƒ¼ã‚¿ãƒ¼ã‚’ãƒã‚§ãƒƒã‚¯
            TransactionState state = manager.getState(tx.getId());

            if (state == TransactionState.COMMITTED) {
                // ã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿ - çµæœã‚’å†æ§‹ç¯‰
                T result = reconstructResult(tx.getId());
                keyStore.save(idempotencyKey, result);
                return result;
            } else {
                // æœªã‚³ãƒŸãƒƒãƒˆ - ã‚¨ãƒ©ãƒ¼è¿”å´
                throw new TransactionFailedException(&quot;Transaction status unknown&quot;, e);
            }
        } catch (Exception e) {
            tx.abort();
            throw new TransactionException(&quot;Transaction failed&quot;, e);
        }
    }
}
</code></pre>

<h3 id="54">5.4 ä¾‹å¤–ãƒãƒ³ãƒ‰ãƒ©<a class="headerlink" href="#54" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@ControllerAdvice
public class ScalarDbExceptionHandler {

    @ExceptionHandler(CrudConflictException.class)
    public ResponseEntity&lt;ErrorResponse&gt; handleConflict(CrudConflictException e) {
        log.warn(&quot;CRUD conflict: {}&quot;, e.getMessage());
        return ResponseEntity
            .status(HttpStatus.CONFLICT)
            .body(new ErrorResponse(&quot;CONFLICT&quot;, &quot;Resource was modified by another transaction&quot;));
    }

    @ExceptionHandler(CommitConflictException.class)
    public ResponseEntity&lt;ErrorResponse&gt; handleCommitConflict(CommitConflictException e) {
        log.warn(&quot;Commit conflict: {}&quot;, e.getMessage());
        return ResponseEntity
            .status(HttpStatus.CONFLICT)
            .body(new ErrorResponse(&quot;COMMIT_CONFLICT&quot;, &quot;Transaction commit failed due to conflict&quot;));
    }

    @ExceptionHandler(UnknownTransactionStatusException.class)
    public ResponseEntity&lt;ErrorResponse&gt; handleUnknown(UnknownTransactionStatusException e) {
        log.error(&quot;Unknown transaction status: {}&quot;, e.getMessage());
        return ResponseEntity
            .status(HttpStatus.INTERNAL_SERVER_ERROR)
            .body(new ErrorResponse(&quot;UNKNOWN_STATUS&quot;, &quot;Transaction status is unknown. Please retry.&quot;));
    }

    @ExceptionHandler(PreparationConflictException.class)
    public ResponseEntity&lt;ErrorResponse&gt; handlePreparationConflict(PreparationConflictException e) {
        log.warn(&quot;Preparation conflict: {}&quot;, e.getMessage());
        return ResponseEntity
            .status(HttpStatus.CONFLICT)
            .body(new ErrorResponse(&quot;PREPARATION_CONFLICT&quot;, &quot;Transaction preparation failed&quot;));
    }
}
</code></pre>

<hr />
<h2 id="6-two-phase-commit">6. Two-Phase Commitè¨­è¨ˆ<a class="headerlink" href="#6-two-phase-commit" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ã‚µãƒ¼ãƒ“ã‚¹é–“ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant App as Application
    participant TM1 as TX Manager (Audit)
    participant TM2 as TX Manager (File)
    participant Coord as Coordinator

    App->>TM1: beginTwoPhaseCommit()
    App->>TM2: join(tx.getId())

    App->>TM1: operations...
    App->>TM2: operations...

    App->>TM1: prepare()
    App->>TM2: prepare()

    TM1-->>App: prepared
    TM2-->>App: prepared

    App->>TM1: validate()
    App->>TM2: validate()

    TM1-->>App: validated
    TM2-->>App: validated

    App->>Coord: commit(tx.getId())
    Coord-->>App: committed

    App->>TM1: commit()
    App->>TM2: commit()
</div>

<h3 id="62-two-phase-commit">6.2 Two-Phase Commitå®Ÿè£…<a class="headerlink" href="#62-two-phase-commit" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Service
public class CrossServiceTransactionManager {
    private final TwoPhaseCommitTransactionManager txManager;

    public void executeAcrossServices(CrossServiceOperation operation) {
        TwoPhaseCommitTransaction tx = txManager.begin();
        try {
            // 1. å„ã‚µãƒ¼ãƒ“ã‚¹ã®æ“ä½œå®Ÿè¡Œ
            operation.execute(tx);

            // 2. Prepare Phase
            tx.prepare();

            // 3. Validation Phase
            tx.validate();

            // 4. Commit Phase
            tx.commit();

        } catch (PreparationConflictException e) {
            tx.rollback();
            throw new TransactionConflictException(&quot;Prepare failed&quot;, e);
        } catch (ValidationConflictException e) {
            tx.rollback();
            throw new TransactionConflictException(&quot;Validation failed&quot;, e);
        } catch (CommitConflictException e) {
            tx.rollback();
            throw new TransactionConflictException(&quot;Commit failed&quot;, e);
        }
    }
}
</code></pre>

<hr />
<h2 id="7">7. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71-group-commit">7.1 Group Commit<a class="headerlink" href="#71-group-commit" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-properties"># Group Commitè¨­å®š
scalar.db.consensus_commit.coordinator.group_commit.enabled=true
scalar.db.consensus_commit.coordinator.group_commit.slot_capacity=20
scalar.db.consensus_commit.coordinator.group_commit.group_size_fix_timeout_millis=40
scalar.db.consensus_commit.coordinator.group_commit.delayed_slot_move_timeout_millis=800
</code></pre>

<div class="mermaid">
graph LR
    subgraph "Without Group Commit"
        T1[TX1] --> C1[Commit]
        T2[TX2] --> C2[Commit]
        T3[TX3] --> C3[Commit]
        C1 --> DB1[(DB Write)]
        C2 --> DB2[(DB Write)]
        C3 --> DB3[(DB Write)]
    end

    subgraph "With Group Commit"
        GT1[TX1] --> GC[Group]
        GT2[TX2] --> GC
        GT3[TX3] --> GC
        GC --> GDB[(Single DB Write)]
    end
</div>

<h3 id="72">7.2 ä¸¦åˆ—å®Ÿè¡Œ<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-properties"># Parallel Execution
scalar.db.consensus_commit.parallel_executor_count=32
scalar.db.consensus_commit.parallel_preparation_enabled=true
scalar.db.consensus_commit.parallel_validation_enabled=true
scalar.db.consensus_commit.parallel_commit_enabled=true
scalar.db.consensus_commit.parallel_rollback_enabled=true
</code></pre>

<h3 id="73">7.3 èª­ã¿å–ã‚Šæœ€é©åŒ–<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">// è¤‡æ•°ã‚­ãƒ¼ã®ä¸¦åˆ—èª­ã¿å–ã‚Š
public List&lt;Result&gt; batchGet(List&lt;Get&gt; gets) {
    return tx.get(gets); // å†…éƒ¨ã§ä¸¦åˆ—åŒ–
}

// Scanæœ€é©åŒ–
Scan scan = Scan.newBuilder()
    .namespace(&quot;audit&quot;)
    .table(&quot;audit_set_items&quot;)
    .partitionKey(Key.ofText(&quot;audit_set_id&quot;, auditSetId))
    .limit(100)  // ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºåˆ¶é™
    .projections(&quot;item_id&quot;, &quot;item_name&quot;, &quot;monitoring_status&quot;)  // å¿…è¦ã‚«ãƒ©ãƒ ã®ã¿
    .build();
</code></pre>

<hr />
<h2 id="8">8. ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¡ãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">metrics:
  - name: scalardb_transaction_duration_seconds
    type: histogram
    labels: [operation, namespace, status]

  - name: scalardb_transaction_total
    type: counter
    labels: [namespace, status]

  - name: scalardb_conflict_total
    type: counter
    labels: [type, namespace]

  - name: scalardb_retry_total
    type: counter
    labels: [namespace]
</code></pre>

<h3 id="82">8.2 ãƒ­ã‚°è¨­è¨ˆ<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Aspect
@Component
public class TransactionLoggingAspect {

    @Around(&quot;@annotation(Transactional)&quot;)
    public Object logTransaction(ProceedingJoinPoint pjp) throws Throwable {
        String txId = UUID.randomUUID().toString();
        long start = System.currentTimeMillis();

        MDC.put(&quot;txId&quot;, txId);
        log.info(&quot;TX_START: method={}&quot;, pjp.getSignature().getName());

        try {
            Object result = pjp.proceed();
            long duration = System.currentTimeMillis() - start;
            log.info(&quot;TX_COMMIT: duration={}ms&quot;, duration);
            return result;
        } catch (Exception e) {
            long duration = System.currentTimeMillis() - start;
            log.error(&quot;TX_ABORT: duration={}ms, error={}&quot;, duration, e.getMessage());
            throw e;
        } finally {
            MDC.remove(&quot;txId&quot;);
        }
    }
}
</code></pre>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: scalar-event-log-fetcher-main</em>
<em>ScalarDB Version: 3.14.x</em></p>
</article>
<article id="design-scalardb-migration">
<h1 id="scalardb">ScalarDB ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨ˆç”»<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ç¾çŠ¶æ§‹æˆ<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Current System"
        APP[Spring Boot App]
        SDB_CURRENT[(ScalarDB Cluster<br/>Single Storage)]
        SDL[(ScalarDL)]
    end

    APP --> SDB_CURRENT
    APP --> SDL
</div>

<h3 id="12">1.2 ç›®æ¨™æ§‹æˆ<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Target System"
        IS[Identity Service]
        AS[Audit Service]
        FS[File Service]
        ES[Event Service]
        VS[Verification Service]
    end

    subgraph "ScalarDB Cluster"
        LB[Load Balancer]
        SDB1[Node 1]
        SDB2[Node 2]
        SDB3[Node 3]
    end

    subgraph "Multi-Storage"
        PG[(PostgreSQL)]
        CS[(Cassandra)]
        SDL[(ScalarDL)]
    end

    IS --> LB
    AS --> LB
    FS --> LB
    ES --> LB
    VS --> LB

    LB --> SDB1
    LB --> SDB2
    LB --> SDB3

    SDB1 --> PG
    SDB1 --> CS
    VS --> SDL
</div>

<h3 id="13">1.3 ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥<a class="headerlink" href="#13" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ•ã‚§ãƒ¼ã‚º</th>
<th>å†…å®¹</th>
<th>æœŸé–“</th>
<th>ãƒªã‚¹ã‚¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phase 0</td>
<td>æº–å‚™ãƒ»æ¤œè¨¼ç’°å¢ƒæ§‹ç¯‰</td>
<td>2é€±é–“</td>
<td>ä½</td>
</tr>
<tr>
<td>Phase 1</td>
<td>ã‚¹ã‚­ãƒ¼ãƒç§»è¡Œãƒ»ä¸¦è¡Œæ›¸ãè¾¼ã¿</td>
<td>4é€±é–“</td>
<td>ä¸­</td>
</tr>
<tr>
<td>Phase 2</td>
<td>æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆ</td>
<td>4é€±é–“</td>
<td>ä¸­</td>
</tr>
<tr>
<td>Phase 3</td>
<td>å®Œå…¨ç§»è¡Œãƒ»æ—§ç’°å¢ƒå»ƒæ­¢</td>
<td>2é€±é–“</td>
<td>ä½</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-phase-0-2">2. Phase 0: æº–å‚™ï¼ˆ2é€±é–“ï¼‰<a class="headerlink" href="#2-phase-0-2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ç’°å¢ƒæ§‹ç¯‰<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<div class="mermaid">
gantt
    title Phase 0 ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
    dateFormat YYYY-MM-DD
    section ã‚¤ãƒ³ãƒ•ãƒ©
    PostgreSQL Clusteræ§‹ç¯‰     :p0-1, 2025-01-06, 3d
    Cassandra Clusteræ§‹ç¯‰      :p0-2, 2025-01-06, 3d
    ScalarDB Clusteræ§‹ç¯‰       :p0-3, after p0-1, 3d
    section æ¤œè¨¼
    æ¥ç¶šãƒ†ã‚¹ãƒˆ                 :p0-4, after p0-3, 2d
    è² è·ãƒ†ã‚¹ãƒˆ                 :p0-5, after p0-4, 3d
</div>

<h3 id="22">2.2 ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># Kubernetesæ§‹æˆä¾‹
---
# PostgreSQL StatefulSet
apiVersion: apps/v1
kind: StatefulSet
metadata:
  name: postgresql
spec:
  serviceName: postgresql
  replicas: 3
  selector:
    matchLabels:
      app: postgresql
  template:
    spec:
      containers:
      - name: postgresql
        image: postgres:15
        resources:
          requests:
            cpu: &quot;2&quot;
            memory: &quot;8Gi&quot;
          limits:
            cpu: &quot;4&quot;
            memory: &quot;16Gi&quot;
        volumeMounts:
        - name: data
          mountPath: /var/lib/postgresql/data
  volumeClaimTemplates:
  - metadata:
      name: data
    spec:
      accessModes: [&quot;ReadWriteOnce&quot;]
      resources:
        requests:
          storage: 100Gi
---
# ScalarDB Cluster Deployment
apiVersion: apps/v1
kind: Deployment
metadata:
  name: scalardb-cluster
spec:
  replicas: 3
  selector:
    matchLabels:
      app: scalardb-cluster
  template:
    spec:
      containers:
      - name: scalardb-cluster
        image: ghcr.io/scalar-labs/scalardb-cluster-node:3.14.0
        ports:
        - containerPort: 60053  # gRPC
        - containerPort: 9080   # GraphQL
        env:
        - name: SCALAR_DB_CLUSTER_MEMBERSHIP_TYPE
          value: &quot;KUBERNETES&quot;
        volumeMounts:
        - name: config
          mountPath: /scalardb-cluster/config
</code></pre>

<h3 id="23">2.3 ã‚¹ã‚­ãƒ¼ãƒä½œæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">public class MigrationSchemaCreator {
    private final Admin admin;

    public void createAllSchemas() throws Exception {
        // Phase 0: æ–°ç’°å¢ƒã«ã‚¹ã‚­ãƒ¼ãƒä½œæˆ
        createNamespaces();
        createIdentityTables();
        createAuditTables();
        createFileTables();
        createEventTables();
    }

    private void createNamespaces() throws Exception {
        admin.createNamespace(&quot;identity&quot;, true);
        admin.createNamespace(&quot;audit&quot;, true);
        admin.createNamespace(&quot;file&quot;, true);
        admin.createNamespace(&quot;event&quot;, true);
        admin.createNamespace(&quot;coordinator&quot;, true);
    }

    private void createIdentityTables() throws Exception {
        // users table
        TableMetadata usersMetadata = TableMetadata.newBuilder()
            .addPartitionKey(&quot;user_email&quot;)
            .addColumn(&quot;user_email&quot;, DataType.TEXT)
            .addColumn(&quot;user_id&quot;, DataType.BIGINT)
            .addColumn(&quot;name&quot;, DataType.TEXT)
            .addColumn(&quot;password_hash&quot;, DataType.TEXT)
            .addColumn(&quot;role&quot;, DataType.TEXT)
            .addColumn(&quot;org_id&quot;, DataType.TEXT)
            .addColumn(&quot;is_deleted&quot;, DataType.BOOLEAN)
            .addColumn(&quot;created_at&quot;, DataType.BIGINT)
            .addColumn(&quot;updated_at&quot;, DataType.BIGINT)
            .addSecondaryIndex(&quot;user_id&quot;)
            .addSecondaryIndex(&quot;org_id&quot;)
            .build();
        admin.createTable(&quot;identity&quot;, &quot;users&quot;, usersMetadata, true);

        // ä»–ã®identityãƒ†ãƒ¼ãƒ–ãƒ«...
    }
}
</code></pre>

<h3 id="24">2.4 æ¤œè¨¼é …ç›®<a class="headerlink" href="#24" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ç¢ºèªå†…å®¹</th>
<th>åˆæ ¼åŸºæº–</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ¥ç¶šãƒ†ã‚¹ãƒˆ</td>
<td>å„ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¸ã®æ¥ç¶š</td>
<td>å…¨ãƒãƒ¼ãƒ‰æ¥ç¶šæˆåŠŸ</td>
</tr>
<tr>
<td>CRUD ãƒ†ã‚¹ãƒˆ</td>
<td>åŸºæœ¬æ“ä½œã®å‹•ä½œç¢ºèª</td>
<td>ã‚¨ãƒ©ãƒ¼ãªã—</td>
</tr>
<tr>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆ</td>
<td>Consensus Commitå‹•ä½œ</td>
<td>æ•´åˆæ€§ä¿æŒ</td>
</tr>
<tr>
<td>è² è·ãƒ†ã‚¹ãƒˆ</td>
<td>1000 TPSé”æˆ</td>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·P99 &lt; 500ms</td>
</tr>
<tr>
<td>éšœå®³ãƒ†ã‚¹ãƒˆ</td>
<td>ãƒãƒ¼ãƒ‰éšœå®³æ™‚ã®å‹•ä½œ</td>
<td>30ç§’ä»¥å†…ã«å¾©æ—§</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-phase-1-4">3. Phase 1: ä¸¦è¡Œæ›¸ãè¾¼ã¿ï¼ˆ4é€±é–“ï¼‰<a class="headerlink" href="#3-phase-1-4" title="Permanent link">&para;</a></h2>
<h3 id="31">3.1 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#31" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "Application"
        APP[Spring Boot App]
        DW[Dual Write Interceptor]
    end

    subgraph "Old System"
        OLD_SDB[(Current ScalarDB)]
    end

    subgraph "New System"
        NEW_SDB[(New ScalarDB Cluster)]
    end

    APP --> DW
    DW -->|Primary| OLD_SDB
    DW -->|Shadow| NEW_SDB
</div>

<h3 id="32-dual-write">3.2 Dual Writeå®Ÿè£…<a class="headerlink" href="#32-dual-write" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class DualWriteTransactionManager implements DistributedTransactionManager {
    private final DistributedTransactionManager primaryManager;  // æ—§ç’°å¢ƒ
    private final DistributedTransactionManager shadowManager;   // æ–°ç’°å¢ƒ
    private final DualWriteConfig config;

    @Override
    public DistributedTransaction start() {
        return new DualWriteTransaction(
            primaryManager.start(),
            shadowManager.start(),
            config
        );
    }
}

public class DualWriteTransaction implements DistributedTransaction {
    private final DistributedTransaction primaryTx;
    private final DistributedTransaction shadowTx;
    private final DualWriteConfig config;
    private final List&lt;Mutation&gt; mutations = new ArrayList&lt;&gt;();

    @Override
    public Optional&lt;Result&gt; get(Get get) throws CrudException {
        // èª­ã¿å–ã‚Šã¯Primaryã®ã¿
        return primaryTx.get(get);
    }

    @Override
    public void put(Put put) throws CrudException {
        mutations.add(put);
        primaryTx.put(put);

        if (config.isShadowWriteEnabled()) {
            try {
                Put shadowPut = convertToNewSchema(put);
                shadowTx.put(shadowPut);
            } catch (Exception e) {
                log.error(&quot;Shadow write failed&quot;, e);
                // Shadowæ›¸ãè¾¼ã¿å¤±æ•—ã¯ç„¡è¦–ï¼ˆãƒ­ã‚°ã®ã¿ï¼‰
            }
        }
    }

    @Override
    public void commit() throws CommitException {
        // Primaryå„ªå…ˆã§ã‚³ãƒŸãƒƒãƒˆ
        primaryTx.commit();

        if (config.isShadowWriteEnabled()) {
            try {
                shadowTx.commit();
            } catch (Exception e) {
                log.error(&quot;Shadow commit failed, scheduling async sync&quot;, e);
                scheduleAsyncSync(mutations);
            }
        }
    }

    private Put convertToNewSchema(Put originalPut) {
        // æ—§ã‚¹ã‚­ãƒ¼ãƒ â†’ æ–°ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›
        String namespace = mapNamespace(originalPut.forNamespace().get());
        String table = mapTable(originalPut.forTable().get());

        return Put.newBuilder()
            .namespace(namespace)
            .table(table)
            .partitionKey(convertKey(originalPut.getPartitionKey()))
            .clusteringKey(convertClusteringKey(originalPut.getClusteringKey()))
            // ... å€¤ã®ãƒãƒƒãƒ”ãƒ³ã‚°
            .build();
    }
}
</code></pre>

<h3 id="33">3.3 ãƒ‡ãƒ¼ã‚¿åŒæœŸãƒãƒƒãƒ<a class="headerlink" href="#33" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class DataSyncBatch {
    private final DistributedTransactionManager oldManager;
    private final DistributedTransactionManager newManager;

    @Scheduled(cron = &quot;0 0 2 * * *&quot;)  // æ¯æ—¥2:00
    public void syncData() {
        log.info(&quot;Starting data sync batch&quot;);

        // ãƒ†ãƒ¼ãƒ–ãƒ«ã”ã¨ã«åŒæœŸ
        syncUsers();
        syncAuditSets();
        syncAuditSetItems();
        syncEvents();

        log.info(&quot;Data sync batch completed&quot;);
    }

    private void syncUsers() {
        DistributedTransaction oldTx = oldManager.start();
        DistributedTransaction newTx = newManager.start();

        try {
            Scan scan = Scan.newBuilder()
                .namespace(&quot;events_log_tool&quot;)
                .table(&quot;user&quot;)
                .all()
                .build();

            List&lt;Result&gt; results = oldTx.scan(scan);

            for (Result result : results) {
                Put put = convertUserToNewSchema(result);
                newTx.put(put);
            }

            newTx.commit();
            log.info(&quot;Synced {} users&quot;, results.size());

        } catch (Exception e) {
            newTx.abort();
            throw new SyncException(&quot;User sync failed&quot;, e);
        } finally {
            oldTx.abort();  // èª­ã¿å–ã‚Šå°‚ç”¨
        }
    }

    private Put convertUserToNewSchema(Result oldUser) {
        return Put.newBuilder()
            .namespace(&quot;identity&quot;)
            .table(&quot;users&quot;)
            .partitionKey(Key.ofText(&quot;user_email&quot;, oldUser.getText(&quot;userEmail&quot;)))
            .bigIntValue(&quot;user_id&quot;, oldUser.getBigInt(&quot;id&quot;))
            .textValue(&quot;name&quot;, oldUser.getText(&quot;name&quot;))
            .textValue(&quot;password_hash&quot;, oldUser.getText(&quot;password&quot;))
            .textValue(&quot;role&quot;, oldUser.getText(&quot;roleJson&quot;))
            .textValue(&quot;org_id&quot;, oldUser.getText(&quot;orgId&quot;))
            .booleanValue(&quot;is_deleted&quot;, oldUser.getBoolean(&quot;isDeleted&quot;))
            .bigIntValue(&quot;created_at&quot;, System.currentTimeMillis())
            .bigIntValue(&quot;updated_at&quot;, System.currentTimeMillis())
            .build();
    }
}
</code></pre>

<h3 id="34">3.4 æ¤œè¨¼ã‚¯ã‚¨ãƒª<a class="headerlink" href="#34" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class DataVerifier {
    private final DistributedTransactionManager oldManager;
    private final DistributedTransactionManager newManager;

    public VerificationResult verify() {
        VerificationResult result = new VerificationResult();

        // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°æ¯”è¼ƒ
        long oldUserCount = countRecords(oldManager, &quot;events_log_tool&quot;, &quot;user&quot;);
        long newUserCount = countRecords(newManager, &quot;identity&quot;, &quot;users&quot;);
        result.addCheck(&quot;users&quot;, oldUserCount, newUserCount);

        // ç›£æŸ»ã‚»ãƒƒãƒˆæ•°æ¯”è¼ƒ
        long oldAuditSetCount = countRecords(oldManager, &quot;events_log_tool&quot;, &quot;audit_set&quot;);
        long newAuditSetCount = countRecords(newManager, &quot;audit&quot;, &quot;audit_sets&quot;);
        result.addCheck(&quot;audit_sets&quot;, oldAuditSetCount, newAuditSetCount);

        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
        verifyRandomSamples(result, 100);

        return result;
    }

    private void verifyRandomSamples(VerificationResult result, int sampleSize) {
        // ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§è©³ç´°æ¯”è¼ƒ
        List&lt;String&gt; sampleEmails = getSampleUserEmails(sampleSize);

        for (String email : sampleEmails) {
            Result oldUser = getOldUser(email);
            Result newUser = getNewUser(email);

            if (!compareUserData(oldUser, newUser)) {
                result.addMismatch(&quot;user&quot;, email);
            }
        }
    }
}
</code></pre>

<h3 id="35-phase-1">3.5 Phase 1 ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ<a class="headerlink" href="#35-phase-1" title="Permanent link">&para;</a></h3>
<ul>
<li>[ ] Dual Write Interceptorå®Ÿè£…</li>
<li>[ ] ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯å®Ÿè£…</li>
<li>[ ] åˆæœŸãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒãƒƒãƒå®Ÿè¡Œ</li>
<li>[ ] æ—¥æ¬¡åŒæœŸãƒãƒƒãƒè¨­å®š</li>
<li>[ ] ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§æ¤œè¨¼</li>
<li>[ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å½±éŸ¿ç¢ºèªï¼ˆãƒ¬ã‚¤ãƒ†ãƒ³ã‚·+10%ä»¥å†…ï¼‰</li>
<li>[ ] ã‚¨ãƒ©ãƒ¼ç›£è¦–è¨­å®š</li>
</ul>
<hr />
<h2 id="4-phase-2-4">4. Phase 2: æ®µéšçš„åˆ‡ã‚Šæ›¿ãˆï¼ˆ4é€±é–“ï¼‰<a class="headerlink" href="#4-phase-2-4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 åˆ‡ã‚Šæ›¿ãˆæˆ¦ç•¥<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "Week 1"
        W1[èª­ã¿å–ã‚Š: 10% New<br/>æ›¸ãè¾¼ã¿: 100% Both]
    end

    subgraph "Week 2"
        W2[èª­ã¿å–ã‚Š: 50% New<br/>æ›¸ãè¾¼ã¿: 100% Both]
    end

    subgraph "Week 3"
        W3[èª­ã¿å–ã‚Š: 100% New<br/>æ›¸ãè¾¼ã¿: 100% Both]
    end

    subgraph "Week 4"
        W4[èª­ã¿å–ã‚Š: 100% New<br/>æ›¸ãè¾¼ã¿: 100% New]
    end

    W1 --> W2 --> W3 --> W4
</div>

<h3 id="42-feature-flag">4.2 Feature Flagå®Ÿè£…<a class="headerlink" href="#42-feature-flag" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class MigrationFeatureFlags {
    private final FeatureFlagClient client;

    // èª­ã¿å–ã‚Šå…ˆã®åˆ¶å¾¡
    public ReadSource getReadSource(String namespace) {
        int percentage = client.getIntValue(&quot;migration.read.new_percentage&quot;, 0);
        return ThreadLocalRandom.current().nextInt(100) &lt; percentage
            ? ReadSource.NEW
            : ReadSource.OLD;
    }

    // æ›¸ãè¾¼ã¿å…ˆã®åˆ¶å¾¡
    public WriteMode getWriteMode() {
        String mode = client.getStringValue(&quot;migration.write.mode&quot;, &quot;DUAL&quot;);
        return WriteMode.valueOf(mode);
    }

    public enum ReadSource { OLD, NEW }
    public enum WriteMode { OLD_ONLY, DUAL, NEW_ONLY }
}

@Component
public class MigrationAwareTransactionManager {
    private final DistributedTransactionManager oldManager;
    private final DistributedTransactionManager newManager;
    private final MigrationFeatureFlags flags;

    public DistributedTransaction start() {
        WriteMode writeMode = flags.getWriteMode();

        return switch (writeMode) {
            case OLD_ONLY -&gt; new SingleTransaction(oldManager.start());
            case DUAL -&gt; new DualWriteTransaction(
                oldManager.start(),
                newManager.start()
            );
            case NEW_ONLY -&gt; new SingleTransaction(newManager.start());
        };
    }

    public Optional&lt;Result&gt; get(Get get) {
        ReadSource source = flags.getReadSource(get.forNamespace().get());

        return switch (source) {
            case OLD -&gt; oldManager.start().get(convertToOldSchema(get));
            case NEW -&gt; newManager.start().get(get);
        };
    }
}
</code></pre>

<h3 id="43">4.3 ã‚«ãƒŠãƒªã‚¢ãƒªãƒªãƒ¼ã‚¹<a class="headerlink" href="#43" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># Kubernetes Canary Deployment
apiVersion: argoproj.io/v1alpha1
kind: Rollout
metadata:
  name: auditor-app
spec:
  replicas: 10
  strategy:
    canary:
      steps:
      - setWeight: 10
      - pause: {duration: 1h}
      - setWeight: 30
      - pause: {duration: 1h}
      - setWeight: 50
      - pause: {duration: 1h}
      - setWeight: 100
      analysis:
        templates:
        - templateName: success-rate
        args:
        - name: service-name
          value: auditor-app
</code></pre>

<h3 id="44">4.4 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †<a class="headerlink" href="#44" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class MigrationRollback {
    private final MigrationFeatureFlags flags;
    private final AlertService alertService;

    public void executeRollback(RollbackReason reason) {
        log.warn(&quot;Initiating rollback: {}&quot;, reason);

        // 1. Feature Flagã‚’å³åº§ã«å¤‰æ›´
        flags.setWriteMode(WriteMode.OLD_ONLY);
        flags.setReadPercentage(0);

        // 2. é€²è¡Œä¸­ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã®å®Œäº†ã‚’å¾…æ©Ÿ
        waitForInFlightTransactions(Duration.ofSeconds(30));

        // 3. ã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡
        alertService.sendCritical(&quot;Migration rollback executed: &quot; + reason);

        // 4. ãƒ­ã‚°è¨˜éŒ²
        log.info(&quot;Rollback completed&quot;);
    }

    public void executeEmergencyRollback() {
        // å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå¾…æ©Ÿãªã—ï¼‰
        flags.setWriteMode(WriteMode.OLD_ONLY);
        flags.setReadPercentage(0);
        alertService.sendCritical(&quot;Emergency rollback executed&quot;);
    }
}
</code></pre>

<h3 id="45-phase-2">4.5 Phase 2 ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°<a class="headerlink" href="#45-phase-2" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># Prometheus AlertRules
groups:
- name: migration
  rules:
  - alert: MigrationHighErrorRate
    expr: |
      rate(scalardb_transaction_total{status=&quot;error&quot;}[5m])
      / rate(scalardb_transaction_total[5m]) &gt; 0.01
    for: 5m
    labels:
      severity: warning
    annotations:
      summary: &quot;Migration error rate &gt; 1%&quot;

  - alert: MigrationDataMismatch
    expr: migration_data_mismatch_count &gt; 0
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: &quot;Data mismatch detected between old and new systems&quot;

  - alert: MigrationLatencyIncrease
    expr: |
      histogram_quantile(0.99, rate(scalardb_transaction_duration_seconds_bucket[5m]))
      &gt; histogram_quantile(0.99, rate(scalardb_transaction_duration_seconds_bucket[5m] offset 1d)) * 1.5
    for: 10m
    labels:
      severity: warning
    annotations:
      summary: &quot;Transaction latency increased 50% compared to yesterday&quot;
</code></pre>

<hr />
<h2 id="5-phase-3-2">5. Phase 3: å®Œå…¨ç§»è¡Œï¼ˆ2é€±é–“ï¼‰<a class="headerlink" href="#5-phase-3-2" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 æœ€çµ‚åˆ‡ã‚Šæ›¿ãˆ<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant OPS as Operations
    participant FF as Feature Flags
    participant APP as Application
    participant OLD as Old ScalarDB
    participant NEW as New ScalarDB

    OPS->>FF: Set write_mode = NEW_ONLY
    FF-->>APP: Configuration Updated

    Note over APP: æ–°ç’°å¢ƒã®ã¿ã«æ›¸ãè¾¼ã¿

    OPS->>OPS: Wait for stability (24h)

    OPS->>OLD: Disable write access
    OPS->>OPS: Final data verification

    OPS->>OLD: Archive and shutdown
</div>

<h3 id="52">5.2 æ—§ç’°å¢ƒå»ƒæ­¢æ‰‹é †<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash">#!/bin/bash
# decommission-old-env.sh

echo &quot;=== Phase 3: Old Environment Decommission ===&quot;

# 1. æœ€çµ‚ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼
echo &quot;Step 1: Final data verification...&quot;
./verify-data.sh
if [ $? -ne 0 ]; then
    echo &quot;ERROR: Data verification failed&quot;
    exit 1
fi

# 2. æ—§ç’°å¢ƒã®èª­ã¿å–ã‚Šå°‚ç”¨åŒ–
echo &quot;Step 2: Setting old environment to read-only...&quot;
kubectl patch configmap scalardb-old-config \
    -p '{&quot;data&quot;:{&quot;read_only&quot;:&quot;true&quot;}}'

# 3. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã®æ¥ç¶šè§£é™¤ç¢ºèª
echo &quot;Step 3: Verifying no active connections...&quot;
./check-connections.sh old-scalardb
if [ $? -ne 0 ]; then
    echo &quot;WARNING: Active connections detected&quot;
    read -p &quot;Continue? (y/n) &quot; -n 1 -r
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        exit 1
    fi
fi

# 4. ãƒ‡ãƒ¼ã‚¿ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
echo &quot;Step 4: Archiving data...&quot;
./archive-data.sh old-scalardb s3://backup-bucket/scalardb-migration/

# 5. æ—§ç’°å¢ƒåœæ­¢
echo &quot;Step 5: Stopping old environment...&quot;
kubectl scale deployment old-scalardb --replicas=0

# 6. ãƒªã‚½ãƒ¼ã‚¹å‰Šé™¤ï¼ˆ7æ—¥å¾Œã«è‡ªå‹•å®Ÿè¡Œï¼‰
echo &quot;Step 6: Scheduling resource deletion in 7 days...&quot;
kubectl apply -f cleanup-job.yaml

echo &quot;=== Decommission completed ===&quot;
</code></pre>

<h3 id="53">5.3 ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@Component
public class MigrationCleanup {

    public void cleanup() {
        // 1. Dual Write ã‚³ãƒ¼ãƒ‰å‰Šé™¤
        log.info(&quot;Removing dual write interceptor...&quot;);

        // 2. æ—§ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›ã‚³ãƒ¼ãƒ‰å‰Šé™¤
        log.info(&quot;Removing old schema converters...&quot;);

        // 3. Feature Flagå‰Šé™¤
        log.info(&quot;Removing migration feature flags...&quot;);

        // 4. ç›£è¦–è¨­å®šæ›´æ–°
        log.info(&quot;Updating monitoring configuration...&quot;);

        // 5. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°
        log.info(&quot;Documentation update reminder sent&quot;);
    }
}
</code></pre>

<hr />
<h2 id="6">6. ãƒ‡ãƒ¼ã‚¿ç§»è¡Œè©³ç´°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 ãƒ†ãƒ¼ãƒ–ãƒ«åˆ¥ç§»è¡Œãƒãƒƒãƒ”ãƒ³ã‚°<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æ—§ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>æ–°Namespace</th>
<th>æ–°ãƒ†ãƒ¼ãƒ–ãƒ«</th>
<th>å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>user</td>
<td>identity</td>
<td>users</td>
<td>userEmail â†’ user_email (PKå¤‰æ›´)</td>
</tr>
<tr>
<td>user_token</td>
<td>identity</td>
<td>user_tokens</td>
<td>æ§‹é€ å¤‰æ›´ãªã—</td>
</tr>
<tr>
<td>audit_set</td>
<td>audit</td>
<td>audit_sets</td>
<td>aclJson â†’ åˆ¥ãƒ†ãƒ¼ãƒ–ãƒ«åŒ–</td>
</tr>
<tr>
<td>audit_set_item</td>
<td>audit</td>
<td>audit_set_items</td>
<td>æ§‹é€ å¤‰æ›´ãªã—</td>
</tr>
<tr>
<td>audit_set_collaborators</td>
<td>audit</td>
<td>audit_set_collaborators</td>
<td>æ§‹é€ å¤‰æ›´ãªã—</td>
</tr>
<tr>
<td>events</td>
<td>event</td>
<td>events</td>
<td>Cassandraã¸ç§»è¡Œ</td>
</tr>
</tbody>
</table>
<h3 id="62-json">6.2 JSONåˆ—æ­£è¦åŒ–<a class="headerlink" href="#62-json" title="Permanent link">&para;</a></h3>
<p><strong>æ—§ã‚¹ã‚­ãƒ¼ãƒ (aclJsonåŸ‹ã‚è¾¼ã¿):</strong></p>
<pre class="codehilite"><code class="language-java">// AuditSet.aclJson
{
  &quot;owner&quot;: {&quot;email&quot;: &quot;owner@example.com&quot;, &quot;role&quot;: &quot;OWNER&quot;},
  &quot;collaborators&quot;: [
    {&quot;email&quot;: &quot;user1@example.com&quot;, &quot;role&quot;: &quot;CO_OWNER&quot;},
    {&quot;email&quot;: &quot;user2@example.com&quot;, &quot;role&quot;: &quot;MEMBER&quot;}
  ]
}
</code></pre>

<p><strong>æ–°ã‚¹ã‚­ãƒ¼ãƒ (æ­£è¦åŒ–):</strong></p>
<pre class="codehilite"><code class="language-java">// audit_set_collaborators ãƒ†ãƒ¼ãƒ–ãƒ«
// PK: audit_set_id, CK: user_email
{
  &quot;audit_set_id&quot;: &quot;uuid&quot;,
  &quot;user_email&quot;: &quot;owner@example.com&quot;,
  &quot;collaborator_role&quot;: &quot;OWNER&quot;
}
</code></pre>

<p><strong>å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯:</strong></p>
<pre class="codehilite"><code class="language-java">public List&lt;Put&gt; convertAclJsonToCollaborators(String auditSetId, String aclJson) {
    List&lt;Put&gt; puts = new ArrayList&lt;&gt;();
    JsonNode acl = objectMapper.readTree(aclJson);

    // ã‚ªãƒ¼ãƒŠãƒ¼è¿½åŠ 
    JsonNode owner = acl.get(&quot;owner&quot;);
    puts.add(createCollaboratorPut(auditSetId, owner.get(&quot;email&quot;).asText(), &quot;OWNER&quot;));

    // ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼è¿½åŠ 
    JsonNode collaborators = acl.get(&quot;collaborators&quot;);
    if (collaborators != null &amp;&amp; collaborators.isArray()) {
        for (JsonNode collab : collaborators) {
            puts.add(createCollaboratorPut(
                auditSetId,
                collab.get(&quot;email&quot;).asText(),
                collab.get(&quot;role&quot;).asText()
            ));
        }
    }

    return puts;
}
</code></pre>

<h3 id="63-postgresql-cassandra">6.3 ã‚¤ãƒ™ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ç§»è¡Œï¼ˆPostgreSQL â†’ Cassandraï¼‰<a class="headerlink" href="#63-postgresql-cassandra" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">public class EventMigrationBatch {
    private final JdbcTemplate oldJdbc;
    private final DistributedTransactionManager newManager;

    public void migrateEvents(LocalDate startDate, LocalDate endDate) {
        LocalDate current = startDate;

        while (!current.isAfter(endDate)) {
            String yyyymmdd = current.format(DateTimeFormatter.BASIC_ISO_DATE);
            migrateEventsForDate(yyyymmdd);
            current = current.plusDays(1);
        }
    }

    private void migrateEventsForDate(String yyyymmdd) {
        log.info(&quot;Migrating events for {}&quot;, yyyymmdd);

        // æ—§DBã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—
        List&lt;Map&lt;String, Object&gt;&gt; oldEvents = oldJdbc.queryForList(
            &quot;SELECT * FROM events WHERE yyyyMMdd = ?&quot;, yyyymmdd
        );

        // ãƒãƒƒãƒã‚µã‚¤ã‚ºã§åˆ†å‰²
        Lists.partition(oldEvents, 100).forEach(batch -&gt; {
            DistributedTransaction tx = newManager.start();
            try {
                for (Map&lt;String, Object&gt; event : batch) {
                    Put put = convertEventToNewSchema(event);
                    tx.put(put);
                }
                tx.commit();
            } catch (Exception e) {
                tx.abort();
                throw new MigrationException(&quot;Event migration failed for &quot; + yyyymmdd, e);
            }
        });

        log.info(&quot;Migrated {} events for {}&quot;, oldEvents.size(), yyyymmdd);
    }
}
</code></pre>

<hr />
<h2 id="7">7. æ¤œè¨¼è¨ˆç”»<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 æ¤œè¨¼ãƒ•ã‚§ãƒ¼ã‚º<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ•ã‚§ãƒ¼ã‚º</th>
<th>å†…å®¹</th>
<th>æœŸé–“</th>
<th>æ‹…å½“</th>
</tr>
</thead>
<tbody>
<tr>
<td>å˜ä½“ãƒ†ã‚¹ãƒˆ</td>
<td>CRUDæ“ä½œã®å‹•ä½œç¢ºèª</td>
<td>1æ—¥</td>
<td>Dev</td>
</tr>
<tr>
<td>çµåˆãƒ†ã‚¹ãƒˆ</td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‹•ä½œç¢ºèª</td>
<td>2æ—¥</td>
<td>Dev</td>
</tr>
<tr>
<td>è² è·ãƒ†ã‚¹ãƒˆ</td>
<td>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¤œè¨¼</td>
<td>3æ—¥</td>
<td>QA</td>
</tr>
<tr>
<td>éšœå®³ãƒ†ã‚¹ãƒˆ</td>
<td>ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ç¢ºèª</td>
<td>2æ—¥</td>
<td>Ops</td>
</tr>
<tr>
<td>UAT</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å—å…¥ãƒ†ã‚¹ãƒˆ</td>
<td>5æ—¥</td>
<td>User</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@SpringBootTest
public class MigrationIntegrationTest {

    @Test
    void shouldCreateAuditSetInNewSchema() {
        // Given
        CreateAuditSetRequest request = new CreateAuditSetRequest(&quot;Test Set&quot;, &quot;owner@example.com&quot;);

        // When
        AuditSet result = auditService.createAuditSet(request);

        // Then
        assertThat(result.getId()).isNotNull();

        // æ–°ç’°å¢ƒã§ãƒ‡ãƒ¼ã‚¿ç¢ºèª
        Optional&lt;Result&gt; newData = newManager.start().get(
            Get.newBuilder()
                .namespace(&quot;audit&quot;)
                .table(&quot;audit_sets&quot;)
                .partitionKey(Key.ofText(&quot;audit_set_id&quot;, result.getId()))
                .build()
        );
        assertThat(newData).isPresent();
    }

    @Test
    void shouldMaintainDataConsistencyDuringDualWrite() {
        // Dual Writeä¸­ã®ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒ†ã‚¹ãƒˆ
        // ä¸¡ç’°å¢ƒã«åŒä¸€ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
    }

    @Test
    void shouldHandleFailoverGracefully() {
        // ãƒãƒ¼ãƒ‰éšœå®³æ™‚ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ãƒ†ã‚¹ãƒˆ
    }
}
</code></pre>

<h3 id="73">7.3 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-java">@BenchmarkMode(Mode.Throughput)
@OutputTimeUnit(TimeUnit.SECONDS)
public class TransactionBenchmark {

    @Benchmark
    public void createAuditSetBenchmark(Blackhole bh) {
        AuditSet result = auditService.createAuditSet(createRandomRequest());
        bh.consume(result);
    }

    @Benchmark
    public void addItemToAuditSetBenchmark(Blackhole bh) {
        AuditSetItem result = auditService.addItem(auditSetId, randomItemId());
        bh.consume(result);
    }
}
</code></pre>

<hr />
<h2 id="8">8. ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯æ‰‹é †<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯åˆ¤æ–­åŸºæº–<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>é–¾å€¤</th>
<th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ©ãƒ¼ç‡</td>
<td>&gt; 5%</td>
<td>è‡ªå‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯</td>
</tr>
<tr>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·P99</td>
<td>&gt; 2ç§’</td>
<td>è­¦å‘Šâ†’æ‰‹å‹•åˆ¤æ–­</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ä¸æ•´åˆ</td>
<td>&gt; 0ä»¶</td>
<td>å³åº§ã«ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯</td>
</tr>
<tr>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼å ±å‘Š</td>
<td>é‡å¤§éšœå®³</td>
<td>æ‰‹å‹•ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯</td>
</tr>
</tbody>
</table>
<h3 id="82">8.2 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å®Ÿè¡Œ<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash">#!/bin/bash
# rollback.sh

echo &quot;=== Migration Rollback ===&quot;

# 1. Feature Flagå¤‰æ›´
echo &quot;Step 1: Switching to old environment...&quot;
curl -X PUT http://feature-flag-service/flags/migration.write.mode \
    -d '{&quot;value&quot;: &quot;OLD_ONLY&quot;}'
curl -X PUT http://feature-flag-service/flags/migration.read.new_percentage \
    -d '{&quot;value&quot;: 0}'

# 2. é€²è¡Œä¸­ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å¾…æ©Ÿ
echo &quot;Step 2: Waiting for in-flight transactions...&quot;
sleep 30

# 3. ç¢ºèª
echo &quot;Step 3: Verifying rollback...&quot;
./verify-rollback.sh

echo &quot;=== Rollback completed ===&quot;
</code></pre>

<h3 id="83">8.3 ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¾Œã®å¯¾å¿œ<a class="headerlink" href="#83" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>åŸå› åˆ†æ</strong>: ãƒ­ã‚°ãƒ»ãƒ¡ãƒˆãƒªã‚¯ã‚¹ç¢ºèª</li>
<li><strong>ä¿®æ­£</strong>: å•é¡Œã®ä¿®æ­£</li>
<li><strong>å†ãƒ†ã‚¹ãƒˆ</strong>: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§æ¤œè¨¼</li>
<li><strong>å†ç§»è¡Œ</strong>: ä¿®æ­£å¾Œã«å†åº¦ç§»è¡Œå®Ÿæ–½</li>
</ol>
<hr />
<h2 id="9">9. ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<div class="mermaid">
gantt
    title ScalarDB Migration Timeline
    dateFormat YYYY-MM-DD
    section Phase 0
    ç’°å¢ƒæ§‹ç¯‰          :p0-1, 2025-01-06, 7d
    æ¤œè¨¼              :p0-2, after p0-1, 7d

    section Phase 1
    Dual Writeå®Ÿè£…    :p1-1, after p0-2, 7d
    åˆæœŸãƒ‡ãƒ¼ã‚¿ç§»è¡Œ    :p1-2, after p1-1, 7d
    ä¸¦è¡Œé‹ç”¨          :p1-3, after p1-2, 14d

    section Phase 2
    10% Newèª­ã¿å–ã‚Š   :p2-1, after p1-3, 7d
    50% Newèª­ã¿å–ã‚Š   :p2-2, after p2-1, 7d
    100% Newèª­ã¿å–ã‚Š  :p2-3, after p2-2, 7d
    Newæ›¸ãè¾¼ã¿ã®ã¿   :p2-4, after p2-3, 7d

    section Phase 3
    å®‰å®šåŒ–ç¢ºèª        :p3-1, after p2-4, 7d
    æ—§ç’°å¢ƒå»ƒæ­¢        :p3-2, after p3-1, 7d
</div>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: scalar-event-log-fetcher-main</em>
<em>ScalarDB Version: 3.14.x</em></p>
</article>
</section>
<section id="stories">
<h1>ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h1>
<article id="stories-domain-stories">
<h1 id="_1">ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼é›†<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">æ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€Scalar Auditor for BOXã‚·ã‚¹ãƒ†ãƒ ã®6ã¤ã®å¢ƒç•Œã¥ã‘ã‚‰ã‚ŒãŸã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ãŠã‘ã‚‹ä¸»è¦ãªãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ†ãƒªãƒ³ã‚°å½¢å¼ã§è¨˜è¿°ã—ã¾ã™ã€‚</p>
<h3 id="_3">è¡¨è¨˜æ³•<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>[ã‚¢ã‚¯ã‚¿ãƒ¼] ãŒ {ãƒ¯ãƒ¼ã‚¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ} ã‚’ ã€Šã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã€‹ ã™ã‚‹
â†’ [æ¬¡ã®ã‚¢ã‚¯ã‚¿ãƒ¼/ã‚·ã‚¹ãƒ†ãƒ ] ã¸æ¸¡ã™
</code></pre>

<hr />
<h2 id="1-identity-access-context">1. Identity &amp; Access Context (èªè¨¼ãƒ»ã‚¢ã‚¯ã‚»ã‚¹ç®¡ç†)<a class="headerlink" href="#1-identity-access-context" title="Permanent link">&para;</a></h2>
<h3 id="story-11">Story 1.1: ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#story-11" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph LR
    subgraph "èªè¨¼ãƒ•ãƒ­ãƒ¼"
        U[ç›£æŸ»æ‹…å½“è€…] -->|1. ãƒ­ã‚°ã‚¤ãƒ³è¦æ±‚| LP[ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸]
        LP -->|2. èªè¨¼æƒ…å ±é€ä¿¡| AS[AuthService]
        AS -->|3. è³‡æ ¼æƒ…å ±æ¤œè¨¼| DB[(UserDB)]
        DB -->|4. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±| AS
        AS -->|5. JWTãƒˆãƒ¼ã‚¯ãƒ³ç™ºè¡Œ| U
        U -->|6. ä¿è­·ãƒªã‚½ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹| API[API Gateway]
        API -->|7. ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼| AS
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ãƒ­ã‚°ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ } ã«ã€Šèªè¨¼æƒ…å ±ã‚’å…¥åŠ›ã€‹ã™ã‚‹</li>
<li><strong>[AuthService]</strong> ãŒ {èªè¨¼æƒ…å ±} ã‚’ã€Šæ¤œè¨¼ã€‹ã™ã‚‹</li>
<li><strong>[AuthService]</strong> ãŒ {JWTãƒˆãƒ¼ã‚¯ãƒ³} ã‚’ã€Šç™ºè¡Œã€‹ã—ã¦ [ç›£æŸ»æ‹…å½“è€…] ã¸æ¸¡ã™</li>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {JWTãƒˆãƒ¼ã‚¯ãƒ³} ã‚’ä½¿ç”¨ã—ã¦ã€Šä¿è­·ãƒªã‚½ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã€‹ã™ã‚‹</li>
<li><strong>[API Gateway]</strong> ãŒ {JWTãƒˆãƒ¼ã‚¯ãƒ³} ã‚’ã€Šæ¤œè¨¼ã€‹ã—ã¦ [ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹] ã¸è»¢é€ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™: 8æ™‚é–“
- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³: 7æ—¥é–“
- 3å›é€£ç¶šå¤±æ•—ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯</p>
<hr />
<h3 id="story-12">Story 1.2: ãƒ­ãƒ¼ãƒ«ãƒ»æ¨©é™ç®¡ç†<a class="headerlink" href="#story-12" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Admin as ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…
    participant RS as RoleService
    participant PS as PermissionService
    participant DB as Database

    Admin->>RS: ãƒ­ãƒ¼ãƒ«ä½œæˆè¦æ±‚
    RS->>PS: æ¨©é™ã‚»ãƒƒãƒˆå–å¾—
    PS-->>RS: åˆ©ç”¨å¯èƒ½ãªæ¨©é™ä¸€è¦§
    RS->>DB: ãƒ­ãƒ¼ãƒ«æ°¸ç¶šåŒ–
    DB-->>RS: ä¿å­˜å®Œäº†
    RS-->>Admin: ãƒ­ãƒ¼ãƒ«ä½œæˆå®Œäº†

    Admin->>RS: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ­ãƒ¼ãƒ«å‰²å½“
    RS->>DB: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ãƒ¼ãƒ«æ›´æ–°
    DB-->>RS: æ›´æ–°å®Œäº†
    RS-->>Admin: å‰²å½“å®Œäº†
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…]</strong> ãŒ {æ–°è¦ãƒ­ãƒ¼ãƒ«} ã‚’ã€Šå®šç¾©ã€‹ã™ã‚‹</li>
<li><strong>[RoleService]</strong> ãŒ {æ¨©é™ã‚»ãƒƒãƒˆ} ã‚’ã€Šãƒ­ãƒ¼ãƒ«ã«ç´ä»˜ã‘ã€‹ã™ã‚‹</li>
<li><strong>[ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†è€…]</strong> ãŒ {ãƒ¦ãƒ¼ã‚¶ãƒ¼} ã«ã€Šãƒ­ãƒ¼ãƒ«ã‚’å‰²ã‚Šå½“ã¦ã€‹ã‚‹</li>
<li><strong>[PermissionService]</strong> ãŒ {ã‚¢ã‚¯ã‚»ã‚¹è¦æ±‚} ã‚’ã€Šæ¨©é™ãƒã‚§ãƒƒã‚¯ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- æœ€å°æ¨©é™ã®åŸå‰‡
- ãƒ­ãƒ¼ãƒ«éšå±¤: Admin &gt; Manager &gt; Auditor &gt; Viewer
- æ¨©é™ã®ç¶™æ‰¿ã¯ä¸Šä½ãƒ­ãƒ¼ãƒ«ã®ã¿</p>
<hr />
<h2 id="2-audit-management-context">2. Audit Management Context (ç›£æŸ»ç®¡ç†)<a class="headerlink" href="#2-audit-management-context" title="Permanent link">&para;</a></h2>
<h3 id="story-21">Story 2.1: ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆ<a class="headerlink" href="#story-21" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆãƒ•ãƒ­ãƒ¼"
        A[ç›£æŸ»æ‹…å½“è€…] -->|1. ä½œæˆè¦æ±‚| AS[AuditSetService]
        AS -->|2. æ¤œè¨¼| VS[ValidationService]
        VS -->|3. OK| AS
        AS -->|4. æ°¸ç¶šåŒ–| DB[(AuditDB)]
        DB -->|5. ä½œæˆå®Œäº†| AS
        AS -->|6. ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ| EQ[EventQueue]
        EQ -->|7. éåŒæœŸå‡¦ç†| NS[NotificationService]
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ç›£æŸ»ã‚»ãƒƒãƒˆåã¨èª¬æ˜} ã‚’ã€Šå…¥åŠ›ã€‹ã™ã‚‹</li>
<li><strong>[AuditSetService]</strong> ãŒ {å…¥åŠ›ãƒ‡ãƒ¼ã‚¿} ã‚’ã€Šãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã€‹ã™ã‚‹</li>
<li><strong>[AuditSetService]</strong> ãŒ {ç›£æŸ»ã‚»ãƒƒãƒˆ} ã‚’ã€Šä½œæˆã€‹ã—ã¦DBã«ä¿å­˜ã™ã‚‹</li>
<li><strong>[EventPublisher]</strong> ãŒ {AuditSetCreatedã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šç™ºè¡Œã€‹ã™ã‚‹</li>
<li><strong>[NotificationService]</strong> ãŒ {é–¢ä¿‚è€…} ã«ã€Šé€šçŸ¥ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- ç›£æŸ»ã‚»ãƒƒãƒˆåã¯ä¸€æ„ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
- ä½œæˆè€…ã¯è‡ªå‹•çš„ã«ã‚ªãƒ¼ãƒŠãƒ¼ã¨ãªã‚‹
- ç›£æŸ»ã‚»ãƒƒãƒˆã«ã¯æœ€ä½1ã¤ã®ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ ãŒå¿…è¦ï¼ˆå¾Œã‹ã‚‰è¿½åŠ å¯ï¼‰</p>
<hr />
<h3 id="story-22">Story 2.2: ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ <a class="headerlink" href="#story-22" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Auditor as ç›£æŸ»æ‹…å½“è€…
    participant UI as WebUI
    participant AIS as AuditItemService
    participant FS as FileService
    participant BoxAPI as BOX API
    participant DB as Database
    participant EQ as EventQueue

    Auditor->>UI: ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
    UI->>FS: ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—
    FS->>BoxAPI: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿å–å¾—
    BoxAPI-->>FS: ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
    FS-->>UI: ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±è¡¨ç¤º

    Auditor->>UI: ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ 
    UI->>AIS: è¿½åŠ è¦æ±‚
    AIS->>DB: ã‚¢ã‚¤ãƒ†ãƒ ä½œæˆ
    DB-->>AIS: ä½œæˆå®Œäº†
    AIS->>EQ: ItemAddedã‚¤ãƒ™ãƒ³ãƒˆ
    AIS-->>UI: è¿½åŠ å®Œäº†
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {BOXãƒ•ã‚¡ã‚¤ãƒ«} ã‚’ã€Šé¸æŠã€‹ã™ã‚‹</li>
<li><strong>[FileService]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿} ã‚’ã€ŠBOXã‹ã‚‰å–å¾—ã€‹ã™ã‚‹</li>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ } ã‚’ã€Šç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ ã€‹ã™ã‚‹</li>
<li><strong>[AuditItemService]</strong> ãŒ {ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ } ã‚’ã€Šä½œæˆã€‹ã—ã¦DBã«ä¿å­˜ã™ã‚‹</li>
<li><strong>[EventPublisher]</strong> ãŒ {ItemAddedã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šç™ºè¡Œã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®é‡è¤‡è¿½åŠ ã¯ä¸å¯
- ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¾åœ¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã¨ã—ã¦ä¿å­˜ã•ã‚Œã‚‹
- ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: Pending â†’ InProgress â†’ Completed</p>
<hr />
<h3 id="story-23-saga">Story 2.3: ç›£æŸ»ã‚»ãƒƒãƒˆå‰Šé™¤ï¼ˆSagaï¼‰<a class="headerlink" href="#story-23-saga" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Auditor as ç›£æŸ»æ‹…å½“è€…
    participant ASS as AuditSetService
    participant SAGA as SagaOrchestrator
    participant AIS as AuditItemService
    participant VS as VerificationService
    participant ES as EventService
    participant DB as Database

    Auditor->>ASS: å‰Šé™¤è¦æ±‚
    ASS->>SAGA: Sagaé–‹å§‹

    SAGA->>VS: æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿å‰Šé™¤
    VS-->>SAGA: å‰Šé™¤å®Œäº†

    SAGA->>AIS: ã‚¢ã‚¤ãƒ†ãƒ å‰Šé™¤
    AIS-->>SAGA: å‰Šé™¤å®Œäº†

    SAGA->>ES: é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆå‰Šé™¤
    ES-->>SAGA: å‰Šé™¤å®Œäº†

    SAGA->>ASS: ã‚»ãƒƒãƒˆå‰Šé™¤
    ASS->>DB: è«–ç†å‰Šé™¤
    DB-->>ASS: å®Œäº†
    ASS-->>SAGA: å‰Šé™¤å®Œäº†

    SAGA-->>Auditor: å…¨å‰Šé™¤å®Œäº†
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ç›£æŸ»ã‚»ãƒƒãƒˆ} ã®ã€Šå‰Šé™¤ã‚’è¦æ±‚ã€‹ã™ã‚‹</li>
<li><strong>[SagaOrchestrator]</strong> ãŒ {å‰Šé™¤Saga} ã‚’ã€Šé–‹å§‹ã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {é–¢é€£ã™ã‚‹æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿} ã‚’ã€Šå‰Šé™¤ã€‹ã™ã‚‹</li>
<li><strong>[AuditItemService]</strong> ãŒ {ã™ã¹ã¦ã®ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ } ã‚’ã€Šå‰Šé™¤ã€‹ã™ã‚‹</li>
<li><strong>[EventService]</strong> ãŒ {é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã€‹ã™ã‚‹</li>
<li><strong>[AuditSetService]</strong> ãŒ {ç›£æŸ»ã‚»ãƒƒãƒˆ} ã‚’ã€Šè«–ç†å‰Šé™¤ã€‹ã™ã‚‹</li>
<li><strong>[SagaOrchestrator]</strong> ãŒ {å®Œäº†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹} ã‚’ã€Šå ±å‘Šã€‹ã™ã‚‹</li>
</ol>
<p><strong>è£œå„Ÿãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³:</strong>
- å„ã‚¹ãƒ†ãƒƒãƒ—ã§å¤±æ•—ã—ãŸå ´åˆã€å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
- å‰Šé™¤ã¯è«–ç†å‰Šé™¤ã§ã€30æ—¥å¾Œã«ç‰©ç†å‰Šé™¤</p>
<hr />
<h2 id="3-file-management-context">3. File Management Context (ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†)<a class="headerlink" href="#3-file-management-context" title="Permanent link">&para;</a></h2>
<h3 id="story-31">Story 3.1: ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸ<a class="headerlink" href="#story-31" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ãƒ•ã‚¡ã‚¤ãƒ«åŒæœŸãƒ•ãƒ­ãƒ¼"
        SCH[Scheduler] -->|1. åŒæœŸãƒˆãƒªã‚¬ãƒ¼| SS[SyncService]
        SS -->|2. å·®åˆ†å–å¾—| BOX[BOX API]
        BOX -->|3. å¤‰æ›´ä¸€è¦§| SS
        SS -->|4. ãƒ­ãƒ¼ã‚«ãƒ«æ›´æ–°| DB[(FileDB)]
        DB -->|5. æ›´æ–°å®Œäº†| SS
        SS -->|6. ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ| EQ[EventQueue]
        EQ -->|7. ç›£æŸ»å½±éŸ¿ãƒã‚§ãƒƒã‚¯| AS[AuditService]
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[Scheduler]</strong> ãŒ {åŒæœŸã‚¸ãƒ§ãƒ–} ã‚’ã€Šå®šæœŸå®Ÿè¡Œã€‹ã™ã‚‹ï¼ˆ5åˆ†é–“éš”ï¼‰</li>
<li><strong>[SyncService]</strong> ãŒ {BOX} ã‹ã‚‰ã€Šå¤‰æ›´å·®åˆ†ã‚’å–å¾—ã€‹ã™ã‚‹</li>
<li><strong>[SyncService]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿} ã‚’ã€Šãƒ­ãƒ¼ã‚«ãƒ«DBã«åŒæœŸã€‹ã™ã‚‹</li>
<li><strong>[EventPublisher]</strong> ãŒ {FileSyncedã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šç™ºè¡Œã€‹ã™ã‚‹</li>
<li><strong>[AuditService]</strong> ãŒ {ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´} ã‚’ã€Šæ¤œå‡ºã€‹ã—ã¦é€šçŸ¥ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- å‰Šé™¤ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã¯è«–ç†å‰Šé™¤ã¨ã—ã¦ä¿æŒ
- ãƒãƒ¼ã‚¸ãƒ§ãƒ³å±¥æ­´ã¯æœ€å¤§100ä¸–ä»£ä¿æŒ
- ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºä¸Šé™: 5GB</p>
<hr />
<h3 id="story-32">Story 3.2: ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ç®¡ç†<a class="headerlink" href="#story-32" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Admin as ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†è€…
    participant CS as CollaboratorService
    participant BoxAPI as BOX API
    participant DB as Database
    participant NS as NotificationService

    Admin->>CS: ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼è¿½åŠ è¦æ±‚
    CS->>BoxAPI: æ¨©é™è¨­å®šAPIå‘¼å‡º
    BoxAPI-->>CS: è¨­å®šå®Œäº†
    CS->>DB: ãƒ­ãƒ¼ã‚«ãƒ«è¨˜éŒ²
    DB-->>CS: ä¿å­˜å®Œäº†
    CS->>NS: é€šçŸ¥è¦æ±‚
    NS-->>Admin: è¿½åŠ å®Œäº†é€šçŸ¥
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†è€…]</strong> ãŒ {ãƒ¦ãƒ¼ã‚¶ãƒ¼} ã‚’ã€Šã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦è¿½åŠ ã€‹ã™ã‚‹</li>
<li><strong>[CollaboratorService]</strong> ãŒ {BOX API} çµŒç”±ã§ã€Šæ¨©é™ã‚’è¨­å®šã€‹ã™ã‚‹</li>
<li><strong>[CollaboratorService]</strong> ãŒ {ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼æƒ…å ±} ã‚’ã€Šãƒ­ãƒ¼ã‚«ãƒ«DBã«è¨˜éŒ²ã€‹ã™ã‚‹</li>
<li><strong>[NotificationService]</strong> ãŒ {æ–°è¦ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼} ã«ã€Šæ‹›å¾…é€šçŸ¥ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- æ¨©é™ãƒ¬ãƒ™ãƒ«: Owner &gt; Editor &gt; Viewer
- ç¶™æ‰¿æ¨©é™ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã¯æ˜ç¤ºçš„ã«è¡Œã†
- ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨©é™å¤‰æ›´ã¯ãƒ­ã‚°è¨˜éŒ²</p>
<hr />
<h2 id="4-event-tracking-context">4. Event Tracking Context (ã‚¤ãƒ™ãƒ³ãƒˆè¿½è·¡)<a class="headerlink" href="#4-event-tracking-context" title="Permanent link">&para;</a></h2>
<h3 id="story-41-box">Story 4.1: BOXã‚¤ãƒ™ãƒ³ãƒˆå–å¾—<a class="headerlink" href="#story-41-box" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—ãƒ•ãƒ­ãƒ¼"
        WH[BOX Webhook] -->|1. ã‚¤ãƒ™ãƒ³ãƒˆé€šçŸ¥| EI[EventIngester]
        EI -->|2. æ­£è¦åŒ–| EP[EventProcessor]
        EP -->|3. æ°¸ç¶šåŒ–| CS[(Cassandra)]
        CS -->|4. ä¿å­˜å®Œäº†| EP
        EP -->|5. åˆ†æ| EA[EventAnalyzer]
        EA -->|6. ã‚¢ãƒ©ãƒ¼ãƒˆ| NS[NotificationService]
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[BOX Webhook]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šã‚·ã‚¹ãƒ†ãƒ ã«é€šçŸ¥ã€‹ã™ã‚‹</li>
<li><strong>[EventIngester]</strong> ãŒ {ç”Ÿã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šæ­£è¦åŒ–ã€‹ã™ã‚‹</li>
<li><strong>[EventProcessor]</strong> ãŒ {æ­£è¦åŒ–ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€ŠCassandraã«æ°¸ç¶šåŒ–ã€‹ã™ã‚‹</li>
<li><strong>[EventAnalyzer]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³} ã‚’ã€Šåˆ†æã€‹ã™ã‚‹</li>
<li><strong>[NotificationService]</strong> ãŒ {ç•°å¸¸æ¤œçŸ¥æ™‚} ã«ã€Šã‚¢ãƒ©ãƒ¼ãƒˆã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- ã‚¤ãƒ™ãƒ³ãƒˆã¯è¿½è¨˜ã®ã¿ï¼ˆä¸å¤‰ï¼‰
- ä¿æŒæœŸé–“: ç›£æŸ»ã‚¤ãƒ™ãƒ³ãƒˆ=7å¹´ã€ä¸€èˆ¬ã‚¤ãƒ™ãƒ³ãƒˆ=1å¹´
- æ¯ç§’1000ã‚¤ãƒ™ãƒ³ãƒˆã®å‡¦ç†èƒ½åŠ›</p>
<hr />
<h3 id="story-42">Story 4.2: ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°<a class="headerlink" href="#story-42" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Auditor as ç›£æŸ»æ‹…å½“è€…
    participant UI as WebUI
    participant ES as EventSearchService
    participant CS as Cassandra
    participant CACHE as Redis

    Auditor->>UI: æ¤œç´¢æ¡ä»¶å…¥åŠ›
    UI->>ES: æ¤œç´¢ã‚¯ã‚¨ãƒª
    ES->>CACHE: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç¢ºèª
    alt ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆ
        CACHE-->>ES: ã‚­ãƒ£ãƒƒã‚·ãƒ¥çµæœ
    else ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹
        ES->>CS: ã‚¯ã‚¨ãƒªå®Ÿè¡Œ
        CS-->>ES: æ¤œç´¢çµæœ
        ES->>CACHE: çµæœã‚­ãƒ£ãƒƒã‚·ãƒ¥
    end
    ES-->>UI: æ¤œç´¢çµæœ
    UI-->>Auditor: çµæœè¡¨ç¤º
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {æ¤œç´¢æ¡ä»¶ï¼ˆæœŸé–“ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼‰} ã‚’ã€Šå…¥åŠ›ã€‹ã™ã‚‹</li>
<li><strong>[EventSearchService]</strong> ãŒ {ã‚­ãƒ£ãƒƒã‚·ãƒ¥} ã‚’ã€Šç¢ºèªã€‹ã™ã‚‹</li>
<li><strong>[EventSearchService]</strong> ãŒ {Cassandra} ã‹ã‚‰ã€Šã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¤œç´¢ã€‹ã™ã‚‹</li>
<li><strong>[EventSearchService]</strong> ãŒ {æ¤œç´¢çµæœ} ã‚’ã€Šãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ»ã‚½ãƒ¼ãƒˆã€‹ã™ã‚‹</li>
<li><strong>[WebUI]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§} ã‚’ã€Šè¡¨ç¤ºã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- æ¤œç´¢çµæœã¯æœ€å¤§10,000ä»¶ã¾ã§
- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³: 100ä»¶/ãƒšãƒ¼ã‚¸
- é »ç¹ãªã‚¯ã‚¨ãƒªã¯5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥</p>
<hr />
<h2 id="5-integrity-verification-context">5. Integrity Verification Context (æ•´åˆæ€§æ¤œè¨¼)<a class="headerlink" href="#5-integrity-verification-context" title="Permanent link">&para;</a></h2>
<h3 id="story-51">Story 5.1: ãƒãƒƒã‚·ãƒ¥è¨ˆç®—ã¨ç™»éŒ²<a class="headerlink" href="#story-51" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ãƒãƒƒã‚·ãƒ¥ç™»éŒ²ãƒ•ãƒ­ãƒ¼"
        T[ãƒˆãƒªã‚¬ãƒ¼] -->|1. æ¤œè¨¼è¦æ±‚| VS[VerificationService]
        VS -->|2. ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—| FS[FileService]
        FS -->|3. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰| BOX[BOX API]
        BOX -->|4. ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿| FS
        FS -->|5. ãƒ•ã‚¡ã‚¤ãƒ«| VS
        VS -->|6. ãƒãƒƒã‚·ãƒ¥è¨ˆç®—| HC[HashCalculator]
        HC -->|7. SHA-256| VS
        VS -->|8. ç™»éŒ²| SDL[ScalarDL]
        SDL -->|9. æ”¹ã–ã‚“é˜²æ­¢è¨˜éŒ²| VS
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…/ã‚·ã‚¹ãƒ†ãƒ ]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«} ã®ã€Šæ¤œè¨¼ã‚’è¦æ±‚ã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«} ã‚’ã€ŠBOXã‹ã‚‰å–å¾—ã€‹ã™ã‚‹</li>
<li><strong>[HashCalculator]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„} ã®ã€ŠSHA-256ãƒãƒƒã‚·ãƒ¥ã‚’è¨ˆç®—ã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {ãƒãƒƒã‚·ãƒ¥å€¤} ã‚’ã€ŠScalarDLã«ç™»éŒ²ã€‹ã™ã‚‹</li>
<li><strong>[ScalarDL]</strong> ãŒ {ç™»éŒ²è¨¼æ˜} ã‚’ã€Šç™ºè¡Œã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- ãƒãƒƒã‚·ãƒ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ : SHA-256
- åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®å†ç™»éŒ²ã¯æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ã—ã¦è¨˜éŒ²
- ScalarDLã«ã‚ˆã‚‹æ”¹ã–ã‚“é˜²æ­¢ä¿è¨¼</p>
<hr />
<h3 id="story-52">Story 5.2: æ•´åˆæ€§æ¤œè¨¼å®Ÿè¡Œ<a class="headerlink" href="#story-52" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor Auditor as ç›£æŸ»æ‹…å½“è€…
    participant VS as VerificationService
    participant FS as FileService
    participant BoxAPI as BOX API
    participant HC as HashCalculator
    participant SDL as ScalarDL
    participant DB as Database

    Auditor->>VS: æ¤œè¨¼å®Ÿè¡Œè¦æ±‚
    VS->>FS: ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«å–å¾—
    FS->>BoxAPI: ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    BoxAPI-->>FS: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‡ãƒ¼ã‚¿
    FS-->>VS: ãƒ•ã‚¡ã‚¤ãƒ«

    VS->>HC: ãƒãƒƒã‚·ãƒ¥è¨ˆç®—
    HC-->>VS: ç¾åœ¨ã®ãƒãƒƒã‚·ãƒ¥

    VS->>SDL: ç™»éŒ²ãƒãƒƒã‚·ãƒ¥å–å¾—
    SDL-->>VS: ç™»éŒ²æ™‚ã®ãƒãƒƒã‚·ãƒ¥

    VS->>VS: ãƒãƒƒã‚·ãƒ¥æ¯”è¼ƒ

    alt ä¸€è‡´
        VS->>DB: æ¤œè¨¼æˆåŠŸè¨˜éŒ²
        VS-->>Auditor: æ•´åˆæ€§ç¢ºèªOK
    else ä¸ä¸€è‡´
        VS->>DB: æ¤œè¨¼å¤±æ•—è¨˜éŒ²
        VS-->>Auditor: æ”¹ã–ã‚“æ¤œå‡ºã‚¢ãƒ©ãƒ¼ãƒˆ
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ } ã®ã€Šæ•´åˆæ€§æ¤œè¨¼ã‚’å®Ÿè¡Œã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {ç¾åœ¨ã®ãƒ•ã‚¡ã‚¤ãƒ«} ã‚’ã€ŠBOXã‹ã‚‰å–å¾—ã€‹ã™ã‚‹</li>
<li><strong>[HashCalculator]</strong> ãŒ {ç¾åœ¨ã®ãƒãƒƒã‚·ãƒ¥} ã‚’ã€Šè¨ˆç®—ã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {ç™»éŒ²æ™‚ã®ãƒãƒƒã‚·ãƒ¥} ã‚’ã€ŠScalarDLã‹ã‚‰å–å¾—ã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {ãƒãƒƒã‚·ãƒ¥ã‚’æ¯”è¼ƒ} ã—ã¦ã€Šæ¤œè¨¼çµæœã‚’åˆ¤å®šã€‹ã™ã‚‹</li>
<li><strong>[VerificationService]</strong> ãŒ {æ¤œè¨¼çµæœ} ã‚’ã€Šè¨˜éŒ²ã€‹ã™ã‚‹</li>
<li>ä¸ä¸€è‡´ã®å ´åˆã€<strong>[NotificationService]</strong> ãŒã€Šã‚¢ãƒ©ãƒ¼ãƒˆã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- æ¤œè¨¼çµæœ: Verified / Tampered / NotRegistered / Error
- æ”¹ã–ã‚“æ¤œå‡ºæ™‚ã¯å³æ™‚ã‚¢ãƒ©ãƒ¼ãƒˆ
- æ¤œè¨¼å±¥æ­´ã¯æ°¸ä¹…ä¿æŒ</p>
<hr />
<h2 id="6-box-integration-context-box">6. BOX Integration Context (BOXé€£æº)<a class="headerlink" href="#6-box-integration-context-box" title="Permanent link">&para;</a></h2>
<h3 id="story-61-oauth">Story 6.1: OAuthèªè¨¼ãƒ•ãƒ­ãƒ¼<a class="headerlink" href="#story-61-oauth" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "OAuthèªè¨¼ãƒ•ãƒ­ãƒ¼"
        U[ãƒ¦ãƒ¼ã‚¶ãƒ¼] -->|1. BOXé€£æºè¦æ±‚| APP[Application]
        APP -->|2. èªå¯ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ| BOX[BOX OAuth]
        BOX -->|3. ãƒ­ã‚°ã‚¤ãƒ³/åŒæ„| U
        U -->|4. èªå¯ã‚³ãƒ¼ãƒ‰| APP
        APP -->|5. ãƒˆãƒ¼ã‚¯ãƒ³äº¤æ›| BOX
        BOX -->|6. ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³| APP
        APP -->|7. ãƒˆãƒ¼ã‚¯ãƒ³ä¿å­˜| DB[(TokenDB)]
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ãƒ¦ãƒ¼ã‚¶ãƒ¼]</strong> ãŒ {BOXé€£æº} ã‚’ã€Šé–‹å§‹ã€‹ã™ã‚‹</li>
<li><strong>[Application]</strong> ãŒ {èªå¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆ} ã‚’ã€ŠBOXã«é€ä¿¡ã€‹ã™ã‚‹</li>
<li><strong>[ãƒ¦ãƒ¼ã‚¶ãƒ¼]</strong> ãŒ {BOXãƒ­ã‚°ã‚¤ãƒ³ç”»é¢} ã§ã€Šèªè¨¼ãƒ»åŒæ„ã€‹ã™ã‚‹</li>
<li><strong>[BOX]</strong> ãŒ {èªå¯ã‚³ãƒ¼ãƒ‰} ã‚’ã€ŠApplicationã«è¿”å´ã€‹ã™ã‚‹</li>
<li><strong>[Application]</strong> ãŒ {èªå¯ã‚³ãƒ¼ãƒ‰} ã‚’ã€Šã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³ã«äº¤æ›ã€‹ã™ã‚‹</li>
<li><strong>[TokenService]</strong> ãŒ {ãƒˆãƒ¼ã‚¯ãƒ³} ã‚’ã€Šæš—å·åŒ–ã—ã¦ä¿å­˜ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™: 60åˆ†
- ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³æœ‰åŠ¹æœŸé™: 60æ—¥
- ãƒˆãƒ¼ã‚¯ãƒ³ã¯AES-256ã§æš—å·åŒ–ä¿å­˜</p>
<hr />
<h3 id="story-62-webhook">Story 6.2: Webhookã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†<a class="headerlink" href="#story-62-webhook" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant BoxPlatform as BOX Platform
    participant WH as WebhookHandler
    participant VAL as SignatureValidator
    participant EI as EventIngester
    participant QUEUE as EventQueue

    BoxPlatform->>WH: Webhookã‚¤ãƒ™ãƒ³ãƒˆ
    WH->>VAL: ç½²åæ¤œè¨¼
    alt ç½²åæœ‰åŠ¹
        VAL-->>WH: æ¤œè¨¼OK
        WH->>EI: ã‚¤ãƒ™ãƒ³ãƒˆæ­£è¦åŒ–
        EI->>QUEUE: ã‚­ãƒ¥ãƒ¼ã‚¤ãƒ³ã‚°
        QUEUE-->>WH: å—ä»˜å®Œäº†
        WH-->>BoxPlatform: 200 OK
    else ç½²åç„¡åŠ¹
        VAL-->>WH: æ¤œè¨¼NG
        WH-->>BoxPlatform: 401 Unauthorized
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[BOX Platform]</strong> ãŒ {Webhookã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«é€ä¿¡ã€‹ã™ã‚‹</li>
<li><strong>[WebhookHandler]</strong> ãŒ {ãƒªã‚¯ã‚¨ã‚¹ãƒˆç½²å} ã‚’ã€Šæ¤œè¨¼ã€‹ã™ã‚‹</li>
<li><strong>[EventIngester]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰} ã‚’ã€Šæ­£è¦åŒ–ã€‹ã™ã‚‹</li>
<li><strong>[EventQueue]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€ŠéåŒæœŸå‡¦ç†ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã€‹ã™ã‚‹</li>
<li><strong>[WebhookHandler]</strong> ãŒ {200 OK} ã‚’ã€Šå³åº§ã«è¿”å´ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- Webhookç½²åã¯HMAC-SHA256ã§æ¤œè¨¼
- å¿œç­”ã¯3ç§’ä»¥å†…ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆå¯¾ç­–ï¼‰
- ãƒªãƒˆãƒ©ã‚¤: æœ€å¤§5å›ï¼ˆæŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰</p>
<hr />
<h3 id="story-63-api">Story 6.3: API ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ<a class="headerlink" href="#story-63-api" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ"
        REQ[APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ] --> RL[RateLimiter]
        RL -->|è¨±å¯| BOX[BOX API]
        RL -->|åˆ¶é™ä¸­| QUEUE[å¾…æ©Ÿã‚­ãƒ¥ãƒ¼]
        QUEUE -->|é…å»¶å®Ÿè¡Œ| RL
        BOX -->|429 Rate Limited| RL
        RL -->|ãƒãƒƒã‚¯ã‚ªãƒ•| QUEUE
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[Application]</strong> ãŒ {APIãƒªã‚¯ã‚¨ã‚¹ãƒˆ} ã‚’ã€Šç™ºè¡Œã€‹ã™ã‚‹</li>
<li><strong>[RateLimiter]</strong> ãŒ {ãƒ¬ãƒ¼ãƒˆåˆ¶é™çŠ¶æ…‹} ã‚’ã€Šç¢ºèªã€‹ã™ã‚‹</li>
<li>åˆ¶é™å†…ã®å ´åˆã€<strong>[RateLimiter]</strong> ãŒ {ãƒªã‚¯ã‚¨ã‚¹ãƒˆ} ã‚’ã€ŠBOX APIã«è»¢é€ã€‹ã™ã‚‹</li>
<li>429å¿œç­”ã®å ´åˆã€<strong>[RateLimiter]</strong> ãŒ {ãƒªã‚¯ã‚¨ã‚¹ãƒˆ} ã‚’ã€Šå¾…æ©Ÿã‚­ãƒ¥ãƒ¼ã«è¿½åŠ ã€‹ã™ã‚‹</li>
<li><strong>[RateLimiter]</strong> ãŒ {æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•} ã§ã€Šãƒªãƒˆãƒ©ã‚¤ã€‹ã™ã‚‹</li>
</ol>
<p><strong>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«:</strong>
- BOX APIãƒ¬ãƒ¼ãƒˆ: 1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†
- ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¬ãƒ¼ãƒˆåˆ¶é™: 800ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/åˆ†ï¼ˆãƒãƒƒãƒ•ã‚¡ï¼‰
- ãƒãƒƒã‚¯ã‚ªãƒ•: 1ç§’ â†’ 2ç§’ â†’ 4ç§’ â†’ ... æœ€å¤§60ç§’</p>
<hr />
<h2 id="7">7. ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="story-71">Story 7.1: ç›£æŸ»å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ<a class="headerlink" href="#story-71" title="Permanent link">&para;</a></h3>
<div class="mermaid">
graph TB
    subgraph "ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ•ãƒ­ãƒ¼"
        A[ç›£æŸ»æ‹…å½“è€…] -->|1. ãƒ¬ãƒãƒ¼ãƒˆè¦æ±‚| AS[AuditService]
        AS -->|2. ã‚¢ã‚¤ãƒ†ãƒ å–å¾—| AIS[AuditItemService]
        AS -->|3. æ¤œè¨¼çµæœå–å¾—| VS[VerificationService]
        AS -->|4. ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—| ES[EventService]
        AS -->|5. ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—| FS[FileService]
        AS -->|6. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ| RG[ReportGenerator]
        RG -->|7. PDFå‡ºåŠ›| A
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[ç›£æŸ»æ‹…å½“è€…]</strong> ãŒ {ç›£æŸ»ã‚»ãƒƒãƒˆ} ã®ã€Šãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã‚’è¦æ±‚ã€‹ã™ã‚‹</li>
<li><strong>[AuditService]</strong> ãŒ {å„ã‚µãƒ¼ãƒ“ã‚¹} ã‹ã‚‰ã€Šå¿…è¦ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã€‹ã™ã‚‹</li>
<li><strong>[ReportGenerator]</strong> ãŒ {åé›†ãƒ‡ãƒ¼ã‚¿} ã‚’ã€Šãƒ¬ãƒãƒ¼ãƒˆå½¢å¼ã«æ•´å½¢ã€‹ã™ã‚‹</li>
<li><strong>[ReportGenerator]</strong> ãŒ {PDF/Excel} ã¨ã—ã¦ã€Šã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€‹ã™ã‚‹</li>
</ol>
<hr />
<h3 id="story-72">Story 7.2: ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ¤œçŸ¥ã¨ç›£æŸ»å½±éŸ¿é€šçŸ¥<a class="headerlink" href="#story-72" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    participant BoxWebhook as BOX Webhook
    participant EI as EventIngester
    participant ES as EventService
    participant AS as AuditService
    participant NS as NotificationService
    actor Auditor as ç›£æŸ»æ‹…å½“è€…

    BoxWebhook->>EI: ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆ
    EI->>ES: ã‚¤ãƒ™ãƒ³ãƒˆä¿å­˜
    ES->>AS: ç›£æŸ»å½±éŸ¿ãƒã‚§ãƒƒã‚¯
    AS->>AS: å¯¾è±¡ç›£æŸ»ã‚»ãƒƒãƒˆæ¤œç´¢

    alt ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«
        AS->>NS: é€šçŸ¥è¦æ±‚
        NS->>Auditor: ãƒ¡ãƒ¼ãƒ«/Slacké€šçŸ¥
    end
</div>

<p><strong>ãƒŠãƒ©ãƒ†ã‚£ãƒ–:</strong></p>
<ol>
<li><strong>[BOX]</strong> ãŒ {ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€ŠWebhookã§é€šçŸ¥ã€‹ã™ã‚‹</li>
<li><strong>[EventService]</strong> ãŒ {ã‚¤ãƒ™ãƒ³ãƒˆ} ã‚’ã€Šè¨˜éŒ²ã€‹ã™ã‚‹</li>
<li><strong>[AuditService]</strong> ãŒ {ç›£æŸ»å¯¾è±¡ã‹ã©ã†ã‹} ã‚’ã€Šãƒã‚§ãƒƒã‚¯ã€‹ã™ã‚‹</li>
<li>ç›£æŸ»å¯¾è±¡ã®å ´åˆã€<strong>[NotificationService]</strong> ãŒ {æ‹…å½“è€…} ã«ã€Šé€šçŸ¥ã€‹ã™ã‚‹</li>
</ol>
<hr />
<h2 id="8">8. ãƒ‰ãƒ¡ã‚¤ãƒ³ç”¨èªé›†<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç”¨èª</th>
<th>æ—¥æœ¬èª</th>
<th>å®šç¾©</th>
</tr>
</thead>
<tbody>
<tr>
<td>Audit Set</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ãŸã‚³ãƒ³ãƒ†ãƒŠ</td>
</tr>
<tr>
<td>Audit Item</td>
<td>ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ </td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆå†…ã®å€‹åˆ¥ç›£æŸ»å¯¾è±¡</td>
</tr>
<tr>
<td>Verification</td>
<td>æ¤œè¨¼</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•´åˆæ€§ã‚’ç¢ºèªã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹</td>
</tr>
<tr>
<td>Hash</td>
<td>ãƒãƒƒã‚·ãƒ¥</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸€æ„è­˜åˆ¥å­ï¼ˆSHA-256ï¼‰</td>
</tr>
<tr>
<td>Collaborator</td>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
</tr>
<tr>
<td>Webhook</td>
<td>ã‚¦ã‚§ãƒ–ãƒ•ãƒƒã‚¯</td>
<td>BOXã‹ã‚‰ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆé€šçŸ¥</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>ã‚¹ã‚«ãƒ©ãƒ¼DL</td>
<td>æ”¹ã–ã‚“é˜²æ­¢ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Generated: 2025-12-26</em>
<em>Version: 1.0.0</em>
<em>Source: Scalar Auditor for BOX Domain Analysis</em></p>
</article>
<article id="stories-audit-set-story">
<h1 id="_1">ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼: ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="_2">æ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>ç›£æŸ»ã‚»ãƒƒãƒˆç®¡ç†ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ãŠã‘ã‚‹ä¸»è¦ãªãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ†ãƒªãƒ³ã‚°å½¢å¼ã§å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
<hr />
<h2 id="1">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼1: ç›£æŸ»ã‚»ãƒƒãƒˆã®ä½œæˆ<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="_3">ã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ç®¡ç†è€…ãŒæ–°ã—ã„è²¡å‹™ç›£æŸ»ã®ãŸã‚ã®ç›£æŸ»ã‚»ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹ã€‚</p>
<h3 id="_4">ç™»å ´äººç‰©ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<ul>
<li>ğŸ‘¤ ç›£æŸ»ç®¡ç†è€…ï¼ˆAudit Adminï¼‰</li>
<li>ğŸ“ ç›£æŸ»ã‚»ãƒƒãƒˆï¼ˆAudit Setï¼‰</li>
<li>ğŸ“‹ Scalar Auditor WebApp</li>
<li>ğŸ’¾ ScalarDB</li>
</ul>
<h3 id="_5">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å›³<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor AA as ğŸ‘¤ ç›£æŸ»ç®¡ç†è€…
    participant WEB as ğŸ“‹ WebApp
    participant API as ğŸ”§ API
    participant DB as ğŸ’¾ ScalarDB

    AA->>WEB: 1. ã€Œç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    WEB->>WEB: 2. ä½œæˆãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º
    AA->>WEB: 3. åå‰ã€Œ2024å¹´åº¦è²¡å‹™ç›£æŸ»ã€ã¨èª¬æ˜ã‚’å…¥åŠ›
    WEB->>API: 4. ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    API->>DB: 5. ç›£æŸ»ã‚»ãƒƒãƒˆã‚’ä¿å­˜
    API->>DB: 6. ä½œæˆè€…ã‚’æ‰€æœ‰è€…ã¨ã—ã¦ç™»éŒ²
    DB-->>API: 7. ä¿å­˜å®Œäº†
    API-->>WEB: 8. ä½œæˆæˆåŠŸãƒ¬ã‚¹ãƒãƒ³ã‚¹
    WEB-->>AA: 9. ç›£æŸ»ã‚»ãƒƒãƒˆè©³ç´°ç”»é¢ã‚’è¡¨ç¤º
</div>

<h3 id="_6">ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£è¨˜è¿°<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>#</th>
<th>ã‚¢ã‚¯ã‚¿ãƒ¼</th>
<th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
<th>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</th>
<th>çµæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>ç›£æŸ»ç®¡ç†è€…</td>
<td>ã‚¯ãƒªãƒƒã‚¯</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆä½œæˆãƒœã‚¿ãƒ³</td>
<td>ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º</td>
</tr>
<tr>
<td>2</td>
<td>ç›£æŸ»ç®¡ç†è€…</td>
<td>å…¥åŠ›</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæƒ…å ±</td>
<td>ãƒ‡ãƒ¼ã‚¿æº–å‚™</td>
</tr>
<tr>
<td>3</td>
<td>WebApp</td>
<td>é€ä¿¡</td>
<td>ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
<td>APIå‘¼ã³å‡ºã—</td>
</tr>
<tr>
<td>4</td>
<td>API</td>
<td>ä¿å­˜</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>DBæ°¸ç¶šåŒ–</td>
</tr>
<tr>
<td>5</td>
<td>API</td>
<td>ç™»éŒ²</td>
<td>æ‰€æœ‰è€…ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>æ¨©é™è¨­å®š</td>
</tr>
<tr>
<td>6</td>
<td>WebApp</td>
<td>è¡¨ç¤º</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆè©³ç´°</td>
<td>ä½œæˆå®Œäº†</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼2: ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ <a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="_7">ã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒBOXçµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ ã™ã‚‹ã€‚</p>
<h3 id="_8">ç™»å ´äººç‰©ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<ul>
<li>ğŸ‘¤ ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆGeneral Userï¼‰</li>
<li>ğŸ“„ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆFileï¼‰</li>
<li>ğŸ“ ç›£æŸ»ã‚»ãƒƒãƒˆï¼ˆAudit Setï¼‰</li>
<li>ğŸ”— BOXçµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼</li>
<li>ğŸ” ScalarDL</li>
</ul>
<h3 id="_9">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å›³<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor GU as ğŸ‘¤ ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant BOX as ğŸ“¦ BOX
    participant MENU as ğŸ”— çµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼
    participant API as ğŸ”§ API
    participant DL as ğŸ” ScalarDL

    GU->>BOX: 1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
    BOX->>MENU: 2. çµ±åˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’é–‹ã
    GU->>MENU: 3. ã€Œç›£æŸ»ã‚»ãƒƒãƒˆã«è¿½åŠ ã€ã‚’é¸æŠ
    MENU->>MENU: 4. ç›£æŸ»ã‚»ãƒƒãƒˆä¸€è¦§ã‚’è¡¨ç¤º
    GU->>MENU: 5. å¯¾è±¡ã®ç›£æŸ»ã‚»ãƒƒãƒˆã‚’é¸æŠ
    MENU->>API: 6. ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    API->>API: 7. æ¨©é™ãƒã‚§ãƒƒã‚¯
    API->>API: 8. ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±å–å¾—
    API->>DL: 9. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›£è¦–å¯¾è±¡ã¨ã—ã¦ç™»éŒ²
    DL-->>API: 10. ç™»éŒ²å®Œäº†
    API-->>MENU: 11. è¿½åŠ æˆåŠŸ
    MENU-->>GU: 12. æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
</div>

<h3 id="_10">ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>æ¨©é™ãƒã‚§ãƒƒã‚¯</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®MEMBERä»¥ä¸Šã®æ¨©é™ãŒå¿…è¦</li>
<li><strong>é‡è¤‡ãƒã‚§ãƒƒã‚¯</strong>: åŒä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®é‡è¤‡è¿½åŠ ã¯ä¸å¯</li>
<li><strong>ç›£è¦–ç™»éŒ²</strong>: è¿½åŠ æ™‚ã«ScalarDLã¸ã®è‡ªå‹•ç™»éŒ²</li>
</ol>
<hr />
<h2 id="3">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼3: ç›£æŸ»ã‚»ãƒƒãƒˆã®æ¤œè¨¼å®Ÿè¡Œ<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="_11">ã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<p>å¤–éƒ¨ç›£æŸ»äººãŒç›£æŸ»ã‚»ãƒƒãƒˆå…¨ä½“ã®ãƒ•ã‚¡ã‚¤ãƒ«æ•´åˆæ€§ã‚’æ¤œè¨¼ã™ã‚‹ã€‚</p>
<h3 id="_12">ç™»å ´äººç‰©ãƒ»ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<ul>
<li>ğŸ‘¤ å¤–éƒ¨ç›£æŸ»äººï¼ˆExternal Auditorï¼‰</li>
<li>ğŸ“ ç›£æŸ»ã‚»ãƒƒãƒˆï¼ˆAudit Setï¼‰</li>
<li>ğŸ“„ ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆFilesï¼‰</li>
<li>ğŸ” ScalarDL</li>
<li>ğŸ“Š æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ</li>
</ul>
<h3 id="_13">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å›³<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor EA as ğŸ‘¤ å¤–éƒ¨ç›£æŸ»äºº
    participant WEB as ğŸ“‹ WebApp
    participant API as ğŸ”§ Verification API
    participant DL as ğŸ” ScalarDL

    EA->>WEB: 1. ç›£æŸ»ã‚»ãƒƒãƒˆã‚’é¸æŠ
    WEB->>WEB: 2. ç›£æŸ»ã‚»ãƒƒãƒˆè©³ç´°è¡¨ç¤º
    EA->>WEB: 3. ã€Œå…¨ä½“æ¤œè¨¼ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    WEB->>API: 4. æ¤œè¨¼ãƒªã‚¯ã‚¨ã‚¹ãƒˆ

    loop å„ãƒ•ã‚¡ã‚¤ãƒ«
        API->>DL: 5. ã‚¢ã‚»ãƒƒãƒˆæ¤œè¨¼å®Ÿè¡Œ
        DL-->>API: 6. æ¤œè¨¼çµæœ
    end

    API->>API: 7. ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    API-->>WEB: 8. æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆ
    WEB-->>EA: 9. çµæœè¡¨ç¤ºï¼ˆæ”¹ã–ã‚“æœ‰ç„¡ï¼‰
</div>

<h3 id="_14">æ¤œè¨¼ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<div class="mermaid">
stateDiagram-v2
    [*] --> NOT_MONITORED: ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ 
    NOT_MONITORED --> MONITORED: ç›£è¦–ç™»éŒ²
    MONITORED --> NOT_TAMPERED: æ¤œè¨¼æˆåŠŸ
    MONITORED --> TAMPERED: æ”¹ã–ã‚“æ¤œçŸ¥
    NOT_TAMPERED --> TAMPERED: å†æ¤œè¨¼ã§æ”¹ã–ã‚“æ¤œçŸ¥
    TAMPERED --> [*]: èª¿æŸ»å®Œäº†
</div>

<hr />
<h2 id="4">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼4: å¤–éƒ¨ç›£æŸ»äººã®æ‹›å¾…<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="_15">ã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ç®¡ç†è€…ãŒå¤–éƒ¨ç›£æŸ»äººã‚’ç›£æŸ»ã‚»ãƒƒãƒˆã«æ‹›å¾…ã™ã‚‹ã€‚</p>
<h3 id="_16">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å›³<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor AA as ğŸ‘¤ ç›£æŸ»ç®¡ç†è€…
    participant WEB as ğŸ“‹ WebApp
    participant API as ğŸ”§ API
    participant MAIL as ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹
    actor EA as ğŸ‘¤ å¤–éƒ¨ç›£æŸ»äºº

    AA->>WEB: 1. ç›£æŸ»ã‚°ãƒ«ãƒ¼ãƒ—ç®¡ç†ã‚’é–‹ã
    AA->>WEB: 2. ã€Œå¤–éƒ¨ç›£æŸ»äººè¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
    WEB->>WEB: 3. ç™»éŒ²ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤º
    AA->>WEB: 4. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»åå‰ã‚’å…¥åŠ›
    WEB->>API: 5. å¤–éƒ¨ç›£æŸ»äººä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    API->>API: 6. ä»®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ
    API->>API: 7. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
    API->>MAIL: 8. æ‹›å¾…ãƒ¡ãƒ¼ãƒ«é€ä¿¡
    MAIL-->>EA: 9. æ‹›å¾…ãƒ¡ãƒ¼ãƒ«å—ä¿¡
    EA->>WEB: 10. ãƒªãƒ³ã‚¯ã‹ã‚‰ãƒ­ã‚°ã‚¤ãƒ³
    EA->>WEB: 11. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
</div>

<hr />
<h2 id="5">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼5: ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´ã®ç¢ºèª<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="_17">ã‚·ãƒŠãƒªã‚ª<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p>ç›£æŸ»ç®¡ç†è€…ãŒãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´å±¥æ­´ã‚’ç¢ºèªã™ã‚‹ã€‚</p>
<h3 id="_18">ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å›³<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<div class="mermaid">
sequenceDiagram
    actor AA as ğŸ‘¤ ç›£æŸ»ç®¡ç†è€…
    participant WEB as ğŸ“‹ WebApp
    participant API as ğŸ”§ Event API
    participant DB as ğŸ’¾ ScalarDB

    AA->>WEB: 1. ã€Œã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´ã€ã‚’é–‹ã
    WEB->>WEB: 2. ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¨­å®šç”»é¢
    AA->>WEB: 3. æ—¥ä»˜ç¯„å›²ãƒ»ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒ—ã‚’é¸æŠ
    WEB->>API: 4. ã‚¤ãƒ™ãƒ³ãƒˆæ¤œç´¢ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
    API->>DB: 5. ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°å–å¾—
    DB-->>API: 6. ã‚¤ãƒ™ãƒ³ãƒˆä¸€è¦§
    API-->>WEB: 7. æ¤œç´¢çµæœ
    WEB-->>AA: 8. ã‚¤ãƒ™ãƒ³ãƒˆå±¥æ­´è¡¨ç¤º
    AA->>WEB: 9. ç‰¹å®šã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯
    WEB-->>AA: 10. ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°è¡¨ç¤º
</div>

<hr />
<h2 id="_19">ãƒ‰ãƒ¡ã‚¤ãƒ³èªå½™ï¼ˆã“ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã§ä½¿ç”¨ï¼‰<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç”¨èª</th>
<th>å®šç¾©</th>
<th>ä½¿ç”¨ç®‡æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆ</td>
<td>ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚°ãƒ«ãƒ¼ãƒ—</td>
<td>å…¨ã‚¹ãƒˆãƒ¼ãƒªãƒ¼</td>
</tr>
<tr>
<td>ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚¿ãƒ¼</td>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼</td>
<td>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼1, 2</td>
</tr>
<tr>
<td>æ¤œè¨¼</td>
<td>ScalarDLã«ã‚ˆã‚‹æ”¹ã–ã‚“ãƒã‚§ãƒƒã‚¯</td>
<td>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼3</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»äºº</td>
<td>å¤–éƒ¨çµ„ç¹”ã‹ã‚‰ã®ç›£æŸ»æ‹…å½“è€…</td>
<td>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼3, 4</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆ</td>
<td>BOXã§ã®æ“ä½œå±¥æ­´</td>
<td>ã‚¹ãƒˆãƒ¼ãƒªãƒ¼5</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_20">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h2>
<ol>
<li>å„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®è©³ç´°åŒ–ï¼ˆä¾‹å¤–ãƒ•ãƒ­ãƒ¼ã€ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ï¼‰</li>
<li>UIãƒ¢ãƒƒã‚¯ã‚¢ãƒƒãƒ—ã¨ã®å¯¾å¿œä»˜ã‘</li>
<li>APIè¨­è¨ˆã¨ã®æ•´åˆæ€§ç¢ºèª</li>
</ol>
</article>
</section>
<section id="estimate">
<h1>ã‚³ã‚¹ãƒˆè©¦ç®—</h1>
<article id="estimate-cost-summary">
<h1 id="_1">ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šã‚µãƒãƒªãƒ¼<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã®ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹åŒ–ã«ä¼´ã†ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»é‹ç”¨ã‚³ã‚¹ãƒˆã®è¦‹ç©ã‚‚ã‚Šã§ã™ã€‚</p>
<p><strong>ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ</strong>: 1 USD = 150 JPYï¼ˆå‚è€ƒå€¤ï¼‰</p>
<hr />
<h2 id="2">2. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã‚³ã‚¹ãƒˆï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-aws">2.1 AWSç’°å¢ƒ æ¨å®šã‚³ã‚¹ãƒˆ<a class="headerlink" href="#21-aws" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>ã‚¹ãƒšãƒƒã‚¯</th>
<th>æ•°é‡</th>
<th>æœˆé¡ (USD)</th>
<th>æœˆé¡ (JPY)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Kubernetes</strong></td>
<td>EKS Cluster</td>
<td>-</td>
<td>1</td>
<td>$73</td>
<td>Â¥10,950</td>
</tr>
<tr>
<td><strong>Compute</strong></td>
<td>EC2 (Worker Nodes)</td>
<td>m5.xlarge</td>
<td>6</td>
<td>$864</td>
<td>Â¥129,600</td>
</tr>
<tr>
<td><strong>Database</strong></td>
<td>Amazon Keyspaces</td>
<td>On-demand</td>
<td>-</td>
<td>$500</td>
<td>Â¥75,000</td>
</tr>
<tr>
<td><strong>Cache</strong></td>
<td>ElastiCache Redis</td>
<td>r6g.large</td>
<td>3</td>
<td>$324</td>
<td>Â¥48,600</td>
</tr>
<tr>
<td><strong>Load Balancer</strong></td>
<td>ALB</td>
<td>-</td>
<td>2</td>
<td>$40</td>
<td>Â¥6,000</td>
</tr>
<tr>
<td><strong>Storage</strong></td>
<td>EBS (gp3)</td>
<td>500GB</td>
<td>6</td>
<td>$120</td>
<td>Â¥18,000</td>
</tr>
<tr>
<td><strong>Monitoring</strong></td>
<td>CloudWatch</td>
<td>-</td>
<td>-</td>
<td>$100</td>
<td>Â¥15,000</td>
</tr>
<tr>
<td><strong>Network</strong></td>
<td>Data Transfer</td>
<td>500GB/æœˆ</td>
<td>-</td>
<td>$45</td>
<td>Â¥6,750</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>$2,066</strong></td>
<td><strong>Â¥309,900</strong></td>
</tr>
</tbody>
</table>
<h3 id="22">2.2 ç’°å¢ƒåˆ¥ã‚³ã‚¹ãƒˆ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>è¦æ¨¡</th>
<th>æœˆé¡ (USD)</th>
<th>æœˆé¡ (JPY)</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>æœ€å°</td>
<td>$300</td>
<td>Â¥45,000</td>
<td>1ãƒãƒ¼ãƒ‰ã€æœ€å°ã‚¹ãƒšãƒƒã‚¯</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>ä¸­</td>
<td>$800</td>
<td>Â¥120,000</td>
<td>2ãƒãƒ¼ãƒ‰</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>ãƒ•ãƒ«</td>
<td>$2,066</td>
<td>Â¥309,900</td>
<td>ä¸Šè¨˜æ§‹æˆ</td>
</tr>
<tr>
<td>DR</td>
<td>æœ€å°</td>
<td>$500</td>
<td>Â¥75,000</td>
<td>å¾…æ©Ÿç³»</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td><strong>$3,666</strong></td>
<td><strong>Â¥549,900</strong></td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚³ã‚¹ãƒˆï¼ˆå¹´é¡ï¼‰<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-scalar">3.1 Scalarè£½å“<a class="headerlink" href="#31-scalar" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è£½å“</th>
<th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å½¢æ…‹</th>
<th>å¹´é¡ (USD)</th>
<th>å¹´é¡ (JPY)</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ScalarDB Enterprise</td>
<td>å•†ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
<td>$50,000</td>
<td>Â¥7,500,000</td>
<td>æœ¬ç•ªç’°å¢ƒç”¨</td>
</tr>
<tr>
<td>ScalarDL</td>
<td>å•†ç”¨ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
<td>$30,000</td>
<td>Â¥4,500,000</td>
<td>æ”¹ã–ã‚“æ¤œçŸ¥</td>
</tr>
<tr>
<td>ã‚µãƒãƒ¼ãƒˆ</td>
<td>ãƒ—ãƒ¬ãƒŸã‚¢ãƒ </td>
<td>$15,000</td>
<td>Â¥2,250,000</td>
<td>24/7ã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td><strong>$95,000</strong></td>
<td><strong>Â¥14,250,000</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="32">3.2 ãã®ä»–ãƒ©ã‚¤ã‚»ãƒ³ã‚¹<a class="headerlink" href="#32" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è£½å“</th>
<th>ç”¨é€”</th>
<th>å¹´é¡ (USD)</th>
<th>å¹´é¡ (JPY)</th>
</tr>
</thead>
<tbody>
<tr>
<td>BOX Platform</td>
<td>APIé€£æº</td>
<td>å«ã¾ã‚Œã‚‹</td>
<td>-</td>
</tr>
<tr>
<td>Kong Enterpriseï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</td>
<td>API Gateway</td>
<td>$25,000</td>
<td>Â¥3,750,000</td>
</tr>
<tr>
<td>Datadogï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</td>
<td>APM/ç›£è¦–</td>
<td>$18,000</td>
<td>Â¥2,700,000</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4">4. é–‹ç™ºãƒ»ç§»è¡Œã‚³ã‚¹ãƒˆ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 é–‹ç™ºå·¥æ•°è¦‹ç©ã‚‚ã‚Š<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ•ã‚§ãƒ¼ã‚º</th>
<th>ä½œæ¥­å†…å®¹</th>
<th>å·¥æ•° (äººæœˆ)</th>
<th>å˜ä¾¡ (ä¸‡å††)</th>
<th>è²»ç”¨ (ä¸‡å††)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Phase 1</td>
<td>UserServiceåˆ†è§£</td>
<td>3</td>
<td>150</td>
<td>450</td>
</tr>
<tr>
<td>Phase 2</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹é–“çµåˆè§£æ¶ˆ</td>
<td>2</td>
<td>150</td>
<td>300</td>
</tr>
<tr>
<td>Phase 3</td>
<td>ã‚µãƒ¼ãƒ“ã‚¹çµ±åˆ</td>
<td>1.5</td>
<td>150</td>
<td>225</td>
</tr>
<tr>
<td>Phase 4</td>
<td>ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æ”¹å–„</td>
<td>2</td>
<td>150</td>
<td>300</td>
</tr>
<tr>
<td>Phase 5</td>
<td>ã‚¤ãƒ³ãƒ•ãƒ©æ§‹ç¯‰</td>
<td>2</td>
<td>150</td>
<td>300</td>
</tr>
<tr>
<td>Phase 6</td>
<td>ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼</td>
<td>2</td>
<td>150</td>
<td>300</td>
</tr>
<tr>
<td>Phase 7</td>
<td>ç§»è¡Œãƒ»ä¸¦è¡Œé‹ç”¨</td>
<td>1.5</td>
<td>150</td>
<td>225</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td><strong>14äººæœˆ</strong></td>
<td></td>
<td><strong>2,100ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 ç§»è¡Œã‚³ã‚¹ãƒˆ<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>è²»ç”¨ (ä¸‡å††)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ç§»è¡Œãƒ„ãƒ¼ãƒ«é–‹ç™º</td>
<td>100</td>
</tr>
<tr>
<td>ä¸¦è¡Œé‹ç”¨æœŸé–“ï¼ˆ3ãƒ¶æœˆï¼‰</td>
<td>150</td>
</tr>
<tr>
<td>åˆ‡ã‚Šæ›¿ãˆã‚µãƒãƒ¼ãƒˆ</td>
<td>50</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>300ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. é‹ç”¨ã‚³ã‚¹ãƒˆï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å†…å®¹</th>
<th>æœˆé¡ (ä¸‡å††)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¤ãƒ³ãƒ•ãƒ©ç›£è¦–</td>
<td>24/7ç›£è¦–ã€ã‚¢ãƒ©ãƒ¼ãƒˆå¯¾å¿œ</td>
<td>30</td>
</tr>
<tr>
<td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¿å®ˆ</td>
<td>ãƒã‚°ä¿®æ­£ã€è»½å¾®ãªæ”¹å–„</td>
<td>50</td>
</tr>
<tr>
<td>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‹ç”¨</td>
<td>è„†å¼±æ€§å¯¾å¿œã€ãƒ‘ãƒƒãƒé©ç”¨</td>
<td>20</td>
</tr>
<tr>
<td>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»DR</td>
<td>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèªã€DRè¨“ç·´</td>
<td>10</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td><strong>110ä¸‡å††/æœˆ</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. ç·ã‚³ã‚¹ãƒˆè©¦ç®—<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61">6.1 åˆå¹´åº¦<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>è²»ç”¨ (ä¸‡å††)</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™ºãƒ»ç§»è¡Œ</td>
<td>2,400</td>
</tr>
<tr>
<td>ã‚¤ãƒ³ãƒ•ãƒ©ï¼ˆå¹´é¡ï¼‰</td>
<td>660</td>
</tr>
<tr>
<td>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼ˆå¹´é¡ï¼‰</td>
<td>1,425</td>
</tr>
<tr>
<td>é‹ç”¨ï¼ˆå¹´é¡ï¼‰</td>
<td>1,320</td>
</tr>
<tr>
<td><strong>åˆå¹´åº¦åˆè¨ˆ</strong></td>
<td><strong>5,805ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<h3 id="62-2">6.2 2å¹´ç›®ä»¥é™ï¼ˆå¹´é¡ï¼‰<a class="headerlink" href="#62-2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>è²»ç”¨ (ä¸‡å††)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¤ãƒ³ãƒ•ãƒ©</td>
<td>660</td>
</tr>
<tr>
<td>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
<td>1,425</td>
</tr>
<tr>
<td>é‹ç”¨</td>
<td>1,320</td>
</tr>
<tr>
<td><strong>å¹´é–“åˆè¨ˆ</strong></td>
<td><strong>3,405ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7-roi">7. ROIåˆ†æ<a class="headerlink" href="#7-roi" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 æœŸå¾…åŠ¹æœ<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>åŠ¹æœ</th>
<th>ç¾çŠ¶</th>
<th>ç§»è¡Œå¾Œ</th>
<th>å¹´é–“å‰Šæ¸›é¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™ºç”Ÿç”£æ€§</td>
<td>100%</td>
<td>150%</td>
<td>500ä¸‡å††</td>
</tr>
<tr>
<td>éšœå®³å¾©æ—§æ™‚é–“</td>
<td>4æ™‚é–“</td>
<td>30åˆ†</td>
<td>100ä¸‡å††</td>
</tr>
<tr>
<td>ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°å·¥æ•°</td>
<td>2é€±é–“</td>
<td>1æ™‚é–“</td>
<td>200ä¸‡å††</td>
</tr>
<tr>
<td>æŠ€è¡“çš„è² å‚µè§£æ¶ˆ</td>
<td>-</td>
<td>-</td>
<td>300ä¸‡å††</td>
</tr>
<tr>
<td><strong>å¹´é–“åŠ¹æœåˆè¨ˆ</strong></td>
<td></td>
<td></td>
<td><strong>1,100ä¸‡å††</strong></td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 æŠ•è³‡å›åæœŸé–“<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>åˆæœŸæŠ•è³‡: 2,400ä¸‡å††
å¹´é–“è¿½åŠ ã‚³ã‚¹ãƒˆ: 3,405 - 2,500ï¼ˆç¾çŠ¶ã‚³ã‚¹ãƒˆï¼‰ = 905ä¸‡å††
å¹´é–“åŠ¹æœ: 1,100ä¸‡å††
ç´”åŠ¹æœ: 1,100 - 905 = 195ä¸‡å††/å¹´

æŠ•è³‡å›åæœŸé–“ = 2,400 / 195 â‰’ 12.3å¹´
</code></pre>

<p><strong>æ³¨è¨˜</strong>: ä¸Šè¨˜ã¯ä¿å®ˆçš„ãªè©¦ç®—ã€‚å®Ÿéš›ã«ã¯ä»¥ä¸‹ã®å®šé‡åŒ–å›°é›£ãªåŠ¹æœã‚‚æœŸå¾…:
- æ©Ÿèƒ½è¿½åŠ é€Ÿåº¦ã®å‘ä¸Š
- ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æ¡ç”¨ã®å®¹æ˜“åŒ–
- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒªã‚¹ã‚¯ä½æ¸›</p>
<hr />
<h2 id="8">8. ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</th>
<th>å‰Šæ¸›é¡/å¹´</th>
<th>ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reserved Instances</td>
<td>-$500</td>
<td>1-3å¹´ã‚³ãƒŸãƒƒãƒˆå¿…è¦</td>
</tr>
<tr>
<td>Spot Instancesï¼ˆé–‹ç™ºç’°å¢ƒï¼‰</td>
<td>-$200</td>
<td>å¯ç”¨æ€§ä½ä¸‹</td>
</tr>
<tr>
<td>OSSç›£è¦–ãƒ„ãƒ¼ãƒ«æ¡ç”¨</td>
<td>-$18,000</td>
<td>é‹ç”¨å·¥æ•°å¢—åŠ </td>
</tr>
<tr>
<td>ScalarDB Community Edition</td>
<td>-$50,000</td>
<td>ã‚µãƒãƒ¼ãƒˆãªã—ã€æ©Ÿèƒ½åˆ¶é™</td>
</tr>
</tbody>
</table>
</article>
<article id="estimate-infrastructure-detail">
<h1 id="_1">ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£è©³ç´°è¦‹ç©ã‚‚ã‚Š<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼</strong></td>
<td>AWS</td>
</tr>
<tr>
<td><strong>ãƒªãƒ¼ã‚¸ãƒ§ãƒ³</strong></td>
<td>ap-northeast-1 (æ±äº¬)</td>
</tr>
<tr>
<td><strong>å¯ç”¨æ€§ã‚¾ãƒ¼ãƒ³</strong></td>
<td>3 AZ (ap-northeast-1a, 1c, 1d)</td>
</tr>
<tr>
<td><strong>è¦‹ç©ã‚‚ã‚ŠåŸºæº–æ—¥</strong></td>
<td>2025-01-12</td>
</tr>
<tr>
<td><strong>ä¾¡æ ¼ã‚¿ã‚¤ãƒ—</strong></td>
<td>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ï¼ˆãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ãªã—ï¼‰</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2-kubernetes-amazon-eks">2. Kubernetes (Amazon EKS)<a class="headerlink" href="#2-kubernetes-amazon-eks" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<h4 id="eks-control-plane">EKS Control Plane<a class="headerlink" href="#eks-control-plane" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å˜ä¾¡ (USD/æ™‚é–“)</th>
<th>æ™‚é–“/æœˆ</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS Cluster</td>
<td>$0.10</td>
<td>730</td>
<td>$73</td>
</tr>
</tbody>
</table>
<h4 id="worker-nodes">Worker Nodes (ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨)<a class="headerlink" href="#worker-nodes" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—</th>
<th>vCPU</th>
<th>ãƒ¡ãƒ¢ãƒª</th>
<th>å˜ä¾¡ (USD/æ™‚é–“)</th>
<th>å°æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>m5.xlarge</td>
<td>4</td>
<td>16 GB</td>
<td>$0.192</td>
<td>6</td>
<td>$840.96</td>
</tr>
</tbody>
</table>
<p><strong>ã‚µãƒ¼ãƒ“ã‚¹é…ç½®è¨ˆç”»:</strong>
- Identity Service: 3 replicas Ã— 0.5 vCPU, 512MB
- Audit Service: 3 replicas Ã— 1 vCPU, 1GB
- File Service: 3 replicas Ã— 0.5 vCPU, 512MB
- Event Service: 3 replicas Ã— 0.5 vCPU, 512MB
- Verification Service: 3 replicas Ã— 0.5 vCPU, 512MB
- BOX Integration Service: 3 replicas Ã— 0.5 vCPU, 512MB
- API Gateway (Kong): 2 replicas Ã— 1 vCPU, 1GB</p>
<h4 id="scalardb-cluster-nodes">ScalarDB Cluster Nodes<a class="headerlink" href="#scalardb-cluster-nodes" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ—</th>
<th>vCPU</th>
<th>ãƒ¡ãƒ¢ãƒª</th>
<th>å˜ä¾¡ (USD/æ™‚é–“)</th>
<th>å°æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>m5.xlarge</td>
<td>4</td>
<td>16 GB</td>
<td>$0.192</td>
<td>3</td>
<td>$420.48</td>
</tr>
</tbody>
</table>
<h4 id="ebs">ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ (EBS)<a class="headerlink" href="#ebs" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¤ãƒ—</th>
<th>å®¹é‡</th>
<th>å˜ä¾¡ (USD/GB/æœˆ)</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>gp3 (Worker)</td>
<td>100GB Ã— 6</td>
<td>$0.08</td>
<td>$48</td>
</tr>
<tr>
<td>gp3 (ScalarDB)</td>
<td>100GB Ã— 3</td>
<td>$0.08</td>
<td>$24</td>
</tr>
</tbody>
</table>
<p><strong>æœ¬ç•ªEKSåˆè¨ˆ: $1,406/æœˆ</strong></p>
<hr />
<h3 id="22">2.2 ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ã‚¹ãƒšãƒƒã‚¯</th>
<th>å°æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS Control Plane</td>
<td>-</td>
<td>1</td>
<td>$73</td>
</tr>
<tr>
<td>Worker Nodes (m5.large)</td>
<td>2 vCPU, 8GB</td>
<td>3</td>
<td>$210</td>
</tr>
<tr>
<td>ScalarDB Nodes (m5.large)</td>
<td>2 vCPU, 8GB</td>
<td>2</td>
<td>$140</td>
</tr>
<tr>
<td>EBS (gp3)</td>
<td>50GB Ã— 5</td>
<td>250GB</td>
<td>$20</td>
</tr>
</tbody>
</table>
<p><strong>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°EKSåˆè¨ˆ: $443/æœˆ</strong></p>
<hr />
<h3 id="23">2.3 é–‹ç™ºç’°å¢ƒ<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ã‚¹ãƒšãƒƒã‚¯</th>
<th>å°æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS Control Plane</td>
<td>-</td>
<td>1</td>
<td>$73</td>
</tr>
<tr>
<td>Worker Nodes (t3.large)</td>
<td>2 vCPU, 8GB</td>
<td>2</td>
<td>$120</td>
</tr>
<tr>
<td>ScalarDB Nodes (t3.large)</td>
<td>2 vCPU, 8GB</td>
<td>1</td>
<td>$60</td>
</tr>
<tr>
<td>EBS (gp3)</td>
<td>50GB Ã— 3</td>
<td>150GB</td>
<td>$12</td>
</tr>
</tbody>
</table>
<p><strong>é–‹ç™ºEKSåˆè¨ˆ: $265/æœˆ</strong></p>
<hr />
<h2 id="3">3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-amazon-aurora-postgresql">3.1 Amazon Aurora PostgreSQL<a class="headerlink" href="#31-amazon-aurora-postgresql" title="Permanent link">&para;</a></h3>
<h4 id="_2">æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ§‹æˆ</th>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹</th>
<th>vCPU</th>
<th>ãƒ¡ãƒ¢ãƒª</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Writer</td>
<td>db.r5.large</td>
<td>2</td>
<td>16 GB</td>
<td>$212</td>
</tr>
<tr>
<td>Reader 1</td>
<td>db.r5.large</td>
<td>2</td>
<td>16 GB</td>
<td>$212</td>
</tr>
<tr>
<td>Reader 2</td>
<td>db.r5.large</td>
<td>2</td>
<td>16 GB</td>
<td>$212</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒ»I/O</th>
<th>å®¹é‡/æ•°é‡</th>
<th>å˜ä¾¡</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Aurora Storage</td>
<td>200GB</td>
<td>$0.12/GB</td>
<td>$24</td>
</tr>
<tr>
<td>I/O ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
<td>100M/æœˆ</td>
<td>$0.24/100ä¸‡</td>
<td>$24</td>
</tr>
<tr>
<td>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—</td>
<td>200GB</td>
<td>$0.023/GB</td>
<td>$5</td>
</tr>
</tbody>
</table>
<p><strong>æœ¬ç•ªAuroraåˆè¨ˆ: $689/æœˆ</strong></p>
<h4 id="_3">ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ§‹æˆ</th>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Writer</td>
<td>db.t3.medium</td>
<td>$68</td>
</tr>
<tr>
<td>Reader</td>
<td>db.t3.medium</td>
<td>$68</td>
</tr>
<tr>
<td>Storage (100GB) + I/O</td>
<td>-</td>
<td>$20</td>
</tr>
</tbody>
</table>
<p><strong>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°Auroraåˆè¨ˆ: $156/æœˆ</strong></p>
<h4 id="_4">é–‹ç™ºç’°å¢ƒ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ§‹æˆ</th>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Serverless v2</td>
<td>0.5-2 ACU</td>
<td>$45</td>
</tr>
<tr>
<td>Storage (50GB) + I/O</td>
<td>-</td>
<td>$10</td>
</tr>
</tbody>
</table>
<p><strong>é–‹ç™ºAuroraåˆè¨ˆ: $55/æœˆ</strong></p>
<blockquote>
<p><strong>Aurora PostgreSQLã®åˆ©ç‚¹:</strong>
- è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ (30ç§’ä»¥å†…)
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è‡ªå‹•æ‹¡å¼µ (æœ€å¤§128TB)
- 3AZã«ã¾ãŸãŒã‚‹6ã‚³ãƒ”ãƒ¼ã®ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- PostgreSQLäº’æ› (æ—¢å­˜ã‚³ãƒ¼ãƒ‰å¤‰æ›´æœ€å°)</p>
</blockquote>
<hr />
<h3 id="32-amazon-dynamodb">3.2 Amazon DynamoDB<a class="headerlink" href="#32-amazon-dynamodb" title="Permanent link">&para;</a></h3>
<h4 id="_5">æœ¬ç•ªç’°å¢ƒï¼ˆã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ï¼‰<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æƒ³å®šåˆ©ç”¨é‡</th>
<th>å˜ä¾¡</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ›¸ãè¾¼ã¿</td>
<td>10M WRU/æœˆ</td>
<td>$1.4269/100ä¸‡</td>
<td>$14</td>
</tr>
<tr>
<td>èª­ã¿å–ã‚Š</td>
<td>30M RRU/æœˆ</td>
<td>$0.285/100ä¸‡</td>
<td>$9</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
<td>60GB</td>
<td>$0.285/GB</td>
<td>$17</td>
</tr>
<tr>
<td>PITR (ãƒã‚¤ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ã‚¤ãƒ ãƒªã‚«ãƒãƒª)</td>
<td>60GB</td>
<td>$0.228/GB</td>
<td>$14</td>
</tr>
</tbody>
</table>
<p><strong>æœ¬ç•ªDynamoDBåˆè¨ˆ: $54/æœˆ</strong></p>
<h4 id="_6">ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°/é–‹ç™º<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</td>
<td>$20</td>
</tr>
<tr>
<td>é–‹ç™º</td>
<td>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</td>
<td>$10</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>DynamoDBã®åˆ©ç‚¹:</strong>
- ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ (é‹ç”¨è² è·ã‚¼ãƒ­)
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- 99.999% å¯ç”¨æ€§ (ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ†ãƒ¼ãƒ–ãƒ«)
- ãƒŸãƒªç§’å˜ä½ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·
- Cassandraæ¯” <strong>ç´„85%ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›</strong></p>
</blockquote>
<hr />
<h3 id="33-amazon-elasticache-redis">3.3 Amazon ElastiCache (Redis)<a class="headerlink" href="#33-amazon-elasticache-redis" title="Permanent link">&para;</a></h3>
<h4 id="_7">æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ§‹æˆ</th>
<th>ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—</th>
<th>ãƒãƒ¼ãƒ‰æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Primary</td>
<td>cache.r5.large</td>
<td>1</td>
<td>$100</td>
</tr>
<tr>
<td>Replica</td>
<td>cache.r5.large</td>
<td>1</td>
<td>$100</td>
</tr>
</tbody>
</table>
<p><strong>æœ¬ç•ªRedisåˆè¨ˆ: $200/æœˆ</strong></p>
<h4 id="_8">ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°/é–‹ç™º<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>cache.t3.medium</td>
<td>$40</td>
</tr>
<tr>
<td>é–‹ç™º</td>
<td>cache.t3.small</td>
<td>$20</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-amazon-mq-msk">4. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚° (Amazon MQ / MSK)<a class="headerlink" href="#4-amazon-mq-msk" title="Permanent link">&para;</a></h2>
<h3 id="41-amazon-mq-rabbitmq">4.1 Amazon MQ (RabbitMQ)<a class="headerlink" href="#41-amazon-mq-rabbitmq" title="Permanent link">&para;</a></h3>
<h4 id="_9">æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>æ§‹æˆ</th>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Active-Standby</td>
<td>mq.m5.large Ã— 2</td>
<td>$240</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
<td>100GB</td>
<td>$10</td>
</tr>
</tbody>
</table>
<p><strong>æœ¬ç•ªMQåˆè¨ˆ: $250/æœˆ</strong></p>
<h4 id="_10">ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°/é–‹ç™º<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>mq.t3.micro Ã— 1</td>
<td>$18</td>
</tr>
<tr>
<td>é–‹ç™º</td>
<td>mq.t3.micro Ã— 1</td>
<td>$18</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚¿ã‚¤ãƒ—</th>
<th>ç”¨é€”</th>
<th>å°æ•°</th>
<th>æœˆé¡å›ºå®š (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALB</td>
<td>External API</td>
<td>1</td>
<td>$22.50</td>
</tr>
<tr>
<td>ALB</td>
<td>Internal Services</td>
<td>1</td>
<td>$22.50</td>
</tr>
<tr>
<td>NLB</td>
<td>ScalarDB Cluster</td>
<td>1</td>
<td>$22.50</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼åˆè¨ˆ: $67.50/æœˆ</strong></p>
<h3 id="52-nat-gateway">5.2 NAT Gateway<a class="headerlink" href="#52-nat-gateway" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>å°æ•°</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>NAT Gateway</td>
<td>2 (Multi-AZ)</td>
<td>$65</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿å‡¦ç† (100GBæƒ³å®š)</td>
<td>-</td>
<td>$4.50</td>
</tr>
</tbody>
</table>
<p><strong>NATåˆè¨ˆ: $69.50/æœˆ</strong></p>
<h3 id="53">5.3 ãƒ‡ãƒ¼ã‚¿è»¢é€<a class="headerlink" href="#53" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è»¢é€ã‚¿ã‚¤ãƒ—</th>
<th>å®¹é‡/æœˆ</th>
<th>å˜ä¾¡ (USD/GB)</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆOUT</td>
<td>100GB</td>
<td>$0.09</td>
<td>$9</td>
</tr>
<tr>
<td>AZé–“è»¢é€</td>
<td>500GB</td>
<td>$0.01</td>
<td>$5</td>
</tr>
</tbody>
</table>
<p><strong>ãƒ‡ãƒ¼ã‚¿è»¢é€åˆè¨ˆ: $14/æœˆ</strong></p>
<h3 id="54-route-53">5.4 Route 53<a class="headerlink" href="#54-route-53" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ›ã‚¹ãƒˆã‚¾ãƒ¼ãƒ³</td>
<td>$0.50</td>
</tr>
<tr>
<td>ã‚¯ã‚¨ãƒª (100ä¸‡)</td>
<td>$0.40</td>
</tr>
</tbody>
</table>
<p><strong>Route 53åˆè¨ˆ: $0.90/æœˆ</strong></p>
<hr />
<h2 id="6">6. ç›£è¦–ãƒ»ãƒ­ã‚°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-amazon-cloudwatch">6.1 Amazon CloudWatch<a class="headerlink" href="#61-amazon-cloudwatch" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æ•°é‡</th>
<th>å˜ä¾¡</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹</td>
<td>100</td>
<td>$0.30/ãƒ¡ãƒˆãƒªã‚¯ã‚¹</td>
<td>$30</td>
</tr>
<tr>
<td>ãƒ­ã‚°å–ã‚Šè¾¼ã¿</td>
<td>50GB</td>
<td>$0.50/GB</td>
<td>$25</td>
</tr>
<tr>
<td>ãƒ­ã‚°ä¿å­˜</td>
<td>100GB</td>
<td>$0.03/GB</td>
<td>$3</td>
</tr>
<tr>
<td>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</td>
<td>5</td>
<td>$3/ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</td>
<td>$15</td>
</tr>
<tr>
<td>ã‚¢ãƒ©ãƒ¼ãƒ </td>
<td>50</td>
<td>$0.10/ã‚¢ãƒ©ãƒ¼ãƒ </td>
<td>$5</td>
</tr>
</tbody>
</table>
<p><strong>CloudWatchåˆè¨ˆ: $78/æœˆ</strong></p>
<h3 id="62-prometheusgrafana-self-hosted">6.2 Prometheus/Grafana (Self-hosted)<a class="headerlink" href="#62-prometheusgrafana-self-hosted" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ã‚¹ãƒšãƒƒã‚¯</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prometheus (EC2 t3.large)</td>
<td>2 vCPU, 8GB</td>
<td>$60</td>
</tr>
<tr>
<td>Grafana (EC2 t3.small)</td>
<td>2 vCPU, 2GB</td>
<td>$15</td>
</tr>
<tr>
<td>EBS Storage</td>
<td>200GB gp3</td>
<td>$16</td>
</tr>
</tbody>
</table>
<p><strong>Prometheus/Grafanaåˆè¨ˆ: $91/æœˆ</strong></p>
<hr />
<h2 id="7">7. ç’°å¢ƒåˆ¥ã‚³ã‚¹ãƒˆä¸€è¦§<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS (Control + Workers + ScalarDB)</td>
<td>$1,406</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>$689</td>
</tr>
<tr>
<td>DynamoDB</td>
<td>$54</td>
</tr>
<tr>
<td>Redis</td>
<td>$200</td>
</tr>
<tr>
<td>MQ (RabbitMQ)</td>
<td>$250</td>
</tr>
<tr>
<td>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
<td>$152</td>
</tr>
<tr>
<td>ç›£è¦–ãƒ»ãƒ­ã‚°</td>
<td>$169</td>
</tr>
<tr>
<td><strong>æœ¬ç•ªåˆè¨ˆ</strong></td>
<td><strong>$2,920</strong></td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒ<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS</td>
<td>$443</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>$156</td>
</tr>
<tr>
<td>DynamoDB</td>
<td>$20</td>
</tr>
<tr>
<td>Redis</td>
<td>$40</td>
</tr>
<tr>
<td>MQ (RabbitMQ)</td>
<td>$18</td>
</tr>
<tr>
<td>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
<td>$76</td>
</tr>
<tr>
<td>ç›£è¦–ãƒ»ãƒ­ã‚°</td>
<td>$85</td>
</tr>
<tr>
<td><strong>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°åˆè¨ˆ</strong></td>
<td><strong>$838</strong></td>
</tr>
</tbody>
</table>
<h3 id="73">7.3 é–‹ç™ºç’°å¢ƒ<a class="headerlink" href="#73" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>æœˆé¡ (USD)</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS</td>
<td>$265</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>$55</td>
</tr>
<tr>
<td>DynamoDB</td>
<td>$10</td>
</tr>
<tr>
<td>Redis</td>
<td>$20</td>
</tr>
<tr>
<td>MQ (RabbitMQ)</td>
<td>$18</td>
</tr>
<tr>
<td>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
<td>$38</td>
</tr>
<tr>
<td>ç›£è¦–ãƒ»ãƒ­ã‚°</td>
<td>$42</td>
</tr>
<tr>
<td><strong>é–‹ç™ºåˆè¨ˆ</strong></td>
<td><strong>$448</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. ç·åˆè¨ˆ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>æœˆé¡ (USD)</th>
<th>å¹´é¡ (USD)</th>
<th>å¹´é¡ (JPY)</th>
</tr>
</thead>
<tbody>
<tr>
<td>æœ¬ç•ª</td>
<td>$2,920</td>
<td>$35,040</td>
<td>Â¥5,256,000</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>$838</td>
<td>$10,056</td>
<td>Â¥1,508,400</td>
</tr>
<tr>
<td>é–‹ç™º</td>
<td>$448</td>
<td>$5,376</td>
<td>Â¥806,400</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>$4,206</strong></td>
<td><strong>$50,472</strong></td>
<td><strong>Â¥7,570,800</strong></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>æ—§æ§‹æˆ (RDS + Cassandra) ã¨ã®æ¯”è¼ƒ:</strong>
- æ—§æœˆé¡: $4,560 â†’ æ–°æœˆé¡: $4,206 (<strong>$354/æœˆ å‰Šæ¸›</strong>)
- å¹´é–“å‰Šæ¸›é¡: <strong>$4,248 (Â¥637,200)</strong>
- å‰Šæ¸›ç‡: <strong>ç´„7.8%</strong></p>
</blockquote>
<hr />
<h2 id="9">9. ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚ªãƒ—ã‚·ãƒ§ãƒ³<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91-1">9.1 ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ (1å¹´)<a class="headerlink" href="#91-1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</th>
<th>ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰</th>
<th>å‰Šæ¸›é¡/å¹´</th>
</tr>
</thead>
<tbody>
<tr>
<td>EC2 (m5.xlarge Ã— 9)</td>
<td>$12,528</td>
<td>$8,770</td>
<td>$3,758</td>
</tr>
<tr>
<td>Aurora (db.r5.large Ã— 3)</td>
<td>$7,632</td>
<td>$5,342</td>
<td>$2,290</td>
</tr>
<tr>
<td>ElastiCache</td>
<td>$2,400</td>
<td>$1,680</td>
<td>$720</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>$22,560</strong></td>
<td><strong>$15,792</strong></td>
<td><strong>$6,768</strong></td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> DynamoDBã¯ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰ã®ãŸã‚ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰å¯¾è±¡å¤–ã€‚Provisioned Capacityã«å¤‰æ›´ã™ã‚Œã°è¿½åŠ å‰Šæ¸›å¯èƒ½ã€‚</p>
</blockquote>
<h3 id="92-savings-plans-compute">9.2 Savings Plans (Compute)<a class="headerlink" href="#92-savings-plans-compute" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚³ãƒŸãƒƒãƒˆé¡</th>
<th>å‰Šæ¸›ç‡</th>
<th>å¹´é–“å‰Šæ¸›é¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>$1,000/æœˆ</td>
<td>20%</td>
<td>$2,400</td>
</tr>
<tr>
<td>$2,000/æœˆ</td>
<td>25%</td>
<td>$6,000</td>
</tr>
<tr>
<td>$3,000/æœˆ</td>
<td>30%</td>
<td>$10,800</td>
</tr>
</tbody>
</table>
<h3 id="93">9.3 é–‹ç™ºç’°å¢ƒã‚¹ãƒãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚½ãƒ¼ã‚¹</th>
<th>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</th>
<th>ã‚¹ãƒãƒƒãƒˆ</th>
<th>å‰Šæ¸›é¡/å¹´</th>
</tr>
</thead>
<tbody>
<tr>
<td>Worker Nodes</td>
<td>$2,160</td>
<td>$648</td>
<td>$1,512</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Generated: 2025-01-13</em>
<em>Pricing Source: AWS Tokyo Region (ap-northeast-1)</em>
<em>Database: Aurora PostgreSQL, DynamoDB (ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹æ§‹æˆ)</em></p>
</article>
<article id="estimate-license-requirements">
<h1 id="_1">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è¦ä»¶<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. æ¦‚è¦<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<p>æœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ç§»è¡Œã«å¿…è¦ãªãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸€è¦§ã¨ã€ãƒ™ãƒ³ãƒ€ãƒ¼ã¸ã®å•ã„åˆã‚ã›ã«å¿…è¦ãªæƒ…å ±ã‚’ã¾ã¨ã‚ã¦ã„ã¾ã™ã€‚</p>
<hr />
<h2 id="2">2. å¿…é ˆãƒ©ã‚¤ã‚»ãƒ³ã‚¹<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21-scalardb-cluster-enterprise">2.1 ScalarDB Cluster Enterprise<a class="headerlink" href="#21-scalardb-cluster-enterprise" title="Permanent link">&para;</a></h3>
<h4 id="_2">è£½å“æ¦‚è¦<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>è£½å“å</strong></td>
<td>ScalarDB Cluster</td>
</tr>
<tr>
<td><strong>ãƒ™ãƒ³ãƒ€ãƒ¼</strong></td>
<td>Scalar, Inc.</td>
</tr>
<tr>
<td><strong>ç”¨é€”</strong></td>
<td>åˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã€Multi-storageçµ±åˆ</td>
</tr>
<tr>
<td><strong>å¿…è¦æ€§</strong></td>
<td><strong>å¿…é ˆ</strong> - ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ä¸­æ ¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
</tbody>
</table>
<h4 id="_3">å•ã„åˆã‚ã›ã«å¿…è¦ãªæƒ…å ±<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>ä»¥ä¸‹ã®æƒ…å ±ã‚’æº–å‚™ã—ã¦å•ã„åˆã‚ã›ã¦ãã ã•ã„ã€‚</p>
<p><strong>ã‚¯ãƒ©ã‚¹ã‚¿ãƒ¼æ§‹æˆï¼ˆæœ¬ç•ªç’°å¢ƒï¼‰:</strong></p>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å€¤</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒ¼ãƒ‰æ•°</td>
<td>3</td>
<td>Active-Active 3ãƒãƒ¼ãƒ‰æ§‹æˆ</td>
</tr>
<tr>
<td>CPU/ãƒãƒ¼ãƒ‰</td>
<td>4 vCPU</td>
<td>m5.xlargeç›¸å½“</td>
</tr>
<tr>
<td>ãƒ¡ãƒ¢ãƒª/ãƒãƒ¼ãƒ‰</td>
<td>16 GB</td>
<td>m5.xlargeç›¸å½“</td>
</tr>
<tr>
<td><strong>CPUåˆè¨ˆ</strong></td>
<td><strong>12 vCPU</strong></td>
<td>3ãƒãƒ¼ãƒ‰ Ã— 4 vCPU</td>
</tr>
<tr>
<td><strong>ãƒ¡ãƒ¢ãƒªåˆè¨ˆ</strong></td>
<td><strong>48 GB</strong></td>
<td>3ãƒãƒ¼ãƒ‰ Ã— 16 GB</td>
</tr>
</tbody>
</table>
<p><strong>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰:</strong></p>
<table>
<thead>
<tr>
<th>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</th>
<th>ç”¨é€”</th>
<th>Namespace</th>
</tr>
</thead>
<tbody>
<tr>
<td>PostgreSQL</td>
<td>Identity, Audit, File, Coordinator</td>
<td>4</td>
</tr>
<tr>
<td>Cassandra</td>
<td>Event</td>
<td>1</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td><strong>5 Namespace</strong></td>
</tr>
</tbody>
</table>
<p><strong>æ€§èƒ½è¦ä»¶:</strong></p>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ç›®æ¨™å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>æƒ³å®šTPS</td>
<td>1,000+ (ãƒ”ãƒ¼ã‚¯æ™‚)</td>
</tr>
<tr>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P99</td>
<td>&lt; 200ms</td>
</tr>
<tr>
<td>å¯ç”¨æ€§</td>
<td>99.9%</td>
</tr>
</tbody>
</table>
<p><strong>æ¥ç¶šæ–¹å¼:</strong></p>
<table>
<thead>
<tr>
<th>ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</th>
<th>ä½¿ç”¨æœ‰ç„¡</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>gRPC</td>
<td>â—‹</td>
<td>ãƒ¡ã‚¤ãƒ³ï¼ˆåˆ†æ•£ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ï¼‰</td>
</tr>
<tr>
<td>SQL</td>
<td>â–³</td>
<td>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆAnalyticsé€£æºæ™‚ï¼‰</td>
</tr>
<tr>
<td>GraphQL</td>
<td>â–³</td>
<td>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼ˆå°†æ¥çš„ãªAPIæ‹¡å¼µï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>ç’°å¢ƒæ§‹æˆ:</strong></p>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ãƒãƒ¼ãƒ‰æ•°</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>æœ¬ç•ª</td>
<td>3</td>
<td>æœ¬ç•ªãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>2</td>
<td>æ¤œè¨¼ãƒ»è² è·ãƒ†ã‚¹ãƒˆ</td>
</tr>
<tr>
<td>é–‹ç™º</td>
<td>1</td>
<td>é–‹ç™ºãƒ»å˜ä½“ãƒ†ã‚¹ãƒˆ</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>6</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>ã‚µãƒãƒ¼ãƒˆè¦ä»¶:</strong></p>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>è¦ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚µãƒãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«</td>
<td>Premiumæ¨å¥¨ (24/7)</td>
</tr>
<tr>
<td>SLA</td>
<td>99.9%ä»¥ä¸Š</td>
</tr>
<tr>
<td>è¨€èª</td>
<td>æ—¥æœ¬èª</td>
</tr>
</tbody>
</table>
<h4 id="_4">å•ã„åˆã‚ã›å…ˆ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æƒ…å ±</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ</strong></td>
<td>https://www.scalar-labs.com/contact</td>
</tr>
<tr>
<td><strong>ãƒ¡ãƒ¼ãƒ«</strong></td>
<td>contact@scalar-labs.com</td>
</tr>
<tr>
<td><strong>é›»è©±</strong></td>
<td>å…¬å¼ã‚µã‚¤ãƒˆå‚ç…§</td>
</tr>
</tbody>
</table>
<h4 id="_5">è¦‹ç©ã‚‚ã‚Šå–å¾—æ™‚ã®è³ªå•äº‹é …<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<ol>
<li>ãƒãƒ¼ãƒ‰æ•°ãƒ™ãƒ¼ã‚¹ã®ä¾¡æ ¼ä½“ç³»ã‹ã€vCPUãƒ™ãƒ¼ã‚¹ã‹</li>
<li>é–‹ç™º/ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®å‰²å¼•æœ‰ç„¡</li>
<li>å¹´é–“å¥‘ç´„ã¨æœˆé¡å¥‘ç´„ã®ä¾¡æ ¼å·®</li>
<li>ã‚µãƒãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«åˆ¥ã®ä¾¡æ ¼</li>
<li>ScalarDB Analyticsã¨ã®ãƒãƒ³ãƒ‰ãƒ«å‰²å¼•</li>
</ol>
<hr />
<h3 id="22-box-platform">2.2 BOX Platform<a class="headerlink" href="#22-box-platform" title="Permanent link">&para;</a></h3>
<h4 id="_6">è£½å“æ¦‚è¦<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>è£½å“å</strong></td>
<td>BOX Platform</td>
</tr>
<tr>
<td><strong>ãƒ™ãƒ³ãƒ€ãƒ¼</strong></td>
<td>Box, Inc.</td>
</tr>
<tr>
<td><strong>ç”¨é€”</strong></td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸APIã€OAuthèªè¨¼ã€ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—</td>
</tr>
<tr>
<td><strong>å¿…è¦æ€§</strong></td>
<td><strong>å¿…é ˆ</strong> - æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®Boxé€£æºã‚’ç¶™ç¶š</td>
</tr>
</tbody>
</table>
<h4 id="_7">å•ã„åˆã‚ã›ã«å¿…è¦ãªæƒ…å ±<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p><strong>APIåˆ©ç”¨é‡ï¼ˆæœˆé–“æƒ³å®šï¼‰:</strong></p>
<table>
<thead>
<tr>
<th>API</th>
<th>æƒ³å®šå‘¼ã³å‡ºã—æ•°/æœˆ</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€æƒ…å ±å–å¾—</td>
<td>100,000</td>
<td>ç›£æŸ»å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆå–å¾—</td>
<td>50,000</td>
<td>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¤ãƒ™ãƒ³ãƒˆåŒæœŸ</td>
</tr>
<tr>
<td>OAuthèªè¨¼</td>
<td>10,000</td>
<td>ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ•ãƒ­ãƒ¼</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>160,000</strong></td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ¨¡:</strong></p>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</td>
<td>è¦ç¢ºèªï¼ˆæ—¢å­˜å¥‘ç´„ï¼‰</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»è€…æ•°</td>
<td>è¦ç¢ºèª</td>
</tr>
<tr>
<td>APIæ¥ç¶šã‚¢ãƒ—ãƒªæ•°</td>
<td>1 (Scalar Auditor)</td>
</tr>
</tbody>
</table>
<h4 id="_8">å•ã„åˆã‚ã›å…ˆ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æƒ…å ±</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ</strong></td>
<td>https://www.box.com/ja-jp/platform</td>
</tr>
<tr>
<td><strong>å–¶æ¥­çª“å£</strong></td>
<td>æ—¢å­˜å¥‘ç´„æ‹…å½“è€…</td>
</tr>
</tbody>
</table>
<h4 id="_9">ç¢ºèªäº‹é …<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<ol>
<li>æ—¢å­˜Boxå¥‘ç´„ã§Platform APIãŒåˆ©ç”¨å¯èƒ½ã‹</li>
<li>APIå‘¼ã³å‡ºã—æ•°ã®åˆ¶é™ã¨è¿½åŠ æ–™é‡‘</li>
<li>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¤ãƒ™ãƒ³ãƒˆAPIåˆ©ç”¨ã®è¿½åŠ è¦ä»¶</li>
</ol>
<hr />
<h2 id="3">3. ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ©ã‚¤ã‚»ãƒ³ã‚¹<a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-scalardb-analytics">3.1 ScalarDB Analytics (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)<a class="headerlink" href="#31-scalardb-analytics" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>è£½å“å</strong></td>
<td>ScalarDB Analytics</td>
</tr>
<tr>
<td><strong>ç”¨é€”</strong></td>
<td>Multi-storageã«å¯¾ã™ã‚‹Spark SQLåˆ†æ</td>
</tr>
<tr>
<td><strong>å¿…è¦æ€§</strong></td>
<td>ã‚ªãƒ—ã‚·ãƒ§ãƒ³ - åˆ†æè¦ä»¶ãŒã‚ã‚‹å ´åˆ</td>
</tr>
<tr>
<td><strong>å•ã„åˆã‚ã›å…ˆ</strong></td>
<td>Scalar, Inc. (ScalarDB Clusterã¨åŒæ™‚è¦‹ç©ã‚‚ã‚Šæ¨å¥¨)</td>
</tr>
</tbody>
</table>
<h3 id="32-datadog-new-relic">3.2 Datadog / New Relic (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)<a class="headerlink" href="#32-datadog-new-relic" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç”¨é€”</strong></td>
<td>APMã€åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ã€é«˜åº¦ãªç›£è¦–</td>
</tr>
<tr>
<td><strong>ä»£æ›¿</strong></td>
<td>Prometheus/Grafana + CloudWatch (OSS + ãƒãƒãƒ¼ã‚¸ãƒ‰)</td>
</tr>
<tr>
<td><strong>å‚è€ƒä¾¡æ ¼</strong></td>
<td>Datadog Pro: $15/ãƒ›ã‚¹ãƒˆ/æœˆã€œ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="4-oss">4. OSSï¼ˆã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ï¼‰<a class="headerlink" href="#4-oss" title="Permanent link">&para;</a></h2>
<p>ä»¥ä¸‹ã¯ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è²»ç”¨ä¸è¦ã®OSSã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚</p>
<table>
<thead>
<tr>
<th>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</th>
<th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
<th>ç”¨é€”</th>
<th>å•†ç”¨ã‚µãƒãƒ¼ãƒˆ (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Kubernetes</td>
<td>Apache 2.0</td>
<td>ã‚³ãƒ³ãƒ†ãƒŠã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</td>
<td>AWS EKS (ãƒãƒãƒ¼ã‚¸ãƒ‰)</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>PostgreSQL License</td>
<td>ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</td>
<td>AWS Aurora (ãƒãƒãƒ¼ã‚¸ãƒ‰)</td>
</tr>
<tr>
<td>Redis</td>
<td>BSD</td>
<td>ã‚­ãƒ£ãƒƒã‚·ãƒ¥</td>
<td>AWS ElastiCache (ãƒãƒãƒ¼ã‚¸ãƒ‰)</td>
</tr>
<tr>
<td>RabbitMQ</td>
<td>MPL 2.0</td>
<td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>AWS MQ (ãƒãƒãƒ¼ã‚¸ãƒ‰)</td>
</tr>
<tr>
<td>Kong</td>
<td>Apache 2.0</td>
<td>API Gateway</td>
<td>Kong Enterprise (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</td>
</tr>
<tr>
<td>Prometheus</td>
<td>Apache 2.0</td>
<td>ãƒ¡ãƒˆãƒªã‚¯ã‚¹åé›†</td>
<td>Grafana Cloud (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</td>
</tr>
<tr>
<td>Grafana</td>
<td>AGPL 3.0</td>
<td>å¯è¦–åŒ–</td>
<td>Grafana Cloud (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</td>
</tr>
<tr>
<td>Jaeger</td>
<td>Apache 2.0</td>
<td>åˆ†æ•£ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°</td>
<td>-</td>
</tr>
<tr>
<td>ELK Stack</td>
<td>Elastic License</td>
<td>ãƒ­ã‚°ç®¡ç†</td>
<td>Elastic Cloud (ã‚ªãƒ—ã‚·ãƒ§ãƒ³)</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note:</strong> ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯Amazon DynamoDBï¼ˆãƒãƒãƒ¼ã‚¸ãƒ‰ï¼‰ã‚’ä½¿ç”¨ã€‚OSSãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä¸è¦ã€‚</p>
</blockquote>
<hr />
<h2 id="5">5. å•†ç”¨ã‚µãƒãƒ¼ãƒˆå¥‘ç´„ï¼ˆæ¤œè¨äº‹é …ï¼‰<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<p>æœ¬ç•ªé‹ç”¨ã«ãŠã„ã¦ã€ä»¥ä¸‹ã®å•†ç”¨ã‚µãƒãƒ¼ãƒˆå¥‘ç´„ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚</p>
<h3 id="51">5.1 æ¨å¥¨<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è£½å“</th>
<th>ã‚µãƒãƒ¼ãƒˆãƒ™ãƒ³ãƒ€ãƒ¼</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ScalarDB Cluster</strong></td>
<td>Scalar, Inc.</td>
<td>å¿…é ˆ - ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</td>
</tr>
<tr>
<td><strong>AWS</strong></td>
<td>AWS Business/Enterprise Support</td>
<td>æ¨å¥¨ - æœ¬ç•ªç’°å¢ƒã®å®‰å®šé‹ç”¨</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 ã‚ªãƒ—ã‚·ãƒ§ãƒ³<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>è£½å“</th>
<th>ã‚µãƒãƒ¼ãƒˆãƒ™ãƒ³ãƒ€ãƒ¼</th>
<th>æ¤œè¨ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>Aurora PostgreSQL</td>
<td>AWS Premium Support</td>
<td>é«˜åº¦ãªãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã€24/7ã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>DynamoDB</td>
<td>AWS Premium Support</td>
<td>å¤§è¦æ¨¡é‹ç”¨æ™‚ã®ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>Kubernetes</td>
<td>Red Hat OpenShift</td>
<td>ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>Kong</td>
<td>Kong Inc.</td>
<td>API Gatewayé«˜åº¦æ©Ÿèƒ½</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ©ç‚¹:</strong> Aurora PostgreSQLã¨DynamoDBã¯AWSãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®ãŸã‚ã€DataStaxç­‰ã®ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ã‚µãƒãƒ¼ãƒˆå¥‘ç´„ã¯ä¸è¦ã§ã™ã€‚AWS Business/Enterprise Supportã§ååˆ†ãªã‚µãƒãƒ¼ãƒˆãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>
</blockquote>
<hr />
<h2 id="6">6. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹è²»ç”¨ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ã‚«ãƒ†ã‚´ãƒª</th>
<th>è£½å“</th>
<th>å¹´é¡</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å¿…é ˆ</strong></td>
<td>ScalarDB Cluster</td>
<td><strong>è¦å•ã„åˆã‚ã›</strong></td>
<td>æœ€å„ªå…ˆã§è¦‹ç©ã‚‚ã‚Šå–å¾—</td>
</tr>
<tr>
<td><strong>å¿…é ˆ</strong></td>
<td>BOX Platform</td>
<td><strong>è¦ç¢ºèª</strong></td>
<td>æ—¢å­˜å¥‘ç´„ã®ç¯„å›²ç¢ºèª</td>
</tr>
<tr>
<td>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</td>
<td>ScalarDB Analytics</td>
<td>è¦å•ã„åˆã‚ã›</td>
<td>åˆ†æè¦ä»¶æ¬¡ç¬¬</td>
</tr>
<tr>
<td>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</td>
<td>AWS Business Support</td>
<td>$100/æœˆã€œ</td>
<td>æœ¬ç•ªç’°å¢ƒæ¨å¥¨</td>
</tr>
<tr>
<td><strong>OSS</strong></td>
<td>ãã®ä»–</td>
<td>$0</td>
<td>ãƒãƒãƒ¼ã‚¸ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹è²»ç”¨ã¯åˆ¥é€”</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7">7. è¦‹ç©ã‚‚ã‚Šå–å¾—ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>å„ªå…ˆåº¦</th>
<th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
<th>æ‹…å½“</th>
<th>æœŸé™</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é«˜</strong></td>
<td>ScalarDB Clusterè¦‹ç©ã‚‚ã‚Šä¾é ¼</td>
<td>PM</td>
<td>1é€±é–“ä»¥å†…</td>
</tr>
<tr>
<td><strong>é«˜</strong></td>
<td>BOX Platformå¥‘ç´„ç¢ºèª</td>
<td>æƒ…ã‚·ã‚¹</td>
<td>1é€±é–“ä»¥å†…</td>
</tr>
<tr>
<td>ä¸­</td>
<td>AWS Support Planæ¤œè¨</td>
<td>ã‚¤ãƒ³ãƒ•ãƒ©</td>
<td>2é€±é–“ä»¥å†…</td>
</tr>
<tr>
<td>ä½</td>
<td>å•†ç”¨ã‚µãƒãƒ¼ãƒˆå¥‘ç´„æ¤œè¨</td>
<td>ã‚¤ãƒ³ãƒ•ãƒ©</td>
<td>æœ¬ç•ªç¨¼åƒå‰</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. å•ã„åˆã‚ã›ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="scalardb">ScalarDBè¦‹ç©ã‚‚ã‚Šä¾é ¼ãƒ¡ãƒ¼ãƒ«ä¾‹<a class="headerlink" href="#scalardb" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>ä»¶å: ScalarDB Cluster Enterprise è¦‹ç©ã‚‚ã‚Šä¾é ¼

Scalar Labs å¾¡ä¸­

ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚
[ä¼šç¤¾å] ã® [æ‹…å½“è€…å] ã¨ç”³ã—ã¾ã™ã€‚

ãƒã‚¤ã‚¯ãƒ­ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ç§»è¡Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ãŠã„ã¦ã€
ScalarDB Cluster Enterpriseã®å°å…¥ã‚’æ¤œè¨ã—ã¦ãŠã‚Šã¾ã™ã€‚

ä»¥ä¸‹ã®æ§‹æˆã§è¦‹ç©ã‚‚ã‚Šã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

ã€æœ¬ç•ªç’°å¢ƒã€‘
- ãƒãƒ¼ãƒ‰æ•°: 3
- CPU/ãƒãƒ¼ãƒ‰: 4 vCPU
- ãƒ¡ãƒ¢ãƒª/ãƒãƒ¼ãƒ‰: 16 GB
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰: PostgreSQL, Cassandra
- æƒ³å®šTPS: 1,000+

ã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã€‘
- ãƒãƒ¼ãƒ‰æ•°: 2
- CPU/ãƒãƒ¼ãƒ‰: 2 vCPU

ã€é–‹ç™ºç’°å¢ƒã€‘
- ãƒãƒ¼ãƒ‰æ•°: 1
- CPU/ãƒãƒ¼ãƒ‰: 2 vCPU

ã€ã‚µãƒãƒ¼ãƒˆè¦ä»¶ã€‘
- 24/7ã‚µãƒãƒ¼ãƒˆå¸Œæœ›
- æ—¥æœ¬èªå¯¾å¿œå¸Œæœ›

ã”å›ç­”ã„ãŸã ããŸã„äº‹é …ï¼š
1. ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ä½“ç³»ï¼ˆãƒãƒ¼ãƒ‰æ•°/vCPUæ•°ï¼‰
2. å¹´é–“å¥‘ç´„ä¾¡æ ¼
3. ã‚µãƒãƒ¼ãƒˆãƒ¬ãƒ™ãƒ«ã¨ä¾¡æ ¼
4. é–‹ç™º/ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã®å‰²å¼•æœ‰ç„¡
5. ScalarDB Analyticsã¨ã®ãƒãƒ³ãƒ‰ãƒ«ä¾¡æ ¼

ãŠæ‰‹æ•°ã§ã™ãŒã€ã”æ¤œè¨ã®ã»ã©ã‚ˆã‚ã—ããŠé¡˜ã„ã„ãŸã—ã¾ã™ã€‚

[ç½²å]
</code></pre>

<hr />
<p><em>Generated: 2025-01-13</em>
<em>Database: Aurora PostgreSQL + DynamoDB (ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰æ§‹æˆ)</em></p>
</article>
<article id="estimate-cost-assumptions">
<h1 id="_1">è¦‹ç©ã‚‚ã‚Šå‰ææ¡ä»¶<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h2 id="1">1. åŸºæœ¬å‰æ<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="11">1.1 ä¸€èˆ¬æ¡ä»¶<a class="headerlink" href="#11" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>è¦‹ç©ã‚‚ã‚ŠåŸºæº–æ—¥</strong></td>
<td>2025-01-13</td>
<td></td>
</tr>
<tr>
<td><strong>ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ</strong></td>
<td>$1 = Â¥150</td>
<td>è¦‹ç©ã‚‚ã‚Šæ™‚ç‚¹ã®æ¦‚ç®—ãƒ¬ãƒ¼ãƒˆ</td>
</tr>
<tr>
<td><strong>ä¾¡æ ¼ã‚¿ã‚¤ãƒ—</strong></td>
<td>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</td>
<td>ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æœªé©ç”¨</td>
</tr>
<tr>
<td><strong>å¥‘ç´„æœŸé–“</strong></td>
<td>1å¹´</td>
<td></td>
</tr>
<tr>
<td><strong>ç¨é‡‘</strong></td>
<td>å«ã¾ãš</td>
<td>æ¶ˆè²»ç¨åˆ¥é€”</td>
</tr>
<tr>
<td><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹æˆ</strong></td>
<td>Aurora PostgreSQL + DynamoDB</td>
<td>ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰</td>
</tr>
</tbody>
</table>
<h3 id="12">1.2 ã‚¯ãƒ©ã‚¦ãƒ‰ç’°å¢ƒ<a class="headerlink" href="#12" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>å‚™è€ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼</strong></td>
<td>AWS</td>
<td></td>
</tr>
<tr>
<td><strong>ãƒªãƒ¼ã‚¸ãƒ§ãƒ³</strong></td>
<td>ap-northeast-1 (æ±äº¬)</td>
<td></td>
</tr>
<tr>
<td><strong>å¯ç”¨æ€§ã‚¾ãƒ¼ãƒ³</strong></td>
<td>3 AZ</td>
<td>é«˜å¯ç”¨æ€§æ§‹æˆ</td>
</tr>
<tr>
<td><strong>ç’°å¢ƒæ•°</strong></td>
<td>3</td>
<td>æœ¬ç•ªã€ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã€é–‹ç™º</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="2">2. ã‚·ã‚¹ãƒ†ãƒ è¦æ¨¡å‰æ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 ãƒ¦ãƒ¼ã‚¶ãƒ¼è¦æ¨¡<a class="headerlink" href="#21" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>åŒæ™‚æ¥ç¶šãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</td>
<td>500</td>
<td>ãƒ”ãƒ¼ã‚¯æ™‚æƒ³å®š</td>
</tr>
<tr>
<td>ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°</td>
<td>5,000</td>
<td>å¹´é–“æƒ³å®š</td>
</tr>
<tr>
<td>å¤–éƒ¨ç›£æŸ»è€…æ•°</td>
<td>200</td>
<td></td>
</tr>
<tr>
<td>çµ„ç¹”æ•°</td>
<td>10</td>
<td>ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ</td>
</tr>
</tbody>
</table>
<h3 id="22">2.2 ãƒ‡ãƒ¼ã‚¿è¦æ¨¡<a class="headerlink" href="#22" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›£æŸ»ã‚»ãƒƒãƒˆæ•°</td>
<td>10,000</td>
<td>å¹´é–“æƒ³å®š</td>
</tr>
<tr>
<td>ç›£æŸ»ã‚¢ã‚¤ãƒ†ãƒ æ•°</td>
<td>500,000</td>
<td>å¹´é–“æƒ³å®š</td>
</tr>
<tr>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°æ•°</td>
<td>10,000,000</td>
<td>æœˆé–“æƒ³å®š</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿å¢—åŠ ç‡</td>
<td>20%/å¹´</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="23">2.3 ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯è¦æ¨¡<a class="headerlink" href="#23" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>APIå‘¼ã³å‡ºã—æ•°</td>
<td>100,000/æ—¥</td>
<td>å¹³å‡</td>
</tr>
<tr>
<td>ãƒ”ãƒ¼ã‚¯æ™‚APIå‘¼ã³å‡ºã—æ•°</td>
<td>500,000/æ—¥</td>
<td>æœˆæœ«ãƒ»å››åŠæœŸæœ«</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿è»¢é€é‡ (å¤–éƒ¨)</td>
<td>100 GB/æœˆ</td>
<td></td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿è»¢é€é‡ (å†…éƒ¨)</td>
<td>500 GB/æœˆ</td>
<td></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3">3. ã‚¤ãƒ³ãƒ•ãƒ©ã‚µã‚¤ã‚¸ãƒ³ã‚°æ ¹æ‹ <a class="headerlink" href="#3" title="Permanent link">&para;</a></h2>
<h3 id="31-kubernetes-worker-nodes">3.1 Kubernetes Worker Nodes<a class="headerlink" href="#31-kubernetes-worker-nodes" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>ãƒ¬ãƒ—ãƒªã‚«æ•°</th>
<th>CPUè¦æ±‚</th>
<th>ãƒ¡ãƒ¢ãƒªè¦æ±‚</th>
<th>åˆè¨ˆCPU</th>
<th>åˆè¨ˆãƒ¡ãƒ¢ãƒª</th>
</tr>
</thead>
<tbody>
<tr>
<td>Identity Service</td>
<td>3</td>
<td>500m</td>
<td>512Mi</td>
<td>1.5</td>
<td>1.5Gi</td>
</tr>
<tr>
<td>Audit Service</td>
<td>3</td>
<td>1000m</td>
<td>1Gi</td>
<td>3</td>
<td>3Gi</td>
</tr>
<tr>
<td>File Service</td>
<td>3</td>
<td>500m</td>
<td>512Mi</td>
<td>1.5</td>
<td>1.5Gi</td>
</tr>
<tr>
<td>Event Service</td>
<td>3</td>
<td>500m</td>
<td>512Mi</td>
<td>1.5</td>
<td>1.5Gi</td>
</tr>
<tr>
<td>Verification Service</td>
<td>3</td>
<td>500m</td>
<td>512Mi</td>
<td>1.5</td>
<td>1.5Gi</td>
</tr>
<tr>
<td>BOX Integration</td>
<td>3</td>
<td>500m</td>
<td>512Mi</td>
<td>1.5</td>
<td>1.5Gi</td>
</tr>
<tr>
<td>Kong Gateway</td>
<td>2</td>
<td>1000m</td>
<td>1Gi</td>
<td>2</td>
<td>2Gi</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td></td>
<td></td>
<td></td>
<td><strong>12.5 vCPU</strong></td>
<td><strong>12.5 Gi</strong></td>
</tr>
</tbody>
</table>
<p><strong>ã‚µã‚¤ã‚¸ãƒ³ã‚°è¨ˆç®—:</strong>
- å¿…è¦ãƒªã‚½ãƒ¼ã‚¹: 12.5 vCPU, 12.5 GB
- ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ (ã‚·ã‚¹ãƒ†ãƒ  + ãƒãƒƒãƒ•ã‚¡): 50%
- å®ŸåŠ¹å¿…è¦ãƒªã‚½ãƒ¼ã‚¹: 18.75 vCPU, 18.75 GB
- m5.xlarge (4 vCPU, 16 GB) Ã— 6 = 24 vCPU, 96 GB â†’ <strong>ååˆ†ãªä½™è£•</strong></p>
<h3 id="32-scalardb-cluster-nodes">3.2 ScalarDB Cluster Nodes<a class="headerlink" href="#32-scalardb-cluster-nodes" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒ¼ãƒ‰æ•°</td>
<td>3</td>
<td>é«˜å¯ç”¨æ€§ + åˆ†æ•£å‡¦ç†</td>
</tr>
<tr>
<td>CPU/ãƒãƒ¼ãƒ‰</td>
<td>4 vCPU</td>
<td>å…¬å¼æ¨å¥¨ + æƒ³å®šTPS</td>
</tr>
<tr>
<td>ãƒ¡ãƒ¢ãƒª/ãƒãƒ¼ãƒ‰</td>
<td>16 GB</td>
<td>å…¬å¼æ¨å¥¨</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸/ãƒãƒ¼ãƒ‰</td>
<td>100 GB</td>
<td>ãƒ­ã‚° + ä¸€æ™‚ãƒ‡ãƒ¼ã‚¿</td>
</tr>
</tbody>
</table>
<h3 id="33-aurora-postgresql">3.3 Aurora PostgreSQL<a class="headerlink" href="#33-aurora-postgresql" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¯ãƒ©ã‚¹</td>
<td>db.r5.large</td>
<td>ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–</td>
</tr>
<tr>
<td>æ§‹æˆ</td>
<td>1 Writer + 2 Reader</td>
<td>é«˜å¯ç”¨æ€§ + èª­ã¿å–ã‚Šã‚¹ã‚±ãƒ¼ãƒ«</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
<td>200 GB (è‡ªå‹•æ‹¡å¼µ)</td>
<td>åˆæœŸ + 1å¹´åˆ†ã®å¢—åŠ </td>
</tr>
<tr>
<td>I/O ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
<td>100M/æœˆ</td>
<td>æƒ³å®šãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰</td>
</tr>
</tbody>
</table>
<p><strong>Aurora PostgreSQLã®åˆ©ç‚¹:</strong>
- è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ (30ç§’ä»¥å†…)
- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è‡ªå‹•æ‹¡å¼µ (æœ€å¤§128TB)
- 3AZã«ã¾ãŸãŒã‚‹6ã‚³ãƒ”ãƒ¼ã®è‡ªå‹•ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- ç¶™ç¶šçš„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (S3)
- PostgreSQLäº’æ› (æ—¢å­˜ã‚³ãƒ¼ãƒ‰å¤‰æ›´æœ€å°)</p>
<p><strong>ãƒ‡ãƒ¼ã‚¿å®¹é‡è¨ˆç®—:</strong>
- Users: 5,000 Ã— 1KB = 5 MB
- AuditSets: 10,000 Ã— 2KB = 20 MB
- AuditSetItems: 500,000 Ã— 1KB = 500 MB
- ãã®ä»–ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿: 100 MB
- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ»ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰: 3x
- <strong>åˆè¨ˆ: ç´„ 2 GB/å¹´</strong> â†’ 200 GB ã¯ååˆ†ãªä½™è£•</p>
<h3 id="34-dynamodb">3.4 DynamoDB<a class="headerlink" href="#34-dynamodb" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ¢ãƒ¼ãƒ‰</td>
<td>ã‚ªãƒ³ãƒ‡ãƒãƒ³ãƒ‰</td>
<td>å¤‰å‹•ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰å¯¾å¿œ</td>
</tr>
<tr>
<td>æ›¸ãè¾¼ã¿ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
<td>10M WRU/æœˆ</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°æ›¸ãè¾¼ã¿</td>
</tr>
<tr>
<td>èª­ã¿å–ã‚Šãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
<td>30M RRU/æœˆ</td>
<td>èª­ã¿å–ã‚Šæ¯”ç‡ 3:1</td>
</tr>
<tr>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</td>
<td>60 GB (å¹´é–“)</td>
<td>ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ä¿æŒ</td>
</tr>
</tbody>
</table>
<p><strong>DynamoDBã®åˆ©ç‚¹:</strong>
- ãƒ•ãƒ«ãƒãƒãƒ¼ã‚¸ãƒ‰ (é‹ç”¨è² è·ã‚¼ãƒ­)
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- 99.999% å¯ç”¨æ€§
- ãƒŸãƒªç§’å˜ä½ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·
- PITR (ãƒã‚¤ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ã‚¤ãƒ ãƒªã‚«ãƒãƒª) å¯¾å¿œ</p>
<p><strong>ãƒ‡ãƒ¼ã‚¿å®¹é‡è¨ˆç®—:</strong>
- ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°: 10,000,000/æœˆ Ã— 500B = 5 GB/æœˆ
- ä¿æŒæœŸé–“: 12ãƒ¶æœˆ
- <strong>åˆè¨ˆ: 5 GB Ã— 12 = 60 GB/å¹´</strong>
- DynamoDBè‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§å¯¾å¿œ</p>
<h3 id="35-redis-elasticache">3.5 Redis (ElastiCache)<a class="headerlink" href="#35-redis-elasticache" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—</td>
<td>cache.r5.large</td>
<td>ã‚»ãƒƒã‚·ãƒ§ãƒ³ + ã‚­ãƒ£ãƒƒã‚·ãƒ¥</td>
</tr>
<tr>
<td>æ§‹æˆ</td>
<td>1 Primary + 1 Replica</td>
<td>é«˜å¯ç”¨æ€§</td>
</tr>
<tr>
<td>ãƒ¡ãƒ¢ãƒª</td>
<td>13 GB/ãƒãƒ¼ãƒ‰</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥å®¹é‡è¨ˆç®—:</strong>
- ã‚»ãƒƒã‚·ãƒ§ãƒ³: 5,000 Ã— 4KB = 20 MB
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚­ãƒ£ãƒƒã‚·ãƒ¥: 5,000 Ã— 2KB = 10 MB
- APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚­ãƒ£ãƒƒã‚·ãƒ¥: 500 MB
- <strong>åˆè¨ˆ: ç´„ 530 MB</strong> â†’ 13 GB ã¯ååˆ†ãªä½™è£•</p>
<hr />
<h2 id="4">4. æ€§èƒ½å‰æ<a class="headerlink" href="#4" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ€§èƒ½<a class="headerlink" href="#41" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>å‰æå€¤</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>æƒ³å®šTPS (å¹³å‡)</td>
<td>100</td>
<td>æ—¥å¸¸é‹ç”¨</td>
</tr>
<tr>
<td>æƒ³å®šTPS (ãƒ”ãƒ¼ã‚¯)</td>
<td>1,000</td>
<td>æœˆæœ«ãƒ»å››åŠæœŸæœ«</td>
</tr>
<tr>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P50</td>
<td>&lt; 50ms</td>
<td>ç›®æ¨™å€¤</td>
</tr>
<tr>
<td>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· P99</td>
<td>&lt; 200ms</td>
<td>ç›®æ¨™å€¤</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 å¯ç”¨æ€§<a class="headerlink" href="#42" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>å‰æå€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¯ç”¨æ€§ç›®æ¨™</td>
<td>99.9%</td>
</tr>
<tr>
<td>æœˆé–“è¨±å®¹ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ </td>
<td>43åˆ†</td>
</tr>
<tr>
<td>RTO (ç›®æ¨™å¾©æ—§æ™‚é–“)</td>
<td>60ç§’</td>
</tr>
<tr>
<td>RPO (ç›®æ¨™å¾©æ—§åœ°ç‚¹)</td>
<td>0 (åŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³)</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="5">5. é‹ç”¨å‰æ<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ç›£è¦–ãƒ»ãƒ­ã‚°<a class="headerlink" href="#51" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒˆãƒªã‚¯ã‚¹æ•°</td>
<td>100</td>
</tr>
<tr>
<td>ãƒ­ã‚°å–ã‚Šè¾¼ã¿é‡</td>
<td>50 GB/æœˆ</td>
</tr>
<tr>
<td>ãƒ­ã‚°ä¿æŒæœŸé–“</td>
<td>90æ—¥</td>
</tr>
<tr>
<td>ã‚¢ãƒ©ãƒ¼ãƒˆæ•°</td>
<td>50</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—<a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å‰æå€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>RDS ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ä¿æŒ</td>
<td>30æ—¥</td>
</tr>
<tr>
<td>Cassandra ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä¿æŒ</td>
<td>14æ—¥</td>
</tr>
<tr>
<td>Coordinator ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—é »åº¦</td>
<td>1æ™‚é–“æ¯</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="6">6. é™¤å¤–äº‹é …<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<p>ä»¥ä¸‹ã®é …ç›®ã¯æœ¬è¦‹ç©ã‚‚ã‚Šã«<strong>å«ã¾ã‚Œã¦ã„ã¾ã›ã‚“</strong>ã€‚</p>
<h3 id="61">6.1 è²»ç”¨ã¨ã—ã¦é™¤å¤–<a class="headerlink" href="#61" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã®å»ƒæ­¢è²»ç”¨</td>
<td>åˆ¥é€”è¦‹ç©ã‚‚ã‚Š</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ç§»è¡Œè²»ç”¨</td>
<td>å·¥æ•°ãƒ™ãƒ¼ã‚¹ã§åˆ¥é€”ç®—å‡º</td>
</tr>
<tr>
<td>é–‹ç™ºãƒ»æ§‹ç¯‰äººä»¶è²»</td>
<td>SIè²»ç”¨ã¨ã—ã¦åˆ¥é€”</td>
</tr>
<tr>
<td>ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°è²»ç”¨</td>
<td>åˆ¥é€”è¦‹ç©ã‚‚ã‚Š</td>
</tr>
<tr>
<td>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆè²»ç”¨</td>
<td>åˆ¥é€”è¦‹ç©ã‚‚ã‚Š</td>
</tr>
<tr>
<td>äºˆå‚™è²»</td>
<td>é€šå¸¸10-20%ã‚’åˆ¥é€”è¨ˆä¸Šæ¨å¥¨</td>
</tr>
<tr>
<td>æ¶ˆè²»ç¨</td>
<td>åˆ¥é€”åŠ ç®—</td>
</tr>
</tbody>
</table>
<h3 id="62">6.2 æ©Ÿèƒ½ã¨ã—ã¦é™¤å¤–<a class="headerlink" href="#62" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>DR (ç½å®³å¾©æ—§) ç’°å¢ƒ</td>
<td>åˆ¥ãƒªãƒ¼ã‚¸ãƒ§ãƒ³æ§‹æˆã¯åˆ¥é€”</td>
</tr>
<tr>
<td>CDN (CloudFront)</td>
<td>ç¾æ™‚ç‚¹ã§ã¯ä¸è¦ã¨æƒ³å®š</td>
</tr>
<tr>
<td>WAF</td>
<td>è¦ä»¶æ¬¡ç¬¬ã§è¿½åŠ </td>
</tr>
<tr>
<td>Direct Connect</td>
<td>å°‚ç”¨ç·šã¯åˆ¥é€”</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7">7. ãƒªã‚¹ã‚¯è¦å› ã¨å½±éŸ¿<a class="headerlink" href="#7" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 ã‚³ã‚¹ãƒˆä¸ŠæŒ¯ã‚Œãƒªã‚¹ã‚¯<a class="headerlink" href="#71" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒªã‚¹ã‚¯è¦å› </th>
<th>å½±éŸ¿åº¦</th>
<th>å¯¾ç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æ€¥å¢—</td>
<td>+30%</td>
<td>ã‚ªãƒ¼ãƒˆã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã€ä¸Šé™ã‚¢ãƒ©ãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿é‡å¢—åŠ </td>
<td>+20%</td>
<td>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ç›£è¦–ã€ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼</td>
</tr>
<tr>
<td>ç‚ºæ›¿å¤‰å‹•</td>
<td>Â±10%</td>
<td>å††å»ºã¦å¥‘ç´„æ¤œè¨ã€äºˆç®—ãƒãƒƒãƒ•ã‚¡</td>
</tr>
<tr>
<td>AWSå€¤ä¸Šã’</td>
<td>+5%</td>
<td>Savings Plansã€ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰æ¤œè¨</td>
</tr>
</tbody>
</table>
<h3 id="72">7.2 è»½æ¸›ç­–<a class="headerlink" href="#72" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>å¯¾ç­–</th>
<th>æœŸå¾…å‰Šæ¸›ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>1å¹´ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</td>
<td>30-40%</td>
</tr>
<tr>
<td>3å¹´ãƒªã‚¶ãƒ¼ãƒ–ãƒ‰ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹</td>
<td>50-60%</td>
</tr>
<tr>
<td>Savings Plans</td>
<td>20-30%</td>
</tr>
<tr>
<td>ã‚¹ãƒãƒƒãƒˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ (é–‹ç™ºç’°å¢ƒ)</td>
<td>60-90%</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. ä¾¡æ ¼å‚ç…§å…ƒ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81-aws">8.1 AWSå…¬å¼ä¾¡æ ¼ãƒšãƒ¼ã‚¸<a class="headerlink" href="#81-aws" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚µãƒ¼ãƒ“ã‚¹</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>EC2</td>
<td>https://aws.amazon.com/ec2/pricing/on-demand/</td>
</tr>
<tr>
<td>EKS</td>
<td>https://aws.amazon.com/eks/pricing/</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>https://aws.amazon.com/rds/aurora/pricing/</td>
</tr>
<tr>
<td>DynamoDB</td>
<td>https://aws.amazon.com/dynamodb/pricing/</td>
</tr>
<tr>
<td>ElastiCache</td>
<td>https://aws.amazon.com/elasticache/pricing/</td>
</tr>
<tr>
<td>MQ</td>
<td>https://aws.amazon.com/amazon-mq/pricing/</td>
</tr>
</tbody>
</table>
<h3 id="82">8.2 ä¾¡æ ¼è¨ˆç®—ãƒ„ãƒ¼ãƒ«<a class="headerlink" href="#82" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>URL</th>
</tr>
</thead>
<tbody>
<tr>
<td>AWS Pricing Calculator</td>
<td>https://calculator.aws/</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="9">9. æ”¹è¨‚å±¥æ­´<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ç‰ˆ</th>
<th>æ—¥ä»˜</th>
<th>å¤‰æ›´å†…å®¹</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.0</td>
<td>2025-01-12</td>
<td>åˆç‰ˆä½œæˆ</td>
</tr>
<tr>
<td>1.1</td>
<td>2025-01-13</td>
<td>Aurora PostgreSQL + DynamoDBæ§‹æˆã«å¤‰æ›´</td>
</tr>
</tbody>
</table>
<hr />
<p><em>Generated: 2025-01-13</em></p>
</article>
<article id="estimate-scalardb-sizing">
<h1 id="scalardb-cluster">ScalarDB Cluster ã‚µã‚¤ã‚¸ãƒ³ã‚°è¦‹ç©ã‚‚ã‚Š<a class="headerlink" href="#scalardb-cluster" title="Permanent link">&para;</a></h1>
<h2 id="1">1. ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#1" title="Permanent link">&para;</a></h2>
<h3 id="_1">è¦ä»¶æ¦‚è¦<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ </td>
<td>Scalar Auditor for BOX</td>
</tr>
<tr>
<td>ç’°å¢ƒæ§‹æˆ</td>
<td>å…¨ç’°å¢ƒã‚»ãƒƒãƒˆï¼ˆé–‹ç™º/ãƒ†ã‚¹ãƒˆ/ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°/æœ¬ç•ª + CI/CDï¼‰</td>
</tr>
<tr>
<td>æƒ³å®šTPS</td>
<td>ã€œ500 TPS</td>
</tr>
<tr>
<td>ç›®æ¨™å¯ç”¨æ€§</td>
<td>99.9%ï¼ˆå¹´é–“ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ 8.76æ™‚é–“ã¾ã§ï¼‰</td>
</tr>
<tr>
<td>ScalarDB Analytics</td>
<td>ä½¿ç”¨ã—ãªã„</td>
</tr>
<tr>
<td>ã‚¯ãƒ©ã‚¦ãƒ‰</td>
<td>AWS</td>
</tr>
</tbody>
</table>
<h3 id="_2">è²»ç”¨ã‚µãƒãƒªãƒ¼ï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ScalarDBãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
<th>ã‚¤ãƒ³ãƒ•ãƒ©</th>
<th>åˆè¨ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>Â¥200,000</td>
<td>Â¥45,000</td>
<td><strong>Â¥245,000</strong></td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>Â¥300,000</td>
<td>Â¥85,000</td>
<td><strong>Â¥385,000</strong></td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>Â¥300,000</td>
<td>Â¥120,000</td>
<td><strong>Â¥420,000</strong></td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>Â¥300,000</td>
<td>Â¥180,000</td>
<td><strong>Â¥480,000</strong></td>
</tr>
<tr>
<td><strong>å…¨ç’°å¢ƒåˆè¨ˆ</strong></td>
<td><strong>Â¥1,100,000</strong></td>
<td><strong>Â¥430,000</strong></td>
<td><strong>Â¥1,530,000/æœˆ</strong></td>
</tr>
</tbody>
</table>
<p>â€» ScalarDB Standard ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ï¼ˆÂ¥100,000/Pod/æœˆï¼‰ã‚’æƒ³å®š
â€» ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ: 1 USD = 150 JPY</p>
<hr />
<h2 id="2">2. ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ<a class="headerlink" href="#2" title="Permanent link">&para;</a></h2>
<h3 id="_3">å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<div class="mermaid">
flowchart TB
    subgraph Internet
        Client[ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ]
        BoxPlatform[BOX Platform]
    end

    subgraph AWS["AWS Cloud"]
        subgraph EKS["EKS Cluster"]
            subgraph Gateway["API Gateway Layer"]
                Kong[Kong API Gateway<br/>DB-less Mode]
            end

            subgraph App["Application Layer"]
                BFF[BFF<br/>Backend for Frontend]
                AMS[Audit Management<br/>Service]
                VS[Verification<br/>Service]
                ES[Event Service]
                IS[Item Service]
                IDS[Identity Service]
            end

            subgraph Data["Data Layer"]
                ScalarDB[ScalarDB Cluster<br/>3 Pods]
            end
        end

        subgraph Database["Backend Database"]
            Aurora[(Aurora PostgreSQL<br/>Multi-AZ)]
        end

        subgraph Monitoring["ç›£è¦–"]
            Prometheus[Prometheus]
            Grafana[Grafana]
        end
    end

    Client --> Kong
    BoxPlatform --> Kong
    Kong --> BFF
    BFF --> AMS & VS & ES & IS & IDS
    AMS & VS & ES & IS & IDS --> ScalarDB
    ScalarDB --> Aurora
    ScalarDB --> Prometheus
</div>

<h3 id="_4">ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£é¸å®šæ ¹æ‹ <a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é¸æŠ</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>Kong DB-less</td>
<td>GitOpsè¦ªå’Œæ€§ã€è¨­å®šã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€Admin APIä¸è¦</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>é«˜å¯ç”¨æ€§ã€è‡ªå‹•ãƒ•ã‚§ã‚¤ãƒ«ã‚ªãƒ¼ãƒãƒ¼ã€ScalarDBå…¬å¼ã‚µãƒãƒ¼ãƒˆ</td>
</tr>
<tr>
<td>Prometheus + Grafana</td>
<td>OSSãƒ»ã‚³ã‚¹ãƒˆåŠ¹ç‡ã€ScalarDBå…¬å¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹å¯¾å¿œ</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="3-scalardb-cluster">3. ScalarDB Cluster ã‚µã‚¤ã‚¸ãƒ³ã‚°<a class="headerlink" href="#3-scalardb-cluster" title="Permanent link">&para;</a></h2>
<h3 id="31-pod">3.1 Podæ•°è¨ˆç®—<a class="headerlink" href="#31-pod" title="Permanent link">&para;</a></h3>
<h4 id="_5">æ€§èƒ½è¦ä»¶ã‹ã‚‰ã®è¨ˆç®—<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code>ç›®æ¨™TPS: 500 TPS
ãƒ¯ãƒ¼ã‚¯ãƒ­ãƒ¼ãƒ‰: ãƒãƒ©ãƒ³ã‚¹å‹ï¼ˆèª­ã¿æ›¸ãæ··åœ¨ï¼‰
TPS/Podï¼ˆv3.17æœ€é©åŒ–æœ‰åŠ¹ï¼‰: 900ã€œ2,400 TPS

å¿…è¦Podæ•° = ceil(500 / 1,000) = 1 pod
</code></pre>

<h4 id="_6">å¯ç”¨æ€§è¦ä»¶ã‹ã‚‰ã®è¨ˆç®—<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code>ç›®æ¨™å¯ç”¨æ€§: 99.9%
éšœå®³è¨±å®¹: 1 Podéšœå®³ã§ã‚‚ã‚µãƒ¼ãƒ“ã‚¹ç¶™ç¶š

Raftæ§‹æˆã®æœ€å°ã‚¯ã‚©ãƒ¼ãƒ©ãƒ : 3 Pods
éšœå®³æ™‚ã®ç¨¼åƒPod: 2 Pods
2 Pods Ã— 1,000 TPS = 2,000 TPSï¼ˆ500 TPSã‚’ååˆ†ã‚«ãƒãƒ¼ï¼‰

å¿…è¦Podæ•° = 3 pods
</code></pre>

<h4 id="_7">æœ€çµ‚æ±ºå®š<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code>æœ¬ç•ªPodæ•° = max(æ€§èƒ½è¦ä»¶1, å¯ç”¨æ€§è¦ä»¶3, æœ€å°3) = 3 pods
</code></pre>

<h3 id="32-scalardb">3.2 ç’°å¢ƒåˆ¥ScalarDBæ§‹æˆ<a class="headerlink" href="#32-scalardb" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>Podæ•°</th>
<th>CPU/Pod</th>
<th>Memory/Pod</th>
<th>æ ¹æ‹ </th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>2</td>
<td>500m</td>
<td>1Gi</td>
<td>æœ€å°æ§‹æˆã€é–‹ç™ºãƒ†ã‚¹ãƒˆç”¨</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>3</td>
<td>1</td>
<td>2Gi</td>
<td>HAæ§‹æˆã€çµåˆãƒ†ã‚¹ãƒˆç”¨</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>3</td>
<td>2</td>
<td>4Gi</td>
<td>æœ¬ç•ªåŒç­‰ã€æ€§èƒ½æ¤œè¨¼ç”¨</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>3</td>
<td>2</td>
<td>4Gi</td>
<td>500 TPS + 99.9%å¯ç”¨æ€§</td>
</tr>
</tbody>
</table>
<h3 id="33-scalardb-v317">3.3 ScalarDB v3.17 æœ€é©åŒ–è¨­å®š<a class="headerlink" href="#33-scalardb-v317" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml"># ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´è¨­å®šï¼ˆæ¨å¥¨ï¼‰
scalar.db.cluster.client.piggyback_begin.enabled: true
scalar.db.cluster.client.write_buffering.enabled: true

# ã‚µãƒ¼ãƒãƒ¼å´è¨­å®šï¼ˆæ¨å¥¨ï¼‰
scalar.db.consensus_commit.async_commit.enabled: true
scalar.db.consensus_commit.one_phase_commit.enabled: true  # å˜ä¸€DBæ™‚
</code></pre>

<p><strong>æœŸå¾…åŠ¹æœ</strong>: å¾“æ¥æ¯”1.5ã€œ2å€ã®æ€§èƒ½å‘ä¸Š</p>
<hr />
<h2 id="4-kubernetes">4. Kubernetes ã‚µã‚¤ã‚¸ãƒ³ã‚°<a class="headerlink" href="#4-kubernetes" title="Permanent link">&para;</a></h2>
<h3 id="41-node">4.1 Nodeæ•°è¨ˆç®—<a class="headerlink" href="#41-node" title="Permanent link">&para;</a></h3>
<h4 id="_8">æœ¬ç•ªç’°å¢ƒ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<pre class="codehilite"><code>ScalarDB: 3 pods Ã— 2 vCPU = 6 vCPU
Application: 6 services Ã— 2 pods Ã— 1 vCPU = 12 vCPU
Kong: 2 pods Ã— 0.5 vCPU = 1 vCPU
Monitoring: 2 vCPU

Total: 21 vCPU
Node Type: m6i.xlarge (4 vCPU)
å¿…è¦Nodeæ•° = ceil(21/4) Ã— 1.3ï¼ˆå†—é•·ä¿‚æ•°ï¼‰ = 7 nodes
â†’ 3 AZåˆ†æ•£ã®ãŸã‚ 9 nodesï¼ˆ3 Ã— 3ï¼‰
</code></pre>

<h3 id="42-kubernetes">4.2 ç’°å¢ƒåˆ¥Kubernetesæ§‹æˆ<a class="headerlink" href="#42-kubernetes" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>Nodeæ•°</th>
<th>Instance Type</th>
<th>åˆè¨ˆvCPU</th>
<th>åˆè¨ˆMemory</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>2</td>
<td>t3.medium</td>
<td>4 vCPU</td>
<td>8 GB</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>3</td>
<td>m6i.large</td>
<td>6 vCPU</td>
<td>24 GB</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>5</td>
<td>m6i.xlarge</td>
<td>20 vCPU</td>
<td>80 GB</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>9</td>
<td>m6i.xlarge</td>
<td>36 vCPU</td>
<td>144 GB</td>
</tr>
</tbody>
</table>
<h3 id="43-node-pool">4.3 Node Poolæ§‹æˆï¼ˆæœ¬ç•ªï¼‰<a class="headerlink" href="#43-node-pool" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-yaml">nodePools:
  - name: scalardb-pool
    instanceType: r6i.xlarge  # 4 vCPU, 32 GBï¼ˆãƒ¡ãƒ¢ãƒªé‡è¦–ï¼‰
    count: 3
    labels:
      workload: scalardb
    taints:
      - key: dedicated
        value: scalardb
        effect: NoSchedule

  - name: application-pool
    instanceType: m6i.xlarge  # 4 vCPU, 16 GB
    count: 4
    labels:
      workload: application

  - name: system-pool
    instanceType: m6i.large  # 2 vCPU, 8 GB
    count: 2
    labels:
      workload: system
</code></pre>

<hr />
<h2 id="5">5. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚¸ãƒ³ã‚°<a class="headerlink" href="#5" title="Permanent link">&para;</a></h2>
<h3 id="51-aurora-postgresql">5.1 Aurora PostgreSQLæ§‹æˆ<a class="headerlink" href="#51-aurora-postgresql" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>Instance Class</th>
<th>Storage</th>
<th>Multi-AZ</th>
<th>Read Replica</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>db.t4g.medium</td>
<td>20 GB</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>db.r6g.large</td>
<td>50 GB</td>
<td>No</td>
<td>No</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>db.r6g.xlarge</td>
<td>100 GB</td>
<td>Yes</td>
<td>No</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>db.r6g.xlarge</td>
<td>200 GB</td>
<td>Yes</td>
<td>1</td>
</tr>
</tbody>
</table>
<h3 id="52">5.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚¸ãƒ³ã‚°æ ¹æ‹ <a class="headerlink" href="#52" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>æƒ³å®šãƒ‡ãƒ¼ã‚¿é‡:
- ç›£æŸ»ã‚»ãƒƒãƒˆ: ã€œ10,000ä»¶
- ãƒ•ã‚¡ã‚¤ãƒ«/ãƒ•ã‚©ãƒ«ãƒ€: ã€œ1,000,000ä»¶
- ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°: ã€œ100,000,000ä»¶/å¹´

ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¨ˆç®—:
- ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚ãŸã‚Šå¹³å‡ã‚µã‚¤ã‚º: 1KB
- ScalarDBã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰: +30%
- å¹´é–“å¢—åŠ é‡: 100GB
- 5å¹´é‹ç”¨æƒ³å®š: 500GB

æœ¬ç•ªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ = 200GBï¼ˆåˆæœŸï¼‰+ Auto Scaling
</code></pre>

<h3 id="53-iops">5.3 IOPSè¨ˆç®—<a class="headerlink" href="#53-iops" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code>TPS: 500
ScalarDB I/Oãƒ‘ã‚¿ãƒ¼ãƒ³: 1ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ã‚ãŸã‚Šç´„5 I/O
å¿…è¦IOPS = 500 Ã— 5 = 2,500 IOPS

db.r6g.xlarge: æœ€å¤§12,500 IOPS â†’ ååˆ†ãªä½™è£•
</code></pre>

<hr />
<h2 id="6">6. è²»ç”¨è©³ç´°<a class="headerlink" href="#6" title="Permanent link">&para;</a></h2>
<h3 id="61-scalardb">6.1 ScalarDBãƒ©ã‚¤ã‚»ãƒ³ã‚¹è²»ç”¨ï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#61-scalardb" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>Podæ•°</th>
<th>å˜ä¾¡/Pod</th>
<th>æœˆé¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>2</td>
<td>Â¥100,000</td>
<td>Â¥200,000</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>3</td>
<td>Â¥100,000</td>
<td>Â¥300,000</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>3</td>
<td>Â¥100,000</td>
<td>Â¥300,000</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>3</td>
<td>Â¥100,000</td>
<td>Â¥300,000</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>11</strong></td>
<td></td>
<td><strong>Â¥1,100,000</strong></td>
</tr>
</tbody>
</table>
<h3 id="62-aws">6.2 AWSã‚¤ãƒ³ãƒ•ãƒ©è²»ç”¨ï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#62-aws" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>é–‹ç™º</th>
<th>ãƒ†ã‚¹ãƒˆ</th>
<th>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</th>
<th>æœ¬ç•ª</th>
</tr>
</thead>
<tbody>
<tr>
<td>EKS Cluster</td>
<td>$73</td>
<td>$73</td>
<td>$73</td>
<td>$73</td>
</tr>
<tr>
<td>EC2 (Nodes)</td>
<td>$150</td>
<td>$300</td>
<td>$500</td>
<td>$900</td>
</tr>
<tr>
<td>Aurora PostgreSQL</td>
<td>$50</td>
<td>$150</td>
<td>$300</td>
<td>$500</td>
</tr>
<tr>
<td>ALB</td>
<td>$20</td>
<td>$30</td>
<td>$50</td>
<td>$80</td>
</tr>
<tr>
<td>EBS Storage</td>
<td>$5</td>
<td>$10</td>
<td>$30</td>
<td>$50</td>
</tr>
<tr>
<td>Data Transfer</td>
<td>$2</td>
<td>$5</td>
<td>$20</td>
<td>$50</td>
</tr>
<tr>
<td>CloudWatch</td>
<td>$5</td>
<td>$10</td>
<td>$20</td>
<td>$50</td>
</tr>
<tr>
<td><strong>USDå°è¨ˆ</strong></td>
<td><strong>$305</strong></td>
<td><strong>$578</strong></td>
<td><strong>$993</strong></td>
<td><strong>$1,703</strong></td>
</tr>
<tr>
<td><strong>JPYå°è¨ˆ</strong></td>
<td><strong>Â¥45,750</strong></td>
<td><strong>Â¥86,700</strong></td>
<td><strong>Â¥148,950</strong></td>
<td><strong>Â¥255,450</strong></td>
</tr>
</tbody>
</table>
<p>â€» ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ: 1 USD = 150 JPY</p>
<h3 id="63">6.3 ç·è²»ç”¨ã‚µãƒãƒªãƒ¼ï¼ˆæœˆé¡ï¼‰<a class="headerlink" href="#63" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ç’°å¢ƒ</th>
<th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
<th>ã‚¤ãƒ³ãƒ•ãƒ©</th>
<th>åˆè¨ˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>é–‹ç™º</td>
<td>Â¥200,000</td>
<td>Â¥45,750</td>
<td>Â¥245,750</td>
</tr>
<tr>
<td>ãƒ†ã‚¹ãƒˆ</td>
<td>Â¥300,000</td>
<td>Â¥86,700</td>
<td>Â¥386,700</td>
</tr>
<tr>
<td>ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
<td>Â¥300,000</td>
<td>Â¥148,950</td>
<td>Â¥448,950</td>
</tr>
<tr>
<td>æœ¬ç•ª</td>
<td>Â¥300,000</td>
<td>Â¥255,450</td>
<td>Â¥555,450</td>
</tr>
<tr>
<td><strong>å…¨ç’°å¢ƒåˆè¨ˆ</strong></td>
<td><strong>Â¥1,100,000</strong></td>
<td><strong>Â¥537,850</strong></td>
<td><strong>Â¥1,637,850</strong></td>
</tr>
</tbody>
</table>
<h3 id="64">6.4 å¹´é–“è²»ç”¨<a class="headerlink" href="#64" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>æœˆé¡</th>
<th>å¹´é¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>ScalarDBãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
<td>Â¥1,100,000</td>
<td>Â¥13,200,000</td>
</tr>
<tr>
<td>AWSã‚¤ãƒ³ãƒ•ãƒ©</td>
<td>Â¥537,850</td>
<td>Â¥6,454,200</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>Â¥1,637,850</strong></td>
<td><strong>Â¥19,654,200</strong></td>
</tr>
</tbody>
</table>
<hr />
<h2 id="7-cicd">7. CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹æˆ<a class="headerlink" href="#7-cicd" title="Permanent link">&para;</a></h2>
<div class="mermaid">
flowchart LR
    subgraph Source["ã‚½ãƒ¼ã‚¹ç®¡ç†"]
        Git[GitLab/GitHub]
    end

    subgraph CI["CI"]
        Build[ãƒ“ãƒ«ãƒ‰]
        Test[ãƒ†ã‚¹ãƒˆ]
        Scan[ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³]
        Push[ã‚¤ãƒ¡ãƒ¼ã‚¸Push]
    end

    subgraph CD["CD - ArgoCD"]
        Sync[GitOps Sync]
    end

    subgraph Envs["ç’°å¢ƒ"]
        Dev[é–‹ç™º]
        QA[ãƒ†ã‚¹ãƒˆ]
        Stg[ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°]
        Prod[æœ¬ç•ª]
    end

    Git --> Build --> Test --> Scan --> Push --> Sync
    Sync --> Dev
    Dev -->|è‡ªå‹•| QA
    QA -->|æ‰¿èª| Stg
    Stg -->|æ‰¿èª| Prod
</div>

<h3 id="cicd">CI/CDãƒ„ãƒ¼ãƒ«æ§‹æˆ<a class="headerlink" href="#cicd" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</th>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>è²»ç”¨/æœˆ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚½ãƒ¼ã‚¹ç®¡ç†</td>
<td>GitLab (SaaS)</td>
<td>$19/user</td>
</tr>
<tr>
<td>CI</td>
<td>GitLab CI</td>
<td>å«ã‚€</td>
</tr>
<tr>
<td>CD</td>
<td>ArgoCD (OSS)</td>
<td>$0</td>
</tr>
<tr>
<td>ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒª</td>
<td>ECR</td>
<td>ã€œ$10</td>
</tr>
<tr>
<td>Helm Charts</td>
<td>ScalarDB Helm Charts</td>
<td>å«ã‚€</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="8">8. ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆæ§‹æˆ<a class="headerlink" href="#8" title="Permanent link">&para;</a></h2>
<h3 id="81">8.1 ç›£è¦–ã‚¹ã‚¿ãƒƒã‚¯<a class="headerlink" href="#81" title="Permanent link">&para;</a></h3>
<div class="mermaid">
flowchart TB
    subgraph Targets["ç›£è¦–å¯¾è±¡"]
        ScalarDB[ScalarDB Cluster]
        App[Application Pods]
        Aurora[Aurora PostgreSQL]
        EKS[EKS Cluster]
    end

    subgraph Monitoring["ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ "]
        Prometheus[Prometheus]
        Grafana[Grafana]
        AlertManager[AlertManager]
    end

    subgraph Notification["é€šçŸ¥"]
        Slack[Slack]
        PagerDuty[PagerDuty]
    end

    ScalarDB & App & Aurora & EKS --> Prometheus
    Prometheus --> Grafana
    Prometheus --> AlertManager
    AlertManager --> Slack & PagerDuty
</div>

<h3 id="82-scalardb">8.2 ScalarDB ãƒ¡ãƒˆãƒªã‚¯ã‚¹<a class="headerlink" href="#82-scalardb" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ¡ãƒˆãƒªã‚¯ã‚¹</th>
<th>èª¬æ˜</th>
<th>ã‚¢ãƒ©ãƒ¼ãƒˆé–¾å€¤</th>
</tr>
</thead>
<tbody>
<tr>
<td>scalardb_cluster_transaction_latency</td>
<td>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·</td>
<td>P99 &gt; 500ms</td>
</tr>
<tr>
<td>scalardb_cluster_active_transactions</td>
<td>ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³æ•°</td>
<td>&gt; 1000</td>
</tr>
<tr>
<td>scalardb_cluster_commit_rate</td>
<td>ã‚³ãƒŸãƒƒãƒˆæˆåŠŸç‡</td>
<td>&lt; 99%</td>
</tr>
<tr>
<td>scalardb_cluster_retry_count</td>
<td>ãƒªãƒˆãƒ©ã‚¤å›æ•°</td>
<td>&gt; 100/min</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="9">9. æ¨å¥¨äº‹é …<a class="headerlink" href="#9" title="Permanent link">&para;</a></h2>
<h3 id="91">9.1 æ®µéšçš„å°å…¥<a class="headerlink" href="#91" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Phase 1ï¼ˆ1-2ãƒ¶æœˆï¼‰</strong>: é–‹ç™ºç’°å¢ƒæ§‹ç¯‰ã€PoCå®Ÿæ–½</li>
<li><strong>Phase 2ï¼ˆ2-3ãƒ¶æœˆï¼‰</strong>: ãƒ†ã‚¹ãƒˆç’°å¢ƒæ§‹ç¯‰ã€çµåˆãƒ†ã‚¹ãƒˆ</li>
<li><strong>Phase 3ï¼ˆ3-4ãƒ¶æœˆï¼‰</strong>: ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã€æ€§èƒ½ãƒ†ã‚¹ãƒˆ</li>
<li><strong>Phase 4ï¼ˆ4-5ãƒ¶æœˆï¼‰</strong>: æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰ã€ç§»è¡Œ</li>
</ol>
<h3 id="92">9.2 ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã‚ªãƒ—ã‚·ãƒ§ãƒ³<a class="headerlink" href="#92" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ã‚ªãƒ—ã‚·ãƒ§ãƒ³</th>
<th>å‰Šæ¸›ç‡</th>
<th>é©ç”¨ç’°å¢ƒ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Reserved Instances (1å¹´)</td>
<td>30-40%</td>
<td>æœ¬ç•ªãƒ»ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°</td>
</tr>
<tr>
<td>Savings Plans</td>
<td>20-30%</td>
<td>å…¨ç’°å¢ƒ</td>
</tr>
<tr>
<td>Spot Instances</td>
<td>60-70%</td>
<td>é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆ</td>
</tr>
<tr>
<td>é–‹ç™ºç’°å¢ƒã®å¤œé–“åœæ­¢</td>
<td>50%</td>
<td>é–‹ç™º</td>
</tr>
</tbody>
</table>
<h3 id="93">9.3 å°†æ¥ã®æ‹¡å¼µæ€§<a class="headerlink" href="#93" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>TPSå¢—åŠ æ™‚</strong>: Podæ•°ã‚’æ®µéšçš„ã«è¿½åŠ ï¼ˆã€œ2,000 TPSã¾ã§3 Podsã§å¯¾å¿œå¯èƒ½ï¼‰</li>
<li><strong>å¯ç”¨æ€§å‘ä¸Šæ™‚</strong>: Multi-Regionæ§‹æˆã¸ã®æ‹¡å¼µ</li>
<li><strong>åˆ†æè¦ä»¶æ™‚</strong>: ScalarDB Analytics (EMR/Databricks) è¿½åŠ </li>
</ul>
<hr />
<h2 id="10">10. å‰ææ¡ä»¶ãƒ»åˆ¶ç´„äº‹é …<a class="headerlink" href="#10" title="Permanent link">&para;</a></h2>
<h3 id="_9">å‰ææ¡ä»¶<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<ul>
<li>AWSæ±äº¬ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ (ap-northeast-1) ã‚’ä½¿ç”¨</li>
<li>ScalarDB v3.17ä»¥ä¸Šã‚’ä½¿ç”¨</li>
<li>Kubernetes v1.28ä»¥ä¸Šã‚’ä½¿ç”¨</li>
<li>ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·: åŒä¸€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³å†… &lt; 1ms</li>
</ul>
<h3 id="_10">åˆ¶ç´„äº‹é …<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<ul>
<li>ScalarDBãƒ©ã‚¤ã‚»ãƒ³ã‚¹è²»ç”¨ã¯å‚è€ƒå€¤ï¼ˆæ­£å¼è¦‹ç©ã‚‚ã‚Šã¯Scalarç¤¾ã¸ï¼‰</li>
<li>AWSè²»ç”¨ã¯2024å¹´1æœˆæ™‚ç‚¹ã®ä¾¡æ ¼</li>
<li>ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆå¤‰å‹•ã«ã‚ˆã‚Šè²»ç”¨ã¯å¤‰å‹•ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š</li>
</ul>
<hr />
<p><em>è¦‹ç©ã‚‚ã‚Šä½œæˆæ—¥: 2026å¹´1æœˆ</em>
<em>ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ: 1 USD = 150 JPY</em></p>
</article>
</section>
<section id="graph">
<h1>ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•</h1>
<article id="graph-schema">
<h1 id="graphdb">GraphDB ã‚¹ã‚­ãƒ¼ãƒ<a class="headerlink" href="#graphdb" title="Permanent link">&para;</a></h1>
<h2 id="_1">æ¦‚è¦<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>Scalar Auditor for BOXã‚·ã‚¹ãƒ†ãƒ ã®ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã‚¹ã‚­ãƒ¼ãƒã§ã™ã€‚</p>
<h2 id="_2">ãƒãƒ¼ãƒ‰ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<h3 id="ubiquitousterm">UbiquitousTerm (ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªç”¨èª)<a class="headerlink" href="#ubiquitousterm" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>TEXT (PK)</td>
<td>è‹±èªå</td>
</tr>
<tr>
<td>name_ja</td>
<td>TEXT</td>
<td>æ—¥æœ¬èªå</td>
</tr>
<tr>
<td>definition</td>
<td>TEXT</td>
<td>å®šç¾©</td>
</tr>
<tr>
<td>domain</td>
<td>TEXT</td>
<td>æ‰€å±ãƒ‰ãƒ¡ã‚¤ãƒ³</td>
</tr>
</tbody>
</table>
<h3 id="domain">Domain (ãƒ‰ãƒ¡ã‚¤ãƒ³)<a class="headerlink" href="#domain" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>TEXT (PK)</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³å</td>
</tr>
<tr>
<td>type</td>
<td>TEXT</td>
<td>Core/Supporting/Integration</td>
</tr>
<tr>
<td>description</td>
<td>TEXT</td>
<td>èª¬æ˜</td>
</tr>
</tbody>
</table>
<h3 id="entity">Entity (ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£)<a class="headerlink" href="#entity" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>TEXT (PK)</td>
<td>ã‚¯ãƒ©ã‚¹/ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å</td>
</tr>
<tr>
<td>file_path</td>
<td>TEXT</td>
<td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹</td>
</tr>
<tr>
<td>type</td>
<td>TEXT</td>
<td>class/interface</td>
</tr>
<tr>
<td>package</td>
<td>TEXT</td>
<td>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å</td>
</tr>
</tbody>
</table>
<h3 id="actor">Actor (ã‚¢ã‚¯ã‚¿ãƒ¼)<a class="headerlink" href="#actor" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>TEXT (PK)</td>
<td>ã‚¢ã‚¯ã‚¿ãƒ¼å</td>
</tr>
<tr>
<td>type</td>
<td>TEXT</td>
<td>internal/external</td>
</tr>
<tr>
<td>description</td>
<td>TEXT</td>
<td>èª¬æ˜</td>
</tr>
</tbody>
</table>
<h3 id="role">Role (ãƒ­ãƒ¼ãƒ«)<a class="headerlink" href="#role" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>TEXT (PK)</td>
<td>ãƒ­ãƒ¼ãƒ«å</td>
</tr>
<tr>
<td>level</td>
<td>TEXT</td>
<td>system/collaborator</td>
</tr>
<tr>
<td>permissions</td>
<td>TEXT</td>
<td>æ¨©é™ãƒªã‚¹ãƒˆ</td>
</tr>
</tbody>
</table>
<h2 id="_3">ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="belongs_to-entity-domain">BELONGS_TO (Entity â†’ Domain)<a class="headerlink" href="#belongs_to-entity-domain" title="Permanent link">&para;</a></h3>
<p>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒã©ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å±ã™ã‚‹ã‹ã‚’è¡¨ã™é–¢ä¿‚ã€‚</p>
<h3 id="has_term-entity-ubiquitousterm">HAS_TERM (Entity â†’ UbiquitousTerm)<a class="headerlink" href="#has_term-entity-ubiquitousterm" title="Permanent link">&para;</a></h3>
<p>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ãŒãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã®ç”¨èªã¨é–¢é€£ã™ã‚‹ã“ã¨ã‚’è¡¨ã™é–¢ä¿‚ã€‚</p>
<h3 id="has_role-actor-role">HAS_ROLE (Actor â†’ Role)<a class="headerlink" href="#has_role-actor-role" title="Permanent link">&para;</a></h3>
<p>ã‚¢ã‚¯ã‚¿ãƒ¼ãŒæŒã¤ãƒ­ãƒ¼ãƒ«ã‚’è¡¨ã™é–¢ä¿‚ã€‚</p>
<h3 id="references-entity-entity">REFERENCES (Entity â†’ Entity)<a class="headerlink" href="#references-entity-entity" title="Permanent link">&para;</a></h3>
<p>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£é–“ã®å‚ç…§é–¢ä¿‚ã€‚</p>
<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£</th>
<th>å‹</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>relation_type</td>
<td>TEXT</td>
<td>owned_by/belongs_to/uses/referencesç­‰</td>
</tr>
</tbody>
</table>
<h2 id="_4">ã‚°ãƒ©ãƒ•ãƒ¢ãƒ‡ãƒ«å›³<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<div class="mermaid">
graph LR
    subgraph "ãƒãƒ¼ãƒ‰"
        T[UbiquitousTerm]
        D[Domain]
        E[Entity]
        A[Actor]
        R[Role]
    end

    subgraph "ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"
        E -->|BELONGS_TO| D
        E -->|HAS_TERM| T
        A -->|HAS_ROLE| R
        E -->|REFERENCES| E
    end
</div>

<h2 id="_5">ã‚¯ã‚¨ãƒªä¾‹<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="_6">ãƒ‰ãƒ¡ã‚¤ãƒ³ã«å±ã™ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å–å¾—<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-cypher">MATCH (e:Entity)-[:BELONGS_TO]-&gt;(d:Domain {name: 'Audit'})
RETURN e.name, e.file_path
</code></pre>

<h3 id="_7">ç”¨èªã«é–¢é€£ã™ã‚‹ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’å–å¾—<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-cypher">MATCH (e:Entity)-[:HAS_TERM]-&gt;(t:UbiquitousTerm {name: 'AuditSet'})
RETURN e.name, t.name_ja
</code></pre>

<h3 id="_8">ã‚¢ã‚¯ã‚¿ãƒ¼ã®ãƒ­ãƒ¼ãƒ«ã‚’å–å¾—<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-cypher">MATCH (a:Actor)-[:HAS_ROLE]-&gt;(r:Role)
RETURN a.name, r.name, r.permissions
</code></pre>

<h3 id="_9">ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã®å‚ç…§é–¢ä¿‚ã‚’å–å¾—<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-cypher">MATCH (e1:Entity)-[r:REFERENCES]-&gt;(e2:Entity)
WHERE e1.name = 'AuditSetService'
RETURN e1.name, r.relation_type, e2.name
</code></pre>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: Scalar Auditor for BOX</em></p>
</article>
<article id="graph-statistics">
<h1 id="graphdb">GraphDBçµ±è¨ˆæƒ…å ±<a class="headerlink" href="#graphdb" title="Permanent link">&para;</a></h1>
<h2 id="_1">ç”Ÿæˆæ—¥æ™‚<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>2025-12-26 11:05:33</p>
<h2 id="_2">ãƒãƒ¼ãƒ‰çµ±è¨ˆ<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—</th>
<th>ä»¶æ•°</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>UbiquitousTerm</td>
<td>26</td>
<td>ãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªã®ç”¨èª</td>
</tr>
<tr>
<td>Domain</td>
<td>7</td>
<td>ãƒ“ã‚¸ãƒã‚¹ãƒ‰ãƒ¡ã‚¤ãƒ³</td>
</tr>
<tr>
<td>Entity</td>
<td>60</td>
<td>ã‚¯ãƒ©ã‚¹/ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</td>
</tr>
<tr>
<td>Actor</td>
<td>6</td>
<td>ã‚·ã‚¹ãƒ†ãƒ ã‚¢ã‚¯ã‚¿ãƒ¼</td>
</tr>
<tr>
<td>Role</td>
<td>7</td>
<td>ãƒ­ãƒ¼ãƒ«å®šç¾©</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>106</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="_3">ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµ±è¨ˆ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—</th>
<th>ä»¶æ•°</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>BELONGS_TO</td>
<td>60</td>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³æ‰€å±</td>
</tr>
<tr>
<td>REFERENCES</td>
<td>39</td>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å‚ç…§</td>
</tr>
<tr>
<td>HAS_TERM</td>
<td>23</td>
<td>ç”¨èªé–¢é€£</td>
</tr>
<tr>
<td>HAS_ROLE</td>
<td>8</td>
<td>ãƒ­ãƒ¼ãƒ«ä¿æŒ</td>
</tr>
<tr>
<td><strong>åˆè¨ˆ</strong></td>
<td><strong>130</strong></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="_4">ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¥ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æ•°<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒ‰ãƒ¡ã‚¤ãƒ³</th>
<th>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Identity</td>
<td>12</td>
</tr>
<tr>
<td>Audit</td>
<td>15</td>
</tr>
<tr>
<td>AuditGroup</td>
<td>8</td>
</tr>
<tr>
<td>File</td>
<td>13</td>
</tr>
<tr>
<td>Event</td>
<td>11</td>
</tr>
<tr>
<td>Verification</td>
<td>2</td>
</tr>
<tr>
<td>BOXIntegration</td>
<td>-</td>
</tr>
</tbody>
</table>
<h2 id="_5">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<ul>
<li>åˆ†æçµæœ: ã‚ã‚Š (<code>reports/01_analysis/</code>)</li>
<li>ã‚³ãƒ¼ãƒ‰è§£æ: ã‚ã‚Š</li>
<li>å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: 60+ ã‚¯ãƒ©ã‚¹/ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</li>
</ul>
<h2 id="_6">ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h2>
<pre class="codehilite"><code>reports/graph/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ terms.csv          (26ä»¶)
â”‚   â”œâ”€â”€ domains.csv         (7ä»¶)
â”‚   â”œâ”€â”€ entities.csv       (60ä»¶)
â”‚   â”œâ”€â”€ actors.csv          (6ä»¶)
â”‚   â”œâ”€â”€ roles.csv           (7ä»¶)
â”‚   â”œâ”€â”€ belongs_to.csv     (60ä»¶)
â”‚   â”œâ”€â”€ has_term.csv       (23ä»¶)
â”‚   â”œâ”€â”€ has_role.csv        (8ä»¶)
â”‚   â””â”€â”€ references.csv     (39ä»¶)
â”œâ”€â”€ schema.md
â””â”€â”€ statistics.md

knowledge.ryugraph/        # RyuGraphãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
</code></pre>

<h2 id="_7">åˆ©ç”¨æ–¹æ³•<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="_8">ã‚¯ã‚¨ãƒªå®Ÿè¡Œ<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash"># ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰
python scripts/query_graph.py --db-path ./knowledge.ryugraph --interactive

# è‡ªç„¶è¨€èªã‚¯ã‚¨ãƒª
python scripts/query_graph.py --db-path ./knowledge.ryugraph \
  --query &quot;ç›£æŸ»ã‚»ãƒƒãƒˆã«é–¢é€£ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’æ•™ãˆã¦&quot;

# Cypherã‚¯ã‚¨ãƒª
python scripts/query_graph.py --db-path ./knowledge.ryugraph \
  --cypher &quot;MATCH (e:Entity)-[:BELONGS_TO]-&gt;(d:Domain) RETURN e.name, d.name LIMIT 10&quot;
</code></pre>

<hr />
<p><em>Generated: 2025-12-26</em>
<em>Source: Scalar Auditor for BOX</em></p>
</article>
<article id="graph-visualizations-summary">
<h1 id="graphdb">GraphDBå¯è¦–åŒ–ã‚µãƒãƒªãƒ¼<a class="headerlink" href="#graphdb" title="Permanent link">&para;</a></h1>
<p><strong>ç”Ÿæˆæ—¥æ™‚</strong>: 2025-12-26 11:12:14</p>
<h2 id="_1">çµ±è¨ˆæƒ…å ±<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ä»¶æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³</td>
<td>7</td>
</tr>
<tr>
<td>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£</td>
<td>60</td>
</tr>
<tr>
<td>ç”¨èª</td>
<td>26</td>
</tr>
<tr>
<td>ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</td>
<td>39</td>
</tr>
</tbody>
</table>
<h2 id="_2">ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>ãƒ•ã‚¡ã‚¤ãƒ«</th>
<th>å½¢å¼</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td>graph.mmd</td>
<td>Mermaid</td>
<td>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŸ‹ã‚è¾¼ã¿</td>
</tr>
<tr>
<td>graph.dot</td>
<td>DOT</td>
<td>Graphvizå¤‰æ›</td>
</tr>
<tr>
<td>graph.html</td>
<td>HTML</td>
<td>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ“ãƒ¥ãƒ¼</td>
</tr>
</tbody>
</table>
<h2 id="_3">ä½¿ç”¨æ–¹æ³•<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="mermaid-png">Mermaid â†’ PNGå¤‰æ›<a class="headerlink" href="#mermaid-png" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash">mmdc -i graph.mmd -o graph.png
</code></pre>

<h3 id="dot-png">DOT â†’ PNGå¤‰æ›<a class="headerlink" href="#dot-png" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash">dot -Tpng graph.dot -o graph-dot.png
</code></pre>

<h3 id="html">HTMLãƒ“ãƒ¥ãƒ¼<a class="headerlink" href="#html" title="Permanent link">&para;</a></h3>
<pre class="codehilite"><code class="language-bash">open graph.html  # macOS
xdg-open graph.html  # Linux
</code></pre>
</article>

<article id="graph-interactive">
<h2>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ã‚¢</h2>
<p>ãƒãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ç§»å‹•ã€ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã‚ºãƒ¼ãƒ ã€ãƒãƒ¼ãƒ‰ã«ãƒ›ãƒãƒ¼ã§è©³ç´°è¡¨ç¤ºã§ãã¾ã™ã€‚</p>
<div id="graph-container" style="width: 100%; height: 600px; border: 1px solid var(--border-color); border-radius: 8px; overflow: hidden; background: #1a1a2e;">
    <div id="graph-controls" style="position: absolute; padding: 10px; background: rgba(255,255,255,0.9); border-radius: 5px; margin: 10px; z-index: 100;">
        <input type="text" id="graph-search" placeholder="ãƒãƒ¼ãƒ‰ã‚’æ¤œç´¢..." style="width: 180px; padding: 5px;">
        <div id="graph-stats" style="font-size: 12px; color: #666; margin-top: 5px;"></div>
    </div>
    <svg id="graph-svg"></svg>
</div>
<div id="graph-legend" style="margin-top: 15px; display: flex; gap: 20px; flex-wrap: wrap;">
    <span><span style="display: inline-block; width: 12px; height: 12px; background: #e74c3c; border-radius: 50%; margin-right: 5px;"></span>Domain</span>
    <span><span style="display: inline-block; width: 12px; height: 12px; background: #3498db; border-radius: 50%; margin-right: 5px;"></span>Entity</span>
    <span><span style="display: inline-block; width: 12px; height: 12px; background: #2ecc71; border-radius: 50%; margin-right: 5px;"></span>Term</span>
</div>
</article>
<script>
(function() {
    const data = {"nodes": [{"id": "domain_Identity", "name": "Identity", "type": "Domain", "group": "Supporting"}, {"id": "domain_Audit", "name": "Audit", "type": "Domain", "group": "Core"}, {"id": "domain_AuditGroup", "name": "AuditGroup", "type": "Domain", "group": "Supporting"}, {"id": "domain_File", "name": "File", "type": "Domain", "group": "Supporting"}, {"id": "domain_Event", "name": "Event", "type": "Domain", "group": "Core"}, {"id": "domain_Verification", "name": "Verification", "type": "Domain", "group": "Core"}, {"id": "domain_BOXIntegration", "name": "BOXIntegration", "type": "Domain", "group": "Integration"}, {"id": "entity_User", "name": "User", "type": "Entity", "group": "class"}, {"id": "entity_UserToken", "name": "UserToken", "type": "Entity", "group": "class"}, {"id": "entity_UserOtp", "name": "UserOtp", "type": "Entity", "group": "class"}, {"id": "entity_Organization", "name": "Organization", "type": "Entity", "group": "class"}, {"id": "entity_RoleUser", "name": "RoleUser", "type": "Entity", "group": "class"}, {"id": "entity_AuditSet", "name": "AuditSet", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetItem", "name": "AuditSetItem", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetCollaborators", "name": "AuditSetCollaborators", "type": "Entity", "group": "class"}, {"id": "entity_AuditGroup", "name": "AuditGroup", "type": "Entity", "group": "class"}, {"id": "entity_UserAuditGroup", "name": "UserAuditGroup", "type": "Entity", "group": "class"}, {"id": "entity_AuditGrpAuditSetMapping", "name": "AuditGrpAuditSetMapping", "type": "Entity", "group": "class"}, {"id": "entity_Item", "name": "Item", "type": "Entity", "group": "class"}, {"id": "entity_ItemStatus", "name": "ItemStatus", "type": "Entity", "group": "class"}, {"id": "entity_ItemEvents", "name": "ItemEvents", "type": "Entity", "group": "class"}, {"id": "entity_ItemsBySha1", "name": "ItemsBySha1", "type": "Entity", "group": "class"}, {"id": "entity_Events", "name": "Events", "type": "Entity", "group": "class"}, {"id": "entity_EnterpriseEventLogs", "name": "EnterpriseEventLogs", "type": "Entity", "group": "class"}, {"id": "entity_PositionTracker", "name": "PositionTracker", "type": "Entity", "group": "class"}, {"id": "entity_AuditorLogs", "name": "AuditorLogs", "type": "Entity", "group": "class"}, {"id": "entity_SystemEventDates", "name": "SystemEventDates", "type": "Entity", "group": "class"}, {"id": "entity_UserController", "name": "UserController", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetController", "name": "AuditSetController", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetItemController", "name": "AuditSetItemController", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetCollaboratorController", "name": "AuditSetCollaboratorController", "type": "Entity", "group": "class"}, {"id": "entity_AuditGroupController", "name": "AuditGroupController", "type": "Entity", "group": "class"}, {"id": "entity_FileController", "name": "FileController", "type": "Entity", "group": "class"}, {"id": "entity_FolderController", "name": "FolderController", "type": "Entity", "group": "class"}, {"id": "entity_ItemController", "name": "ItemController", "type": "Entity", "group": "class"}, {"id": "entity_EventLogController", "name": "EventLogController", "type": "Entity", "group": "class"}, {"id": "entity_UserService", "name": "UserService", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetService", "name": "AuditSetService", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetItemService", "name": "AuditSetItemService", "type": "Entity", "group": "class"}, {"id": "entity_AuditSetCollaboratorService", "name": "AuditSetCollaboratorService", "type": "Entity", "group": "class"}, {"id": "entity_AuditGroupService", "name": "AuditGroupService", "type": "Entity", "group": "class"}, {"id": "entity_FileService", "name": "FileService", "type": "Entity", "group": "class"}, {"id": "entity_FolderService", "name": "FolderService", "type": "Entity", "group": "class"}, {"id": "entity_CommonService", "name": "CommonService", "type": "Entity", "group": "class"}, {"id": "entity_AssetService", "name": "AssetService", "type": "Entity", "group": "class"}, {"id": "entity_EventLogService", "name": "EventLogService", "type": "Entity", "group": "class"}, {"id": "entity_UserRepository", "name": "UserRepository", "type": "Entity", "group": "interface"}, {"id": "entity_UserTokenRepository", "name": "UserTokenRepository", "type": "Entity", "group": "interface"}, {"id": "entity_UserOptRepository", "name": "UserOptRepository", "type": "Entity", "group": "interface"}, {"id": "entity_OrganizationRepository", "name": "OrganizationRepository", "type": "Entity", "group": "interface"}, {"id": "entity_RoleUserRepository", "name": "RoleUserRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditSetRepository", "name": "AuditSetRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditSetItemRepository", "name": "AuditSetItemRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditSetCollaboratorsRepository", "name": "AuditSetCollaboratorsRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditGroupRepository", "name": "AuditGroupRepository", "type": "Entity", "group": "interface"}, {"id": "entity_UserAuditGroupRepository", "name": "UserAuditGroupRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditGrpAuditSetMappingRepository", "name": "AuditGrpAuditSetMappingRepository", "type": "Entity", "group": "interface"}, {"id": "entity_ItemRepository", "name": "ItemRepository", "type": "Entity", "group": "interface"}, {"id": "entity_ItemStatusRepository", "name": "ItemStatusRepository", "type": "Entity", "group": "interface"}, {"id": "entity_ItemEventsRepository", "name": "ItemEventsRepository", "type": "Entity", "group": "interface"}, {"id": "entity_ItemsBySha1Repository", "name": "ItemsBySha1Repository", "type": "Entity", "group": "interface"}, {"id": "entity_EventsRepository", "name": "EventsRepository", "type": "Entity", "group": "interface"}, {"id": "entity_EnterpriseEventLogsRepository", "name": "EnterpriseEventLogsRepository", "type": "Entity", "group": "interface"}, {"id": "entity_PositionTrackerRepository", "name": "PositionTrackerRepository", "type": "Entity", "group": "interface"}, {"id": "entity_AuditorLogsRepository", "name": "AuditorLogsRepository", "type": "Entity", "group": "interface"}, {"id": "entity_SystemEventDatesRepository", "name": "SystemEventDatesRepository", "type": "Entity", "group": "interface"}, {"id": "entity_ScalardlRepository", "name": "ScalardlRepository", "type": "Entity", "group": "interface"}, {"id": "term_AuditSet", "name": "AuditSet (\u76e3\u67fb\u30bb\u30c3\u30c8)", "type": "Term", "group": "Audit"}, {"id": "term_AuditGroup", "name": "AuditGroup (\u76e3\u67fb\u30b0\u30eb\u30fc\u30d7)", "type": "Term", "group": "Audit"}, {"id": "term_Collaborator", "name": "Collaborator (\u30b3\u30e9\u30dc\u30ec\u30fc\u30bf\u30fc)", "type": "Term", "group": "Audit"}, {"id": "term_Reviewer", "name": "Reviewer (\u30ec\u30d3\u30e5\u30a2\u30fc)", "type": "Term", "group": "Audit"}, {"id": "term_AuditAdmin", "name": "AuditAdmin (\u76e3\u67fb\u7ba1\u7406\u8005)", "type": "Term", "group": "Audit"}, {"id": "term_GeneralUser", "name": "GeneralUser (\u4e00\u822c\u30e6\u30fc\u30b6\u30fc)", "type": "Term", "group": "Identity"}, {"id": "term_ExternalAuditor", "name": "ExternalAuditor (\u5916\u90e8\u76e3\u67fb\u4eba)", "type": "Term", "group": "Audit"}, {"id": "term_Item", "name": "Item (\u30a2\u30a4\u30c6\u30e0)", "type": "Term", "group": "File"}, {"id": "term_Asset", "name": "Asset (\u30a2\u30bb\u30c3\u30c8)", "type": "Term", "group": "Verification"}, {"id": "term_TamperingVerification", "name": "TamperingVerification (\u6539\u3056\u3093\u691c\u8a3c)", "type": "Term", "group": "Verification"}, {"id": "term_FileCopy", "name": "FileCopy (\u30d5\u30a1\u30a4\u30eb\u30b3\u30d4\u30fc)", "type": "Term", "group": "File"}, {"id": "term_FileVersion", "name": "FileVersion (\u30d5\u30a1\u30a4\u30eb\u30d0\u30fc\u30b8\u30e7\u30f3)", "type": "Term", "group": "File"}, {"id": "term_SHA1Hash", "name": "SHA1Hash (SHA1\u30cf\u30c3\u30b7\u30e5)", "type": "Term", "group": "File"}, {"id": "term_EventLog", "name": "EventLog (\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0)", "type": "Term", "group": "Event"}, {"id": "term_EnterpriseEvent", "name": "EnterpriseEvent (\u30a8\u30f3\u30bf\u30fc\u30d7\u30e9\u30a4\u30ba\u30a4\u30d9\u30f3\u30c8)", "type": "Term", "group": "Event"}, {"id": "term_EventType", "name": "EventType (\u30a4\u30d9\u30f3\u30c8\u30bf\u30a4\u30d7)", "type": "Term", "group": "Event"}, {"id": "term_PositionTracker", "name": "PositionTracker (\u4f4d\u7f6e\u30c8\u30e9\u30c3\u30ab\u30fc)", "type": "Term", "group": "Event"}, {"id": "term_OTP", "name": "OTP (\u30ef\u30f3\u30bf\u30a4\u30e0\u30d1\u30b9\u30ef\u30fc\u30c9)", "type": "Term", "group": "Identity"}, {"id": "term_RefreshToken", "name": "RefreshToken (\u30ea\u30d5\u30ec\u30c3\u30b7\u30e5\u30c8\u30fc\u30af\u30f3)", "type": "Term", "group": "Identity"}, {"id": "term_AccessToken", "name": "AccessToken (\u30a2\u30af\u30bb\u30b9\u30c8\u30fc\u30af\u30f3)", "type": "Term", "group": "Identity"}, {"id": "term_Organization", "name": "Organization (\u7d44\u7e54)", "type": "Term", "group": "Identity"}, {"id": "term_BoxAdmin", "name": "BoxAdmin (Box\u7ba1\u7406\u8005)", "type": "Term", "group": "Identity"}, {"id": "term_AuditSetItem", "name": "AuditSetItem (\u76e3\u67fb\u30bb\u30c3\u30c8\u30a2\u30a4\u30c6\u30e0)", "type": "Term", "group": "Audit"}, {"id": "term_AuditSetCollaborator", "name": "AuditSetCollaborator (\u76e3\u67fb\u30bb\u30c3\u30c8\u30b3\u30e9\u30dc\u30ec\u30fc\u30bf\u30fc)", "type": "Term", "group": "Audit"}, {"id": "term_AuditorLog", "name": "AuditorLog (\u76e3\u67fb\u30ed\u30b0)", "type": "Term", "group": "Event"}, {"id": "term_ItemStatus", "name": "ItemStatus (\u30a2\u30a4\u30c6\u30e0\u30b9\u30c6\u30fc\u30bf\u30b9)", "type": "Term", "group": "File"}], "links": [{"source": "entity_User", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserToken", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserOtp", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "term_Organization", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_RoleUser", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserController", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserService", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserRepository", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserTokenRepository", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_UserOptRepository", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_OrganizationRepository", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "entity_RoleUserRepository", "target": "domain_Identity", "type": "BELONGS_TO"}, {"source": "term_AuditSet", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "term_AuditSetItem", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetCollaborators", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetController", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetItemController", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetCollaboratorController", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetService", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetItemService", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetCollaboratorService", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetRepository", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetItemRepository", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "entity_AuditSetCollaboratorsRepository", "target": "domain_Audit", "type": "BELONGS_TO"}, {"source": "term_AuditGroup", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_UserAuditGroup", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_AuditGrpAuditSetMapping", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_AuditGroupController", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_AuditGroupService", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_AuditGroupRepository", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_UserAuditGroupRepository", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "entity_AuditGrpAuditSetMappingRepository", "target": "term_AuditGroup", "type": "BELONGS_TO"}, {"source": "term_Item", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "term_ItemStatus", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemEvents", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemsBySha1", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_FileController", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_FolderController", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemController", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_FileService", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_FolderService", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_CommonService", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemRepository", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemStatusRepository", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemEventsRepository", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_ItemsBySha1Repository", "target": "domain_File", "type": "BELONGS_TO"}, {"source": "entity_Events", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_EnterpriseEventLogs", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "term_PositionTracker", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_AuditorLogs", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_SystemEventDates", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_EventLogController", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_EventLogService", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_EventsRepository", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_EnterpriseEventLogsRepository", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_PositionTrackerRepository", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_AuditorLogsRepository", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_SystemEventDatesRepository", "target": "domain_Event", "type": "BELONGS_TO"}, {"source": "entity_AssetService", "target": "domain_Verification", "type": "BELONGS_TO"}, {"source": "entity_ScalardlRepository", "target": "domain_Verification", "type": "BELONGS_TO"}, {"source": "term_AuditSet", "target": "entity_User", "type": "owned_by"}, {"source": "term_AuditSetItem", "target": "term_AuditSet", "type": "belongs_to"}, {"source": "term_AuditSetItem", "target": "term_Item", "type": "references"}, {"source": "entity_AuditSetCollaborators", "target": "term_AuditSet", "type": "belongs_to"}, {"source": "entity_AuditSetCollaborators", "target": "entity_User", "type": "references"}, {"source": "term_AuditGroup", "target": "entity_User", "type": "owned_by"}, {"source": "entity_UserAuditGroup", "target": "entity_User", "type": "references"}, {"source": "entity_UserAuditGroup", "target": "term_AuditGroup", "type": "belongs_to"}, {"source": "entity_AuditGrpAuditSetMapping", "target": "term_AuditGroup", "type": "references"}, {"source": "entity_AuditGrpAuditSetMapping", "target": "term_AuditSet", "type": "references"}, {"source": "term_Item", "target": "term_ItemStatus", "type": "has"}, {"source": "term_Item", "target": "entity_ItemEvents", "type": "has"}, {"source": "term_Item", "target": "entity_ItemsBySha1", "type": "grouped_by"}, {"source": "entity_Events", "target": "entity_User", "type": "triggered_by"}, {"source": "entity_Events", "target": "term_Item", "type": "affects"}, {"source": "entity_AuditorLogs", "target": "entity_User", "type": "logged_for"}, {"source": "entity_UserController", "target": "entity_UserService", "type": "uses"}, {"source": "entity_AuditSetController", "target": "entity_AuditSetService", "type": "uses"}, {"source": "entity_AuditSetItemController", "target": "entity_AuditSetItemService", "type": "uses"}, {"source": "entity_AuditSetCollaboratorController", "target": "entity_AuditSetCollaboratorService", "type": "uses"}, {"source": "entity_AuditGroupController", "target": "entity_AuditGroupService", "type": "uses"}, {"source": "entity_FileController", "target": "entity_FileService", "type": "uses"}, {"source": "entity_FolderController", "target": "entity_FolderService", "type": "uses"}, {"source": "entity_EventLogController", "target": "entity_EventLogService", "type": "uses"}, {"source": "entity_UserService", "target": "entity_UserRepository", "type": "uses"}, {"source": "entity_UserService", "target": "entity_UserTokenRepository", "type": "uses"}, {"source": "entity_UserService", "target": "entity_UserOptRepository", "type": "uses"}, {"source": "entity_UserService", "target": "entity_OrganizationRepository", "type": "uses"}, {"source": "entity_AuditSetService", "target": "entity_AuditSetRepository", "type": "uses"}, {"source": "entity_AuditSetItemService", "target": "entity_AuditSetItemRepository", "type": "uses"}, {"source": "entity_AuditSetCollaboratorService", "target": "entity_AuditSetCollaboratorsRepository", "type": "uses"}, {"source": "entity_AuditGroupService", "target": "entity_AuditGroupRepository", "type": "uses"}, {"source": "entity_AuditGroupService", "target": "entity_UserAuditGroupRepository", "type": "uses"}, {"source": "entity_FileService", "target": "entity_ItemRepository", "type": "uses"}, {"source": "entity_FileService", "target": "entity_ItemStatusRepository", "type": "uses"}, {"source": "entity_EventLogService", "target": "entity_EventsRepository", "type": "uses"}, {"source": "entity_EventLogService", "target": "entity_EnterpriseEventLogsRepository", "type": "uses"}, {"source": "entity_EventLogService", "target": "entity_PositionTrackerRepository", "type": "uses"}, {"source": "entity_AssetService", "target": "entity_ScalardlRepository", "type": "uses"}]};

    const container = document.getElementById('graph-container');
    const width = container.clientWidth;
    const height = 600;

    const svg = d3.select("#graph-svg")
        .attr("width", width)
        .attr("height", height);

    const g = svg.append("g");

    // Zoom
    const zoom = d3.zoom()
        .scaleExtent([0.1, 4])
        .on("zoom", (event) => g.attr("transform", event.transform));
    svg.call(zoom);

    // Colors
    const color = d3.scaleOrdinal()
        .domain(["Domain", "Entity", "Term"])
        .range(["#e74c3c", "#3498db", "#2ecc71"]);

    // Simulation
    const simulation = d3.forceSimulation(data.nodes)
        .force("link", d3.forceLink(data.links).id(d => d.id).distance(80))
        .force("charge", d3.forceManyBody().strength(-200))
        .force("center", d3.forceCenter(width / 2, height / 2))
        .force("collision", d3.forceCollide().radius(25));

    // Links
    const link = g.append("g")
        .selectAll("line")
        .data(data.links)
        .join("line")
        .attr("stroke", "#666")
        .attr("stroke-opacity", 0.6)
        .attr("stroke-width", 1);

    // Nodes
    const node = g.append("g")
        .selectAll("g")
        .data(data.nodes)
        .join("g")
        .attr("cursor", "pointer")
        .call(d3.drag()
            .on("start", (event, d) => {
                if (!event.active) simulation.alphaTarget(0.3).restart();
                d.fx = d.x; d.fy = d.y;
            })
            .on("drag", (event, d) => { d.fx = event.x; d.fy = event.y; })
            .on("end", (event, d) => {
                if (!event.active) simulation.alphaTarget(0);
                d.fx = null; d.fy = null;
            }));

    node.append("circle")
        .attr("r", d => d.type === "Domain" ? 15 : 8)
        .attr("fill", d => color(d.type));

    node.append("text")
        .text(d => d.name.length > 15 ? d.name.substring(0, 15) + "..." : d.name)
        .attr("x", 12)
        .attr("y", 4)
        .attr("font-size", "10px")
        .attr("fill", "white");

    // Tooltip
    const tooltip = d3.select("body").append("div")
        .style("position", "absolute")
        .style("background", "rgba(0,0,0,0.8)")
        .style("color", "white")
        .style("padding", "10px")
        .style("border-radius", "5px")
        .style("font-size", "12px")
        .style("pointer-events", "none")
        .style("opacity", 0);

    node.on("mouseover", (event, d) => {
        tooltip.style("opacity", 1)
            .html(`<strong>${d.name}</strong><br/>Type: ${d.type}<br/>Group: ${d.group || 'N/A'}`)
            .style("left", (event.pageX + 10) + "px")
            .style("top", (event.pageY - 10) + "px");
    }).on("mouseout", () => { tooltip.style("opacity", 0); });

    simulation.on("tick", () => {
        link.attr("x1", d => d.source.x).attr("y1", d => d.source.y)
            .attr("x2", d => d.target.x).attr("y2", d => d.target.y);
        node.attr("transform", d => `translate(${d.x},${d.y})`);
    });

    // Stats
    document.getElementById("graph-stats").innerHTML =
        `Nodes: ${data.nodes.length} | Links: ${data.links.length}`;

    // Search
    document.getElementById("graph-search").addEventListener("input", (e) => {
        const query = e.target.value.toLowerCase();
        node.style("opacity", d =>
            query === "" || d.name.toLowerCase().includes(query) ? 1 : 0.2);
    });
})();
</script>

</section>
</main>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
    </script>
</body>
</html>
