# MMI評価概要

## 評価対象システム

**Scalar Auditor for BOX** - BOX統合ファイル監査ツール

## MMI（Modularity Maturity Index）とは

MMIは、システムのモジュール化成熟度を4軸で評価する指標です。

### 評価軸と重み

| 軸 | 重み | 評価内容 |
|----|------|---------|
| Cohesion（凝集度） | 30% | 単一責任原則の遵守度、機能の集中度 |
| Coupling（結合度） | 30% | 疎結合度、循環依存の有無 |
| Independence（独立性） | 20% | デプロイ独立性、他モジュールへの影響度 |
| Reusability（再利用性） | 20% | 他コンテキストでの適用可能性 |

### 成熟度レベル

| スコア範囲 | レベル | 説明 |
|-----------|--------|------|
| 80-100 | 高成熟度 | マイクロサービス化に適した状態 |
| 60-80 | 中成熟度 | 軽微な改善でマイクロサービス化可能 |
| 40-60 | 低中成熟度 | 中程度のリファクタリングが必要 |
| 0-40 | 未成熟 | 大規模なリファクタリングが必要 |

## システム全体のMMIスコア

### 総合スコア: 52.3 / 100（低中成熟度）

```
┌─────────────────────────────────────────────────────────────┐
│ MMI Total Score                                              │
├─────────────────────────────────────────────────────────────┤
│ ████████████████████████████░░░░░░░░░░░░░░░░░░  52.3%       │
└─────────────────────────────────────────────────────────────┘
```

### 軸別スコア

| 軸 | スコア | 重み付きスコア |
|----|--------|---------------|
| Cohesion | 45/100 | 13.5 |
| Coupling | 50/100 | 15.0 |
| Independence | 55/100 | 11.0 |
| Reusability | 64/100 | 12.8 |
| **合計** | - | **52.3** |

```
Cohesion      ████████████████████████░░░░░░░░░░░░░░░░░░░░░░░░  45%
Coupling      █████████████████████████████░░░░░░░░░░░░░░░░░░░  50%
Independence  ███████████████████████████████░░░░░░░░░░░░░░░░░  55%
Reusability   ████████████████████████████████████░░░░░░░░░░░░  64%
```

## モジュール別スコアサマリー

### バックエンドサービス

| モジュール | Cohesion | Coupling | Independence | Reusability | MMI |
|-----------|----------|----------|--------------|-------------|-----|
| UserService | 25 | 30 | 40 | 45 | 34.0 |
| AuditSetService | 40 | 45 | 50 | 55 | 46.5 |
| AuditSetItemService | 35 | 40 | 45 | 50 | 41.5 |
| AuditGroupService | 55 | 55 | 60 | 65 | 57.5 |
| FileService | 50 | 50 | 55 | 60 | 52.5 |
| EventLogService | 70 | 75 | 70 | 75 | 72.5 |
| AssetService | 65 | 70 | 65 | 70 | 67.5 |
| CommonService | 80 | 85 | 75 | 70 | 78.5 |
| FolderService | 60 | 65 | 60 | 65 | 62.5 |
| AuditSetCollaboratorService | 55 | 60 | 55 | 60 | 57.5 |

### フロントエンドモジュール

| モジュール | Cohesion | Coupling | Independence | Reusability | MMI |
|-----------|----------|----------|--------------|-------------|-----|
| pages/auth | 60 | 55 | 60 | 55 | 57.5 |
| pages/AuditSet | 45 | 50 | 50 | 45 | 47.5 |
| pages/AuditorsAndGroups | 50 | 55 | 55 | 50 | 52.5 |
| pages/ExternalAuditorPage | 45 | 50 | 50 | 45 | 47.5 |
| pages/ViewAllEventHistory | 55 | 60 | 60 | 55 | 57.5 |
| redux | 65 | 60 | 55 | 60 | 60.0 |

## 主要な問題点

### 1. God Class問題（深刻度: 高）

**UserService** が1118行、20以上の依存を持つ巨大クラス

```
責務の混在:
├── 認証・認可
├── ユーザーCRUD
├── ロール管理
├── トークン管理
├── メール送信
├── BOX連携
└── パスワードリセット
```

### 2. サービス間密結合（深刻度: 中）

```
依存関係:
AuditSetItemService ──→ AuditSetService
FileService ──→ UserService
AuditSetService ──→ CommonService
```

### 3. 大規模サービスクラス（深刻度: 中）

| クラス | 行数 | 問題点 |
|-------|------|--------|
| UserService | 1118 | 責務過多、分割必要 |
| AuditSetItemService | 902 | やや大きい |
| AuditSetService | 845 | やや大きい |

### 4. フロントエンドの状態管理（深刻度: 低）

- 一部コンポーネントでローカル状態とRedux状態が混在
- ページコンポーネントが大きすぎる（AuditSet: 1000行超）

## 改善の優先順位

| 優先度 | 対象 | 改善内容 | 期待効果 |
|--------|------|---------|---------|
| 1 | UserService | 責務分割（5-6サービスへ） | Cohesion +30, Coupling +25 |
| 2 | AuditSetItemService | AssetServiceとの統合検討 | Coupling +15 |
| 3 | FileService | UserService依存の削除 | Independence +20 |
| 4 | フロントエンド | コンポーネント分割 | Reusability +15 |

## 次のステップ

1. **Phase 3: ドメインマッピング** - 境界づけられたコンテキストの特定
2. **Phase 4: マイクロサービス設計** - サービス境界の決定
3. **Phase 5: ScalarDB設計** - データアーキテクチャの最適化
